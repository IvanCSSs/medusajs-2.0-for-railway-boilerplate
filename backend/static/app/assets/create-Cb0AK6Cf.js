import{X as h,eF as v,r as b,K as j,j as e,L as u}from"./index-S35l5lon.js";import{s as g}from"./client-DUf8-hSd.js";import{t as d}from"./toast-_TmXxcvA.js";import{A as f,S as y}from"./switch-BDQaPcbG.js";import{E as N}from"./envelope-solid-BKxvxx9H.js";import{L as l,I as i,T as C}from"./textarea-MFJZH2HF.js";import{C as c,H as o,T as _}from"./heading-Cdx6okg4.js";import{B as m}from"./button-9jJy7PHD.js";import"./spinner-2pZ_p3OB.js";import"./x-circle-solid-BoF-1eMv.js";import"./index-B9-Umq18.js";const w=async r=>await g.client.fetch("/admin/email-templates",{method:"POST",body:r}),T=[{value:"order.placed",label:"Order Placed"},{value:"order.shipped",label:"Order Shipped"},{value:"order.canceled",label:"Order Canceled"},{value:"order.completed",label:"Order Completed"},{value:"customer.created",label:"Customer Created"},{value:"customer.password_reset",label:"Password Reset"},{value:"refund.created",label:"Refund Created"},{value:"invite.created",label:"Invite Created"}],E=`<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{subject}}</title>
</head>
<body style="font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px;">
  <div style="background-color: #f8f9fa; padding: 20px; border-radius: 8px;">
    <h1 style="color: #1a1a1a; margin-bottom: 16px;">Hello!</h1>
    <p>Your email content goes here.</p>
    <p>Use {{variable}} syntax for dynamic content.</p>
  </div>
  <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #eee; font-size: 12px; color: #666;">
    <p>{{store.name}}</p>
  </div>
</body>
</html>`,B=()=>{const r=h(),p=v(),[t,a]=b.useState({name:"",subject:"",description:"",event_name:"",html_content:E,is_active:!0}),n=j({mutationFn:w,onSuccess:()=>{p.invalidateQueries({queryKey:["email-templates"]}),d.success("Template created successfully"),r("/notifications")},onError:s=>{d.error(s.message||"Failed to create template")}}),x=s=>{if(s.preventDefault(),!t.name||!t.subject||!t.event_name||!t.html_content){d.error("Please fill in all required fields");return}n.mutate({name:t.name,subject:t.subject,description:t.description||void 0,event_name:t.event_name,html_content:t.html_content,is_active:t.is_active})};return e.jsxs("div",{className:"flex flex-col gap-y-4 p-6",children:[e.jsx(c,{className:"divide-y p-0",children:e.jsx("div",{className:"flex items-center justify-between px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-x-3",children:[e.jsx(m,{variant:"transparent",size:"small",asChild:!0,children:e.jsx(u,{to:"/notifications",children:e.jsx(f,{})})}),e.jsx(N,{className:"text-ui-fg-subtle"}),e.jsx(o,{level:"h1",children:"Create Email Template"})]})})}),e.jsxs("form",{onSubmit:x,children:[e.jsxs(c,{className:"divide-y p-0",children:[e.jsx("div",{className:"px-6 py-4",children:e.jsx(o,{level:"h2",children:"Template Details"})}),e.jsxs("div",{className:"px-6 py-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"name",children:"Name *"}),e.jsx(i,{id:"name",value:t.name,onChange:s=>a({...t,name:s.target.value}),placeholder:"e.g., Order Confirmation",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"event_name",children:"Event Name *"}),e.jsx("div",{className:"flex gap-2",children:e.jsx(i,{id:"event_name",value:t.event_name,onChange:s=>a({...t,event_name:s.target.value}),placeholder:"e.g., order.placed",className:"font-mono flex-1",required:!0})}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:T.map(s=>e.jsx("button",{type:"button",onClick:()=>a({...t,event_name:s.value}),className:"text-xs px-2 py-1 rounded bg-ui-bg-subtle hover:bg-ui-bg-subtle-hover text-ui-fg-subtle",children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"subject",children:"Subject *"}),e.jsx(i,{id:"subject",value:t.subject,onChange:s=>a({...t,subject:s.target.value}),placeholder:"e.g., Your order has been confirmed!",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"description",children:"Description"}),e.jsx(i,{id:"description",value:t.description,onChange:s=>a({...t,description:s.target.value}),placeholder:"Brief description of when this template is used"})]}),e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx(y,{id:"is_active",checked:t.is_active,onCheckedChange:s=>a({...t,is_active:s})}),e.jsx(l,{htmlFor:"is_active",children:"Active"})]})]})]}),e.jsxs(c,{className:"divide-y p-0 mt-4",children:[e.jsxs("div",{className:"px-6 py-4",children:[e.jsx(o,{level:"h2",children:"HTML Content *"}),e.jsxs(_,{size:"small",className:"text-ui-fg-subtle mt-1",children:["Use ","{{variable}}"," syntax for dynamic content. Common variables:"]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[e.jsx("code",{className:"text-xs px-2 py-1 rounded bg-ui-bg-subtle",children:"{{customer.email}}"}),e.jsx("code",{className:"text-xs px-2 py-1 rounded bg-ui-bg-subtle",children:"{{customer.first_name}}"}),e.jsx("code",{className:"text-xs px-2 py-1 rounded bg-ui-bg-subtle",children:"{{order.display_id}}"}),e.jsx("code",{className:"text-xs px-2 py-1 rounded bg-ui-bg-subtle",children:"{{order.total}}"}),e.jsx("code",{className:"text-xs px-2 py-1 rounded bg-ui-bg-subtle",children:"{{store.name}}"}),e.jsx("code",{className:"text-xs px-2 py-1 rounded bg-ui-bg-subtle",children:"{{reset_link}}"})]})]}),e.jsx("div",{className:"px-6 py-4",children:e.jsx(C,{value:t.html_content,onChange:s=>a({...t,html_content:s.target.value}),placeholder:"<html>...</html>",className:"font-mono text-sm min-h-[400px]",required:!0})})]}),e.jsxs("div",{className:"flex justify-end gap-x-2 mt-4",children:[e.jsx(m,{variant:"secondary",asChild:!0,children:e.jsx(u,{to:"/notifications",children:"Cancel"})}),e.jsx(m,{type:"submit",disabled:n.isPending,children:n.isPending?"Creating...":"Create Template"})]})]})]})};export{B as Component};
