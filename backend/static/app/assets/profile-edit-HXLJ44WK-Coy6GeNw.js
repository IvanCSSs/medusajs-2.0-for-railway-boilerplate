import{bE as E,u as y,j as e,H as L,z as N,c as S,aw as g,bF as w,t as u,F as s,I as p,B as f,e as I,o as P,s as h}from"./index-S35l5lon.js";import{K as H}from"./chunk-6HTZNHPT-USxWRfar.js";import{a as i,u as M}from"./chunk-AERWK3TJ-Gph8MRZF.js";import{S as c}from"./select-CmrtK7XQ.js";import"./focus-modal-B7NOABos.js";import"./prompt-YaiseBxh.js";import"./check-B9bFzKnZ.js";import"./triangles-mini-CX2619vl.js";var T=P({first_name:h().optional(),last_name:h().optional(),language:h()}),z=({user:l})=>{const{t:r,i18n:d}=y(),{handleSuccess:m}=M(),x=N(),t=S({defaultValues:{first_name:l.first_name??"",last_name:l.last_name??"",language:d.language},resolver:I(T)}),_=async a=>{await d.changeLanguage(a)},b=g.sort((a,n)=>a.display_name.localeCompare(n.display_name)),{mutateAsync:v,isPending:C}=w(l.id),F=t.handleSubmit(async a=>{await v({first_name:a.first_name,last_name:a.last_name},{onError:n=>{u.error(n.message)}}),await _(a.language),u.success(r("profile.toast.edit")),m()});return e.jsx(i.Form,{form:t,children:e.jsxs(H,{onSubmit:F,className:"flex flex-1 flex-col",children:[e.jsx(i.Body,{children:e.jsxs("div",{className:"flex flex-col gap-y-8",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(s.Field,{control:t.control,name:"first_name",render:({field:a})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{children:r("fields.firstName")}),e.jsx(s.Control,{children:e.jsx(p,{...a})}),e.jsx(s.ErrorMessage,{})]})}),e.jsx(s.Field,{control:t.control,name:"last_name",render:({field:a})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{children:r("fields.lastName")}),e.jsx(s.Control,{children:e.jsx(p,{...a})}),e.jsx(s.ErrorMessage,{})]})})]}),e.jsx(s.Field,{control:t.control,name:"language",render:({field:{ref:a,...n}})=>{var j;return e.jsxs(s.Item,{className:"gap-y-4",children:[e.jsxs("div",{children:[e.jsx(s.Label,{children:r("profile.fields.languageLabel")}),e.jsx(s.Hint,{children:r("profile.edit.languageHint")})]}),e.jsxs("div",{children:[e.jsx(s.Control,{children:e.jsxs(c,{dir:x,...n,onValueChange:n.onChange,children:[e.jsx(c.Trigger,{ref:a,className:"py-1 text-[13px]",children:e.jsx(c.Value,{placeholder:r("profile.edit.languagePlaceholder"),children:(j=b.find(o=>o.code===n.value))==null?void 0:j.display_name})}),e.jsx(c.Content,{children:g.map(o=>e.jsx(c.Item,{value:o.code,children:o.display_name},o.code))})]})}),e.jsx(s.ErrorMessage,{})]})]})}})]})}),e.jsx(i.Footer,{children:e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx(i.Close,{asChild:!0,children:e.jsx(f,{size:"small",variant:"secondary",children:r("actions.cancel")})}),e.jsx(f,{size:"small",type:"submit",isLoading:C,children:r("actions.save")})]})})]})})},k=()=>{const{user:l,isPending:r,isError:d,error:m}=E(),{t:x}=y();if(d)throw m;return e.jsxs(i,{children:[e.jsx(i.Header,{className:"capitalize",children:e.jsx(i.Title,{asChild:!0,children:e.jsx(L,{children:x("profile.edit.header")})})}),!r&&l&&e.jsx(z,{user:l})]})};export{k as Component};
