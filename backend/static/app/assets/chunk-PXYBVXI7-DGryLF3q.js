import{f as w}from"./chunk-4FM6S5CX-BpW1LsFY.js";import{D as x}from"./chunk-IFFVQD5Q-CYuRkI39.js";import{T as M}from"./chunk-FMPUXSXC-DpF6ipvW.js";import{L as E,u as R}from"./chunk-EGD5UUDW-D7jeo1Iu.js";import{u as p,j as e,q as g,y as D,r as N,d1 as I,L as k,B,A as _,ct as A,cu as L,w as V,x as $,cv as q,co as K,G as y,T as U,U as F,cC as G}from"./index-S35l5lon.js";import{a as Q}from"./chunk-ASIIOFVB-BHdj0c6d.js";import{D as Y}from"./chunk-ULVVVKLF-DQ5i1kAh.js";import{D as H}from"./chunk-HQKGZADC-CFjwmGLF.js";import{a as J,N as W}from"./chunk-EMIHDNB7-1UnYIHIF.js";import{u as X,a as Z,b as ee}from"./index-D8hIMFbh.js";import{P as z}from"./pencil-square-Y_YO1xMN.js";import{T as C}from"./trash-VeZKzNu3.js";import{A as se}from"./arrow-down-right-mini-BkrFKUze.js";import{S}from"./status-badge-CXGqPLdn.js";var ye=({taxRate:s,isSublevelTaxRate:a})=>{const{t:i}=p();return e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-[1fr_1fr_auto] items-center gap-4 px-6 py-4",children:[e.jsxs("div",{className:"flex items-center gap-x-1.5",children:[e.jsx(g,{size:"small",weight:"plus",leading:"compact",children:s.name}),s.code&&e.jsxs("div",{className:"flex items-center gap-x-1.5",children:[e.jsx(g,{size:"small",leading:"compact",children:"·"}),e.jsx(g,{size:"small",leading:"compact",children:s.code})]})]}),e.jsx(g,{size:"small",leading:"compact",children:w(s.rate)}),e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[a&&e.jsx(S,{color:s.is_combinable?"green":"grey",children:s.is_combinable?i("taxRegions.fields.isCombinable.true"):i("taxRegions.fields.isCombinable.false")}),e.jsx(ae,{taxRate:s})]})]})},ae=({taxRate:s})=>{const{t:a}=p(),i=R(s);return e.jsx(_,{groups:[{actions:[{label:a("actions.edit"),icon:e.jsx(z,{}),to:`tax-rates/${s.id}/edit`}]},{actions:[{label:a("actions.delete"),icon:e.jsx(C,{}),onClick:i}]}]})},ie=({taxRate:s})=>{const{t:a}=p(),i=R(s);if(s.is_default)return null;const r=s.rules.reduce((t,n)=>(t[n.reference]||(t[n.reference]=[]),t[n.reference].push(n.reference_id),t),{}),d=Object.values(M),o=Object.keys(r).map(t=>d.includes(t)).length;return e.jsxs(A,{children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-3",children:[e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx(L,{asChild:!0,children:e.jsx(V,{size:"2xsmall",variant:"transparent",className:"group",children:e.jsx($,{className:"text-ui-fg-muted transition-transform group-data-[state='open']:rotate-90"})})}),e.jsxs("div",{className:"flex items-center gap-x-1.5",children:[e.jsx(g,{size:"small",weight:"plus",leading:"compact",children:s.name}),s.code&&e.jsxs("div",{className:"text-ui-fg-subtle flex items-center gap-x-1.5",children:[e.jsx(g,{size:"small",leading:"compact",children:"·"}),e.jsx(g,{size:"small",leading:"compact",children:s.code})]})]})]}),e.jsxs("div",{className:"flex items-center gap-x-3",children:[e.jsx(g,{size:"small",leading:"compact",className:"text-ui-fg-subtle",children:a("taxRegions.fields.targets.numberOfTargets",{count:o})}),e.jsx("div",{className:"bg-ui-border-base h-3 w-px"}),e.jsx(S,{color:s.is_combinable?"green":"grey",children:s.is_combinable?a("taxRegions.fields.isCombinable.true"):a("taxRegions.fields.isCombinable.false")}),e.jsx(_,{groups:[{actions:[{label:a("actions.edit"),icon:e.jsx(z,{}),to:`overrides/${s.id}/edit`}]},{actions:[{label:a("actions.delete"),icon:e.jsx(C,{}),onClick:i}]}]})]})]}),e.jsx(q,{children:e.jsxs("div",{className:"bg-ui-bg-subtle",children:[e.jsx(K,{variant:"dashed"}),e.jsx("div",{className:"px-6 py-3",children:e.jsxs("div",{className:"flex items-center gap-x-3",children:[e.jsx("div",{className:"text-ui-fg-muted flex size-5 items-center justify-center",children:e.jsx(se,{})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-x-1.5 gap-y-2",children:[e.jsx(y,{size:"2xsmall",children:w(s.rate)}),e.jsx(g,{size:"small",leading:"compact",className:"text-ui-fg-subtle",children:a("taxRegions.fields.targets.operators.on")}),Object.entries(r).map(([t,n],c)=>e.jsxs("div",{className:"flex items-center gap-x-1.5",children:[e.jsx(te,{reference:t,ids:n},t),c<Object.keys(r).length-1&&e.jsx(g,{size:"small",leading:"compact",className:"text-ui-fg-subtle",children:a("taxRegions.fields.targets.operators.and")})]},t))]})]})})]})})]})},te=({reference:s,ids:a})=>e.jsxs("div",{className:"flex items-center gap-x-1.5",children:[e.jsx(re,{reference:s}),e.jsx(ne,{type:s,ids:a})]}),re=({reference:s})=>{const{t:a}=p();let i=null;switch(s){case"product":i=a("taxRegions.fields.targets.tags.product");break;case"product_type":i=a("taxRegions.fields.targets.tags.productType");break;case"shipping_option":i=a("taxRegions.fields.targets.tags.shippingOption");break}return i?e.jsx(y,{size:"2xsmall",children:i}):null},ne=({type:s,ids:a})=>{const{t:i}=p(),{isPending:r,additional:d,labels:o,isError:t,error:n}=le(s,a);if(t)throw n;return r?e.jsx("div",{className:"bg-ui-tag-neutral-bg border-ui-tag-neutral-border h-5 w-14 animate-pulse rounded-md"}):e.jsx(U,{content:e.jsxs("ul",{children:[o==null?void 0:o.map((c,l)=>e.jsx("li",{children:c},l)),d>0&&e.jsx("li",{children:i("taxRegions.fields.targets.additionalValues",{count:d})})]}),children:e.jsx(y,{size:"2xsmall",children:i("taxRegions.fields.targets.values",{count:a.length})})})},le=(s,a)=>{var t,n,c;const i=F({id:a.slice(0,x),limit:x},{enabled:!!a.length&&s==="product"}),r=G({id:a.slice(0,x),limit:x},{enabled:!!a.length&&s==="product_type"}),d=Q({id:a.slice(0,x),limit:x},{enabled:!!a.length&&s==="shipping_option"}),o=a.length>x?a.length-x:0;switch(s){case"product":return{labels:(t=i.products)==null?void 0:t.map(l=>l.title),isPending:i.isPending,additional:o,isError:i.isError,error:i.error};case"product_type":return{labels:(n=r.product_types)==null?void 0:n.map(l=>l.value),isPending:r.isPending,additional:o,isError:r.isError,error:r.error};case"shipping_option":return{labels:(c=d.shipping_options)==null?void 0:c.map(l=>l.name),isPending:d.isPending,additional:o,isError:d.isError,error:d.error}}},Te=({isPending:s,action:a,count:i=0,table:r,queryObject:d,prefix:o,children:t})=>{if(s)return e.jsxs("div",{className:"flex flex-col divide-y",children:[Array.from({length:3}).map((m,j)=>e.jsx("div",{className:"bg-ui-bg-field-component h-[52px] w-full animate-pulse"},j)),e.jsx(I,{layout:"fit"})]});const n=Object.values(d).filter(m=>!!m).length===0,c=!s&&i===0&&!n,l=!s&&i===0&&n,{pageIndex:f,pageSize:h}=r.getState().pagination;return e.jsxs("div",{className:"flex flex-col divide-y",children:[e.jsxs("div",{className:"flex flex-col justify-between gap-x-4 gap-y-3 px-6 py-4 md:flex-row md:items-center",children:[e.jsx("div",{children:t}),e.jsxs("div",{className:"flex items-center gap-x-2",children:[!l&&e.jsxs("div",{className:"flex w-full items-center gap-x-2 md:w-fit",children:[e.jsx("div",{className:"w-full md:w-fit",children:e.jsx(Y,{prefix:o})}),e.jsx(H,{keys:["name","rate","code","updated_at","created_at"],prefix:o})]}),e.jsx(k,{to:a.to,children:e.jsx(B,{size:"small",variant:"secondary",children:a.label})})]})]}),c&&e.jsx(J,{}),l&&e.jsx(W,{}),!l&&!c?s?Array.from({length:3}).map((m,j)=>e.jsx("div",{className:"bg-ui-bg-field-component h-[60px] w-full animate-pulse"},j)):r.getRowModel().rows.map(m=>e.jsx(ie,{taxRate:m.original,role:"row","aria-rowindex":m.index},m.id)):null,!l&&e.jsx(E,{prefix:o,canNextPage:r.getCanNextPage(),canPreviousPage:r.getCanPreviousPage(),count:i,nextPage:r.nextPage,previousPage:r.previousPage,pageCount:r.getPageCount(),pageIndex:f,pageSize:h})]})},Pe=({data:s=[],count:a=0,pageSize:i=10,prefix:r})=>{const[d,o]=D(),t=`${`${r}_`}offset`,n=d.get(t),[{pageIndex:c,pageSize:l},f]=N.useState({pageIndex:n?Math.ceil(Number(n)/i):0,pageSize:i}),h=N.useMemo(()=>({pageIndex:c,pageSize:l}),[c,l]);N.useEffect(()=>{const b=n?Math.ceil(Number(n)/i):0;b!==c&&f(u=>({...u,pageIndex:b}))},[n,i,c]);const m=b=>{const u=b(h),{pageIndex:T,pageSize:O}=u;return o(v=>{if(!T)return v.delete(t),v;const P=new URLSearchParams(v);return P.set(t,String(T*O)),P}),f(u),u};return{table:X({data:s,columns:[],pageCount:Math.ceil(a/l),state:{pagination:h},getCoreRowModel:ee(),onPaginationChange:m,getPaginationRowModel:Z(),manualPagination:!0})}};export{ye as T,Te as a,Pe as u};
