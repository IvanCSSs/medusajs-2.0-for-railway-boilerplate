import{r as a,bJ as L,j as s}from"./index-S35l5lon.js";import{s as I}from"./client-DUf8-hSd.js";import{C as p,H as x,T as o,c as n}from"./heading-Cdx6okg4.js";import{B as j}from"./badge-DtJwLgim.js";import{C as _,X as R}from"./x-circle-solid-BoF-1eMv.js";import{A as w}from"./arrow-path-BPTWh_TX.js";import{E as A}from"./envelope-solid-BKxvxx9H.js";import{S as H}from"./shopping-cart-B8FY75jc.js";var W=Object.defineProperty,d=Object.getOwnPropertySymbols,O=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable,y=(e,r,t)=>r in e?W(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,T=(e,r)=>{for(var t in r||(r={}))O.call(r,t)&&y(e,t,r[t]);if(d)for(var t of d(r))E.call(r,t)&&y(e,t,r[t]);return e},V=(e,r)=>{var t={};for(var l in e)O.call(e,l)&&r.indexOf(l)<0&&(t[l]=e[l]);if(e!=null&&d)for(var l of d(e))r.indexOf(l)<0&&E.call(e,l)&&(t[l]=e[l]);return t};const P=a.forwardRef((e,r)=>{var t=e,{color:l="currentColor"}=t,i=V(t,["color"]);return a.createElement("svg",T({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:r},i),a.createElement("g",{stroke:l,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#a)"},a.createElement("path",{d:"M7.5 13.944a6.444 6.444 0 1 0 0-12.888 6.444 6.444 0 0 0 0 12.888"}),a.createElement("path",{d:"M9.115 5.679c-.35-.83-1.051-1.017-1.581-1.017-.493 0-1.787.262-1.667 1.504.084.872.906 1.196 1.624 1.324s1.761.402 1.787 1.454c.021.888-.778 1.495-1.744 1.495-.923 0-1.565-.359-1.812-1.17M7.5 3.722v.94M7.5 10.44v.838"})),a.createElement("defs",null,a.createElement("clipPath",{id:"a"},a.createElement("path",{fill:"#fff",d:"M0 0h15v15H0z"}))))});P.displayName="CurrencyDollar";var B=Object.defineProperty,m=Object.getOwnPropertySymbols,k=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable,N=(e,r,t)=>r in e?B(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,q=(e,r)=>{for(var t in r||(r={}))k.call(r,t)&&N(e,t,r[t]);if(m)for(var t of m(r))C.call(r,t)&&N(e,t,r[t]);return e},z=(e,r)=>{var t={};for(var l in e)k.call(e,l)&&r.indexOf(l)<0&&(t[l]=e[l]);if(e!=null&&m)for(var l of m(e))r.indexOf(l)<0&&C.call(e,l)&&(t[l]=e[l]);return t};const $=a.forwardRef((e,r)=>{var t=e,{color:l="currentColor"}=t,i=z(t,["color"]);return a.createElement("svg",q({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:r},i),a.createElement("path",{stroke:l,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M5 7.767h2M5 10.813h5M1.944 12.167V2.833c0-.982.796-1.777 1.778-1.777h4.966c.235 0 .462.093.628.26l3.48 3.48c.166.166.26.392.26.628v6.743c0 .982-.796 1.778-1.778 1.778H3.722a1.777 1.777 0 0 1-1.778-1.778"}),a.createElement("path",{stroke:l,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12.976 5.056H9.944a.89.89 0 0 1-.888-.89v-3.02"}))});$.displayName="DocumentText";var F=Object.defineProperty,f=Object.getOwnPropertySymbols,M=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable,b=(e,r,t)=>r in e?F(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,K=(e,r)=>{for(var t in r||(r={}))M.call(r,t)&&b(e,t,r[t]);if(f)for(var t of f(r))S.call(r,t)&&b(e,t,r[t]);return e},U=(e,r)=>{var t={};for(var l in e)M.call(e,l)&&r.indexOf(l)<0&&(t[l]=e[l]);if(e!=null&&f)for(var l of f(e))r.indexOf(l)<0&&S.call(e,l)&&(t[l]=e[l]);return t};const h=a.forwardRef((e,r)=>{var t=e,{color:l="currentColor"}=t,i=U(t,["color"]);return a.createElement("svg",K({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:r},i),a.createElement("path",{stroke:l,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7.5 5.944a2.444 2.444 0 1 0 0-4.888 2.444 2.444 0 0 0 0 4.888M11.733 13.292c.764-.24 1.166-1.085.842-1.818A5.55 5.55 0 0 0 7.5 8.167a5.55 5.55 0 0 0-5.075 3.307c-.324.733.078 1.577.842 1.818a14.1 14.1 0 0 0 8.466 0"}))});h.displayName="User";const X=e=>{const r="h-4 w-4";switch(e){case"order.placed":return s.jsx(P,{className:n(r,"text-green-500")});case"order.canceled":return s.jsx(R,{className:n(r,"text-red-500")});case"order.completed":return s.jsx(_,{className:n(r,"text-green-600")});case"customer.created":return s.jsx(h,{className:n(r,"text-blue-500")});case"customer.updated":return s.jsx(w,{className:n(r,"text-gray-500")});case"cart.created":case"cart.updated":return s.jsx(H,{className:n(r,"text-orange-500")});case"fulfillment.created":case"fulfillment.shipment_created":return s.jsx($,{className:n(r,"text-purple-500")});case"notification.sent":return s.jsx(A,{className:n(r,"text-blue-400")});case"return.created":case"claim.created":return s.jsx(w,{className:n(r,"text-yellow-500")});default:return s.jsx(_,{className:n(r,"text-gray-400")})}},D=e=>e.includes("order.placed")||e.includes("completed")?"green":e.includes("canceled")||e.includes("failed")?"red":e.includes("customer")?"blue":e.includes("cart")?"orange":e.includes("fulfillment")||e.includes("ship")?"purple":"grey",G=async e=>await I.client.fetch(`/admin/customers/${e}/timeline?limit=100`,{method:"GET"}),J=({data:e})=>{const{data:r,isLoading:t,error:l}=L({queryKey:["customer-timeline",e.id],queryFn:()=>G(e.id),enabled:!!(e!=null&&e.id)}),i=(r==null?void 0:r.activities)??[],v=(r==null?void 0:r.grouped)??{};if(t)return s.jsxs(p,{className:"divide-y p-0",children:[s.jsx("div",{className:"flex items-center justify-between px-6 py-4",children:s.jsx(x,{level:"h2",children:"Activity Timeline"})}),s.jsx("div",{className:"px-6 py-8 text-center",children:s.jsx(o,{className:"text-ui-fg-subtle",children:"Loading timeline..."})})]});if(l)return s.jsxs(p,{className:"divide-y p-0",children:[s.jsx("div",{className:"flex items-center justify-between px-6 py-4",children:s.jsx(x,{level:"h2",children:"Activity Timeline"})}),s.jsx("div",{className:"px-6 py-8 text-center",children:s.jsx(o,{className:"text-ui-fg-error",children:"Failed to load timeline"})})]});const g=Object.keys(v);return s.jsxs(p,{className:"divide-y p-0",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[s.jsxs("div",{children:[s.jsx(x,{level:"h2",children:"Activity Timeline"}),s.jsx(o,{className:"text-ui-fg-subtle text-sm",children:"Customer actions and events"})]}),i.length>0&&s.jsxs(j,{color:"grey",children:[i.length," events"]})]}),s.jsx("div",{className:"px-6 py-4 max-h-[500px] overflow-y-auto",children:g.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(h,{className:"h-8 w-8 text-ui-fg-muted mx-auto mb-2"}),s.jsx(o,{className:"text-ui-fg-subtle",children:"No activity recorded yet"})]}):s.jsx("div",{className:"space-y-6",children:g.map(u=>s.jsxs("div",{children:[s.jsx(o,{className:"text-ui-fg-subtle text-xs font-medium uppercase tracking-wider mb-3",children:u}),s.jsx("div",{className:"space-y-3",children:v[u].map(c=>s.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-ui-bg-subtle hover:bg-ui-bg-subtle-hover transition-colors",children:[s.jsx("div",{className:"flex-shrink-0 mt-0.5",children:X(c.event_type)}),s.jsxs("div",{className:"flex-grow min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsx(o,{className:"font-medium text-sm",children:c.event_name}),s.jsx(j,{color:D(c.event_type),size:"2xsmall",children:c.event_type.split(".")[0]})]}),c.description&&s.jsx(o,{className:"text-ui-fg-subtle text-xs mt-0.5",children:c.description})]}),s.jsx(o,{className:"text-ui-fg-muted text-xs flex-shrink-0",children:c.time})]},c.id))})]},u))})})]})},ae={id:"@customer-timeline",injections:()=>[{pluginId:"@customers",slot:"details.after",component:J}]};export{ae as customerTimelinePlugin};
