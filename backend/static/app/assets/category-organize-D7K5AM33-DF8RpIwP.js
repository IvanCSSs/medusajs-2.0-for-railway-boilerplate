import{C as _}from"./chunk-XDCNT5GQ-B0dIRHFU.js";import{j as a,p as h,r as j,K as C,M as s,N as n,t as v,O as w,S as Q}from"./index-S35l5lon.js";import{R as o}from"./chunk-AERWK3TJ-Gph8MRZF.js";import"./sortable.esm-G2J7QBKc.js";import"./dots-six-DvRLB6s4.js";import"./folder-illustration-D2z_kJwh.js";import"./focus-modal-B7NOABos.js";import"./prompt-YaiseBxh.js";var i={fields:"id,name,parent_category_id,rank,*category_children",parent_category_id:"null",include_descendants_tree:!0,limit:9999},k=()=>{const{product_categories:d,isPending:c,isError:u,error:p}=h(i),[y,m]=j.useState([]),{mutateAsync:g,isPending:f}=C({mutationFn:async({value:e})=>{await w.admin.productCategory.update(e.id,{rank:e.rank??0,parent_category_id:e.parent_category_id})},onMutate:async e=>{await s.cancelQueries({queryKey:n.list(i)});const t=s.getQueryData(n.list(i)),r={...t,product_categories:e.arr};return s.setQueryData(n.list(i),r),{previousValue:t}},onError:(e,t,r)=>{s.setQueryData(n.list(i),r==null?void 0:r.previousValue),v.error(e.message)},onSettled:async()=>{await s.invalidateQueries({queryKey:n.all})}}),x=async(e,t)=>{const r={id:e.id,parent_category_id:e.parentId,rank:e.index};m(t),await g({value:r,arr:t})},l=c||f;if(u)throw p;return a.jsxs("div",{className:"flex h-full flex-col overflow-hidden",children:[a.jsx(o.Header,{children:a.jsx("div",{className:"flex items-center justify-end",children:l&&a.jsx(Q,{className:"animate-spin"})})}),a.jsx(o.Body,{className:"bg-ui-bg-subtle flex flex-1 flex-col overflow-y-auto",children:a.jsx(_,{renderValue:e=>e.name,value:l?y:d||[],onChange:x})})]})},q=()=>a.jsx(o,{children:a.jsx(k,{})});export{q as Component};
