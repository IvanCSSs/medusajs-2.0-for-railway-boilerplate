import{C as D,c as w,p as A}from"./chunk-4QZ5WTIF-CFLSJgvI.js";import{m as L,j as t,O as k,ab as E,M as _,u as g,b1 as v,bl as F,P as q,U as P,k as z,C as H,H as $,B as m,L as f,ai as C,r as T,e4 as M,A as N,cC as R,cx as B,bY as I,t as j}from"./index-S35l5lon.js";import{u as K}from"./chunk-2GWGNMAA-CfkRT-MD.js";import{u as O}from"./chunk-BW322BVH-Bu7mNcFf.js";import{u as V,a as W}from"./chunk-CONJV275-BHlnUjoP.js";import{S as Y}from"./chunk-GIZFNLKK-DRFYVOmD.js";import{u as G,_ as U}from"./chunk-ULVVVKLF-DQ5i1kAh.js";import"./chunk-GU5PJRPM-CRBxyP7n.js";import{N as Z}from"./NoctoSlot-Cmfmjduv.js";import{u as J}from"./use-prompt-D56I0Z60.js";import{P as Q}from"./pencil-square-Y_YO1xMN.js";import{T as X}from"./trash-VeZKzNu3.js";import{c as ee}from"./index-D8hIMFbh.js";import{c as te}from"./create-data-table-filter-helper-BDq3TjGS.js";import"./chunk-6CPMXY5N-BnsD9cSz.js";import"./chunk-3I6G3NRU-Yu_RzIa9.js";import"./chunk-INE2QCSC-D6C4GUuG.js";import"./chunk-X6BAAGCL-D2m0rpEk.js";import"./chunk-DK4WIVY6-CYCbBMOO.js";import"./chunk-P3UUX2T6-CDvcsuG9.js";import"./chunk-CM4CTG5D-ghcQfLC7.js";import"./chunk-C76H5USB-C4gmMgZH.js";import"./use-data-table-C4h0AgWj.js";import"./command-bar-D5PjKtE8.js";import"./index-BqPH3RWs.js";import"./adjustments-D-7QP2vC.js";import"./checkbox-Bm9_gGRM.js";import"./select-CmrtK7XQ.js";import"./check-B9bFzKnZ.js";import"./triangles-mini-CX2619vl.js";import"./date-picker-CzxuXAvc.js";import"./popover-9ZHd-JXE.js";import"./triangle-left-mini-CmFFwE40.js";import"./table-u7knMi01.js";import"./arrow-up-mini-BZwwZ9E8.js";import"./sortable.esm-G2J7QBKc.js";import"./chunk-XLDQPLK4-BnBv0RH3.js";import"./chunk-ADOCJB6L-3RvuFqSE.js";import"./chunk-IQBAUTU5-BcF73Rgu.js";import"./chunk-ROKB75YP-BjHfL7E6.js";import"./chunk-DZWH2RV6-B7cI8-p8.js";import"./sub-Ca2BFeSf.js";import"./format-BsAuNKh5.js";import"./react-country-flag.esm-D5FaBppi.js";import"./create-data-table-column-helper-CslhiBa7.js";import"./status-badge-CXGqPLdn.js";import"./index-DRUHz9yq.js";import"./chunk-HQKGZADC-CFjwmGLF.js";import"./chunk-EMIHDNB7-1UnYIHIF.js";import"./plus-mini-B5zW_eay.js";import"./index-haGLTuDn.js";import"./prompt-YaiseBxh.js";var se=()=>({queryKey:E.list({limit:20,offset:0,is_giftcard:!1}),queryFn:async()=>k.admin.product.list({limit:20,offset:0,is_giftcard:!1})}),nt=e=>async()=>{const s=se();return _.getQueryData(s.queryKey)??await e.fetchQuery(s)},b=te(),re=()=>{const{t:e}=g(),s=K(),{product_types:r}=R({limit:1e3,offset:0}),{product_tags:o}=B({limit:1e3,offset:0}),{sales_channels:i}=I({limit:1e3,fields:"id,name"});return T.useMemo(()=>{const l=[...s];return r!=null&&r.length&&l.push(b.accessor("type_id",{label:e("fields.type"),type:"multiselect",options:r.map(a=>({label:a.value,value:a.id}))})),o!=null&&o.length&&l.push(b.accessor("tag_id",{label:e("fields.tag"),type:"multiselect",options:o.map(a=>({label:a.value,value:a.id}))})),i!=null&&i.length&&l.push(b.accessor("sales_channel_id",{label:e("fields.salesChannel"),type:"multiselect",options:i.map(a=>({label:a.name,value:a.id}))})),l.push(b.accessor("status",{label:e("fields.status"),type:"multiselect",options:[{label:e("products.productStatus.draft"),value:"draft"},{label:e("products.productStatus.proposed"),value:"proposed"},{label:e("products.productStatus.published"),value:"published"},{label:e("products.productStatus.rejected"),value:"rejected"}]})),l},[r,o,i,s,e])};function ae(){return w({entity:"products",queryPrefix:"p",pageSize:20,columnAdapter:A,useData:(e,s)=>{const{products:r,count:o,isError:i,error:l,isLoading:a}=P({fields:e,...s,is_giftcard:!1},{placeholderData:(n,c)=>{var u,p;const d=(p=(u=c==null?void 0:c[c.length-1])==null?void 0:u.query)==null?void 0:p.fields;if(!(d&&d!==e))return n}});return{data:r,count:o,isLoading:a,isError:i,error:l}},getRowHref:e=>`/products/${e.id}`})}function oe(){const e=re();return{...ae(),filters:e}}var ie=()=>{const{t:e}=g(),s=v(),r=oe();return t.jsxs(t.Fragment,{children:[t.jsx(D,{adapter:r,heading:e("products.domain"),actions:[{label:e("actions.export"),to:`export${s.search}`},{label:e("actions.import"),to:`import${s.search}`},{label:e("actions.create"),to:"create"}]}),t.jsx(C,{})]})},x=20,le=()=>{const{t:e}=g(),s=v();if(F("view_configurations"))return t.jsx(ie,{});const o=q(),{searchParams:i,raw:l}=V({pageSize:x}),{products:a,count:n,isLoading:c,isError:d,error:u}=P({...i,is_giftcard:!1},{initialData:o,placeholderData:z}),p=W(),y=de(),{table:S}=G({data:a??[],columns:y,count:n,enablePagination:!0,pageSize:x,getRowId:h=>h.id});if(d)throw u;return t.jsxs(H,{className:"divide-y p-0",children:[t.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[t.jsx($,{level:"h1",children:e("products.domain")}),t.jsxs("div",{className:"flex items-center justify-center gap-x-2",children:[t.jsx(m,{size:"small",variant:"secondary",asChild:!0,children:t.jsx(f,{to:`export${s.search}`,children:e("actions.export")})}),t.jsx(m,{size:"small",variant:"secondary",asChild:!0,children:t.jsx(f,{to:`import${s.search}`,children:e("actions.import")})}),t.jsx(m,{size:"small",variant:"secondary",asChild:!0,children:t.jsx(f,{to:"/bulk-editor",children:"Bulk Editor"})}),t.jsx(m,{size:"small",variant:"secondary",asChild:!0,children:t.jsx(f,{to:"create",children:e("actions.create")})})]})]}),t.jsx(U,{table:S,columns:y,count:n,pageSize:x,filters:p,search:!0,pagination:!0,isLoading:c,queryObject:l,navigateTo:h=>`${h.original.id}`,orderBy:[{key:"title",label:e("fields.title")},{key:"created_at",label:e("fields.createdAt")},{key:"updated_at",label:e("fields.updatedAt")}],noRecords:{message:e("products.list.noRecordsMessage")}}),t.jsx(C,{})]})},ce=({product:e})=>{const{t:s}=g(),r=J(),{mutateAsync:o}=M(e.id),i=async()=>{await r({title:s("general.areYouSure"),description:s("products.deleteWarning",{title:e.title}),confirmText:s("actions.delete"),cancelText:s("actions.cancel")})&&await o(void 0,{onSuccess:()=>{j.success(s("products.toasts.delete.success.header"),{description:s("products.toasts.delete.success.description",{title:e.title})})},onError:a=>{j.error(s("products.toasts.delete.error.header"),{description:a.message})}})};return t.jsx(N,{groups:[{actions:[{icon:t.jsx(Q,{}),label:s("actions.edit"),to:`/products/${e.id}/edit`}]},{actions:[{icon:t.jsx(X,{}),label:s("actions.delete"),onClick:i}]}]})},ne=ee(),de=()=>{const e=O();return T.useMemo(()=>[...e,ne.display({id:"actions",cell:({row:r})=>t.jsx(ce,{product:r.original})})],[e])},dt=()=>{const{getWidgets:e}=L();return t.jsx(Y,{widgets:{after:e("product.list.after"),before:e("product.list.before")},children:t.jsx(Z,{pluginId:"@products",name:"main",fallback:t.jsx(le,{})})})};export{dt as Component,nt as productLoader};
