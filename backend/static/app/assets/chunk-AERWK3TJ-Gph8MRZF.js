import{aj as l,X as y,r as i,j as o,u as J,b0 as Q,F as U,v as S,b1 as V}from"./index-S35l5lon.js";import{F as u}from"./focus-modal-B7NOABos.js";import{P as m}from"./prompt-YaiseBxh.js";var x=e=>{const a=V();return i.useMemo(()=>{var r;const t=(r=a.state)==null?void 0:r.restore_params;return t?`${e}?${t.toString()}`:a.search?`${e}${a.search}`:e},[a.state,a.search,e])},F=({form:e,blockSearchParams:a=!1,children:n,onClose:t})=>{const{t:r}=J(),{formState:{isDirty:p}}=e,s=Q(({currentLocation:c,nextLocation:g})=>{const{isSubmitSuccessful:f}=g.state||{};if(f)return t==null||t(!0),!1;const h=c.pathname!==g.pathname,q=c.search!==g.search;if(a){const G=p&&(h||q);return h&&(t==null||t(f)),G}const z=p&&h;return h&&(t==null||t(f)),z}),v=()=>{var c;(c=s==null?void 0:s.reset)==null||c.call(s)},d=()=>{var c;(c=s==null?void 0:s.proceed)==null||c.call(s),t==null||t(!1)};return o.jsxs(U,{...e,children:[n,o.jsx(m,{open:s.state==="blocked",variant:"confirmation",children:o.jsxs(m.Content,{children:[o.jsxs(m.Header,{children:[o.jsx(m.Title,{children:r("general.unsavedChangesTitle")}),o.jsx(m.Description,{children:r("general.unsavedChangesDescription")})]}),o.jsxs(m.Footer,{children:[o.jsx(m.Cancel,{onClick:v,type:"button",children:r("actions.cancel")}),o.jsx(m.Action,{onClick:d,type:"button",children:r("actions.continue")})]})]})})]})},j=i.createContext(null),D=({prev:e,children:a})=>{const n=y(),[t,r]=i.useState(!0),p=i.useCallback(v=>{n(v||e,{replace:!0,state:{isSubmitSuccessful:!0}})},[n,e]),s=i.useMemo(()=>({handleSuccess:p,setCloseOnEscape:r,__internal:{closeOnEscape:t}}),[p,r,t]);return o.jsx(j.Provider,{value:s,children:a})},M=i.createContext(null),C=({children:e,onOpenChange:a})=>{const[n,t]=i.useState({}),r=d=>n[d]||!1,p=(d,c)=>{t(g=>({...g,[d]:c})),a(c)},s=d=>{t(c=>({...c,[d]:!1}))},v=d=>{t(c=>{const g={...c};return delete g[d],g})};return o.jsx(M.Provider,{value:{getIsOpen:r,setIsOpen:p,register:s,unregister:v},children:e})},k=()=>{const e=i.useContext(M);if(!e)throw new Error("useStackedModal must be used within a StackedModalProvider");return e},W=({prev:e="..",children:a})=>{const n=y(),[t,r]=i.useState(!1),[p,s]=i.useState(!1),v=x(e);i.useEffect(()=>(r(!0),()=>{r(!1),s(!1)}),[]);const d=c=>{if(!c){document.body.style.pointerEvents="auto",n(v,{replace:!0});return}r(c)};return o.jsx(l,{open:t,onOpenChange:d,children:o.jsx(D,{prev:v,children:o.jsx(C,{onOpenChange:s,children:o.jsx(l.Content,{"aria-describedby":void 0,className:S({"!bg-ui-bg-disabled !inset-y-5 !right-5":p}),children:a})})})})},Y=l.Header,Z=l.Title,L=l.Description,ee=l.Body,te=l.Footer,ae=l.Close,re=F,ye=Object.assign(W,{Header:Y,Title:Z,Body:ee,Description:L,Footer:te,Close:ae,Form:re}),se=()=>{const e=i.useContext(j);if(!e)throw new Error("useRouteModal must be used within a RouteModalProvider");return e},oe=({prev:e="..",children:a})=>{const n=y(),[t,r]=i.useState(!1),[p,s]=i.useState(!1),v=x(e);i.useEffect(()=>(r(!0),()=>{r(!1),s(!1)}),[]);const d=c=>{if(!c){document.body.style.pointerEvents="auto",n(v,{replace:!0});return}r(c)};return o.jsx(u,{open:t,onOpenChange:d,children:o.jsx(D,{prev:v,children:o.jsx(C,{onOpenChange:s,children:o.jsx(ne,{stackedModalOpen:p,children:a})})})})},ne=({stackedModalOpen:e,children:a})=>{const{__internal:n}=se(),t=!n.closeOnEscape;return o.jsx(u.Content,{onEscapeKeyDown:t?r=>{r.preventDefault()}:void 0,className:S({"!bg-ui-bg-disabled !inset-x-5 !inset-y-3":e}),children:a})},ce=u.Header,ie=u.Title,de=u.Description,le=u.Footer,ue=u.Body,pe=u.Close,ve=F,xe=Object.assign(oe,{Header:ce,Title:ie,Body:ue,Description:de,Footer:le,Close:pe,Form:ve}),ge=({id:e,children:a})=>{const{register:n,unregister:t,getIsOpen:r,setIsOpen:p}=k();return i.useEffect(()=>(n(e),()=>t(e)),[]),o.jsx(l,{open:r(e),onOpenChange:s=>p(e,s),children:a})},O=l.Close;O.displayName="StackedDrawer.Close";var T=l.Header;T.displayName="StackedDrawer.Header";var N=l.Body;N.displayName="StackedDrawer.Body";var w=l.Trigger;w.displayName="StackedDrawer.Trigger";var b=l.Footer;b.displayName="StackedDrawer.Footer";var B=l.Title;B.displayName="StackedDrawer.Title";var R=l.Description;R.displayName="StackedDrawer.Description";var E=i.forwardRef(({className:e,...a},n)=>o.jsx(l.Content,{ref:n,className:S(e),overlayProps:{className:"bg-transparent"},...a}));E.displayName="StackedDrawer.Content";var Fe=Object.assign(ge,{Close:O,Header:T,Body:N,Content:E,Trigger:w,Footer:b,Description:R,Title:B}),me=({id:e,onOpenChangeCallback:a,children:n})=>{const{register:t,unregister:r,getIsOpen:p,setIsOpen:s}=k();i.useEffect(()=>(t(e),()=>r(e)),[]);const v=d=>{s(e,d),a==null||a(d)};return o.jsx(u,{open:p(e),onOpenChange:v,children:n})},H=u.Close;H.displayName="StackedFocusModal.Close";var P=u.Header;P.displayName="StackedFocusModal.Header";var I=u.Body;I.displayName="StackedFocusModal.Body";var _=u.Trigger;_.displayName="StackedFocusModal.Trigger";var $=u.Footer;$.displayName="StackedFocusModal.Footer";var A=u.Title;A.displayName="StackedFocusModal.Title";var K=u.Description;K.displayName="StackedFocusModal.Description";var X=i.forwardRef(({className:e,...a},n)=>o.jsx(u.Content,{ref:n,className:S("!top-6",e),overlayProps:{className:"bg-transparent"},...a}));X.displayName="StackedFocusModal.Content";var je=Object.assign(me,{Close:H,Header:P,Body:I,Content:X,Trigger:_,Footer:$,Description:K,Title:A});export{xe as R,je as S,ye as a,k as b,Fe as c,se as u};
