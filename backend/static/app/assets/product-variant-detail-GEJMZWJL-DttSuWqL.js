import{V as v}from"./chunk-FA2DYBNX-199JOd1f.js";import{a as P}from"./chunk-X6BAAGCL-D2m0rpEk.js";import{S as N}from"./chunk-LFLGEXIG-4PAd85Bq.js";import{L as D}from"./chunk-6WKBBTKM-C6Riaf54.js";import{P as I,a as z,dN as _,m as V,j as e,R as k,O as B,ep as M,M as A,u,X as E,eq as L,C as x,H as p,A as f,G as R,T as K,q as b,ed as S,r as T,er as O,B as H}from"./index-S35l5lon.js";import{T as g}from"./chunk-GIZFNLKK-DRFYVOmD.js";import{P as j}from"./chunk-P3UUX2T6-CDvcsuG9.js";import{u as Q,_ as $}from"./chunk-ULVVVKLF-DQ5i1kAh.js";import"./chunk-GU5PJRPM-CRBxyP7n.js";import{N as G}from"./chunk-EMIHDNB7-1UnYIHIF.js";import{u as F}from"./use-prompt-D56I0Z60.js";import{C as q}from"./component-DIzZwMmE.js";import{P as C}from"./pencil-square-Y_YO1xMN.js";import{T as J}from"./trash-VeZKzNu3.js";import{T as W}from"./thumbnail-badge-Z1PKPc-j.js";import{c as U}from"./index-D8hIMFbh.js";import"./chunk-DK4WIVY6-CYCbBMOO.js";import"./index-DRUHz9yq.js";import"./check-B9bFzKnZ.js";import"./chunk-HQKGZADC-CFjwmGLF.js";import"./table-u7knMi01.js";import"./command-bar-D5PjKtE8.js";import"./index-BqPH3RWs.js";import"./chunk-DZWH2RV6-B7cI8-p8.js";import"./sub-Ca2BFeSf.js";import"./format-BsAuNKh5.js";import"./index-haGLTuDn.js";import"./date-picker-CzxuXAvc.js";import"./popover-9ZHd-JXE.js";import"./triangle-left-mini-CmFFwE40.js";import"./plus-mini-B5zW_eay.js";import"./prompt-YaiseBxh.js";var Ae=s=>{const{id:t,variant_id:a}=s.params||{},{variant:i}=_(t,a,{fields:v},{initialData:s.data,enabled:!!t&&!!a});return i?e.jsx("span",{children:i.title}):null},X=(s,t)=>({queryKey:M.detail(t,{fields:v}),queryFn:async()=>B.admin.product.retrieveVariant(s,t,{fields:v})}),Ee=async({params:s})=>{const t=s.id,a=s.variant_id,i=X(t,a);return A.ensureQueryData(i)};function Y({variant:s}){var c,d;const{t}=u(),a=F(),i=E(),r=((c=s.inventory)==null?void 0:c.length)>1,{mutateAsync:n}=L(s.product_id,s.id),o=async()=>{await a({title:t("general.areYouSure"),description:t("products.variant.deleteWarning",{title:s.title}),confirmText:t("actions.delete"),cancelText:t("actions.cancel")})&&await n(void 0,{onSuccess:()=>{i("..",{replace:!0})}})};return e.jsxs(x,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{children:s.title}),r&&e.jsx("span",{className:"text-ui-fg-muted font-normal",children:e.jsx(q,{})})]}),e.jsx("span",{className:"text-ui-fg-subtle txt-small mt-2",children:t("labels.productVariant")})]}),e.jsx("div",{className:"flex items-center gap-x-4",children:e.jsx(f,{groups:[{actions:[{label:t("actions.edit"),to:"edit",icon:e.jsx(C,{})}]},{actions:[{label:t("actions.delete"),onClick:o,icon:e.jsx(J,{})}]}]})})]}),e.jsx(N,{title:t("fields.sku"),value:s.sku}),(d=s.options)==null?void 0:d.map(l=>{var h;return e.jsx(N,{title:(h=l.option)==null?void 0:h.title,value:e.jsx(R,{size:"2xsmall",children:l.value})},l.id)})]})}var Z=({item:s})=>{const{t}=u();return e.jsx(f,{groups:[{actions:[{icon:e.jsx(S,{}),label:t("products.variant.inventory.navigateToItem"),to:`/inventory/${s.id}`}]}]})},m=U(),ee=()=>{const{t:s}=u();return T.useMemo(()=>[m.accessor("title",{header:s("fields.title"),cell:({getValue:t})=>{const a=t();return a?e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:a})}):e.jsx(j,{})}}),m.accessor("sku",{header:s("fields.sku"),cell:({getValue:t})=>{const a=t();return a?e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:a})}):e.jsx(j,{})}}),m.accessor("required_quantity",{header:s("fields.requiredQuantity"),cell:({getValue:t})=>{const a=t();return Number.isNaN(a)?e.jsx(j,{}):e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:a})})}}),m.display({id:"inventory_quantity",header:s("fields.inventory"),cell:({getValue:t,row:{original:a}})=>{var n;if(!((n=a.location_levels)!=null&&n.length))return e.jsx(j,{});let i=0,r=0;return a.location_levels.forEach(o=>{i+=o.available_quantity,r+=1}),e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:s("products.variant.tableItem",{availableCount:i,locationCount:r,count:r})})})}}),m.display({id:"actions",cell:({row:t})=>e.jsx(Z,{item:t.original})})],[s])},w=20;function te({inventoryItems:s}){const{t}=u(),a=ee(),{table:i}=Q({data:s??[],columns:a,count:s.length,enablePagination:!0,getRowId:n=>n.id,pageSize:w}),r=s.length>1;return e.jsxs(x,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(p,{level:"h2",children:t("fields.inventoryItems")})}),e.jsx("div",{className:"flex items-center gap-x-4",children:e.jsx(f,{groups:[{actions:[{label:t(r?"products.variant.inventory.manageKit":"products.variant.inventory.manageItems"),to:"manage-items",icon:r?e.jsx(q,{}):e.jsx(S,{})}]}]})})]}),e.jsx($,{table:i,columns:a,pageSize:w,count:s.length,navigateTo:n=>`/inventory/${n.id}`})]})}function se(){const{t:s}=u();return e.jsx(x,{className:"divide-y p-0",children:e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(p,{level:"h2",children:s("fields.inventoryItems")}),e.jsx("span",{className:"txt-small text-ui-fg-subtle",children:s("products.variant.inventory.notManagedDesc")})]}),e.jsx("div",{className:"flex items-center gap-x-4",children:e.jsx(D,{to:"edit",children:s("products.variant.edit.header")})})]})})}var ae=({variant:s})=>{const{t}=u(),a=(s.images||[]).filter(i=>{var r;return(r=i.variants)==null?void 0:r.some(n=>n.id===n.id)});return e.jsxs(x,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(p,{level:"h2",children:t("products.media.label")}),e.jsx(f,{groups:[{actions:[{label:t("actions.editImages"),to:"media",icon:e.jsx(C,{})}]}]})]}),a.length>0?e.jsx("div",{className:"grid grid-cols-[repeat(auto-fill,minmax(96px,1fr))] gap-4 px-6 py-4",children:a.map(i=>e.jsxs("div",{className:"shadow-elevation-card-rest hover:shadow-elevation-card-hover transition-fg group relative aspect-square size-full overflow-hidden rounded-[8px]",children:[i.url===s.thumbnail&&e.jsx("div",{className:"absolute left-2 top-2",children:e.jsx(K,{content:t("products.media.thumbnailTooltip"),children:e.jsx(W,{})})}),e.jsx("img",{src:i.url,className:"size-full object-cover"})]},i.id))}):e.jsx("div",{className:"flex flex-col items-center gap-y-4 pb-8 pt-6",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(b,{size:"small",leading:"compact",weight:"plus",className:"text-ui-fg-subtle",children:t("products.media.emptyState.header")}),e.jsx(b,{size:"small",className:"text-ui-fg-muted",children:t("products.media.emptyState.description")})]})})]})};function ie({variant:s}){var d;const{t}=u(),a=(d=s.prices)==null?void 0:d.filter(l=>!Object.keys(l.rules||{}).length).sort((l,h)=>{var y;return(y=l.currency_code)==null?void 0:y.localeCompare(h.currency_code)}),i=!!(a!=null&&a.length),[r,n]=T.useState(3),o=a==null?void 0:a.slice(0,r),c=()=>{n(r+3)};return e.jsxs(x,{className:"flex flex-col divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(p,{level:"h2",children:t("labels.prices")}),e.jsx(f,{groups:[{actions:[{label:t("actions.edit"),to:`/products/${s.product_id}/variants/${s.id}/prices`,icon:e.jsx(O,{})}]}]})]}),!i&&e.jsx(G,{className:"h-60"}),o==null?void 0:o.map(l=>e.jsxs("div",{className:"txt-small text-ui-fg-subtle flex justify-between px-6 py-4",children:[e.jsx("span",{className:"font-medium",children:l.currency_code.toUpperCase()}),e.jsx("span",{children:P(l.amount,l.currency_code)})]},l.id)),i&&e.jsxs("div",{className:"txt-small text-ui-fg-subtle flex items-center justify-between px-6 py-4",children:[e.jsx("span",{className:"font-medium",children:t("products.variant.pricesPagination",{total:a.length,current:Math.min(r,a.length)})}),e.jsx(H,{onClick:c,disabled:r>=a.length,className:"-mr-3 text-blue-500",variant:"transparent",children:t("actions.showMore")})]})]})}var Le=()=>{const s=I(),{id:t,variant_id:a}=z(),{variant:i,isLoading:r,isError:n,error:o}=_(t,a,{fields:v},{initialData:s}),{getWidgets:c}=V();if(r||!i)return e.jsx(k,{mainSections:2,sidebarSections:1,showJSON:!0,showMetadata:!0});if(n)throw o;return e.jsxs(g,{data:i,hasOutlet:!0,showJSON:!0,showMetadata:!0,widgets:{after:c("product_variant.details.after"),before:c("product_variant.details.before"),sideAfter:c("product_variant.details.side.after"),sideBefore:c("product_variant.details.side.before")},children:[e.jsxs(g.Main,{children:[e.jsx(Y,{variant:i}),e.jsx(ae,{variant:i}),i.manage_inventory?e.jsx(te,{inventoryItems:i.inventory_items.map(d=>({...d.inventory,required_quantity:d.required_quantity,variant:i}))}):e.jsx(se,{})]}),e.jsx(g.Sidebar,{children:e.jsx(ie,{variant:i})})]})};export{Ae as Breadcrumb,Le as Component,Ee as loader};
