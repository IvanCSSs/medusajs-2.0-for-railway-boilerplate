import{a as B}from"./chunk-B6ZOPCPA-Bu8977YU.js";import{I as $}from"./chunk-MLNUGLGT-Czc1aKlI.js";import{S as l}from"./chunk-LFLGEXIG-4PAd85Bq.js";import{D as F}from"./chunk-CM4CTG5D-ghcQfLC7.js";import{a as G,P as J,bA as E,m as V,j as e,R as W,O as R,dx as I,M as h,u,C as g,H as b,B as z,L as S,bg as Y,x as X,A as Q,dC as Z,bu as U,bv as ee,r as T,X as te,t as j,dD as P,T as se,bw as ie}from"./index-S35l5lon.js";import{a as p,T as m}from"./chunk-MSDRGCRR-CygM1UmD.js";import{T as N}from"./chunk-GIZFNLKK-DRFYVOmD.js";import{P as c}from"./chunk-P3UUX2T6-CDvcsuG9.js";import{u as re,_ as ae}from"./chunk-ULVVVKLF-DQ5i1kAh.js";import"./chunk-GU5PJRPM-CRBxyP7n.js";import{u as ne}from"./chunk-DZWH2RV6-B7cI8-p8.js";import{u as A}from"./chunk-C76H5USB-C4gmMgZH.js";import{P as q}from"./pencil-square-Y_YO1xMN.js";import{u as M}from"./use-prompt-D56I0Z60.js";import{T as O}from"./trash-VeZKzNu3.js";import{c as oe}from"./create-data-table-column-helper-CslhiBa7.js";import{c as le}from"./index-D8hIMFbh.js";import"./use-data-table-C4h0AgWj.js";import"./command-bar-D5PjKtE8.js";import"./index-BqPH3RWs.js";import"./adjustments-D-7QP2vC.js";import"./checkbox-Bm9_gGRM.js";import"./select-CmrtK7XQ.js";import"./check-B9bFzKnZ.js";import"./triangles-mini-CX2619vl.js";import"./date-picker-CzxuXAvc.js";import"./popover-9ZHd-JXE.js";import"./triangle-left-mini-CmFFwE40.js";import"./table-u7knMi01.js";import"./arrow-up-mini-BZwwZ9E8.js";import"./sortable.esm-G2J7QBKc.js";import"./index-DRUHz9yq.js";import"./chunk-HQKGZADC-CFjwmGLF.js";import"./chunk-EMIHDNB7-1UnYIHIF.js";import"./plus-mini-B5zW_eay.js";import"./index-haGLTuDn.js";import"./sub-Ca2BFeSf.js";import"./format-BsAuNKh5.js";import"./prompt-YaiseBxh.js";var C="*variants,*variants.product,*variants.options",ot=t=>{const{id:s}=t.params||{},{inventory_item:i}=E(s,{fields:C},{initialData:t.data,enabled:!!s});return i?e.jsx("span",{children:i.title??i.sku??s}):null},ce=({inventoryItem:t})=>{const{t:s}=u();return e.jsxs(g,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(b,{level:"h2",children:s("products.attributes")}),e.jsx(Q,{groups:[{actions:[{label:s("actions.edit"),to:"attributes",icon:e.jsx(q,{})}]}]})]}),e.jsx(l,{title:s("fields.height"),value:t.height}),e.jsx(l,{title:s("fields.width"),value:t.width}),e.jsx(l,{title:s("fields.length"),value:t.length}),e.jsx(l,{title:s("fields.weight"),value:t.weight}),e.jsx(l,{title:s("fields.midCode"),value:t.mid_code}),e.jsx(l,{title:s("fields.material"),value:t.material}),e.jsx(l,{title:s("fields.hsCode"),value:t.hs_code}),e.jsx(l,{title:s("fields.countryOfOrigin"),value:B(t.origin_country)})]})},f=oe(),de=()=>{const{t}=u(),s=te(),i=M(),a=async r=>{if(await i({title:t("general.areYouSure"),description:t("inventory.deleteWarning"),confirmText:t("actions.delete"),cancelText:t("actions.cancel")}))try{await R.admin.inventoryItem.deleteLevel(r.inventory_item_id,r.location_id),j.success(t("inventory.levelDeleted")),h.invalidateQueries({queryKey:I.lists()}),h.invalidateQueries({queryKey:P.list({inventoryItemId:r.inventory_item_id})}),h.invalidateQueries({queryKey:I.detail(r.inventory_item_id)}),h.invalidateQueries({queryKey:P.detail(r.inventory_item_id)})}catch(o){j.error(o.message)}};return T.useMemo(()=>[f.accessor("stock_locations.0.name",{header:t("fields.location"),cell:({getValue:r})=>{const n=r();return n?e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:n.toString()})}):e.jsx(c,{})}}),f.accessor("reserved_quantity",{header:t("inventory.reserved"),cell:({getValue:r})=>{const n=r();return Number.isNaN(n)?e.jsx(c,{}):e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:n})})},enableSorting:!0}),f.accessor("stocked_quantity",{header:t("fields.inStock"),cell:({getValue:r})=>{const n=r();return Number.isNaN(n)?e.jsx(c,{}):e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:n})})},enableSorting:!0}),f.accessor("available_quantity",{header:t("inventory.available"),cell:({getValue:r})=>{const n=r();return Number.isNaN(n)?e.jsx(c,{}):e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:n})})}}),f.action({actions:r=>{const n=r.row.original;return[[{icon:e.jsx(q,{}),label:t("actions.edit"),onClick:o=>{s(`locations/${n.location_id}`)}}],[{icon:e.jsx(O,{}),label:t("actions.delete"),onClick:()=>a(n),disabled:n.reserved_quantity>0||n.stocked_quantity>0}]]}})],[t])},ue=({pageSize:t=20,prefix:s})=>{const i=A(["order","offset","location_id","stocked_quantity","reserved_quantity","incoming_quantity"],s),{offset:a,...r}=i;return{limit:t,offset:a?Number(a):0,...r}},k=20,D="invlvl",me=({inventory_item_id:t})=>{const s=ue({pageSize:k,prefix:D}),{inventory_levels:i,count:a,isPending:r,isError:n,error:o}=Z(t,{...s,fields:"+stock_locations.id,+stock_locations.name"}),_=de();if(n)throw o;return e.jsx(F,{data:i??[],columns:_,rowCount:a,pageSize:k,getRowId:y=>y.id,isLoading:r,prefix:D,layout:"fill",enableSearch:!1})},xe=({inventoryItem:t})=>{const{t:s}=u();return e.jsxs(g,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(b,{level:"h2",children:s("inventory.locationLevels")}),e.jsx(z,{size:"small",variant:"secondary",asChild:!0,children:e.jsx(S,{to:"locations",children:s("inventory.manageLocations")})})]}),e.jsx(me,{inventory_item_id:t.id})]})},ve=({date:t})=>{const{getFullDate:s}=ne();return t?e.jsx("div",{className:"flex h-full w-full items-center overflow-hidden",children:e.jsx(se,{className:"z-10",content:e.jsx("span",{className:"text-pretty",children:`${s({date:t,includeTime:!0})}`}),children:e.jsx("span",{className:"truncate",children:s({date:t,includeTime:!0})})})}):e.jsx(c,{})},pe=({reservation:t})=>{const{t:s}=u(),i=M(),{mutateAsync:a}=ie(t.id),r=async()=>{await i({title:s("general.areYouSure"),description:s("inventory.deleteWarning"),confirmText:s("actions.delete"),cancelText:s("actions.cancel")})&&await a(void 0,{onSuccess:()=>{j.success(s("inventory.reservation.deleteSuccessToast"))},onError:o=>{j.error(o.message)}})};return e.jsx(Q,{groups:[{actions:[{icon:e.jsx(q,{}),label:s("actions.edit"),to:`/reservations/${t.id}/edit`}]},{actions:[{icon:e.jsx(O,{}),label:s("actions.delete"),onClick:r}]}]})},d=le(),fe=({sku:t})=>{const{t:s}=u();return T.useMemo(()=>[d.display({id:"sku",header:()=>e.jsx(m,{text:s("fields.sku")}),cell:()=>e.jsx(p,{text:t})}),d.accessor("line_item.order_id",{header:()=>e.jsx(m,{text:s("inventory.reservation.orderID")}),cell:({getValue:i})=>{const a=i();return a?e.jsx(p,{text:a}):e.jsx(c,{})}}),d.accessor("description",{header:()=>e.jsx(m,{text:s("fields.description")}),cell:({getValue:i})=>{const a=i();return a?e.jsx(p,{text:a}):e.jsx(c,{})}}),d.accessor("location.name",{header:()=>e.jsx(m,{text:s("inventory.reservation.location")}),cell:({getValue:i})=>{const a=i();return a?e.jsx(p,{text:a}):e.jsx(c,{})}}),d.accessor("created_at",{header:()=>e.jsx(m,{text:s("fields.createdAt")}),cell:({getValue:i})=>e.jsx(ve,{date:i()})}),d.accessor("quantity",{header:()=>e.jsx(m,{text:s("fields.quantity"),align:"right"}),cell:({getValue:i})=>e.jsx(p,{text:i(),align:"right"})}),d.display({id:"actions",cell:({row:i})=>e.jsx(pe,{reservation:i.original})})],[s])},he=({pageSize:t=20,prefix:s})=>{const i=A(["id","location_id","inventory_item_id","quantity","line_item_id","description","created_by"],s),{quantity:a,...r}=i;return{searchParams:{limit:t,quantity:a?JSON.parse(a):void 0,...r},raw:i}},w=20,ye=({inventoryItem:t})=>{const{searchParams:s,raw:i}=he({pageSize:w}),{reservations:a,count:r,isPending:n,isError:o,error:_}=U({...s,inventory_item_id:[t.id]}),{stock_locations:y}=ee({id:(a||[]).map(x=>x.location_id)}),H=T.useMemo(()=>{const x=new Map((y||[]).map(v=>[v.id,v]));return(a||[]).map(v=>({...v,location:x.get(v.location_id)}))},[a,y]),L=fe({sku:t.sku}),{table:K}=re({data:H??[],columns:L,count:r,enablePagination:!0,getRowId:x=>x.id,pageSize:w});if(o)throw _;return e.jsx(ae,{table:K,columns:L,pageSize:w,count:r,isLoading:n,pagination:!0,queryObject:i})},je=({inventoryItem:t})=>{const{t:s}=u();return e.jsxs(g,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(b,{level:"h2",children:s("reservations.domain")}),e.jsx(z,{size:"small",variant:"secondary",asChild:!0,children:e.jsx(S,{to:`/reservations/create?item_id=${t.id}`,children:s("actions.create")})})]}),e.jsx(ye,{inventoryItem:t})]})},ge=({variants:t})=>{const{t:s}=u();return t!=null&&t.length?e.jsxs(g,{className:"p-0",children:[e.jsx("div",{className:"flex items-center justify-between px-6 py-4",children:e.jsx(b,{level:"h2",children:s("inventory.associatedVariants")})}),e.jsx("div",{className:"txt-small flex flex-col gap-2 px-2 pb-2",children:t.map(i=>{var n;const a=i.product?`/products/${i.product.id}/variants/${i.id}`:null,r=e.jsx("div",{className:"shadow-elevation-card-rest bg-ui-bg-component rounded-md px-4 py-2 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"shadow-elevation-card-rest rounded-md",children:e.jsx(Y,{src:(n=i.product)==null?void 0:n.thumbnail})}),e.jsxs("div",{className:"flex flex-1 flex-col",children:[e.jsx("span",{className:"text-ui-fg-base font-medium",children:i.title}),e.jsx("span",{className:"text-ui-fg-subtle",children:i.options.map(o=>o.value).join(" â‹… ")})]}),e.jsx("div",{className:"size-7 flex items-center justify-center",children:e.jsx(X,{className:"text-ui-fg-muted rtl:rotate-180"})})]})});return a?e.jsx(S,{to:a,className:"outline-none focus-within:shadow-borders-interactive-with-focus rounded-md [&:hover>div]:bg-ui-bg-component-hover",children:r},i.id):e.jsx("div",{children:r},i.id)})})]}):null},lt=()=>{const{id:t}=G(),s=J(),{inventory_item:i,isPending:a,isError:r,error:n}=E(t,{fields:C},{initialData:s}),{getWidgets:o}=V();if(a||!i)return e.jsx(W,{showJSON:!0,mainSections:3,sidebarSections:2,showMetadata:!0});if(r)throw n;return e.jsxs(N,{widgets:{after:o("inventory_item.details.after"),before:o("inventory_item.details.before"),sideAfter:o("inventory_item.details.side.after"),sideBefore:o("inventory_item.details.side.before")},data:i,showJSON:!0,showMetadata:!0,children:[e.jsxs(N.Main,{children:[e.jsx($,{inventoryItem:i}),e.jsx(xe,{inventoryItem:i}),e.jsx(je,{inventoryItem:i})]}),e.jsxs(N.Sidebar,{children:[e.jsx(ge,{variants:i.variants}),e.jsx(ce,{inventoryItem:i})]})]})},be=t=>({queryKey:I.detail(t),queryFn:async()=>R.admin.inventoryItem.retrieve(t,{fields:C})}),ct=async({params:t})=>{const s=t.id,i=be(s);return h.ensureQueryData(i)};export{ot as Breadcrumb,lt as Component,ct as loader};
