import{r as a,j as e,eF as pe,K as z,bJ as Ts}from"./index-S35l5lon.js";import{s as F}from"./client-DUf8-hSd.js";import{t as _,X as Z}from"./toast-_TmXxcvA.js";import{P as ve,a as ks}from"./plus-CZtd4i4F.js";import{T as re}from"./trash-B7qNFf4m.js";import{u as be,c as ne,T as v,C as V,H as q}from"./heading-Cdx6okg4.js";import{B as R}from"./button-9jJy7PHD.js";import{B as b}from"./badge-DtJwLgim.js";import{L as J,I as ee,T as Fe}from"./textarea-MFJZH2HF.js";import{e as Re,u as je,c as ye,P as X,a as K,b as Os,d as As,f as Ms}from"./index-B9-Umq18.js";import{c as Fs,u as $e,a as De,S as A,b as Pe}from"./index-DoEhg8_f.js";import{E as Se}from"./envelope-solid-BKxvxx9H.js";import{A as $s}from"./arrow-path-BPTWh_TX.js";import{C as Ds}from"./x-circle-solid-BoF-1eMv.js";import"./spinner-2pZ_p3OB.js";var Ls=Object.defineProperty,ie=Object.getOwnPropertySymbols,Le=Object.prototype.hasOwnProperty,Ue=Object.prototype.propertyIsEnumerable,Ie=(s,r,t)=>r in s?Ls(s,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[r]=t,Us=(s,r)=>{for(var t in r||(r={}))Le.call(r,t)&&Ie(s,t,r[t]);if(ie)for(var t of ie(r))Ue.call(r,t)&&Ie(s,t,r[t]);return s},zs=(s,r)=>{var t={};for(var n in s)Le.call(s,n)&&r.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&ie)for(var n of ie(s))r.indexOf(n)<0&&Ue.call(s,n)&&(t[n]=s[n]);return t};const ze=a.forwardRef((s,r)=>{var t=s,{color:n="currentColor"}=t,l=zs(t,["color"]);return a.createElement("svg",Us({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:r},l),a.createElement("path",{stroke:n,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"m3.036 7.679 2.857 3.571 6.071-7.5"}))});ze.displayName="CheckMini";var Ks=Object.defineProperty,le=Object.getOwnPropertySymbols,Ke=Object.prototype.hasOwnProperty,Ve=Object.prototype.propertyIsEnumerable,Te=(s,r,t)=>r in s?Ks(s,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[r]=t,Vs=(s,r)=>{for(var t in r||(r={}))Ke.call(r,t)&&Te(s,t,r[t]);if(le)for(var t of le(r))Ve.call(r,t)&&Te(s,t,r[t]);return s},qs=(s,r)=>{var t={};for(var n in s)Ke.call(s,n)&&r.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&le)for(var n of le(s))r.indexOf(n)<0&&Ve.call(s,n)&&(t[n]=s[n]);return t};const qe=a.forwardRef((s,r)=>{var t=s,{color:n="currentColor"}=t,l=qs(t,["color"]);return a.createElement("svg",Vs({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:r},l),a.createElement("g",{stroke:n,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#a)"},a.createElement("path",{d:"m12.389.833 1.778 1.778M2.611.833.833 2.611M7.5 13.056a5.556 5.556 0 1 0 0-11.112 5.556 5.556 0 0 0 0 11.112M3.572 11.428l-1.628 1.627M11.428 11.428l1.627 1.627"}),a.createElement("path",{d:"M7.5 4.611V7.5l2.444 1.556"})),a.createElement("defs",null,a.createElement("clipPath",{id:"a"},a.createElement("path",{fill:"#fff",d:"M0 0h15v15H0z"}))))});qe.displayName="Clock";var Bs=Object.defineProperty,oe=Object.getOwnPropertySymbols,Be=Object.prototype.hasOwnProperty,Ge=Object.prototype.propertyIsEnumerable,ke=(s,r,t)=>r in s?Bs(s,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[r]=t,Gs=(s,r)=>{for(var t in r||(r={}))Be.call(r,t)&&ke(s,t,r[t]);if(oe)for(var t of oe(r))Ge.call(r,t)&&ke(s,t,r[t]);return s},Ws=(s,r)=>{var t={};for(var n in s)Be.call(s,n)&&r.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&oe)for(var n of oe(s))r.indexOf(n)<0&&Ge.call(s,n)&&(t[n]=s[n]);return t};const Ne=a.forwardRef((s,r)=>{var t=s,{color:n="currentColor"}=t,l=Ws(t,["color"]);return a.createElement("svg",Gs({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:r},l),a.createElement("g",{stroke:n,clipPath:"url(#a)"},a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"m1.345 13.497.158-2.53L6.739 5.73a3.6 3.6 0 0 1-.128-.897 3.556 3.556 0 1 1 3.556 3.556c-.322 0-.629-.057-.926-.137L7.5 9.944h-2v2l-1.462 1.559z"}),a.createElement("path",{d:"M10.222 4.389a.389.389 0 1 0 .778 0 .389.389 0 0 0-.778 0Z"})),a.createElement("defs",null,a.createElement("clipPath",{id:"a"},a.createElement("path",{fill:"#fff",d:"M0 0h15v15H0z"}))))});Ne.displayName="Key";var Qs=Object.defineProperty,ce=Object.getOwnPropertySymbols,We=Object.prototype.hasOwnProperty,Qe=Object.prototype.propertyIsEnumerable,Oe=(s,r,t)=>r in s?Qs(s,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[r]=t,Hs=(s,r)=>{for(var t in r||(r={}))We.call(r,t)&&Oe(s,t,r[t]);if(ce)for(var t of ce(r))Qe.call(r,t)&&Oe(s,t,r[t]);return s},Xs=(s,r)=>{var t={};for(var n in s)We.call(s,n)&&r.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&ce)for(var n of ce(s))r.indexOf(n)<0&&Qe.call(s,n)&&(t[n]=s[n]);return t};const He=a.forwardRef((s,r)=>{var t=s,{color:n="currentColor"}=t,l=Xs(t,["color"]);return a.createElement("svg",Hs({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:r},l),a.createElement("path",{stroke:n,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M2.5 7.5h10"}))});He.displayName="MinusMini";var Ys=Object.defineProperty,de=Object.getOwnPropertySymbols,Xe=Object.prototype.hasOwnProperty,Ye=Object.prototype.propertyIsEnumerable,Ae=(s,r,t)=>r in s?Ys(s,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[r]=t,Js=(s,r)=>{for(var t in r||(r={}))Xe.call(r,t)&&Ae(s,t,r[t]);if(de)for(var t of de(r))Ye.call(r,t)&&Ae(s,t,r[t]);return s},Zs=(s,r)=>{var t={};for(var n in s)Xe.call(s,n)&&r.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&de)for(var n of de(s))r.indexOf(n)<0&&Ye.call(s,n)&&(t[n]=s[n]);return t};const Je=a.forwardRef((s,r)=>{var t=s,{color:n="currentColor"}=t,l=Zs(t,["color"]);return a.createElement("svg",Js({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:r},l),a.createElement("g",{stroke:n,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#a)"},a.createElement("path",{d:"M12.386 4.5H7.614c-.753 0-1.364.773-1.364 1.727v6.046c0 .954.61 1.727 1.364 1.727h4.772c.754 0 1.364-.773 1.364-1.727V6.227c0-.954-.61-1.727-1.364-1.727"}),a.createElement("path",{d:"M8.633 2.025C8.42 1.421 7.943 1 7.386 1H2.614C1.86 1 1.25 1.773 1.25 2.727v6.046c0 .954.61 1.727 1.364 1.727h1.039"})),a.createElement("defs",null,a.createElement("clipPath",{id:"a"},a.createElement("path",{fill:"#fff",d:"M0 0h15v15H0z"}))))});Je.displayName="SquareTwoStack";var et=Object.defineProperty,ue=Object.getOwnPropertySymbols,Ze=Object.prototype.hasOwnProperty,es=Object.prototype.propertyIsEnumerable,Me=(s,r,t)=>r in s?et(s,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[r]=t,st=(s,r)=>{for(var t in r||(r={}))Ze.call(r,t)&&Me(s,t,r[t]);if(ue)for(var t of ue(r))es.call(r,t)&&Me(s,t,r[t]);return s},tt=(s,r)=>{var t={};for(var n in s)Ze.call(s,n)&&r.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&ue)for(var n of ue(s))r.indexOf(n)<0&&es.call(s,n)&&(t[n]=s[n]);return t};const se=a.forwardRef((s,r)=>{var t=s,{color:n="currentColor"}=t,l=tt(t,["color"]);return a.createElement("svg",st({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:r},l),a.createElement("g",{stroke:n,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#a)"},a.createElement("path",{d:"M4.701 6.854a1.722 1.722 0 1 0 0-3.444 1.722 1.722 0 0 0 0 3.444M8.024 12.772c.45-.151.715-.64.548-1.084a4.135 4.135 0 0 0-7.74 0c-.167.444.098.934.548 1.084a10.486 10.486 0 0 0 6.644 0M10.083 4.701a1.722 1.722 0 1 0 0-3.444 1.722 1.722 0 0 0 0 3.444M10.728 11.14a10.5 10.5 0 0 0 2.678-.521c.45-.15.714-.64.547-1.084a4.135 4.135 0 0 0-6.146-1.997"})),a.createElement("defs",null,a.createElement("clipPath",{id:"a"},a.createElement("path",{fill:"#fff",d:"M0 0h15v15H0z"}))))});se.displayName="Users";function rt(s,r){return a.useReducer((t,n)=>r[t][n]??t,s)}var we=s=>{const{present:r,children:t}=s,n=nt(r),l=typeof t=="function"?t({present:n.isPresent}):a.Children.only(t),u=be(n.ref,at(l));return typeof t=="function"||n.isPresent?a.cloneElement(l,{ref:u}):null};we.displayName="Presence";function nt(s){const[r,t]=a.useState(),n=a.useRef({}),l=a.useRef(s),u=a.useRef("none"),m=s?"mounted":"unmounted",[h,x]=rt(m,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return a.useEffect(()=>{const d=ae(n.current);u.current=h==="mounted"?d:"none"},[h]),Re(()=>{const d=n.current,f=l.current;if(f!==s){const p=u.current,C=ae(d);s?x("MOUNT"):C==="none"||(d==null?void 0:d.display)==="none"?x("UNMOUNT"):x(f&&p!==C?"ANIMATION_OUT":"UNMOUNT"),l.current=s}},[s,x]),Re(()=>{if(r){let d;const f=r.ownerDocument.defaultView??window,g=C=>{const P=ae(n.current).includes(C.animationName);if(C.target===r&&P&&(x("ANIMATION_END"),!l.current)){const T=r.style.animationFillMode;r.style.animationFillMode="forwards",d=f.setTimeout(()=>{r.style.animationFillMode==="forwards"&&(r.style.animationFillMode=T)})}},p=C=>{C.target===r&&(u.current=ae(n.current))};return r.addEventListener("animationstart",p),r.addEventListener("animationcancel",g),r.addEventListener("animationend",g),()=>{f.clearTimeout(d),r.removeEventListener("animationstart",p),r.removeEventListener("animationcancel",g),r.removeEventListener("animationend",g)}}else x("ANIMATION_END")},[r,x]),{isPresent:["mounted","unmountSuspended"].includes(h),ref:a.useCallback(d=>{d&&(n.current=getComputedStyle(d)),t(d)},[])}}function ae(s){return(s==null?void 0:s.animationName)||"none"}function at(s){var n,l;let r=(n=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:n.get,t=r&&"isReactWarning"in r&&r.isReactWarning;return t?s.ref:(r=(l=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:l.get,t=r&&"isReactWarning"in r&&r.isReactWarning,t?s.props.ref:s.props.ref||s.ref)}var Ce="Checkbox",[it]=ye(Ce),[lt,ot]=it(Ce),ss=a.forwardRef((s,r)=>{const{__scopeCheckbox:t,name:n,checked:l,defaultChecked:u,required:m,disabled:h,value:x="on",onCheckedChange:d,form:f,...g}=s,[p,C]=a.useState(null),j=be(r,I=>C(I)),P=a.useRef(!1),T=p?f||!!p.closest("form"):!0,[y=!1,S]=je({prop:l,defaultProp:u,onChange:d}),$=a.useRef(y);return a.useEffect(()=>{const I=p==null?void 0:p.form;if(I){const k=()=>S($.current);return I.addEventListener("reset",k),()=>I.removeEventListener("reset",k)}},[p,S]),e.jsxs(lt,{scope:t,state:y,disabled:h,children:[e.jsx(X.button,{type:"button",role:"checkbox","aria-checked":H(y)?"mixed":y,"aria-required":m,"data-state":ns(y),"data-disabled":h?"":void 0,disabled:h,value:x,...g,ref:j,onKeyDown:K(s.onKeyDown,I=>{I.key==="Enter"&&I.preventDefault()}),onClick:K(s.onClick,I=>{S(k=>H(k)?!0:!k),T&&(P.current=I.isPropagationStopped(),P.current||I.stopPropagation())})}),T&&e.jsx(ct,{control:p,bubbles:!P.current,name:n,value:x,checked:y,required:m,disabled:h,form:f,style:{transform:"translateX(-100%)"},defaultChecked:H(u)?!1:u})]})});ss.displayName=Ce;var ts="CheckboxIndicator",rs=a.forwardRef((s,r)=>{const{__scopeCheckbox:t,forceMount:n,...l}=s,u=ot(ts,t);return e.jsx(we,{present:n||H(u.state)||u.state===!0,children:e.jsx(X.span,{"data-state":ns(u.state),"data-disabled":u.disabled?"":void 0,...l,ref:r,style:{pointerEvents:"none",...s.style}})})});rs.displayName=ts;var ct=s=>{const{control:r,checked:t,bubbles:n=!0,defaultChecked:l,...u}=s,m=a.useRef(null),h=Os(t),x=As(r);a.useEffect(()=>{const f=m.current,g=window.HTMLInputElement.prototype,C=Object.getOwnPropertyDescriptor(g,"checked").set;if(h!==t&&C){const j=new Event("click",{bubbles:n});f.indeterminate=H(t),C.call(f,H(t)?!1:t),f.dispatchEvent(j)}},[h,t,n]);const d=a.useRef(H(t)?!1:t);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:l??d.current,...u,tabIndex:-1,ref:m,style:{...s.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function H(s){return s==="indeterminate"}function ns(s){return H(s)?"indeterminate":s?"checked":"unchecked"}var dt=ss,ut=rs,xe="rovingFocusGroup.onEntryFocus",mt={bubbles:!1,cancelable:!0},me="RovingFocusGroup",[ge,as,ht]=Fs(me),[ft,is]=ye(me,[ht]),[xt,gt]=ft(me),ls=a.forwardRef((s,r)=>e.jsx(ge.Provider,{scope:s.__scopeRovingFocusGroup,children:e.jsx(ge.Slot,{scope:s.__scopeRovingFocusGroup,children:e.jsx(pt,{...s,ref:r})})}));ls.displayName=me;var pt=a.forwardRef((s,r)=>{const{__scopeRovingFocusGroup:t,orientation:n,loop:l=!1,dir:u,currentTabStopId:m,defaultCurrentTabStopId:h,onCurrentTabStopIdChange:x,onEntryFocus:d,preventScrollOnEntryFocus:f=!1,...g}=s,p=a.useRef(null),C=be(r,p),j=De(u),[P=null,T]=je({prop:m,defaultProp:h,onChange:x}),[y,S]=a.useState(!1),$=Ms(d),I=as(t),k=a.useRef(!1),[L,B]=a.useState(0);return a.useEffect(()=>{const c=p.current;if(c)return c.addEventListener(xe,$),()=>c.removeEventListener(xe,$)},[$]),e.jsx(xt,{scope:t,orientation:n,dir:j,loop:l,currentTabStopId:P,onItemFocus:a.useCallback(c=>T(c),[T]),onItemShiftTab:a.useCallback(()=>S(!0),[]),onFocusableItemAdd:a.useCallback(()=>B(c=>c+1),[]),onFocusableItemRemove:a.useCallback(()=>B(c=>c-1),[]),children:e.jsx(X.div,{tabIndex:y||L===0?-1:0,"data-orientation":n,...g,ref:C,style:{outline:"none",...s.style},onMouseDown:K(s.onMouseDown,()=>{k.current=!0}),onFocus:K(s.onFocus,c=>{const G=!k.current;if(c.target===c.currentTarget&&G&&!y){const M=new CustomEvent(xe,mt);if(c.currentTarget.dispatchEvent(M),!M.defaultPrevented){const Y=I().filter(O=>O.focusable),te=Y.find(O=>O.active),o=Y.find(O=>O.id===P),E=[te,o,...Y].filter(Boolean).map(O=>O.ref.current);ds(E,f)}}k.current=!1}),onBlur:K(s.onBlur,()=>S(!1))})})}),os="RovingFocusGroupItem",cs=a.forwardRef((s,r)=>{const{__scopeRovingFocusGroup:t,focusable:n=!0,active:l=!1,tabStopId:u,...m}=s,h=$e(),x=u||h,d=gt(os,t),f=d.currentTabStopId===x,g=as(t),{onFocusableItemAdd:p,onFocusableItemRemove:C}=d;return a.useEffect(()=>{if(n)return p(),()=>C()},[n,p,C]),e.jsx(ge.ItemSlot,{scope:t,id:x,focusable:n,active:l,children:e.jsx(X.span,{tabIndex:f?0:-1,"data-orientation":d.orientation,...m,ref:r,onMouseDown:K(s.onMouseDown,j=>{n?d.onItemFocus(x):j.preventDefault()}),onFocus:K(s.onFocus,()=>d.onItemFocus(x)),onKeyDown:K(s.onKeyDown,j=>{if(j.key==="Tab"&&j.shiftKey){d.onItemShiftTab();return}if(j.target!==j.currentTarget)return;const P=jt(j,d.orientation,d.dir);if(P!==void 0){if(j.metaKey||j.ctrlKey||j.altKey||j.shiftKey)return;j.preventDefault();let y=g().filter(S=>S.focusable).map(S=>S.ref.current);if(P==="last")y.reverse();else if(P==="prev"||P==="next"){P==="prev"&&y.reverse();const S=y.indexOf(j.currentTarget);y=d.loop?yt(y,S+1):y.slice(S+1)}setTimeout(()=>ds(y))}})})})});cs.displayName=os;var vt={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function bt(s,r){return r!=="rtl"?s:s==="ArrowLeft"?"ArrowRight":s==="ArrowRight"?"ArrowLeft":s}function jt(s,r,t){const n=bt(s.key,t);if(!(r==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(r==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return vt[n]}function ds(s,r=!1){const t=document.activeElement;for(const n of s)if(n===t||(n.focus({preventScroll:r}),document.activeElement!==t))return}function yt(s,r){return s.map((t,n)=>s[(r+n)%s.length])}var Nt=ls,wt=cs,Ee="Tabs",[Ct]=ye(Ee,[is]),us=is(),[Et,_e]=Ct(Ee),ms=a.forwardRef((s,r)=>{const{__scopeTabs:t,value:n,onValueChange:l,defaultValue:u,orientation:m="horizontal",dir:h,activationMode:x="automatic",...d}=s,f=De(h),[g,p]=je({prop:n,onChange:l,defaultProp:u});return e.jsx(Et,{scope:t,baseId:$e(),value:g,onValueChange:p,orientation:m,dir:f,activationMode:x,children:e.jsx(X.div,{dir:f,"data-orientation":m,...d,ref:r})})});ms.displayName=Ee;var hs="TabsList",fs=a.forwardRef((s,r)=>{const{__scopeTabs:t,loop:n=!0,...l}=s,u=_e(hs,t),m=us(t);return e.jsx(Nt,{asChild:!0,...m,orientation:u.orientation,dir:u.dir,loop:n,children:e.jsx(X.div,{role:"tablist","aria-orientation":u.orientation,...l,ref:r})})});fs.displayName=hs;var xs="TabsTrigger",gs=a.forwardRef((s,r)=>{const{__scopeTabs:t,value:n,disabled:l=!1,...u}=s,m=_e(xs,t),h=us(t),x=bs(m.baseId,n),d=js(m.baseId,n),f=n===m.value;return e.jsx(wt,{asChild:!0,...h,focusable:!l,active:f,children:e.jsx(X.button,{type:"button",role:"tab","aria-selected":f,"aria-controls":d,"data-state":f?"active":"inactive","data-disabled":l?"":void 0,disabled:l,id:x,...u,ref:r,onMouseDown:K(s.onMouseDown,g=>{!l&&g.button===0&&g.ctrlKey===!1?m.onValueChange(n):g.preventDefault()}),onKeyDown:K(s.onKeyDown,g=>{[" ","Enter"].includes(g.key)&&m.onValueChange(n)}),onFocus:K(s.onFocus,()=>{const g=m.activationMode!=="manual";!f&&!l&&g&&m.onValueChange(n)})})})});gs.displayName=xs;var ps="TabsContent",vs=a.forwardRef((s,r)=>{const{__scopeTabs:t,value:n,forceMount:l,children:u,...m}=s,h=_e(ps,t),x=bs(h.baseId,n),d=js(h.baseId,n),f=n===h.value,g=a.useRef(f);return a.useEffect(()=>{const p=requestAnimationFrame(()=>g.current=!1);return()=>cancelAnimationFrame(p)},[]),e.jsx(we,{present:l||f,children:({present:p})=>e.jsx(X.div,{"data-state":f?"active":"inactive","data-orientation":h.orientation,role:"tabpanel","aria-labelledby":x,hidden:!p,id:d,tabIndex:0,...m,ref:r,style:{...s.style,animationDuration:g.current?"0s":void 0},children:p&&u})})});vs.displayName=ps;function bs(s,r){return`${s}-trigger-${r}`}function js(s,r){return`${s}-content-${r}`}var _t=ms,Rt=fs,Pt=gs,St=vs;const ys=a.forwardRef(({className:s,checked:r,...t},n)=>a.createElement(dt,{...t,ref:n,checked:r,className:ne("group inline-flex h-5 w-5 items-center justify-center outline-none ",s)},a.createElement("div",{className:ne("text-ui-fg-on-inverted bg-ui-bg-base shadow-borders-base [&_path]:shadow-details-contrast-on-bg-interactive transition-fg h-[15px] w-[15px] rounded-[3px]","group-disabled:cursor-not-allowed group-disabled:opacity-50","group-focus-visible:!shadow-borders-interactive-with-focus","group-hover:group-enabled:group-data-[state=unchecked]:bg-ui-bg-base-hover","group-data-[state=checked]:bg-ui-bg-interactive group-data-[state=checked]:shadow-borders-interactive-with-shadow","group-data-[state=indeterminate]:bg-ui-bg-interactive group-data-[state=indeterminate]:shadow-borders-interactive-with-shadow")},a.createElement(ut,null,r==="indeterminate"?a.createElement(He,null):a.createElement(ze,null)))));ys.displayName="Checkbox";const Ns=s=>a.createElement(_t,{...s});Ns.displayName="Tabs";const ws=a.forwardRef(({className:s,children:r,...t},n)=>a.createElement(Pt,{ref:n,className:ne("txt-compact-small-plus transition-fg text-ui-fg-subtle inline-flex items-center justify-center rounded-full border border-transparent bg-transparent px-2.5 py-1 outline-none","hover:text-ui-fg-base","focus-visible:border-ui-border-interactive focus-visible:!shadow-borders-focus focus-visible:bg-ui-bg-base","data-[state=active]:text-ui-fg-base data-[state=active]:bg-ui-bg-base data-[state=active]:shadow-elevation-card-rest",s),...t},r));ws.displayName="Tabs.Trigger";const Cs=a.forwardRef(({className:s,...r},t)=>a.createElement(Rt,{ref:t,className:ne("flex items-center gap-2",s),...r}));Cs.displayName="Tabs.List";const Es=a.forwardRef(({className:s,...r},t)=>a.createElement(St,{ref:t,className:ne("outline-none",s),...r}));Es.displayName="Tabs.Content";const Q=Object.assign(Ns,{Trigger:ws,List:Cs,Content:Es});function It({roles:s,users:r,permissionsByCategory:t,onUpdate:n}){const l=pe(),[u,m]=a.useState(!1),[h,x]=a.useState(null),[d,f]=a.useState(""),[g,p]=a.useState(""),[C,j]=a.useState({}),[P,T]=a.useState(!1),[y,S]=a.useState(null),$=z({mutationFn:async o=>{const N=o.id?`/admin/rbac/roles/${o.id}`:"/admin/rbac/roles";return F.client.fetch(N,{method:"POST",body:{name:o.name,description:o.description,policies:o.policies}})},onSuccess:()=>{l.invalidateQueries({queryKey:["rbac-management"]}),_.success(h?"Role updated":"Role created"),m(!1),n()},onError:()=>{_.error("Failed to save role")}}),I=z({mutationFn:async o=>F.client.fetch(`/admin/rbac/roles/${o}`,{method:"DELETE"}),onSuccess:()=>{l.invalidateQueries({queryKey:["rbac-management"]}),_.success("Role deleted"),n()},onError:()=>{_.error("Failed to delete role")}}),k=z({mutationFn:async({userId:o,roleId:N,hasRole:E})=>F.client.fetch(`/admin/rbac/users/${o}/roles`,{method:E?"DELETE":"POST",body:{role_id:N}}),onSuccess:(o,N)=>{l.invalidateQueries({queryKey:["rbac-management"]}),_.success(N.hasRole?"Role removed from user":"Role assigned to user"),n()},onError:()=>{_.error("Failed to update user role")}}),L=()=>{x(null),f(""),p(""),j({}),m(!0)},B=o=>{x(o),f(o.name),p(o.description||"");const N={};for(const E of o.policies)N[E.permission.id]=E.policy.decision;j(N),m(!0)},c=()=>{if(!d.trim()){_.error("Role name is required");return}const o=Object.entries(C).filter(([N,E])=>E!==null).map(([N,E])=>({permission_id:N,decision:E}));$.mutate({id:h==null?void 0:h.id,name:d,description:g||null,policies:o})},G=o=>{confirm(`Delete role "${o.name}"? Users with this role will lose their permissions.`)&&I.mutate(o.id)},M=o=>{S(o),T(!0)},Y=(o,N)=>{y&&k.mutate({userId:o,roleId:y.id,hasRole:N})},te=o=>{j(N=>{const E=N[o];if(E==null)return{...N,[o]:"allow"};if(E==="allow")return{...N,[o]:"deny"};{const{[o]:O,...D}=N;return D}})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(v,{className:"text-ui-fg-subtle",children:"Create roles to define permission sets for your users"}),e.jsxs(R,{onClick:L,children:[e.jsx(ve,{className:"w-4 h-4 mr-2"}),"Create Role"]})]}),s.length===0?e.jsx(V,{className:"p-6",children:e.jsxs("div",{className:"text-center py-12 bg-ui-bg-subtle rounded-lg",children:[e.jsx(se,{className:"w-12 h-12 mx-auto text-ui-fg-muted mb-4"}),e.jsx(v,{className:"text-ui-fg-subtle mb-4",children:"No roles created yet"}),e.jsx(R,{onClick:L,children:"Create First Role"})]})}):e.jsx("div",{className:"space-y-4",children:s.map(o=>{const N=r.filter(D=>D.roles.some(he=>he.id===o.id)),E=o.policies.filter(D=>D.policy.decision==="allow").length,O=o.policies.filter(D=>D.policy.decision==="deny").length;return e.jsxs(V,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(q,{level:"h3",children:o.name}),o.is_system&&e.jsx(b,{color:"grey",children:"System"})]}),o.description&&e.jsx(v,{className:"text-ui-fg-subtle mb-3",children:o.description}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs(b,{color:"green",children:[E," Allow"]}),e.jsxs(b,{color:"red",children:[O," Deny"]}),e.jsxs(v,{className:"text-ui-fg-subtle",children:[N.length," users"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(R,{variant:"secondary",size:"small",onClick:()=>M(o),children:[e.jsx(se,{className:"w-4 h-4 mr-1"}),"Users"]}),!o.is_system&&e.jsxs(e.Fragment,{children:[e.jsx(R,{variant:"secondary",size:"small",onClick:()=>B(o),children:e.jsx(ks,{className:"w-4 h-4"})}),e.jsx(R,{variant:"danger",size:"small",onClick:()=>G(o),children:e.jsx(re,{className:"w-4 h-4"})})]})]})]}),o.policies.length>0&&e.jsx("div",{className:"mt-4 pt-4 border-t border-ui-border-base",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.policies.slice(0,6).map(D=>e.jsxs(b,{color:D.policy.decision==="allow"?"green":"red",children:[D.policy.decision==="allow"?"+":"-"," ",D.permission.name]},D.policy.id)),o.policies.length>6&&e.jsxs(b,{color:"grey",children:["+",o.policies.length-6," more"]})]})})]},o.id)})}),u&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-ui-bg-base rounded-lg w-full max-w-3xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-ui-border-base",children:[e.jsx(q,{level:"h2",children:h?"Edit Role":"Create Role"}),e.jsx(R,{variant:"transparent",onClick:()=>m(!1),children:e.jsx(Z,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-180px)]",children:[e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{children:[e.jsx(J,{htmlFor:"role-name",children:"Role Name"}),e.jsx(ee,{id:"role-name",value:d,onChange:o=>f(o.target.value),placeholder:"e.g., Editor, Viewer, Order Manager"})]}),e.jsxs("div",{children:[e.jsx(J,{htmlFor:"role-description",children:"Description"}),e.jsx(Fe,{id:"role-description",value:g,onChange:o=>p(o.target.value),placeholder:"What can users with this role do?"})]})]}),e.jsxs("div",{children:[e.jsx(q,{level:"h3",className:"mb-4",children:"Permissions"}),e.jsxs(v,{className:"text-sm text-ui-fg-subtle mb-4",children:["Click to toggle: ",e.jsx(b,{color:"grey",children:"None"})," → ",e.jsx(b,{color:"green",children:"Allow"})," → ",e.jsx(b,{color:"red",children:"Deny"})]}),Object.entries(t).map(([o,N])=>e.jsxs("div",{className:"mb-6",children:[e.jsx(v,{className:"font-medium mb-2",children:o}),e.jsx("div",{className:"space-y-2",children:N.map(E=>{const O=C[E.id];return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-ui-bg-subtle rounded cursor-pointer hover:bg-ui-bg-subtle-hover",onClick:()=>te(E.id),children:[e.jsxs("div",{children:[e.jsx(v,{className:"font-medium",children:E.name}),e.jsxs(v,{className:"text-sm text-ui-fg-subtle",children:[E.action," ",E.resource]})]}),e.jsx(b,{color:O==="allow"?"green":O==="deny"?"red":"grey",children:O==="allow"?"Allow":O==="deny"?"Deny":"None"})]},E.id)})})]},o))]})]}),e.jsxs("div",{className:"flex justify-end gap-2 p-6 border-t border-ui-border-base",children:[e.jsx(R,{variant:"secondary",onClick:()=>m(!1),children:"Cancel"}),e.jsx(R,{onClick:c,disabled:$.isPending,children:$.isPending?"Saving...":h?"Save Changes":"Create Role"})]})]})}),P&&y&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-ui-bg-base rounded-lg w-full max-w-lg max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-ui-border-base",children:[e.jsxs(q,{level:"h2",children:['Users with "',y.name,'"']}),e.jsx(R,{variant:"transparent",onClick:()=>T(!1),children:e.jsx(Z,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(80vh-120px)]",children:r.length===0?e.jsx(v,{className:"text-ui-fg-subtle",children:"No users found"}):e.jsx("div",{className:"space-y-2",children:r.map(o=>{const N=o.roles.some(E=>E.id===y.id);return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-ui-bg-subtle rounded",children:[e.jsxs("div",{children:[e.jsxs(v,{className:"font-medium",children:[o.first_name," ",o.last_name]}),e.jsx(v,{className:"text-sm text-ui-fg-subtle",children:o.email})]}),e.jsx(ys,{checked:N,onCheckedChange:()=>Y(o.id,N)})]},o.id)})})}),e.jsx("div",{className:"flex justify-end p-6 border-t border-ui-border-base",children:e.jsx(R,{onClick:()=>T(!1),children:"Done"})})]})})]})}function Tt({permissions:s,permissionsByCategory:r,onUpdate:t}){const n=pe(),[l,u]=a.useState("category"),[m,h]=a.useState(!1),[x,d]=a.useState(""),[f,g]=a.useState(""),[p,C]=a.useState("read"),[j,P]=a.useState(""),[T,y]=a.useState(""),S=z({mutationFn:async()=>F.client.fetch("/admin/rbac/permissions",{method:"POST",body:{name:x,description:f||null,action:p,resource:j,category:T||"Custom"}}),onSuccess:()=>{n.invalidateQueries({queryKey:["rbac-management"]}),_.success("Permission created"),h(!1),t()},onError:()=>{_.error("Failed to create permission")}}),$=z({mutationFn:async c=>F.client.fetch(`/admin/rbac/permissions/${c}`,{method:"DELETE"}),onSuccess:()=>{n.invalidateQueries({queryKey:["rbac-management"]}),_.success("Permission deleted"),t()},onError:c=>{_.error(c.message||"Failed to delete permission")}}),I=()=>{d(""),g(""),C("read"),P(""),y("Custom"),h(!0)},k=()=>{if(!x.trim()||!j.trim()){_.error("Name and resource are required");return}S.mutate()},L=c=>{confirm(`Delete permission "${c.name}"?`)&&$.mutate(c.id)},B=c=>{switch(c){case"read":return"blue";case"write":return"orange";case"delete":return"red";default:return"grey"}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"flex gap-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(b,{color:"blue",children:[s.filter(c=>c.action==="read").length," Read"]}),e.jsxs(b,{color:"orange",children:[s.filter(c=>c.action==="write").length," Write"]}),e.jsxs(b,{color:"red",children:[s.filter(c=>c.action==="delete").length," Delete"]})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex border border-ui-border-base rounded-lg overflow-hidden",children:[e.jsx("button",{className:`px-3 py-1.5 text-sm ${l==="category"?"bg-ui-bg-interactive text-ui-fg-on-color":"bg-ui-bg-base"}`,onClick:()=>u("category"),children:"By Category"}),e.jsx("button",{className:`px-3 py-1.5 text-sm ${l==="list"?"bg-ui-bg-interactive text-ui-fg-on-color":"bg-ui-bg-base"}`,onClick:()=>u("list"),children:"List"})]}),e.jsxs(R,{onClick:I,children:[e.jsx(ve,{className:"w-4 h-4 mr-2"}),"Add Custom"]})]})]}),l==="category"?e.jsx("div",{className:"space-y-4",children:Object.entries(r).map(([c,G])=>e.jsxs(V,{className:"divide-y p-0",children:[e.jsx("div",{className:"p-4 bg-ui-bg-subtle",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(q,{level:"h3",children:c}),e.jsx(b,{color:"grey",children:G.length})]})}),e.jsx("div",{className:"divide-y divide-ui-border-base",children:G.map(M=>e.jsxs("div",{className:"flex items-center justify-between p-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"font-medium",children:M.name}),e.jsx(b,{color:B(M.action),children:M.action}),M.is_system&&e.jsx(b,{color:"grey",children:"System"})]}),e.jsx(v,{className:"text-sm text-ui-fg-subtle",children:M.resource})]}),!M.is_system&&e.jsx(R,{variant:"danger",size:"small",onClick:()=>L(M),children:e.jsx(re,{className:"w-4 h-4"})})]},M.id))})]},c))}):e.jsx(V,{className:"divide-y p-0",children:s.map(c=>e.jsxs("div",{className:"flex items-center justify-between p-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"font-medium",children:c.name}),e.jsx(b,{color:B(c.action),children:c.action}),e.jsx(b,{color:"grey",children:c.category}),c.is_system&&e.jsx(b,{color:"purple",children:"System"})]}),e.jsx(v,{className:"text-sm text-ui-fg-subtle",children:c.resource})]}),!c.is_system&&e.jsx(R,{variant:"danger",size:"small",onClick:()=>L(c),children:e.jsx(re,{className:"w-4 h-4"})})]},c.id))}),m&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-ui-bg-base rounded-lg w-full max-w-lg",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-ui-border-base",children:[e.jsx(q,{level:"h2",children:"Add Custom Permission"}),e.jsx(R,{variant:"transparent",onClick:()=>h(!1),children:e.jsx(Z,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx(J,{htmlFor:"perm-name",children:"Name"}),e.jsx(ee,{id:"perm-name",value:x,onChange:c=>d(c.target.value),placeholder:"e.g., View Reports"})]}),e.jsxs("div",{children:[e.jsx(J,{htmlFor:"perm-description",children:"Description"}),e.jsx(Fe,{id:"perm-description",value:f,onChange:c=>g(c.target.value),placeholder:"What does this permission allow?"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(J,{htmlFor:"perm-action",children:"Action"}),e.jsxs(A,{value:p,onValueChange:c=>C(c),children:[e.jsx(A.Trigger,{children:e.jsx(A.Value,{placeholder:"Select action"})}),e.jsxs(A.Content,{children:[e.jsx(A.Item,{value:"read",children:"Read"}),e.jsx(A.Item,{value:"write",children:"Write"}),e.jsx(A.Item,{value:"delete",children:"Delete"})]})]})]}),e.jsxs("div",{children:[e.jsx(J,{htmlFor:"perm-category",children:"Category"}),e.jsx(ee,{id:"perm-category",value:T,onChange:c=>y(c.target.value),placeholder:"e.g., Custom"})]})]}),e.jsxs("div",{children:[e.jsx(J,{htmlFor:"perm-resource",children:"Resource (API Path)"}),e.jsx(ee,{id:"perm-resource",value:j,onChange:c=>P(c.target.value),placeholder:"/admin/custom-route"}),e.jsx(v,{className:"text-xs text-ui-fg-muted mt-1",children:"The API path this permission applies to"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 p-6 border-t border-ui-border-base",children:[e.jsx(R,{variant:"secondary",onClick:()=>h(!1),children:"Cancel"}),e.jsx(R,{onClick:k,disabled:S.isPending,children:S.isPending?"Creating...":"Create Permission"})]})]})})]})}function kt({users:s,roles:r,invites:t,onUpdate:n}){const l=pe(),[u,m]=a.useState(""),[h,x]=a.useState(!1),[d,f]=a.useState(!1),[g,p]=a.useState(null),[C,j]=a.useState(""),[P,T]=a.useState(""),[y,S]=a.useState(""),[$,I]=a.useState(null),k=z({mutationFn:async({email:i,roleId:w})=>{var W;I(null);try{return await F.client.fetch("/admin/rbac/invites",{method:"POST",body:{email:i,role_id:w}})}catch(U){console.error("[RBAC Invite] Caught error:",U);const Is=((W=U==null?void 0:U.body)==null?void 0:W.message)||(U==null?void 0:U.message)||"Failed to send invite";throw new Error(Is)}},onSuccess:i=>{l.invalidateQueries({queryKey:["rbac-management"]});const w=(i==null?void 0:i.message)||`Invite sent to ${P}`;_.success(w),console.log("[RBAC Invite] Success:",i),f(!1),T(""),S(""),I(null),n()},onError:i=>{const w=(i==null?void 0:i.message)||"Failed to send invite";console.error("[RBAC Invite] Error:",w),I(w),_.error(w)}}),L=z({mutationFn:async({userId:i,roleId:w})=>F.client.fetch(`/admin/rbac/users/${i}/roles`,{method:"POST",body:{role_id:w}}),onSuccess:()=>{l.invalidateQueries({queryKey:["rbac-management"]}),_.success("Role assigned successfully"),x(!1),n()},onError:i=>{_.error(i.message||"Failed to assign role")}}),B=z({mutationFn:async({userId:i,roleId:w})=>F.client.fetch(`/admin/rbac/users/${i}/roles`,{method:"DELETE",body:{role_id:w}}),onSuccess:()=>{l.invalidateQueries({queryKey:["rbac-management"]}),_.success("Role removed"),n()},onError:()=>{_.error("Failed to remove role")}}),c=z({mutationFn:async i=>F.client.fetch(`/admin/invites/${i}/resend`,{method:"POST"}),onSuccess:()=>{l.invalidateQueries({queryKey:["rbac-management"]}),_.success("Invite resent successfully"),n()},onError:i=>{_.error((i==null?void 0:i.message)||"Failed to resend invite")}}),G=z({mutationFn:async i=>F.client.fetch(`/admin/invites/${i}`,{method:"DELETE"}),onSuccess:()=>{l.invalidateQueries({queryKey:["rbac-management"]}),_.success("Invite cancelled"),n()},onError:i=>{_.error((i==null?void 0:i.message)||"Failed to cancel invite")}}),M=z({mutationFn:async i=>F.client.fetch(`/admin/users/${i}`,{method:"DELETE"}),onSuccess:()=>{l.invalidateQueries({queryKey:["rbac-management"]}),_.success("User deleted successfully"),n()},onError:i=>{_.error((i==null?void 0:i.message)||"Failed to delete user")}}),Y=i=>{p(i),j(""),x(!0)},te=()=>{if(!g||!C){_.error("Please select a role");return}L.mutate({userId:g.id,roleId:C})},o=(i,w,W)=>{confirm(`Remove role "${W}" from this user?`)&&B.mutate({userId:i,roleId:w})},N=s.filter(i=>{var W,U;const w=u.toLowerCase();return i.email.toLowerCase().includes(w)||(((W=i.first_name)==null?void 0:W.toLowerCase())||"").includes(w)||(((U=i.last_name)==null?void 0:U.toLowerCase())||"").includes(w)}),E=()=>{if(!g)return r;const i=g.roles.map(w=>w.id);return r.filter(w=>!i.includes(w.id))},O=()=>{if(!P){_.error("Please enter an email address");return}if(!y){_.error("Please select a role for the new user");return}k.mutate({email:P,roleId:y})},D=()=>{T(""),S(""),I(null),f(!0)},he=i=>{c.mutate(i.id)},_s=i=>{confirm(`Cancel invite for "${i.email}"? They won't be able to accept this invitation.`)&&G.mutate(i.id)},Rs=i=>{const W=`${window.location.origin}/app/invite?token=${i.token}`;navigator.clipboard.writeText(W),_.success("Invite link copied to clipboard")},Ps=i=>{const w=i.first_name||i.last_name?`${i.first_name||""} ${i.last_name||""}`.trim():i.email;confirm(`Are you sure you want to delete "${w}"? This action cannot be undone.`)&&M.mutate(i.id)},Ss=i=>new Date(i.expires_at)<new Date,fe=t.filter(i=>!i.accepted);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-80",children:e.jsx(ee,{type:"text",placeholder:"Search users...",value:u,onChange:i=>m(i.target.value)})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{color:"green",children:s.filter(i=>i.roles.length===0).length}),e.jsx(v,{className:"text-ui-fg-subtle",children:"Full Access"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{color:"blue",children:s.filter(i=>i.roles.length>0).length}),e.jsx(v,{className:"text-ui-fg-subtle",children:"Restricted"})]})]}),e.jsxs(R,{onClick:D,children:[e.jsx(Se,{className:"w-4 h-4 mr-2"}),"Invite User"]})]})]}),fe.length>0&&e.jsxs(V,{className:"p-0 overflow-hidden mb-4",children:[e.jsxs("div",{className:"px-4 py-3 bg-ui-bg-subtle border-b border-ui-border-base flex items-center gap-2",children:[e.jsx(qe,{className:"w-4 h-4 text-ui-fg-muted"}),e.jsx(v,{className:"font-medium text-sm",children:"Pending Invites"}),e.jsx(b,{color:"orange",size:"small",children:fe.length})]}),e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-ui-bg-subtle-hover border-b border-ui-border-base",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-2 text-xs font-medium text-ui-fg-subtle",children:"Email"}),e.jsx("th",{className:"text-left px-4 py-2 text-xs font-medium text-ui-fg-subtle",children:"Role"}),e.jsx("th",{className:"text-left px-4 py-2 text-xs font-medium text-ui-fg-subtle",children:"Status"}),e.jsx("th",{className:"text-left px-4 py-2 text-xs font-medium text-ui-fg-subtle",children:"Sent"}),e.jsx("th",{className:"text-right px-4 py-2 text-xs font-medium text-ui-fg-subtle",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-ui-border-base",children:fe.map(i=>e.jsxs("tr",{className:"hover:bg-ui-bg-subtle-hover",children:[e.jsx("td",{className:"px-4 py-2",children:e.jsx(v,{className:"text-sm",children:i.email})}),e.jsx("td",{className:"px-4 py-2",children:i.pending_role?e.jsx(b,{color:"blue",size:"small",children:i.pending_role.name}):e.jsx(b,{color:"grey",size:"small",children:"No role"})}),e.jsx("td",{className:"px-4 py-2",children:Ss(i)?e.jsx(b,{color:"red",size:"small",children:"Expired"}):e.jsx(b,{color:"orange",size:"small",children:"Pending"})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx(v,{className:"text-xs text-ui-fg-muted",children:new Date(i.created_at).toLocaleDateString()})}),e.jsx("td",{className:"px-4 py-2 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(R,{variant:"transparent",size:"small",onClick:()=>Rs(i),title:"Copy invite link",children:e.jsx(Je,{className:"w-4 h-4"})}),e.jsx(R,{variant:"transparent",size:"small",onClick:()=>he(i),disabled:c.isPending,title:"Resend invite",children:e.jsx($s,{className:"w-4 h-4"})}),e.jsx(R,{variant:"transparent",size:"small",onClick:()=>_s(i),disabled:G.isPending,title:"Cancel invite",className:"text-ui-fg-error hover:text-ui-fg-error",children:e.jsx(re,{className:"w-4 h-4"})})]})})]},i.id))})]})]}),e.jsxs(V,{className:"p-0 overflow-hidden",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-ui-bg-subtle border-b border-ui-border-base",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-ui-fg-subtle",children:"User"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-ui-fg-subtle",children:"Email"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-ui-fg-subtle",children:"Role(s)"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-ui-fg-subtle",children:"Access"}),e.jsx("th",{className:"text-right px-4 py-3 text-sm font-medium text-ui-fg-subtle",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-ui-border-base",children:N.map(i=>e.jsxs("tr",{className:"hover:bg-ui-bg-subtle-hover",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx(v,{className:"font-medium",children:i.first_name||i.last_name?`${i.first_name||""} ${i.last_name||""}`.trim():"No name"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(v,{className:"text-ui-fg-subtle",children:i.email})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:i.roles.length===0?e.jsx(b,{color:"grey",children:"None"}):i.roles.map(w=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(b,{color:"blue",children:w.name}),e.jsx("button",{onClick:()=>o(i.id,w.id,w.name),className:"text-ui-fg-muted hover:text-ui-fg-error",title:"Remove role",children:e.jsx(Z,{className:"w-3 h-3"})})]},w.id))})}),e.jsx("td",{className:"px-4 py-3",children:i.roles.length===0?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ds,{className:"w-4 h-4 text-green-500"}),e.jsx(v,{className:"text-green-600 text-sm",children:"Full"})]}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ne,{className:"w-4 h-4 text-ui-fg-muted"}),e.jsx(v,{className:"text-ui-fg-subtle text-sm",children:"Limited"})]})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsxs(R,{variant:"secondary",size:"small",onClick:()=>Y(i),children:[e.jsx(ve,{className:"w-4 h-4 mr-1"}),"Add Role"]}),e.jsx(R,{variant:"transparent",size:"small",onClick:()=>Ps(i),disabled:M.isPending,title:"Delete user",className:"text-ui-fg-error hover:text-ui-fg-error",children:e.jsx(re,{className:"w-4 h-4"})})]})})]},i.id))})]}),N.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx(v,{className:"text-ui-fg-subtle",children:"No users found"})})]}),e.jsx("div",{className:"mt-4 p-4 bg-ui-bg-subtle rounded-lg",children:e.jsxs(v,{className:"text-sm text-ui-fg-subtle",children:[e.jsx("strong",{children:"Note:"})," Users without roles have full admin access. Assign a role to restrict their permissions."]})}),h&&g&&e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center",style:{zIndex:9999},children:e.jsxs("div",{className:"bg-ui-bg-base rounded-lg w-full max-w-md shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-ui-border-base",children:[e.jsx(q,{level:"h2",children:"Assign Role"}),e.jsx(R,{variant:"transparent",onClick:()=>x(!1),children:e.jsx(Z,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs(v,{className:"text-ui-fg-subtle mb-4",children:["Assign a role to ",e.jsx("strong",{children:g.email})]}),E().length===0?e.jsx(v,{className:"text-ui-fg-muted",children:"This user already has all available roles."}):e.jsxs(A,{value:C,onValueChange:j,children:[e.jsx(A.Trigger,{children:e.jsx(A.Value,{placeholder:"Select a role"})}),e.jsx(A.Content,{className:"z-[10000]",children:E().map(i=>e.jsx(A.Item,{value:i.id,children:i.name},i.id))})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 p-6 border-t border-ui-border-base",children:[e.jsx(R,{variant:"secondary",onClick:()=>x(!1),children:"Cancel"}),e.jsx(R,{onClick:te,disabled:!C||L.isPending,children:L.isPending?"Assigning...":"Assign Role"})]})]})}),d&&e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center",style:{zIndex:9999},children:e.jsxs("div",{className:"bg-ui-bg-base rounded-lg w-full max-w-md shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-ui-border-base",children:[e.jsx(q,{level:"h2",children:"Invite New User"}),e.jsx(R,{variant:"transparent",onClick:()=>f(!1),children:e.jsx(Z,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[$&&e.jsx("div",{className:"p-3 bg-ui-bg-subtle-hover border border-ui-tag-red-border rounded-lg",children:e.jsx(v,{className:"text-ui-fg-error text-sm",children:$})}),e.jsxs("div",{children:[e.jsx(v,{className:"text-ui-fg-subtle mb-2 block",children:"Email Address"}),e.jsx(ee,{type:"email",placeholder:"user@example.com",value:P,onChange:i=>T(i.target.value)})]}),e.jsxs("div",{children:[e.jsx(v,{className:"text-ui-fg-subtle mb-2 block",children:"Assign Role"}),e.jsxs(A,{value:y,onValueChange:S,children:[e.jsx(A.Trigger,{children:e.jsx(A.Value,{placeholder:"Select role"})}),e.jsx(A.Content,{className:"z-[10000]",children:r.map(i=>e.jsx(A.Item,{value:i.id,children:i.name},i.id))})]}),e.jsx(v,{className:"text-xs text-ui-fg-muted mt-1",children:"Role will be assigned when the user accepts."})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 p-6 border-t border-ui-border-base",children:[e.jsx(R,{variant:"secondary",onClick:()=>f(!1),children:"Cancel"}),e.jsxs(R,{onClick:O,disabled:!P||!y||k.isPending,children:[e.jsx(Se,{className:"w-4 h-4 mr-2"}),k.isPending?"Sending...":"Send Invite"]})]})]})})]})}const Ot=async()=>{try{if(!((await F.client.fetch("/admin/rbac/check",{method:"POST",body:{action:"read",resource:"/admin/rbac"}})).allowed??!1))return{roles:[],users:[],permissions:[],permissionsByCategory:{},invites:[],hasAccess:!1};const[t,n,l,u]=await Promise.all([F.client.fetch("/admin/rbac/roles",{method:"GET"}),F.client.fetch("/admin/rbac/users",{method:"GET"}),F.client.fetch("/admin/rbac/permissions",{method:"GET"}),F.client.fetch("/admin/rbac/invites",{method:"GET"})]);return{roles:t.roles||[],users:n.users||[],permissions:l.permissions||[],permissionsByCategory:l.by_category||{},invites:u.invites||[],hasAccess:!0}}catch{return{roles:[],users:[],permissions:[],permissionsByCategory:{},invites:[],hasAccess:!1}}},Ht=()=>{const[s,r]=a.useState("users"),{data:t,isLoading:n,refetch:l}=Ts({queryKey:["rbac-management"],queryFn:Ot}),u=(t==null?void 0:t.roles)??[],m=(t==null?void 0:t.users)??[],h=(t==null?void 0:t.permissions)??[],x=(t==null?void 0:t.permissionsByCategory)??{},d=(t==null?void 0:t.invites)??[],f=(t==null?void 0:t.hasAccess)??!1;return n?e.jsx("div",{className:"flex flex-col gap-y-4 p-6",children:e.jsx(V,{className:"p-6",children:e.jsx(v,{className:"text-ui-fg-subtle",children:"Loading..."})})}):f?(m.filter(g=>{var p;return((p=g.roles)==null?void 0:p.length)>0}),e.jsxs("div",{className:"flex flex-col gap-y-4 p-6",children:[e.jsx(V,{className:"divide-y p-0",children:e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsxs("div",{className:"flex items-center gap-x-3",children:[e.jsx(se,{className:"w-6 h-6 text-ui-fg-subtle"}),e.jsxs("div",{children:[e.jsx(q,{level:"h1",children:"Users & Access Control"}),e.jsx(v,{className:"text-ui-fg-subtle",children:"Manage users, roles, and permissions"})]})]}),e.jsx("div",{className:"flex items-center gap-4 text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(b,{color:"grey",children:[m.length," Users"]}),e.jsxs(b,{color:"blue",children:[u.length," Roles"]}),e.jsxs(b,{color:"purple",children:[h.length," Permissions"]})]})})]})}),e.jsxs(Q,{value:s,onValueChange:r,children:[e.jsxs(Q.List,{children:[e.jsxs(Q.Trigger,{value:"users",className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4"}),"Users",e.jsx(b,{color:"grey",size:"small",children:m.length})]}),e.jsxs(Q.Trigger,{value:"roles",className:"flex items-center gap-2",children:[e.jsx(Pe,{className:"w-4 h-4"}),"Roles",e.jsx(b,{color:"grey",size:"small",children:u.length})]}),e.jsxs(Q.Trigger,{value:"permissions",className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-4 h-4"}),"Permissions",e.jsx(b,{color:"grey",size:"small",children:h.length})]})]}),e.jsx(Q.Content,{value:"users",className:"mt-4",children:e.jsx(kt,{users:m,roles:u,invites:d,onUpdate:l})}),e.jsx(Q.Content,{value:"roles",className:"mt-4",children:e.jsx(It,{roles:u,users:m,permissionsByCategory:x,onUpdate:l})}),e.jsx(Q.Content,{value:"permissions",className:"mt-4",children:e.jsx(Tt,{permissions:h,permissionsByCategory:x,onUpdate:l})})]})]})):e.jsxs("div",{className:"flex flex-col gap-y-4 p-6",children:[e.jsx(V,{className:"divide-y p-0",children:e.jsxs("div",{className:"flex items-center gap-x-3 px-6 py-4",children:[e.jsx(se,{className:"w-6 h-6 text-ui-fg-subtle"}),e.jsxs("div",{children:[e.jsx(q,{level:"h1",children:"Users"}),e.jsx(v,{className:"text-ui-fg-subtle",children:"Manage admin users"})]})]})}),e.jsx(V,{className:"p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Pe,{className:"w-12 h-12 mx-auto text-ui-fg-muted mb-4"}),e.jsx(v,{className:"text-ui-fg-subtle mb-2",children:"RBAC not configured or you don't have access"}),e.jsx(v,{className:"text-sm text-ui-fg-muted",children:"Contact your administrator to enable role-based access control"})]})})]})};export{Ht as Component};
