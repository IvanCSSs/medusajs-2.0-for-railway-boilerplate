import{u as F}from"./chunk-3TZOFKX2-M15LmCS4.js";import{f as I}from"./chunk-IR5DHEKS-aVJcUHa1.js";import{C as L}from"./chunk-OFN7DIZA-C5u54b_Q.js";import{u as w,a as R,bM as S,b2 as H,bN as T,j as e,H as M,z as k,c as z,bP as D,t as b,F as s,I as U,bI as C,q as E,B as P,O as q,o as B,bk as N,l as K,s as v}from"./index-S35l5lon.js";import{c as V}from"./chunk-DK4WIVY6-CYCbBMOO.js";import{K as O}from"./chunk-6HTZNHPT-USxWRfar.js";import{a as l,u as A}from"./chunk-AERWK3TJ-Gph8MRZF.js";import{S as u}from"./select-CmrtK7XQ.js";import"./combobox-provider-CcO6EPfN.js";import"./triangles-mini-CX2619vl.js";import"./plus-mini-B5zW_eay.js";import"./focus-modal-B7NOABos.js";import"./prompt-YaiseBxh.js";import"./check-B9bFzKnZ.js";B({name:v().min(1),currency_code:v(),payment_providers:K(v()),automatic_taxes:N(),is_tax_inclusive:N()});var G=({region:t,currencies:p,pricePreferences:a})=>{var h;const{t:i}=w(),{handleSuccess:f}=A(),d=a==null?void 0:a.find(r=>r.attribute==="region_id"&&r.value===t.id),m=k(),n=z({defaultValues:{name:t.name,currency_code:t.currency_code.toUpperCase(),payment_providers:((h=t.payment_providers)==null?void 0:h.map(r=>r.id))||[],automatic_taxes:t.automatic_taxes,is_tax_inclusive:(d==null?void 0:d.is_tax_inclusive)||!1}}),j=F({queryKey:["payment_providers"],queryFn:r=>q.admin.payment.listPaymentProviders({...r,is_enabled:!0}),getOptions:r=>r.payment_providers.map(o=>({label:I(o.id),value:o.id}))}),{mutateAsync:g,isPending:y}=D(t.id),_=n.handleSubmit(async r=>{await g({name:r.name,automatic_taxes:r.automatic_taxes,currency_code:r.currency_code.toLowerCase(),payment_providers:r.payment_providers,is_tax_inclusive:r.is_tax_inclusive},{onSuccess:()=>{b.success(i("regions.toast.edit")),f()},onError:o=>{b.error(o.message)}})});return e.jsx(l.Form,{form:n,children:e.jsxs(O,{onSubmit:_,className:"flex flex-1 flex-col overflow-hidden",children:[e.jsx(l.Body,{className:"overflow-y-auto",children:e.jsxs("div",{className:"flex flex-col gap-y-8",children:[e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx(s.Field,{control:n.control,name:"name",render:({field:r})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{children:i("fields.name")}),e.jsx(s.Control,{children:e.jsx(U,{...r})}),e.jsx(s.ErrorMessage,{})]})}),e.jsx(s.Field,{control:n.control,name:"currency_code",render:({field:{onChange:r,ref:o,...c}})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{children:i("fields.currency")}),e.jsx(s.Control,{children:e.jsxs(u,{dir:m,onValueChange:r,...c,children:[e.jsx(u.Trigger,{ref:o,children:e.jsx(u.Value,{})}),e.jsx(u.Content,{children:p.map(x=>e.jsx(u.Item,{value:x.code,children:x.code.toUpperCase()},x.code))})]})}),e.jsx(s.ErrorMessage,{})]})})]}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx(s.Field,{control:n.control,name:"automatic_taxes",render:({field:{value:r,onChange:o,...c}})=>e.jsx(s.Item,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(s.Label,{children:i("fields.automaticTaxes")}),e.jsx(s.Control,{children:e.jsx(C,{dir:"ltr",className:"rtl:rotate-180",...c,checked:r,onCheckedChange:o})})]}),e.jsx(s.Hint,{children:i("regions.automaticTaxesHint")}),e.jsx(s.ErrorMessage,{})]})})}),e.jsx(s.Field,{control:n.control,name:"is_tax_inclusive",render:({field:{value:r,onChange:o,...c}})=>e.jsx(s.Item,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(s.Label,{children:i("fields.taxInclusivePricing")}),e.jsx(s.Control,{children:e.jsx(C,{dir:"ltr",className:"rtl:rotate-180",...c,checked:r,onCheckedChange:o})})]}),e.jsx(s.Hint,{children:i("regions.taxInclusiveHint")}),e.jsx(s.ErrorMessage,{})]})})})]}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsxs("div",{children:[e.jsx(E,{size:"small",leading:"compact",weight:"plus",children:"Providers"}),e.jsx(E,{size:"small",className:"text-ui-fg-subtle",children:i("regions.providersHint")})]}),e.jsx(s.Field,{control:n.control,name:"payment_providers",render:({field:r})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{children:i("fields.paymentProviders")}),e.jsx(s.Control,{children:e.jsx(L,{forceHideInput:!0,options:j.options,fetchNextPage:j.fetchNextPage,...r})}),e.jsx(s.ErrorMessage,{})]})})]})]})}),e.jsx(l.Footer,{children:e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx(l.Close,{asChild:!0,children:e.jsx(P,{size:"small",variant:"secondary",children:i("actions.cancel")})}),e.jsx(P,{size:"small",type:"submit",isLoading:y,children:i("actions.save")})]})})]})})},ae=()=>{const{t}=w(),{id:p}=R(),{region:a,isPending:i,isError:f,error:d}=S(p,{fields:"*payment_providers,*countries,+automatic_taxes"}),{store:m,isPending:n,isError:j,error:g}=H(),{price_preferences:y=[],isPending:_,isError:h,error:r}=T({attribute:"region_id",value:p},{enabled:!!a}),o=i||n||_,c=((m==null?void 0:m.supported_currencies)??[]).map(x=>V[x.currency_code.toUpperCase()]);if(f)throw d;if(j)throw g;if(h)throw r;return e.jsxs(l,{children:[e.jsx(l.Header,{children:e.jsx(M,{children:t("regions.editRegion")})}),!o&&a&&e.jsx(G,{region:a,currencies:c,pricePreferences:y})]})};export{ae as Component};
