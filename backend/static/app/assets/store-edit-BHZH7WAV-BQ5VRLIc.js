import{u as g}from"./chunk-3TZOFKX2-M15LmCS4.js";import{C as b}from"./chunk-OFN7DIZA-C5u54b_Q.js";import{u as L,b2 as q,j as e,H as w,z as K,c as R,bR as k,t as V,F as o,I as z,B as F,e as D,O as y,o as M,s as d}from"./index-S35l5lon.js";import{K as N}from"./chunk-6HTZNHPT-USxWRfar.js";import{a as i,u as O}from"./chunk-AERWK3TJ-Gph8MRZF.js";import{S as c}from"./select-CmrtK7XQ.js";import"./combobox-provider-CcO6EPfN.js";import"./triangles-mini-CX2619vl.js";import"./plus-mini-B5zW_eay.js";import"./focus-modal-B7NOABos.js";import"./prompt-YaiseBxh.js";import"./check-B9bFzKnZ.js";var T=M({name:d().min(1),default_currency_code:d().optional(),default_region_id:d().optional(),default_sales_channel_id:d().optional(),default_location_id:d().optional()}),B=({store:n})=>{var C,v;const{t:r}=L(),{handleSuccess:f}=O(),p=K(),l=R({defaultValues:{name:n.name,default_region_id:n.default_region_id||void 0,default_currency_code:((v=(C=n.supported_currencies)==null?void 0:C.find(a=>a.is_default))==null?void 0:v.currency_code)||void 0,default_sales_channel_id:n.default_sales_channel_id||void 0,default_location_id:n.default_location_id||void 0},resolver:D(T)}),{mutateAsync:j,isPending:E}=k(n.id),u=g({queryKey:["regions","default_region_id"],queryFn:a=>y.admin.region.list({...a,fields:"id,name"}),defaultValue:n.default_region_id||void 0,getOptions:a=>a.regions.map(s=>({label:s.name,value:s.id}))}),m=g({queryFn:a=>y.admin.salesChannel.list({...a,fields:"id,name"}),getOptions:a=>a.sales_channels.map(s=>({label:s.name,value:s.id})),queryKey:["sales_channels","default_sales_channel_id"],defaultValue:n.default_sales_channel_id||void 0}),h=g({queryFn:a=>y.admin.stockLocation.list({...a,fields:"id,name"}),getOptions:a=>a.stock_locations.map(s=>({label:s.name,value:s.id})),queryKey:["stock_locations","default_location_id"],defaultValue:n.default_location_id||void 0}),I=l.handleSubmit(async a=>{var S;const{default_currency_code:s,..._}=a,t={..._,supported_currencies:(S=n.supported_currencies)==null?void 0:S.map(x=>({...x,is_default:x.currency_code===s}))};await j(t,{onSuccess:()=>{V.success(r("store.toast.update")),f()},onError:x=>{V.error(x.message)}})});return e.jsx(i.Form,{form:l,children:e.jsxs(N,{onSubmit:I,className:"flex h-full flex-col overflow-hidden",children:[e.jsx(i.Body,{className:"overflow-y-auto",children:e.jsxs("div",{className:"flex flex-col gap-y-8",children:[e.jsx(o.Field,{control:l.control,name:"name",render:({field:a})=>e.jsxs(o.Item,{children:[e.jsx(o.Label,{children:r("fields.name")}),e.jsx(o.Control,{children:e.jsx(z,{placeholder:"ACME",...a})}),e.jsx(o.ErrorMessage,{})]})}),e.jsx(o.Field,{control:l.control,name:"default_currency_code",render:({field:{onChange:a,...s}})=>{var _;return e.jsxs(o.Item,{children:[e.jsx(o.Label,{children:r("store.defaultCurrency")}),e.jsx(o.Control,{children:e.jsxs(c,{dir:p,...s,onValueChange:a,children:[e.jsx(c.Trigger,{ref:s.ref,children:e.jsx(c.Value,{})}),e.jsx(c.Content,{children:(_=n.supported_currencies)==null?void 0:_.map(t=>e.jsx(c.Item,{value:t.currency_code,children:t.currency_code.toUpperCase()},t.currency_code))})]})})]})}}),e.jsx(o.Field,{control:l.control,name:"default_region_id",render:({field:a})=>e.jsxs(o.Item,{children:[e.jsx(o.Label,{children:r("store.defaultRegion")}),e.jsx(o.Control,{children:e.jsx(b,{...a,options:u.options,searchValue:u.searchValue,onSearchValueChange:u.onSearchValueChange,disabled:u.disabled})})]})}),e.jsx(o.Field,{control:l.control,name:"default_sales_channel_id",render:({field:a})=>e.jsxs(o.Item,{children:[e.jsx(o.Label,{children:r("store.defaultSalesChannel")}),e.jsx(o.Control,{children:e.jsx(b,{...a,options:m.options,searchValue:m.searchValue,onSearchValueChange:m.onSearchValueChange,disabled:m.disabled})})]})}),e.jsx(o.Field,{control:l.control,name:"default_location_id",render:({field:a})=>e.jsxs(o.Item,{children:[e.jsx(o.Label,{children:r("store.defaultLocation")}),e.jsx(o.Control,{children:e.jsx(b,{...a,options:h.options,searchValue:h.searchValue,onSearchValueChange:h.onSearchValueChange,disabled:h.disabled})})]})})]})}),e.jsx(i.Footer,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(i.Close,{asChild:!0,children:e.jsx(F,{size:"small",variant:"secondary",children:r("actions.cancel")})}),e.jsx(F,{size:"small",isLoading:E,type:"submit",children:r("actions.save")})]})})]})})},ee=()=>{const{t:n}=L(),{store:r,isPending:f,isError:p,error:l}=q();if(p)throw l;const j=!!r&&!f;return e.jsxs(i,{children:[e.jsx(i.Header,{children:e.jsx(w,{children:n("store.edit.header")})}),j&&e.jsx(B,{store:r})]})};export{ee as Component};
