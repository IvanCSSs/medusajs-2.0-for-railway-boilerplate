import{u as Yn}from"./chunk-DZWH2RV6-B7cI8-p8.js";import{eN as qn,f5 as Ie,u as ve,y as We,r as T,j as s,B as Wn,v as H,ap as wt,a$ as Me,bd as Ee,I as Fe,eR as Ye,q as xe,f6 as be,am as St,a_ as Xn}from"./index-S35l5lon.js";import{R as ye,T as Ot,P as _e,C as je,A as Qn}from"./index-BqPH3RWs.js";import{R as Zn,I as kn,a as es}from"./index-haGLTuDn.js";import{D as yt}from"./date-picker-CzxuXAvc.js";var Re={exports:{}};Re.exports;(function(r,o){var i=200,_="__lodash_hash_undefined__",p=1,g=2,j=9007199254740991,h="[object Arguments]",C="[object Array]",D="[object AsyncFunction]",u="[object Boolean]",x="[object Date]",O="[object Error]",m="[object Function]",l="[object GeneratorFunction]",f="[object Map]",w="[object Number]",v="[object Null]",S="[object Object]",L="[object Promise]",G="[object Proxy]",W="[object RegExp]",J="[object Set]",K="[object String]",X="[object Symbol]",ae="[object Undefined]",y="[object WeakMap]",z="[object ArrayBuffer]",E="[object DataView]",b="[object Float32Array]",c="[object Float64Array]",V="[object Int8Array]",ee="[object Int16Array]",re="[object Int32Array]",Nt="[object Uint8Array]",At="[object Uint8ClampedArray]",Pt="[object Uint16Array]",Dt="[object Uint32Array]",It=/[\\^$.*+?()[\]{}|]/g,Et=/^\[object .+?Constructor\]$/,Ft=/^(?:0|[1-9]\d*)$/,N={};N[b]=N[c]=N[V]=N[ee]=N[re]=N[Nt]=N[At]=N[Pt]=N[Dt]=!0,N[h]=N[C]=N[z]=N[u]=N[E]=N[x]=N[O]=N[m]=N[f]=N[w]=N[S]=N[W]=N[J]=N[K]=N[y]=!1;var Xe=typeof Ie=="object"&&Ie&&Ie.Object===Object&&Ie,Mt=typeof self=="object"&&self&&self.Object===Object&&self,Q=Xe||Mt||Function("return this")(),Qe=o&&!o.nodeType&&o,Ze=Qe&&!0&&r&&!r.nodeType&&r,ke=Ze&&Ze.exports===Qe,Ve=ke&&Xe.process,et=function(){try{return Ve&&Ve.binding&&Ve.binding("util")}catch{}}(),tt=et&&et.isTypedArray;function Rt(e,t){for(var n=-1,a=e==null?0:e.length,A=0,d=[];++n<a;){var I=e[n];t(I,n,e)&&(d[A++]=I)}return d}function Lt(e,t){for(var n=-1,a=t.length,A=e.length;++n<a;)e[A+n]=t[n];return e}function zt(e,t){for(var n=-1,a=e==null?0:e.length;++n<a;)if(t(e[n],n,e))return!0;return!1}function Vt(e,t){for(var n=-1,a=Array(e);++n<e;)a[n]=t(n);return a}function $t(e){return function(t){return e(t)}}function Ht(e,t){return e.has(t)}function Bt(e,t){return e==null?void 0:e[t]}function Ut(e){var t=-1,n=Array(e.size);return e.forEach(function(a,A){n[++t]=[A,a]}),n}function Gt(e,t){return function(n){return e(t(n))}}function Jt(e){var t=-1,n=Array(e.size);return e.forEach(function(a){n[++t]=a}),n}var Kt=Array.prototype,Yt=Function.prototype,Se=Object.prototype,$e=Q["__core-js_shared__"],nt=Yt.toString,q=Se.hasOwnProperty,st=function(){var e=/[^.]+$/.exec($e&&$e.keys&&$e.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),at=Se.toString,qt=RegExp("^"+nt.call(q).replace(It,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),rt=ke?Q.Buffer:void 0,Oe=Q.Symbol,it=Q.Uint8Array,lt=Se.propertyIsEnumerable,Wt=Kt.splice,ie=Oe?Oe.toStringTag:void 0,ot=Object.getOwnPropertySymbols,Xt=rt?rt.isBuffer:void 0,Qt=Gt(Object.keys,Object),He=de(Q,"DataView"),pe=de(Q,"Map"),Be=de(Q,"Promise"),Ue=de(Q,"Set"),Ge=de(Q,"WeakMap"),ge=de(Object,"create"),Zt=ue(He),kt=ue(pe),en=ue(Be),tn=ue(Ue),nn=ue(Ge),ut=Oe?Oe.prototype:void 0,Je=ut?ut.valueOf:void 0;function le(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var a=e[t];this.set(a[0],a[1])}}function sn(){this.__data__=ge?ge(null):{},this.size=0}function an(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function rn(e){var t=this.__data__;if(ge){var n=t[e];return n===_?void 0:n}return q.call(t,e)?t[e]:void 0}function ln(e){var t=this.__data__;return ge?t[e]!==void 0:q.call(t,e)}function on(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ge&&t===void 0?_:t,this}le.prototype.clear=sn,le.prototype.delete=an,le.prototype.get=rn,le.prototype.has=ln,le.prototype.set=on;function Z(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var a=e[t];this.set(a[0],a[1])}}function un(){this.__data__=[],this.size=0}function cn(e){var t=this.__data__,n=Ce(t,e);if(n<0)return!1;var a=t.length-1;return n==a?t.pop():Wt.call(t,n,1),--this.size,!0}function dn(e){var t=this.__data__,n=Ce(t,e);return n<0?void 0:t[n][1]}function fn(e){return Ce(this.__data__,e)>-1}function pn(e,t){var n=this.__data__,a=Ce(n,e);return a<0?(++this.size,n.push([e,t])):n[a][1]=t,this}Z.prototype.clear=un,Z.prototype.delete=cn,Z.prototype.get=dn,Z.prototype.has=fn,Z.prototype.set=pn;function oe(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var a=e[t];this.set(a[0],a[1])}}function gn(){this.size=0,this.__data__={hash:new le,map:new(pe||Z),string:new le}}function hn(e){var t=Ne(this,e).delete(e);return this.size-=t?1:0,t}function mn(e){return Ne(this,e).get(e)}function bn(e){return Ne(this,e).has(e)}function xn(e,t){var n=Ne(this,e),a=n.size;return n.set(e,t),this.size+=n.size==a?0:1,this}oe.prototype.clear=gn,oe.prototype.delete=hn,oe.prototype.get=mn,oe.prototype.has=bn,oe.prototype.set=xn;function Te(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new oe;++t<n;)this.add(e[t])}function vn(e){return this.__data__.set(e,_),this}function yn(e){return this.__data__.has(e)}Te.prototype.add=Te.prototype.push=vn,Te.prototype.has=yn;function te(e){var t=this.__data__=new Z(e);this.size=t.size}function _n(){this.__data__=new Z,this.size=0}function jn(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function wn(e){return this.__data__.get(e)}function Sn(e){return this.__data__.has(e)}function On(e,t){var n=this.__data__;if(n instanceof Z){var a=n.__data__;if(!pe||a.length<i-1)return a.push([e,t]),this.size=++n.size,this;n=this.__data__=new oe(a)}return n.set(e,t),this.size=n.size,this}te.prototype.clear=_n,te.prototype.delete=jn,te.prototype.get=wn,te.prototype.has=Sn,te.prototype.set=On;function Tn(e,t){var n=Ae(e),a=!n&&Hn(e),A=!n&&!a&&Ke(e),d=!n&&!a&&!A&&xt(e),I=n||a||A||d,F=I?Vt(e.length,String):[],M=F.length;for(var P in e)q.call(e,P)&&!(I&&(P=="length"||A&&(P=="offset"||P=="parent")||d&&(P=="buffer"||P=="byteLength"||P=="byteOffset")||Rn(P,M)))&&F.push(P);return F}function Ce(e,t){for(var n=e.length;n--;)if(gt(e[n][0],t))return n;return-1}function Cn(e,t,n){var a=t(e);return Ae(e)?a:Lt(a,n(e))}function he(e){return e==null?e===void 0?ae:v:ie&&ie in Object(e)?Fn(e):$n(e)}function ct(e){return me(e)&&he(e)==h}function dt(e,t,n,a,A){return e===t?!0:e==null||t==null||!me(e)&&!me(t)?e!==e&&t!==t:Nn(e,t,n,a,dt,A)}function Nn(e,t,n,a,A,d){var I=Ae(e),F=Ae(t),M=I?C:ne(e),P=F?C:ne(t);M=M==h?S:M,P=P==h?S:P;var $=M==S,Y=P==S,R=M==P;if(R&&Ke(e)){if(!Ke(t))return!1;I=!0,$=!1}if(R&&!$)return d||(d=new te),I||xt(e)?ft(e,t,n,a,A,d):In(e,t,M,n,a,A,d);if(!(n&p)){var B=$&&q.call(e,"__wrapped__"),U=Y&&q.call(t,"__wrapped__");if(B||U){var se=B?e.value():e,k=U?t.value():t;return d||(d=new te),A(se,k,n,a,d)}}return R?(d||(d=new te),En(e,t,n,a,A,d)):!1}function An(e){if(!bt(e)||zn(e))return!1;var t=ht(e)?qt:Et;return t.test(ue(e))}function Pn(e){return me(e)&&mt(e.length)&&!!N[he(e)]}function Dn(e){if(!Vn(e))return Qt(e);var t=[];for(var n in Object(e))q.call(e,n)&&n!="constructor"&&t.push(n);return t}function ft(e,t,n,a,A,d){var I=n&p,F=e.length,M=t.length;if(F!=M&&!(I&&M>F))return!1;var P=d.get(e);if(P&&d.get(t))return P==t;var $=-1,Y=!0,R=n&g?new Te:void 0;for(d.set(e,t),d.set(t,e);++$<F;){var B=e[$],U=t[$];if(a)var se=I?a(U,B,$,t,e,d):a(B,U,$,e,t,d);if(se!==void 0){if(se)continue;Y=!1;break}if(R){if(!zt(t,function(k,ce){if(!Ht(R,ce)&&(B===k||A(B,k,n,a,d)))return R.push(ce)})){Y=!1;break}}else if(!(B===U||A(B,U,n,a,d))){Y=!1;break}}return d.delete(e),d.delete(t),Y}function In(e,t,n,a,A,d,I){switch(n){case E:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case z:return!(e.byteLength!=t.byteLength||!d(new it(e),new it(t)));case u:case x:case w:return gt(+e,+t);case O:return e.name==t.name&&e.message==t.message;case W:case K:return e==t+"";case f:var F=Ut;case J:var M=a&p;if(F||(F=Jt),e.size!=t.size&&!M)return!1;var P=I.get(e);if(P)return P==t;a|=g,I.set(e,t);var $=ft(F(e),F(t),a,A,d,I);return I.delete(e),$;case X:if(Je)return Je.call(e)==Je.call(t)}return!1}function En(e,t,n,a,A,d){var I=n&p,F=pt(e),M=F.length,P=pt(t),$=P.length;if(M!=$&&!I)return!1;for(var Y=M;Y--;){var R=F[Y];if(!(I?R in t:q.call(t,R)))return!1}var B=d.get(e);if(B&&d.get(t))return B==t;var U=!0;d.set(e,t),d.set(t,e);for(var se=I;++Y<M;){R=F[Y];var k=e[R],ce=t[R];if(a)var vt=I?a(ce,k,R,t,e,d):a(k,ce,R,e,t,d);if(!(vt===void 0?k===ce||A(k,ce,n,a,d):vt)){U=!1;break}se||(se=R=="constructor")}if(U&&!se){var Pe=e.constructor,De=t.constructor;Pe!=De&&"constructor"in e&&"constructor"in t&&!(typeof Pe=="function"&&Pe instanceof Pe&&typeof De=="function"&&De instanceof De)&&(U=!1)}return d.delete(e),d.delete(t),U}function pt(e){return Cn(e,Gn,Mn)}function Ne(e,t){var n=e.__data__;return Ln(t)?n[typeof t=="string"?"string":"hash"]:n.map}function de(e,t){var n=Bt(e,t);return An(n)?n:void 0}function Fn(e){var t=q.call(e,ie),n=e[ie];try{e[ie]=void 0;var a=!0}catch{}var A=at.call(e);return a&&(t?e[ie]=n:delete e[ie]),A}var Mn=ot?function(e){return e==null?[]:(e=Object(e),Rt(ot(e),function(t){return lt.call(e,t)}))}:Jn,ne=he;(He&&ne(new He(new ArrayBuffer(1)))!=E||pe&&ne(new pe)!=f||Be&&ne(Be.resolve())!=L||Ue&&ne(new Ue)!=J||Ge&&ne(new Ge)!=y)&&(ne=function(e){var t=he(e),n=t==S?e.constructor:void 0,a=n?ue(n):"";if(a)switch(a){case Zt:return E;case kt:return f;case en:return L;case tn:return J;case nn:return y}return t});function Rn(e,t){return t=t??j,!!t&&(typeof e=="number"||Ft.test(e))&&e>-1&&e%1==0&&e<t}function Ln(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function zn(e){return!!st&&st in e}function Vn(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||Se;return e===n}function $n(e){return at.call(e)}function ue(e){if(e!=null){try{return nt.call(e)}catch{}try{return e+""}catch{}}return""}function gt(e,t){return e===t||e!==e&&t!==t}var Hn=ct(function(){return arguments}())?ct:function(e){return me(e)&&q.call(e,"callee")&&!lt.call(e,"callee")},Ae=Array.isArray;function Bn(e){return e!=null&&mt(e.length)&&!ht(e)}var Ke=Xt||Kn;function Un(e,t){return dt(e,t)}function ht(e){if(!bt(e))return!1;var t=he(e);return t==m||t==l||t==D||t==G}function mt(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=j}function bt(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function me(e){return e!=null&&typeof e=="object"}var xt=tt?$t(tt):Pn;function Gn(e){return Bn(e)?Tn(e):Dn(e)}function Jn(){return[]}function Kn(){return!1}r.exports=Un})(Re,Re.exports);var ts=Re.exports;const ns=qn(ts);var Tt=T.createContext(null),we=()=>{const r=T.useContext(Tt);if(!r)throw new Error("useDataTableFacetedFilterContext must be used within a DataTableFacetedFilter");return r},Le=({param:r,prefix:o,multiple:i=!1})=>{const[_,p]=We(),g=o?`${o}_${r}`:r,j=o?`${o}_offset`:"offset";return{add:u=>{p(x=>{const O=new URLSearchParams(x);return i?(()=>{var w;const f=((w=O.get(g))==null?void 0:w.split(","))||[];f.includes(u)||(f.push(u),O.set(g,f.join(",")))})():(()=>{O.set(g,u)})(),O.delete(j),O})},delete:u=>{const x=m=>{var w;const l=((w=m.get(g))==null?void 0:w.split(","))||[],f=l.indexOf(u||"");f>-1&&(l.splice(f,1),m.set(g,l.join(",")))},O=m=>{m.delete(g)};p(m=>(u?(i?x(m):O(m),m.get(g)||m.delete(g)):m.delete(g),m.delete(j),m))},get:()=>{var u;return((u=_.get(g))==null?void 0:u.split(",").filter(Boolean))||[]}}},ss=({hadPreviousValue:r,label:o,value:i,readonly:_,hasOperator:p,onRemove:g})=>{const{t:j}=ve(),h=C=>{C.stopPropagation(),g()};return s.jsxs("div",{className:"bg-ui-bg-field transition-fg shadow-borders-base text-ui-fg-subtle flex cursor-default select-none items-stretch overflow-hidden rounded-md",children:[!r&&s.jsx(Qn,{}),s.jsx("div",{className:H("flex items-center justify-center whitespace-nowrap px-2 py-1",{"border-r":!!(i||r)}),children:s.jsx(xe,{size:"small",weight:"plus",leading:"compact",children:o})}),s.jsxs("div",{className:"flex w-full items-center overflow-hidden",children:[p&&!!(i||r)&&s.jsx("div",{className:"border-r p-1 px-2",children:s.jsx(xe,{size:"small",weight:"plus",leading:"compact",className:"text-ui-fg-muted",children:j("general.is")})}),!!(i||r)&&s.jsx(Ot,{asChild:!0,className:H("flex-1 cursor-pointer overflow-hidden border-r p-1 px-2",{"hover:bg-ui-bg-field-hover":!_,"data-[state=open]:bg-ui-bg-field-hover":!_}),children:s.jsx(xe,{size:"small",leading:"compact",weight:"plus",className:"truncate text-nowrap",children:i||"Â "})})]}),!_&&!!(i||r)&&s.jsx("button",{onClick:h,className:H("text-ui-fg-muted transition-fg flex items-center justify-center p-1","hover:bg-ui-bg-subtle-hover","active:bg-ui-bg-subtle-pressed active:text-ui-fg-base"),children:s.jsx(St,{})})]})},ze=ss,as=({filter:r,prefix:o,readonly:i,openOnMount:_})=>{const[p,g]=T.useState(_),[j,h]=T.useState(!1),{getFullDate:C}=Yn(),{key:D,label:u}=r,{removeFilter:x}=we(),O=Le({param:D,prefix:o}),m=rs(),l=c=>{O.add(JSON.stringify(c)),h(!1)},f=()=>{O.delete(),h(c=>!c)},w=O.get(),v=is(w),S=_t(v,"$gte"),L=_t(v,"$lte"),G=(c,V)=>{const ee=V==="start"?"$gte":"$lte";let re=c;ee==="$lte"&&c&&(re=new Date(c.getTime()),re.setHours(23,59,59,999)),O.add(JSON.stringify({...v||{},[ee]:re==null?void 0:re.toISOString()}))},W=()=>{const c=m.find(V=>ns(V.value,v));return c==null?void 0:c.label},J=c=>c?C({date:c}):void 0,K=()=>[S,L].map(J).filter(Boolean).join(" - "),X=W()||K(),[ae,y]=T.useState(X),z=()=>{O.delete(),x(D)};let E=null;const b=c=>{g(c),y(X),E&&clearTimeout(E),!c&&!w.length&&(E=setTimeout(()=>{x(D)},200))};return s.jsxs(ye,{modal:!0,open:p,onOpenChange:b,children:[s.jsx(ze,{hadPreviousValue:!!ae,label:u,value:X,onRemove:z,readonly:i}),!i&&s.jsx(_e,{children:s.jsxs(je,{"data-name":"date_filter_content",align:"start",sideOffset:8,collisionPadding:24,className:H("bg-ui-bg-base text-ui-fg-base shadow-elevation-flyout h-full max-h-[var(--radix-popper-available-height)] w-[300px] overflow-auto rounded-lg"),onInteractOutside:c=>{var V;c.target instanceof HTMLElement&&((V=c.target.attributes.getNamedItem("data-name"))==null?void 0:V.value)==="filters_menu_content"&&c.preventDefault()},children:[s.jsxs("ul",{className:"w-full p-1",children:[m.map(c=>{const V=O.get().includes(JSON.stringify(c.value));return s.jsx("li",{children:s.jsxs("button",{className:"bg-ui-bg-base hover:bg-ui-bg-base-hover focus-visible:bg-ui-bg-base-pressed text-ui-fg-base data-[disabled]:text-ui-fg-disabled txt-compact-small relative flex w-full cursor-pointer select-none items-center rounded-md px-2 py-1.5 outline-none transition-colors data-[disabled]:pointer-events-none",type:"button",onClick:()=>{l(c.value)},children:[s.jsx("div",{className:H("transition-fg flex h-5 w-5 items-center justify-center",{"[&_svg]:invisible":!V}),children:s.jsx(Me,{})}),c.label]})},c.label)}),s.jsx("li",{children:s.jsxs("button",{className:"bg-ui-bg-base hover:bg-ui-bg-base-hover focus-visible:bg-ui-bg-base-pressed text-ui-fg-base data-[disabled]:text-ui-fg-disabled txt-compact-small relative flex w-full cursor-pointer select-none items-center rounded-md px-2 py-1.5 outline-none transition-colors data-[disabled]:pointer-events-none",type:"button",onClick:f,children:[s.jsx("div",{className:H("transition-fg flex h-5 w-5 items-center justify-center",{"[&_svg]:invisible":!j}),children:s.jsx(Me,{})}),Ye("filters.date.custom")]})})]}),j&&s.jsxs("div",{className:"border-t px-1 pb-3 pt-1",children:[s.jsxs("div",{children:[s.jsx("div",{className:"px-2 py-1",children:s.jsx(xe,{size:"xsmall",leading:"compact",weight:"plus",children:Ye("filters.date.from")})}),s.jsx("div",{className:"px-2 py-1",children:s.jsx(yt,{modal:!0,maxValue:L,value:S,onChange:c=>G(c,"start")})})]}),s.jsxs("div",{children:[s.jsx("div",{className:"px-2 py-1",children:s.jsx(xe,{size:"xsmall",leading:"compact",weight:"plus",children:Ye("filters.date.to")})}),s.jsx("div",{className:"px-2 py-1",children:s.jsx(yt,{modal:!0,minValue:S,value:L||void 0,onChange:c=>{G(c,"end")}})})]})]})]})})]})},fe=new Date;fe.setHours(0,0,0,0);var rs=()=>{const{t:r}=ve();return T.useMemo(()=>[{label:r("filters.date.today"),value:{$gte:fe.toISOString()}},{label:r("filters.date.lastSevenDays"),value:{$gte:new Date(fe.getTime()-7*24*60*60*1e3).toISOString()}},{label:r("filters.date.lastThirtyDays"),value:{$gte:new Date(fe.getTime()-30*24*60*60*1e3).toISOString()}},{label:r("filters.date.lastNinetyDays"),value:{$gte:new Date(fe.getTime()-90*24*60*60*1e3).toISOString()}},{label:r("filters.date.lastTwelveMonths"),value:{$gte:new Date(fe.getTime()-365*24*60*60*1e3).toISOString()}}],[r])},is=r=>r!=null&&r.length?JSON.parse(r.join(",")):null,_t=(r,o)=>{if(!(r!=null&&r[o]))return;const i=new Date(r[o]);return o==="$lte"&&i.setHours(0,0,0,0),i},ls=({filter:r,prefix:o,readonly:i,openOnMount:_})=>{const{t:p}=ve(),[g,j]=T.useState(_),{key:h,label:C}=r,{removeFilter:D}=we(),u=Le({param:h,prefix:o,multiple:!1}),x=u.get(),[O,m]=T.useState(x),[l,f]=T.useState(os(x)),w=T.useCallback(wt((y,z)=>{const E=y.target.value,b=JSON.parse((x==null?void 0:x.join(","))||"{}"),c=!isNaN(Number(b)),V=ee=>{if(!E&&c){u.delete();return}if(b&&!E){delete b[ee],u.add(JSON.stringify(b));return}if(!b){u.add(JSON.stringify({[ee]:E}));return}u.add(JSON.stringify({...b,[ee]:E}))};switch(z){case"eq":E?u.add(E):u.delete();break;case"lt":case"gt":V(z);break}},500),[u,x]);T.useEffect(()=>()=>{w.cancel()},[w]);let v=null;const S=y=>{j(y),m(x),v&&clearTimeout(v),!y&&!x.length&&(v=setTimeout(()=>{D(h)},200))},L=()=>{u.delete(),D(h)},G=[{operator:"exact",label:p("filters.compare.exact")},{operator:"range",label:p("filters.compare.range")}],W=`${h}-gt`,J=`${h}-lt`,K=h,X=jt(x,p),ae=jt(O,p);return s.jsxs(ye,{modal:!0,open:g,onOpenChange:S,children:[s.jsx(ze,{hasOperator:!0,hadPreviousValue:!!ae,label:C,value:X,onRemove:L,readonly:i}),!i&&s.jsx(_e,{children:s.jsxs(je,{"data-name":"number_filter_content",align:"start",sideOffset:8,collisionPadding:24,className:H("bg-ui-bg-base text-ui-fg-base shadow-elevation-flyout max-h-[var(--radix-popper-available-height)] w-[300px] divide-y overflow-y-auto rounded-lg outline-none"),onInteractOutside:y=>{var z;y.target instanceof HTMLElement&&((z=y.target.attributes.getNamedItem("data-name"))==null?void 0:z.value)==="filters_menu_content"&&y.preventDefault()},children:[s.jsx("div",{className:"p-1",children:s.jsx(Zn,{value:l,onValueChange:y=>f(y),className:"flex flex-col items-start",orientation:"vertical",autoFocus:!0,children:G.map(y=>s.jsxs(kn,{value:y.operator,className:"txt-compact-small hover:bg-ui-bg-base-hover focus-visible:bg-ui-bg-base-hover active:bg-ui-bg-base-pressed transition-fg grid w-full grid-cols-[20px_1fr] gap-2 rounded-[4px] px-2 py-1.5 text-left outline-none",children:[s.jsx("div",{className:"size-5",children:s.jsx(es,{children:s.jsx(Me,{})})}),s.jsx("span",{className:"w-full",children:y.label})]},y.operator))})}),s.jsx("div",{children:l==="range"?s.jsxs("div",{className:"px-1 pb-3 pt-1",children:[s.jsx("div",{className:"px-2 py-1.5",children:s.jsx(Ee,{size:"xsmall",weight:"plus",htmlFor:W,children:p("filters.compare.greaterThan")})}),s.jsx("div",{className:"px-2 py-0.5",children:s.jsx(Fe,{name:W,size:"small",type:"number",defaultValue:qe(x,"gt"),onChange:y=>w(y,"gt")})}),s.jsx("div",{className:"px-2 py-1.5",children:s.jsx(Ee,{size:"xsmall",weight:"plus",htmlFor:J,children:p("filters.compare.lessThan")})}),s.jsx("div",{className:"px-2 py-0.5",children:s.jsx(Fe,{name:J,size:"small",type:"number",defaultValue:qe(x,"lt"),onChange:y=>w(y,"lt")})})]},"range"):s.jsxs("div",{className:"px-1 pb-3 pt-1",children:[s.jsx("div",{className:"px-2 py-1.5",children:s.jsx(Ee,{size:"xsmall",weight:"plus",htmlFor:K,children:C})}),s.jsx("div",{className:"px-2 py-0.5",children:s.jsx(Fe,{name:K,size:"small",type:"number",defaultValue:qe(x,"eq"),onChange:y=>w(y,"eq")})})]},"exact")})]})})]})},jt=(r,o)=>{const i=JSON.parse((r==null?void 0:r.join(","))||"{}");let _="";if(typeof i=="object"){const p=[];i.gt&&p.push(o("filters.compare.greaterThanLabel",{value:i.gt})),i.lt&&p.push(o("filters.compare.lessThanLabel",{value:i.lt})),_=p.join(` ${o("filters.compare.andLabel")} `)}return typeof i=="number"&&(_=i.toString()),_},Ct=r=>{if(!r)return;const o=r.join(",");if(o)return JSON.parse(o)},qe=(r,o)=>{const i=Ct(r);if(typeof i=="object")return i[o];if(typeof i=="number"&&o==="eq")return i},os=r=>typeof Ct(r)=="object"?"range":"exact",us=({filter:r,prefix:o,readonly:i,multiple:_,searchable:p,options:g,openOnMount:j})=>{const[h,C]=T.useState(j),[D,u]=T.useState(""),[x,O]=T.useState(null),{t:m}=ve(),{removeFilter:l}=we(),{key:f,label:w}=r,v=Le({param:f,prefix:o,multiple:_}),S=v.get(),L=S.map(b=>{var c;return(c=g.find(V=>V.value===b))==null?void 0:c.label}).filter(Boolean),[G,W]=T.useState(L),J=()=>{v.delete(),l(f)};let K=null;const X=b=>{C(b),W(L),K&&clearTimeout(K),!b&&!S.length&&(K=setTimeout(()=>{l(f)},200))},ae=()=>{u(""),x&&x.focus()},y=b=>{v.get().includes(String(b))?v.delete(String(b)):v.add(String(b))},z=L?Array.isArray(L)?L:[L]:null,E=G?Array.isArray(G)?G:[G]:null;return s.jsxs(ye,{modal:!0,open:h,onOpenChange:X,children:[s.jsx(ze,{hasOperator:!0,hadPreviousValue:!!(E!=null&&E.length),readonly:i,label:w,value:z==null?void 0:z.join(", "),onRemove:J}),!i&&s.jsx(_e,{children:s.jsx(je,{hideWhenDetached:!0,align:"start",sideOffset:8,collisionPadding:8,className:H("bg-ui-bg-base text-ui-fg-base shadow-elevation-flyout z-[1] h-full max-h-[200px] w-[300px] overflow-hidden rounded-lg outline-none"),onInteractOutside:b=>{var c;b.target instanceof HTMLElement&&((c=b.target.attributes.getNamedItem("data-name"))==null?void 0:c.value)==="filters_menu_content"&&(b.preventDefault(),b.stopPropagation())},children:s.jsxs(be,{className:"h-full",children:[p&&s.jsx("div",{className:"border-b p-1",children:s.jsxs("div",{className:"grid grid-cols-[1fr_20px] gap-x-2 rounded-md px-2 py-1",children:[s.jsx(be.Input,{ref:O,value:D,onValueChange:u,className:"txt-compact-small placeholder:text-ui-fg-muted bg-transparent outline-none",placeholder:"Search"}),s.jsx("div",{className:"flex h-5 w-5 items-center justify-center",children:s.jsx("button",{disabled:!D,onClick:ae,className:H("transition-fg text-ui-fg-muted focus-visible:bg-ui-bg-base-pressed rounded-md outline-none",{invisible:!D}),children:s.jsx(St,{})})})]})}),s.jsx(be.Empty,{className:"txt-compact-small flex items-center justify-center p-1",children:s.jsx("span",{className:"w-full px-2 py-1 text-center",children:m("general.noResultsTitle")})}),s.jsx(be.List,{className:"h-full max-h-[163px] min-h-[0] overflow-auto p-1 outline-none",children:g.map(b=>{const c=v.get().includes(String(b.value));return s.jsxs(be.Item,{className:"bg-ui-bg-base hover:bg-ui-bg-base-hover aria-selected:bg-ui-bg-base-pressed focus-visible:bg-ui-bg-base-pressed text-ui-fg-base data-[disabled]:text-ui-fg-disabled txt-compact-small relative flex cursor-pointer select-none items-center gap-x-2 rounded-md px-2 py-1.5 outline-none transition-colors data-[disabled]:pointer-events-none",value:b.label,onSelect:()=>{y(b.value)},children:[s.jsx("div",{className:H("transition-fg flex h-5 w-5 items-center justify-center",{"[&_svg]:invisible":!c}),children:_?s.jsx(Xn,{}):s.jsx(Me,{})}),b.label]},String(b.value))})})]})})})]})},cs=({filter:r,prefix:o,readonly:i,openOnMount:_})=>{const[p,g]=T.useState(_),{key:j,label:h}=r,{removeFilter:C}=we(),D=Le({param:j,prefix:o}),u=D.get(),[x,O]=T.useState(u==null?void 0:u[0]),m=T.useCallback(wt(v=>{const S=v.target.value;S?D.add(S):D.delete()},500),[D]);T.useEffect(()=>()=>{m.cancel()},[m]);let l=null;const f=v=>{g(v),O(u==null?void 0:u[0]),l&&clearTimeout(l),!v&&!u.length&&(l=setTimeout(()=>{C(j)},200))},w=()=>{D.delete(),C(j)};return s.jsxs(ye,{modal:!0,open:p,onOpenChange:f,children:[s.jsx(ze,{hasOperator:!0,hadPreviousValue:!!x,label:h,value:u==null?void 0:u[0],onRemove:w,readonly:i}),!i&&s.jsx(_e,{children:s.jsx(je,{hideWhenDetached:!0,align:"start",sideOffset:8,collisionPadding:8,className:H("bg-ui-bg-base text-ui-fg-base shadow-elevation-flyout z-[1] h-full max-h-[200px] w-[300px] overflow-hidden rounded-lg outline-none"),onInteractOutside:v=>{var S;v.target instanceof HTMLElement&&((S=v.target.attributes.getNamedItem("data-name"))==null?void 0:S.value)==="filters_menu_content"&&(v.preventDefault(),v.stopPropagation())},children:s.jsxs("div",{className:"px-1 pb-3 pt-1",children:[s.jsx("div",{className:"px-2 py-1.5",children:s.jsx(Ee,{size:"xsmall",weight:"plus",htmlFor:j,children:h})}),s.jsx("div",{className:"px-2 py-0.5",children:s.jsx(Fe,{name:j,size:"small",defaultValue:(u==null?void 0:u[0])||void 0,onChange:m})})]})})})]})},xs=({filters:r,readonly:o,prefix:i})=>{const{t:_}=ve(),[p]=We(),[g,j]=T.useState(!1),[h,C]=T.useState(fs({searchParams:p,filters:r,prefix:i})),D=r.filter(l=>!h.find(f=>f.key===l.key)),u=T.useRef(!0);T.useEffect(()=>{if(u.current){const l=new URLSearchParams(p);r.forEach(f=>{const w=i?`${i}_${f.key}`:f.key;l.get(w)&&!h.find(S=>S.key===f.key)&&(f.type==="select"?C(S=>[...S,{...f,multiple:f.multiple,options:f.options,openOnMount:!1}]):C(S=>[...S,{...f,openOnMount:!1}]))})}u.current=!1},[h,r,i,p]);const x=l=>{j(!1),C(f=>[...f,{...l,openOnMount:!0}])},O=T.useCallback(l=>{C(f=>f.filter(w=>w.key!==l))},[]),m=T.useCallback(()=>{C([])},[]);return s.jsx(Tt.Provider,{value:T.useMemo(()=>({removeFilter:O,removeAllFilters:m}),[m,O]),children:s.jsxs("div",{className:"max-w-2/3 flex flex-wrap items-center gap-2",children:[h.map(l=>{switch(l.type){case"select":return s.jsx(us,{filter:l,prefix:i,readonly:o,options:l.options,multiple:l.multiple,searchable:l.searchable,openOnMount:l.openOnMount},l.key);case"date":return s.jsx(as,{filter:l,prefix:i,readonly:o,openOnMount:l.openOnMount},l.key);case"string":return s.jsx(cs,{filter:l,prefix:i,readonly:o,openOnMount:l.openOnMount},l.key);case"number":return s.jsx(ls,{filter:l,prefix:i,readonly:o,openOnMount:l.openOnMount},l.key)}}),!o&&D.length>0&&s.jsxs(ye,{modal:!0,open:g,onOpenChange:j,children:[s.jsx(Ot,{asChild:!0,id:"filters_menu_trigger",children:s.jsx(Wn,{size:"small",variant:"secondary",children:_("filters.addFilter")})}),s.jsx(_e,{children:s.jsx(je,{className:H("bg-ui-bg-base text-ui-fg-base shadow-elevation-flyout z-[1] h-full max-h-[200px] w-[300px] overflow-auto rounded-lg p-1 outline-none"),"data-name":"filters_menu_content",align:"start",sideOffset:8,collisionPadding:8,onCloseAutoFocus:l=>{h.find(w=>w.openOnMount)&&l.preventDefault()},children:D.map(l=>s.jsx("div",{className:"bg-ui-bg-base hover:bg-ui-bg-base-hover focus-visible:bg-ui-bg-base-pressed text-ui-fg-base data-[disabled]:text-ui-fg-disabled txt-compact-small relative flex cursor-pointer select-none items-center rounded-md px-2 py-1.5 outline-none transition-colors data-[disabled]:pointer-events-none",role:"menuitem",onClick:()=>{x(l)},children:l.label},l.key))})})]}),!o&&h.length>0&&s.jsx(ds,{filters:r,prefix:i})]})})},ds=({filters:r,prefix:o})=>{const{removeAllFilters:i}=we(),[_,p]=We(),g=()=>{p(j=>{const h=new URLSearchParams(j);return r.forEach(C=>{h.delete(o?`${o}_${C.key}`:C.key)}),h}),i()};return s.jsx("button",{type:"button",onClick:g,className:H("text-ui-fg-muted transition-fg txt-compact-small-plus rounded-md px-2 py-1","hover:text-ui-fg-subtle","focus-visible:shadow-borders-focus"),children:"Clear all"})},fs=({searchParams:r,filters:o,prefix:i})=>{const _=new URLSearchParams(r),p=[];return o.forEach(g=>{const j=i?`${i}_${g.key}`:g.key;_.get(j)&&(g.type==="select"?p.push({...g,multiple:g.multiple,options:g.options,openOnMount:!1}):p.push({...g,openOnMount:!1}))}),p};export{xs as D,Le as u};
