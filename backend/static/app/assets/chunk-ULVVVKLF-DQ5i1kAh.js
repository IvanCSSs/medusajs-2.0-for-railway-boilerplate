import{u as J,D as X}from"./chunk-GU5PJRPM-CRBxyP7n.js";import{D as Y}from"./chunk-HQKGZADC-CFjwmGLF.js";import{N as Z,a as G}from"./chunk-EMIHDNB7-1UnYIHIF.js";import{y as _,r as x,j as e,ao as ee,v as p,u as V,L as te,ap as se,I as ae}from"./index-S35l5lon.js";import{u as le,g as oe,a as ne,b as re,f as U}from"./index-D8hIMFbh.js";import{T as P}from"./table-u7knMi01.js";import{C as D}from"./command-bar-D5PjKtE8.js";var ie=({placeholder:s,prefix:a,autofocus:i})=>{const{t:r}=V(),o=s||r("general.search"),d=J({param:"q",prefix:a,multiple:!1}),v=d.get(),n=x.useCallback(se(c=>{const C=c.target.value;C?d.add(C):d.delete()},500),[d]);return x.useEffect(()=>()=>{n.cancel()},[n]),e.jsx(ae,{autoComplete:"off",name:"q",type:"search",size:"small",autoFocus:i,defaultValue:(v==null?void 0:v[0])||void 0,onChange:n,placeholder:o})},ce=({search:s,orderBy:a,filters:i,prefix:r})=>(s||a||i||r)&&e.jsxs("div",{className:"flex items-start justify-between gap-x-4 px-6 py-4",children:[e.jsx("div",{className:"w-full max-w-[60%]",children:i&&i.length>0&&e.jsx(X,{filters:i,prefix:r})}),e.jsxs("div",{className:"flex shrink-0 items-center gap-x-2",children:[s&&e.jsx(ie,{prefix:r,autofocus:s==="autofocus"}),a&&e.jsx(Y,{keys:a,prefix:r})]})]}),de=({table:s,columns:a,pagination:i,navigateTo:r,commands:o,count:d=0,noResults:v=!1,noHeader:n=!1,layout:c="fit"})=>{const{t:C}=V(),[y,k]=x.useState(!1),S=x.useRef(null),m=a.find(t=>t.id==="select"),g=a.find(t=>t.id==="actions"),j=o&&o.length>0,u=s.getState().rowSelection,{pageIndex:R,pageSize:I}=s.getState().pagination,O=100/(a.length-(m?1:0)-(g?1:0)),E=t=>{t.currentTarget.scrollLeft>0?k(!0):k(!1)},F=async t=>{await t(u).then(()=>{s.resetRowSelection()})};return x.useEffect(()=>{var t;(t=S.current)==null||t.scroll({top:0,left:0})},[R]),e.jsxs("div",{className:p("flex w-full flex-col overflow-hidden",{"flex flex-1 flex-col":c==="fill"}),children:[e.jsx("div",{ref:S,onScroll:E,className:p("w-full",{"min-h-0 flex-grow overflow-auto":c==="fill","overflow-x-auto":c==="fit"}),children:v?e.jsx("div",{className:p({"border-b":c==="fit"}),children:e.jsx(G,{})}):e.jsxs(P,{className:"relative w-full",children:[!n&&e.jsx(P.Header,{className:"border-t-0",children:s.getHeaderGroups().map(t=>e.jsx(P.Row,{className:p({"relative border-b-0 [&_th:last-of-type]:w-[1%] [&_th:last-of-type]:whitespace-nowrap":g,"[&_th:first-of-type]:w-[1%] [&_th:first-of-type]:whitespace-nowrap":m}),children:t.headers.map((l,H)=>{const w=l.id==="actions",f=l.id==="select",h=w||f,T=t.headers.findIndex(L=>L.id!=="select"),N=T!==-1?l.id===t.headers[T].id:H===0,b=f||N;return e.jsx(P.HeaderCell,{"data-table-header-id":l.id,style:{width:h?void 0:`${O}%`},className:p({"bg-ui-bg-subtle sticky left-0 after:absolute after:inset-y-0 after:right-0 after:h-full after:w-px after:bg-transparent after:content-['']":b,"left-[68px]":b&&m&&!f,"after:bg-ui-border-base":y&&b&&!h}),children:U(l.column.columnDef.header,l.getContext())},l.id)})},t.id))}),e.jsx(P.Body,{className:"border-b-0",children:s.getRowModel().rows.map(t=>{const l=r?r(t):void 0,H=m&&!t.getCanSelect(),w=t.depth%2!==0,f=t.getVisibleCells();return e.jsx(P.Row,{"data-selected":t.getIsSelected(),className:p("transition-fg group/row group relative [&_td:last-of-type]:w-[1%] [&_td:last-of-type]:whitespace-nowrap","has-[[data-row-link]:focus-visible]:bg-ui-bg-base-hover",{"bg-ui-bg-subtle hover:bg-ui-bg-subtle-hover":w,"cursor-pointer":!!l,"bg-ui-bg-highlight hover:bg-ui-bg-highlight-hover":t.getIsSelected(),"!bg-ui-bg-disabled !hover:bg-ui-bg-disabled":H}),children:f.map((h,T)=>{const N=t.getVisibleCells(),b=h.column.id==="select",L=N.findIndex(W=>W.column.id!=="select"),A=L!==-1?h.column.id===N[L].column.id:T===0,z=b||A,$=t.depth>0&&A?t.depth*14+24:void 0,Q=z&&m&&!b,B=U(h.column.columnDef.cell,h.getContext()),q=A&&!!l,K=!!l&&!b;return e.jsx(P.Cell,{className:p({"!ps-0 !pe-0":K,"bg-ui-bg-base group-data-[selected=true]/row:bg-ui-bg-highlight group-data-[selected=true]/row:group-hover/row:bg-ui-bg-highlight-hover group-hover/row:bg-ui-bg-base-hover transition-fg group-has-[[data-row-link]:focus-visible]:bg-ui-bg-base-hover sticky left-0 after:absolute after:inset-y-0 after:right-0 after:h-full after:w-px after:bg-transparent after:content-['']":z,"bg-ui-bg-subtle group-hover/row:bg-ui-bg-subtle-hover":w&&z,"left-[68px]":Q,"after:bg-ui-border-base":y&&z&&!b,"!bg-ui-bg-disabled !hover:bg-ui-bg-disabled":H}),style:{paddingLeft:$?`${$}px`:void 0},children:K?e.jsx(te,{to:l,className:"size-full outline-none","data-row-link":!0,tabIndex:q?0:-1,children:e.jsx("div",{className:p("flex size-full items-center pe-6",{"ps-6":q&&!Q}),children:B})}):B},h.id)})},t.id)})})]})}),i&&e.jsx("div",{className:p({"border-t":c==="fill"}),children:e.jsx(ge,{canNextPage:s.getCanNextPage(),canPreviousPage:s.getCanPreviousPage(),nextPage:s.nextPage,previousPage:s.previousPage,count:d,pageIndex:R,pageCount:s.getPageCount(),pageSize:I})}),j&&e.jsx(D,{open:!!Object.keys(u).length,children:e.jsxs(D.Bar,{children:[e.jsx(D.Value,{children:C("general.countSelected",{count:Object.keys(u).length})}),e.jsx(D.Seperator,{}),o==null?void 0:o.map((t,l)=>e.jsxs(x.Fragment,{children:[e.jsx(D.Command,{label:t.label,shortcut:t.shortcut,action:()=>F(t.action)}),l<o.length-1&&e.jsx(D.Seperator,{})]},l))]})})]})},ge=s=>{const{t:a}=V(),i={of:a("general.of"),results:a("general.results"),pages:a("general.pages"),prev:a("general.prev"),next:a("general.next")};return e.jsx(P.Pagination,{className:"flex-shrink-0",...s,translations:i})},ue=x.memo(ce),je=({table:s,columns:a,pagination:i,navigateTo:r,commands:o,count:d=0,search:v=!1,orderBy:n,filters:c,prefix:C,queryObject:y={},pageSize:k,isLoading:S=!1,noHeader:m=!1,layout:g="fit",noRecords:j={}})=>{if(S)return e.jsx(ee,{layout:g,rowCount:k,search:!!v,filters:!!(c!=null&&c.length),orderBy:!!(n!=null&&n.length),pagination:!!i});const u=Object.values(y).filter(M=>!!M).length===0,R=!S&&d===0&&!u;return!S&&d===0&&u?e.jsx(Z,{className:p({"flex h-full flex-col overflow-hidden":g==="fill"}),...j}):e.jsxs("div",{className:p("divide-y",{"flex h-full flex-col overflow-hidden":g==="fill"}),children:[e.jsx(ue,{search:v,orderBy:n,filters:c,prefix:C}),e.jsx(de,{table:s,count:d,columns:a,pagination:!0,navigateTo:r,commands:o,noResults:R,noHeader:m,layout:g})]})},we=({data:s=[],columns:a,count:i=0,pageSize:r=20,enablePagination:o=!0,enableRowSelection:d=!1,enableExpandableRows:v=!1,rowSelection:n,getSubRows:c,getRowId:C,meta:y,prefix:k})=>{const[S,m]=_(),g=`${k?`${k}_`:""}offset`,j=S.get(g),[{pageIndex:u,pageSize:R},I]=x.useState({pageIndex:j?Math.ceil(Number(j)/r):0,pageSize:r}),M=x.useMemo(()=>({pageIndex:u,pageSize:R}),[u,R]),[O,E]=x.useState({}),F=(n==null?void 0:n.state)??O,t=(n==null?void 0:n.updater)??E;x.useEffect(()=>{if(!o)return;const w=j?Math.ceil(Number(j)/r):0;w!==u&&I(f=>({...f,pageIndex:w}))},[j,o,r,u]);const l=w=>{const f=w(M),{pageIndex:h,pageSize:T}=f;return m(N=>{if(!h)return N.delete(g),N;const b=new URLSearchParams(N);return b.set(g,String(h*T)),b}),I(f),f};return{table:le({data:s,columns:a,state:{rowSelection:F,pagination:o?M:void 0},pageCount:Math.ceil((i??0)/R),enableRowSelection:d,getRowId:C,getSubRows:c,onRowSelectionChange:d?t:void 0,onPaginationChange:o?l:void 0,getCoreRowModel:re(),getPaginationRowModel:o?ne():void 0,getExpandedRowModel:v?oe():void 0,manualPagination:o?!0:void 0,meta:y})}};export{ie as D,je as _,we as u};
