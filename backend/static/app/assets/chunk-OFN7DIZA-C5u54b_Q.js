import{C as ie,a as oe,b as ne,c as le,d as H,e as ce,f as ue,S as de}from"./combobox-provider-CcO6EPfN.js";import{r as s,u as be,aZ as me,j as t,v as c,am as $,q as p,a_ as xe,a$ as fe}from"./index-S35l5lon.js";import{T as pe}from"./triangles-mini-CX2619vl.js";import{P as ge}from"./plus-mini-B5zW_eay.js";function he(n){return s.forwardRef(n)}var B=8,L=28,ve=({value:n,onChange:S,searchValue:g,onSearchValueChange:T,options:o,className:F,placeholder:G,fetchNextPage:x,isFetchingNextPage:h,onCreateOption:v,noResultsPlaceholder:M,allowClear:X,forceHideInput:j,...Z},q)=>{var W;const[u,R]=s.useState(!1),[J,K]=s.useTransition(),{t:y}=be(),k=s.useRef(null),Q=s.useRef(null);s.useImperativeHandle(q,()=>k.current);const A=n!==void 0,d=g!==void 0,l=Array.isArray(n),I=l?[]:"",[f,C]=s.useState(g||""),O=s.useDeferredValue(f),[V,Y]=s.useState(I),b=d?g:f,a=A?n:V,N=e=>{!o.filter(i=>!i.disabled).find(i=>l?e==null?void 0:e.includes(i.value):i.value===e)&&v&&e&&v(e),A||Y(e||I),S&&S(e),C("")},P=e=>{C(e),T&&T(e)},D=s.useMemo(()=>d?[]:j?o:me(o,O,{keys:["label"]}),[o,O,d,j]),z=s.useRef(new IntersectionObserver(e=>{e[0].isIntersecting&&(x==null||x())},{threshold:1})),ee=s.useCallback(e=>{h||(z.current&&z.current.disconnect(),e&&z.current.observe(e))},[h]),te=e=>{e||C(""),R(e)},E=(a==null?void 0:a.length)>0,r=E&&l,_=r&&!b&&!u,U=j||!l&&E&&!u,se=(W=o.find(e=>e.value===a))==null?void 0:W.label,ae=_||u,re=s.useMemo(()=>{if(!Array.isArray(a))return L+B;const m=a.length.toString().length;return L+m*B},[a]),w=s.useMemo(()=>d?o:D,[D,o,d]);return t.jsxs(ie,{open:u,setOpen:te,selectedValue:a,setSelectedValue:e=>N(e),value:f,setValue:e=>{K(()=>P(e))},children:[t.jsxs("div",{className:c("relative flex cursor-pointer items-center gap-x-2 overflow-hidden","h-8 w-full rounded-md","bg-ui-bg-field transition-fg shadow-borders-base","has-[input:focus]:shadow-borders-interactive-with-active","has-[:invalid]:shadow-borders-error has-[[aria-invalid=true]]:shadow-borders-error","has-[:disabled]:bg-ui-bg-disabled has-[:disabled]:text-ui-fg-disabled has-[:disabled]:cursor-not-allowed",F),style:{"--tag-width":`${re}px`},children:[r&&t.jsxs("button",{type:"button",onClick:e=>{e.preventDefault(),N(l?[]:void 0)},className:"bg-ui-bg-base hover:bg-ui-bg-base-hover txt-compact-small-plus text-ui-fg-subtle focus-within:border-ui-fg-interactive transition-fg absolute start-0.5 top-0.5 z-[1] flex h-[28px] items-center rounded-[4px] border py-[3px] pe-1 ps-1.5 outline-none",children:[t.jsx("span",{className:"tabular-nums",children:a.length}),t.jsx($,{className:"text-ui-fg-muted"})]}),t.jsxs("div",{className:"relative flex size-full items-center",children:[_&&t.jsx("div",{className:c("pointer-events-none absolute inset-y-0 flex size-full items-center",{"start-[calc(var(--tag-width)+8px)]":r,"start-2":!r}),children:t.jsx(p,{size:"small",leading:"compact",children:y("general.selected")})}),U&&t.jsx("div",{className:c("pointer-events-none absolute inset-y-0 flex size-full items-center overflow-hidden",{"start-[calc(var(--tag-width)+8px)]":r,"start-2":!r}),children:t.jsx(p,{size:"small",leading:"compact",className:"truncate",children:se})}),t.jsx(oe,{autoSelect:!0,ref:k,onFocus:()=>R(!0),className:c("txt-compact-small text-ui-fg-base !placeholder:text-ui-fg-muted transition-fg size-full cursor-pointer bg-transparent pe-8 ps-2 outline-none focus:cursor-text","hover:bg-ui-bg-field-hover",{"opacity-0":U,"ps-2":!r,"ps-[calc(var(--tag-width)+8px)]":r}),placeholder:ae?void 0:G,...Z})]}),X&&n&&t.jsx("button",{type:"button",onClick:e=>{e.preventDefault(),N(void 0)},className:"bg-ui-bg-base hover:bg-ui-bg-base-hover txt-compact-small-plus text-ui-fg-subtle focus-within:border-ui-fg-interactive transition-fg absolute end-[28px] top-0.5 z-[1] flex h-[28px] items-center rounded-[4px] border px-1.5 py-[2px] outline-none",children:t.jsx($,{className:"text-ui-fg-muted"})}),t.jsx(ne,{render:e=>t.jsx("button",{...e,type:"button",className:"text-ui-fg-muted transition-fg hover:bg-ui-bg-field-hover absolute end-0 flex size-8 items-center justify-center rounded-r outline-none",children:t.jsx(pe,{})})})]}),t.jsxs(le,{gutter:4,sameWidth:!0,ref:Q,role:"listbox",className:c("shadow-elevation-flyout bg-ui-bg-base z-50 rounded-[8px] p-1","max-h-[200px] overflow-y-auto","data-[state=open]:animate-in data-[state=open]:fade-in-0 data-[state=open]:zoom-in-95","data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95","data-[side=bottom]:slide-in-from-top-2 data-[side=start]:slide-in-from-end-2 data-[side=end]:slide-in-from-start-2 data-[side=top]:slide-in-from-bottom-2"),style:{pointerEvents:u?"auto":"none"},"aria-busy":J,children:[w.map(({value:e,label:m,disabled:i})=>t.jsxs(H,{value:e,focusOnHover:!0,setValueOnClick:!1,disabled:i,className:c("transition-fg bg-ui-bg-base data-[active-item=true]:bg-ui-bg-base-hover group flex cursor-pointer items-center gap-x-2 rounded-[4px] px-2 py-1",{"text-ui-fg-disabled":i,"bg-ui-bg-component":i}),children:[t.jsx(ce,{className:"flex !size-5 items-center justify-center",children:l?t.jsx(xe,{}):t.jsx(fe,{})}),t.jsx(ue,{className:"txt-compact-small",children:m})]},e)),!!x&&t.jsx("div",{ref:ee,className:"w-px"}),h&&t.jsx("div",{className:"transition-fg bg-ui-bg-base flex items-center rounded-[4px] px-2 py-1.5",children:t.jsx("div",{className:"bg-ui-bg-component size-full h-5 w-full animate-pulse rounded-[4px]"})}),!w.length&&(M&&!(b!=null&&b.length)?M:t.jsx("div",{className:"flex items-center gap-x-2 rounded-[4px] px-2 py-1.5",children:t.jsx(p,{size:"small",leading:"compact",className:"text-ui-fg-subtle",children:y("general.noResultsTitle")})})),!w.length&&v&&t.jsxs(s.Fragment,{children:[t.jsx(de,{className:"bg-ui-border-base -mx-1"}),t.jsxs(H,{value:f,focusOnHover:!0,setValueOnClick:!1,className:"transition-fg bg-ui-bg-base data-[active-item=true]:bg-ui-bg-base-hover group mt-1 flex cursor-pointer items-center gap-x-2 rounded-[4px] px-2 py-1.5",children:[t.jsx(ge,{className:"text-ui-fg-subtle"}),t.jsxs(p,{size:"small",leading:"compact",children:[y("actions.create"),' "',b,'"']})]})]})]})]})},ze=he(ve);export{ze as C};
