import{r as Ct,f5 as Ng,ar as Ut,fk as rH,j as be}from"./index-S35l5lon.js";import{$ as hV,t as So}from"./toast-_TmXxcvA.js";import{c as dV,C as fV,H as aP,T as Ro}from"./heading-Cdx6okg4.js";import{B as gV}from"./badge-DtJwLgim.js";import{B as Kh}from"./button-9jJy7PHD.js";import"./spinner-2pZ_p3OB.js";import"./x-circle-solid-BoF-1eMv.js";var mV=Object.defineProperty,sw=Object.getOwnPropertySymbols,oH=Object.prototype.hasOwnProperty,sH=Object.prototype.propertyIsEnumerable,lP=(t,e,n)=>e in t?mV(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,pV=(t,e)=>{for(var n in e||(e={}))oH.call(e,n)&&lP(t,n,e[n]);if(sw)for(var n of sw(e))sH.call(e,n)&&lP(t,n,e[n]);return t},wV=(t,e)=>{var n={};for(var i in t)oH.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&sw)for(var i of sw(t))e.indexOf(i)<0&&sH.call(t,i)&&(n[i]=t[i]);return n};const aH=Ct.forwardRef((t,e)=>{var n=t,{color:i="currentColor"}=n,r=wV(n,["color"]);return Ct.createElement("svg",pV({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:e},r),Ct.createElement("path",{stroke:i,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M13.056 9.944v1.334c0 .982-.796 1.778-1.778 1.778H3.722a1.777 1.777 0 0 1-1.778-1.778V9.944M4.389 5.5 7.5 8.611 10.611 5.5M7.5 8.611V1.944"}))});aH.displayName="ArrowDownTray";var vV=Object.defineProperty,aw=Object.getOwnPropertySymbols,lH=Object.prototype.hasOwnProperty,uH=Object.prototype.propertyIsEnumerable,uP=(t,e,n)=>e in t?vV(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,CV=(t,e)=>{for(var n in e||(e={}))lH.call(e,n)&&uP(t,n,e[n]);if(aw)for(var n of aw(e))uH.call(e,n)&&uP(t,n,e[n]);return t},yV=(t,e)=>{var n={};for(var i in t)lH.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&aw)for(var i of aw(t))e.indexOf(i)<0&&uH.call(t,i)&&(n[i]=t[i]);return n};const cH=Ct.forwardRef((t,e)=>{var n=t,{color:i="currentColor"}=n,r=yV(n,["color"]);return Ct.createElement("svg",CV({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:e},r),Ct.createElement("g",{fill:i,clipPath:"url(#a)"},Ct.createElement("path",{d:"M11.228 6.952a2.45 2.45 0 0 0-3.457 0l-5.545 5.546c.19.07.393.113.607.113h9.334c.982 0 1.777-.796 1.777-1.778V9.668z"}),Ct.createElement("path",{d:"M12.167 13.278H2.833A2.446 2.446 0 0 1 .39 10.833V4.167a2.446 2.446 0 0 1 2.444-2.445h9.334a2.446 2.446 0 0 1 2.444 2.445v6.666a2.446 2.446 0 0 1-2.444 2.445M2.833 3.056c-.612 0-1.11.498-1.11 1.11v6.667c0 .613.498 1.111 1.11 1.111h9.334c.612 0 1.11-.498 1.11-1.11V4.166c0-.613-.498-1.111-1.11-1.111z"}),Ct.createElement("path",{d:"M4.611 7.056a1.111 1.111 0 1 0 0-2.223 1.111 1.111 0 0 0 0 2.223"})),Ct.createElement("defs",null,Ct.createElement("clipPath",{id:"a"},Ct.createElement("path",{fill:"#fff",d:"M0 0h15v15H0z"}))))});cH.displayName="PhotoSolid";const bV=({position:t="bottom-right",gap:e=12,offset:n=24,duration:i,...r})=>{const o={...r,position:t,gap:e,offset:n,cn:dV,toastOptions:{duration:i}};return Ct.createElement(hV,{...o})};var Xh=function(t){return t&&t.Math===Math&&t},dn=Xh(typeof globalThis=="object"&&globalThis)||Xh(typeof window=="object"&&window)||Xh(typeof self=="object"&&self)||Xh(typeof Ng=="object"&&Ng)||Xh(typeof Ng=="object"&&Ng)||function(){return this}()||Function("return this")(),TE={},fn=function(t){try{return!!t()}catch{return!0}},SV=fn,kr=!SV(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),RV=fn,Sv=!RV(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),EV=Sv,Dg=Function.prototype.call,Sn=EV?Dg.bind(Dg):function(){return Dg.apply(Dg,arguments)},hH={},dH={}.propertyIsEnumerable,fH=Object.getOwnPropertyDescriptor,TV=fH&&!dH.call({1:2},1);hH.f=TV?function(e){var n=fH(this,e);return!!n&&n.enumerable}:dH;var Rv=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},gH=Sv,mH=Function.prototype,YS=mH.call,_V=gH&&mH.bind.bind(YS,YS),gn=gH?_V:function(t){return function(){return YS.apply(t,arguments)}},pH=gn,MV=pH({}.toString),PV=pH("".slice),ku=function(t){return PV(MV(t),8,-1)},IV=gn,xV=fn,OV=ku,EC=Object,AV=IV("".split),HV=xV(function(){return!EC("z").propertyIsEnumerable(0)})?function(t){return OV(t)==="String"?AV(t,""):EC(t)}:EC,_E=function(t){return t==null},NV=_E,DV=TypeError,rg=function(t){if(NV(t))throw new DV("Can't call method on "+t);return t},$V=HV,kV=rg,og=function(t){return $V(kV(t))},TC=typeof document=="object"&&document.all,On=typeof TC>"u"&&TC!==void 0?function(t){return typeof t=="function"||t===TC}:function(t){return typeof t=="function"},LV=On,dr=function(t){return typeof t=="object"?t!==null:LV(t)},_C=dn,FV=On,VV=function(t){return FV(t)?t:void 0},Ah=function(t,e){return arguments.length<2?VV(_C[t]):_C[t]&&_C[t][e]},WV=gn,sg=WV({}.isPrototypeOf),BV=dn,cP=BV.navigator,hP=cP&&cP.userAgent,Ev=hP?String(hP):"",wH=dn,MC=Ev,dP=wH.process,fP=wH.Deno,gP=dP&&dP.versions||fP&&fP.version,mP=gP&&gP.v8,lo,lw;mP&&(lo=mP.split("."),lw=lo[0]>0&&lo[0]<4?1:+(lo[0]+lo[1]));!lw&&MC&&(lo=MC.match(/Edge\/(\d+)/),(!lo||lo[1]>=74)&&(lo=MC.match(/Chrome\/(\d+)/),lo&&(lw=+lo[1])));var jV=lw,pP=jV,UV=fn,zV=dn,YV=zV.String,ME=!!Object.getOwnPropertySymbols&&!UV(function(){var t=Symbol("symbol detection");return!YV(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&pP&&pP<41}),GV=ME,vH=GV&&!Symbol.sham&&typeof Symbol.iterator=="symbol",KV=Ah,XV=On,qV=sg,ZV=vH,JV=Object,PE=ZV?function(t){return typeof t=="symbol"}:function(t){var e=KV("Symbol");return XV(e)&&qV(e.prototype,JV(t))},QV=String,Tv=function(t){try{return QV(t)}catch{return"Object"}},eW=On,tW=Tv,nW=TypeError,Wi=function(t){if(eW(t))return t;throw new nW(tW(t)+" is not a function")},iW=Wi,rW=_E,ag=function(t,e){var n=t[e];return rW(n)?void 0:iW(n)},PC=Sn,IC=On,xC=dr,oW=TypeError,sW=function(t,e){var n,i;if(e==="string"&&IC(n=t.toString)&&!xC(i=PC(n,t))||IC(n=t.valueOf)&&!xC(i=PC(n,t))||e!=="string"&&IC(n=t.toString)&&!xC(i=PC(n,t)))return i;throw new oW("Can't convert object to primitive value")},CH={exports:{}},wP=dn,aW=Object.defineProperty,IE=function(t,e){try{aW(wP,t,{value:e,configurable:!0,writable:!0})}catch{wP[t]=e}return e},lW=dn,uW=IE,vP="__core-js_shared__",CP=CH.exports=lW[vP]||uW(vP,{});(CP.versions||(CP.versions=[])).push({version:"3.47.0",mode:"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.47.0/LICENSE",source:"https://github.com/zloirock/core-js"});var xE=CH.exports,yP=xE,yH=function(t,e){return yP[t]||(yP[t]=e||{})},cW=rg,hW=Object,Hh=function(t){return hW(cW(t))},dW=gn,fW=Hh,gW=dW({}.hasOwnProperty),fr=Object.hasOwn||function(e,n){return gW(fW(e),n)},mW=gn,pW=0,wW=Math.random(),vW=mW(1.1.toString),OE=function(t){return"Symbol("+(t===void 0?"":t)+")_"+vW(++pW+wW,36)},CW=dn,yW=yH,bP=fr,bW=OE,SW=ME,RW=vH,eh=CW.Symbol,OC=yW("wks"),EW=RW?eh.for||eh:eh&&eh.withoutSetter||bW,vo=function(t){return bP(OC,t)||(OC[t]=SW&&bP(eh,t)?eh[t]:EW("Symbol."+t)),OC[t]},TW=Sn,SP=dr,RP=PE,_W=ag,MW=sW,PW=vo,IW=TypeError,xW=PW("toPrimitive"),OW=function(t,e){if(!SP(t)||RP(t))return t;var n=_W(t,xW),i;if(n){if(e===void 0&&(e="default"),i=TW(n,t,e),!SP(i)||RP(i))return i;throw new IW("Can't convert object to primitive value")}return e===void 0&&(e="number"),MW(t,e)},AW=OW,HW=PE,bH=function(t){var e=AW(t,"string");return HW(e)?e:e+""},NW=dn,EP=dr,GS=NW.document,DW=EP(GS)&&EP(GS.createElement),AE=function(t){return DW?GS.createElement(t):{}},$W=kr,kW=fn,LW=AE,SH=!$W&&!kW(function(){return Object.defineProperty(LW("div"),"a",{get:function(){return 7}}).a!==7}),FW=kr,VW=Sn,WW=hH,BW=Rv,jW=og,UW=bH,zW=fr,YW=SH,TP=Object.getOwnPropertyDescriptor;TE.f=FW?TP:function(e,n){if(e=jW(e),n=UW(n),YW)try{return TP(e,n)}catch{}if(zW(e,n))return BW(!VW(WW.f,e,n),e[n])};var ra={},GW=kr,KW=fn,RH=GW&&KW(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),XW=dr,qW=String,ZW=TypeError,Rn=function(t){if(XW(t))return t;throw new ZW(qW(t)+" is not an object")},JW=kr,QW=SH,eB=RH,$g=Rn,_P=bH,tB=TypeError,AC=Object.defineProperty,nB=Object.getOwnPropertyDescriptor,HC="enumerable",NC="configurable",DC="writable";ra.f=JW?eB?function(e,n,i){if($g(e),n=_P(n),$g(i),typeof e=="function"&&n==="prototype"&&"value"in i&&DC in i&&!i[DC]){var r=nB(e,n);r&&r[DC]&&(e[n]=i.value,i={configurable:NC in i?i[NC]:r[NC],enumerable:HC in i?i[HC]:r[HC],writable:!1})}return AC(e,n,i)}:AC:function(e,n,i){if($g(e),n=_P(n),$g(i),QW)try{return AC(e,n,i)}catch{}if("get"in i||"set"in i)throw new tB("Accessors not supported");return"value"in i&&(e[n]=i.value),e};var iB=kr,rB=ra,oB=Rv,Nh=iB?function(t,e,n){return rB.f(t,e,oB(1,n))}:function(t,e,n){return t[e]=n,t},EH={exports:{}},KS=kr,sB=fr,TH=Function.prototype,aB=KS&&Object.getOwnPropertyDescriptor,lB=sB(TH,"name"),uB=lB&&(!KS||KS&&aB(TH,"name").configurable),cB={CONFIGURABLE:uB},hB=gn,dB=On,XS=xE,fB=hB(Function.toString);dB(XS.inspectSource)||(XS.inspectSource=function(t){return fB(t)});var gB=XS.inspectSource,mB=dn,pB=On,MP=mB.WeakMap,wB=pB(MP)&&/native code/.test(String(MP)),vB=yH,CB=OE,PP=vB("keys"),HE=function(t){return PP[t]||(PP[t]=CB(t))},NE={},yB=wB,_H=dn,bB=dr,SB=Nh,$C=fr,kC=xE,RB=HE,EB=NE,IP="Object already initialized",qS=_H.TypeError,TB=_H.WeakMap,uw,Nf,cw,_B=function(t){return cw(t)?Nf(t):uw(t,{})},MB=function(t){return function(e){var n;if(!bB(e)||(n=Nf(e)).type!==t)throw new qS("Incompatible receiver, "+t+" required");return n}};if(yB||kC.state){var Eo=kC.state||(kC.state=new TB);Eo.get=Eo.get,Eo.has=Eo.has,Eo.set=Eo.set,uw=function(t,e){if(Eo.has(t))throw new qS(IP);return e.facade=t,Eo.set(t,e),e},Nf=function(t){return Eo.get(t)||{}},cw=function(t){return Eo.has(t)}}else{var Zu=RB("state");EB[Zu]=!0,uw=function(t,e){if($C(t,Zu))throw new qS(IP);return e.facade=t,SB(t,Zu,e),e},Nf=function(t){return $C(t,Zu)?t[Zu]:{}},cw=function(t){return $C(t,Zu)}}var DE={set:uw,get:Nf,has:cw,enforce:_B,getterFor:MB},$E=gn,PB=fn,IB=On,kg=fr,ZS=kr,xB=cB.CONFIGURABLE,OB=gB,MH=DE,AB=MH.enforce,HB=MH.get,xP=String,xp=Object.defineProperty,NB=$E("".slice),DB=$E("".replace),$B=$E([].join),kB=ZS&&!PB(function(){return xp(function(){},"length",{value:8}).length!==8}),LB=String(String).split("String"),FB=EH.exports=function(t,e,n){NB(xP(e),0,7)==="Symbol("&&(e="["+DB(xP(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!kg(t,"name")||xB&&t.name!==e)&&(ZS?xp(t,"name",{value:e,configurable:!0}):t.name=e),kB&&n&&kg(n,"arity")&&t.length!==n.arity&&xp(t,"length",{value:n.arity});try{n&&kg(n,"constructor")&&n.constructor?ZS&&xp(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var i=AB(t);return kg(i,"source")||(i.source=$B(LB,typeof e=="string"?e:"")),t};Function.prototype.toString=FB(function(){return IB(this)&&HB(this).source||OB(this)},"toString");var PH=EH.exports,VB=On,WB=ra,BB=PH,jB=IE,kE=function(t,e,n,i){i||(i={});var r=i.enumerable,o=i.name!==void 0?i.name:e;if(VB(n)&&BB(n,o,i),i.global)r?t[e]=n:jB(e,n);else{try{i.unsafe?t[e]&&(r=!0):delete t[e]}catch{}r?t[e]=n:WB.f(t,e,{value:n,enumerable:!1,configurable:!i.nonConfigurable,writable:!i.nonWritable})}return t},IH={},UB=Math.ceil,zB=Math.floor,YB=Math.trunc||function(e){var n=+e;return(n>0?zB:UB)(n)},GB=YB,lg=function(t){var e=+t;return e!==e||e===0?0:GB(e)},KB=lg,XB=Math.max,qB=Math.min,ZB=function(t,e){var n=KB(t);return n<0?XB(n+e,0):qB(n,e)},JB=lg,QB=Math.min,ej=function(t){var e=JB(t);return e>0?QB(e,9007199254740991):0},tj=ej,Dh=function(t){return tj(t.length)},nj=og,ij=ZB,rj=Dh,oj=function(t){return function(e,n,i){var r=nj(e),o=rj(r);if(o===0)return!t&&-1;var s=ij(i,o),a;if(t&&n!==n){for(;o>s;)if(a=r[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in r)&&r[s]===n)return t||s||0;return!t&&-1}},sj={indexOf:oj(!1)},aj=gn,LC=fr,lj=og,uj=sj.indexOf,cj=NE,OP=aj([].push),xH=function(t,e){var n=lj(t),i=0,r=[],o;for(o in n)!LC(cj,o)&&LC(n,o)&&OP(r,o);for(;e.length>i;)LC(n,o=e[i++])&&(~uj(r,o)||OP(r,o));return r},LE=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],hj=xH,dj=LE,fj=dj.concat("length","prototype");IH.f=Object.getOwnPropertyNames||function(e){return hj(e,fj)};var OH={};OH.f=Object.getOwnPropertySymbols;var gj=Ah,mj=gn,pj=IH,wj=OH,vj=Rn,Cj=mj([].concat),yj=gj("Reflect","ownKeys")||function(e){var n=pj.f(vj(e)),i=wj.f;return i?Cj(n,i(e)):n},AP=fr,bj=yj,Sj=TE,Rj=ra,AH=function(t,e,n){for(var i=bj(e),r=Rj.f,o=Sj.f,s=0;s<i.length;s++){var a=i[s];!AP(t,a)&&!(n&&AP(n,a))&&r(t,a,o(e,a))}},Ej=fn,Tj=On,_j=/#|\.prototype\./,ug=function(t,e){var n=Pj[Mj(t)];return n===xj?!0:n===Ij?!1:Tj(e)?Ej(e):!!e},Mj=ug.normalize=function(t){return String(t).replace(_j,".").toLowerCase()},Pj=ug.data={},Ij=ug.NATIVE="N",xj=ug.POLYFILL="P",Oj=ug,Lg=dn,Aj=TE.f,Hj=Nh,Nj=kE,Dj=IE,$j=AH,kj=Oj,St=function(t,e){var n=t.target,i=t.global,r=t.stat,o,s,a,l,u,c;if(i?s=Lg:r?s=Lg[n]||Dj(n,{}):s=Lg[n]&&Lg[n].prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=Aj(s,a),l=c&&c.value):l=s[a],o=kj(i?a:n+(r?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;$j(u,l)}(t.sham||l&&l.sham)&&Hj(u,"sham",!0),Nj(s,a,u,t)}},Lj=Sv,HH=Function.prototype,HP=HH.apply,NP=HH.call,cg=typeof Reflect=="object"&&Reflect.apply||(Lj?NP.bind(HP):function(){return NP.apply(HP,arguments)}),Fj=gn,Vj=Wi,NH=function(t,e,n){try{return Fj(Vj(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},Wj=dr,Bj=function(t){return Wj(t)||t===null},jj=Bj,Uj=String,zj=TypeError,Yj=function(t){if(jj(t))return t;throw new zj("Can't set "+Uj(t)+" as a prototype")},Gj=NH,Kj=dr,Xj=rg,qj=Yj,DH=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=Gj(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(r,o){return Xj(r),qj(o),Kj(r)&&(t?n(r,o):r.__proto__=o),r}}():void 0),Zj=ra.f,Jj=function(t,e,n){n in t||Zj(t,n,{configurable:!0,get:function(){return e[n]},set:function(i){e[n]=i}})},Qj=On,eU=dr,DP=DH,tU=function(t,e,n){var i,r;return DP&&Qj(i=e.constructor)&&i!==n&&eU(r=i.prototype)&&r!==n.prototype&&DP(t,r),t},nU=vo,iU=nU("toStringTag"),$H={};$H[iU]="z";var rU=String($H)==="[object z]",oU=rU,sU=On,Op=ku,aU=vo,lU=aU("toStringTag"),uU=Object,cU=Op(function(){return arguments}())==="Arguments",hU=function(t,e){try{return t[e]}catch{}},kH=oU?Op:function(t){var e,n,i;return t===void 0?"Undefined":t===null?"Null":typeof(n=hU(e=uU(t),lU))=="string"?n:cU?Op(e):(i=Op(e))==="Object"&&sU(e.callee)?"Arguments":i},dU=kH,fU=String,_v=function(t){if(dU(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return fU(t)},gU=_v,mU=function(t,e){return t===void 0?arguments.length<2?"":e:gU(t)},pU=dr,wU=Nh,vU=function(t,e){pU(e)&&"cause"in e&&wU(t,"cause",e.cause)},CU=gn,LH=Error,yU=CU("".replace),bU=function(t){return String(new LH(t).stack)}("zxcasd"),FH=/\n\s*at [^:]*:[^\n]*/,SU=FH.test(bU),RU=function(t,e){if(SU&&typeof t=="string"&&!LH.prepareStackTrace)for(;e--;)t=yU(t,FH,"");return t},EU=fn,TU=Rv,_U=!EU(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",TU(1,7)),t.stack!==7):!0}),MU=Nh,PU=RU,IU=_U,$P=Error.captureStackTrace,xU=function(t,e,n,i){IU&&($P?$P(t,e):MU(t,"stack",PU(n,i)))},kP=Ah,OU=fr,LP=Nh,AU=sg,FP=DH,VP=AH,WP=Jj,HU=tU,NU=mU,DU=vU,$U=xU,kU=kr,LU=function(t,e,n,i){var r="stackTraceLimit",o=i?2:1,s=t.split("."),a=s[s.length-1],l=kP.apply(null,s);if(l){var u=l.prototype;if(OU(u,"cause")&&delete u.cause,!n)return l;var c=kP("Error"),h=e(function(d,f){var p=NU(i?f:d,void 0),v=i?new l(d):new l;return p!==void 0&&LP(v,"message",p),$U(v,h,v.stack,2),this&&AU(u,this)&&HU(v,this,h),arguments.length>o&&DU(v,arguments[o]),v});h.prototype=u,a!=="Error"?FP?FP(h,c):VP(h,c,{name:!0}):kU&&r in l&&(WP(h,l,r),WP(h,l,"prepareStackTrace")),VP(h,l);try{u.name!==a&&LP(u,"name",a),u.constructor=h}catch{}return h}},VH=St,FU=dn,us=cg,WH=LU,JS="WebAssembly",BP=FU[JS],hw=new Error("e",{cause:7}).cause!==7,Lu=function(t,e){var n={};n[t]=WH(t,e,hw),VH({global:!0,constructor:!0,arity:1,forced:hw},n)},FE=function(t,e){if(BP&&BP[t]){var n={};n[t]=WH(JS+"."+t,e,hw),VH({target:JS,stat:!0,constructor:!0,arity:1,forced:hw},n)}};Lu("Error",function(t){return function(n){return us(t,this,arguments)}});Lu("EvalError",function(t){return function(n){return us(t,this,arguments)}});Lu("RangeError",function(t){return function(n){return us(t,this,arguments)}});Lu("ReferenceError",function(t){return function(n){return us(t,this,arguments)}});Lu("SyntaxError",function(t){return function(n){return us(t,this,arguments)}});Lu("TypeError",function(t){return function(n){return us(t,this,arguments)}});Lu("URIError",function(t){return function(n){return us(t,this,arguments)}});FE("CompileError",function(t){return function(n){return us(t,this,arguments)}});FE("LinkError",function(t){return function(n){return us(t,this,arguments)}});FE("RuntimeError",function(t){return function(n){return us(t,this,arguments)}});var VU=ku,BH=Array.isArray||function(e){return VU(e)==="Array"},WU=kr,BU=BH,jU=TypeError,UU=Object.getOwnPropertyDescriptor,zU=WU&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),jH=zU?function(t,e){if(BU(t)&&!UU(t,"length").writable)throw new jU("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},YU=TypeError,GU=9007199254740991,UH=function(t){if(t>GU)throw YU("Maximum allowed index exceeded");return t},KU=St,XU=Hh,qU=Dh,ZU=jH,JU=UH,QU=fn,ez=QU(function(){return[].push.call({length:4294967296},1)!==4294967297}),tz=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},nz=ez||!tz();KU({target:"Array",proto:!0,arity:1,forced:nz},{push:function(e){var n=XU(this),i=qU(n),r=arguments.length;JU(i+r);for(var o=0;o<r;o++)n[i]=arguments[o],i++;return ZU(n,i),i}});var iz=ku,rz=gn,oz=function(t){if(iz(t)==="Function")return rz(t)},jP=oz,sz=Wi,az=Sv,lz=jP(jP.bind),zH=function(t,e){return sz(t),e===void 0?t:az?lz(t,e):function(){return t.apply(e,arguments)}},YH={},uz=vo,cz=YH,hz=uz("iterator"),dz=Array.prototype,fz=function(t){return t!==void 0&&(cz.Array===t||dz[hz]===t)},gz=kH,UP=ag,mz=_E,pz=YH,wz=vo,vz=wz("iterator"),VE=function(t){if(!mz(t))return UP(t,vz)||UP(t,"@@iterator")||pz[gz(t)]},Cz=Sn,yz=Wi,bz=Rn,Sz=Tv,Rz=VE,Ez=TypeError,Tz=function(t,e){var n=arguments.length<2?Rz(t):e;if(yz(n))return bz(Cz(n,t));throw new Ez(Sz(t)+" is not iterable")},_z=Sn,zP=Rn,Mz=ag,Bi=function(t,e,n){var i,r;zP(t);try{if(i=Mz(t,"return"),!i){if(e==="throw")throw n;return n}i=_z(i,t)}catch(o){r=!0,i=o}if(e==="throw")throw n;if(r)throw i;return zP(i),n},Pz=zH,Iz=Sn,xz=Rn,Oz=Tv,Az=fz,Hz=Dh,YP=sg,Nz=Tz,Dz=VE,GP=Bi,$z=TypeError,Ap=function(t,e){this.stopped=t,this.result=e},KP=Ap.prototype,$h=function(t,e,n){var i=n&&n.that,r=!!(n&&n.AS_ENTRIES),o=!!(n&&n.IS_RECORD),s=!!(n&&n.IS_ITERATOR),a=!!(n&&n.INTERRUPTED),l=Pz(e,i),u,c,h,d,f,p,v,b=function(_){return u&&GP(u,"normal"),new Ap(!0,_)},P=function(_){return r?(xz(_),a?l(_[0],_[1],b):l(_[0],_[1])):a?l(_,b):l(_)};if(o)u=t.iterator;else if(s)u=t;else{if(c=Dz(t),!c)throw new $z(Oz(t)+" is not iterable");if(Az(c)){for(h=0,d=Hz(t);d>h;h++)if(f=P(t[h]),f&&YP(KP,f))return f;return new Ap(!1)}u=Nz(t,c)}for(p=o?t.next:u.next;!(v=Iz(p,u)).done;){try{f=P(v.value)}catch(_){GP(u,"throw",_)}if(typeof f=="object"&&f&&YP(KP,f))return f}return new Ap(!1)},kz=kr,Lz=ra,Fz=Rv,GH=function(t,e,n){kz?Lz.f(t,e,Fz(0,n)):t[e]=n},Vz=St,Wz=$h,Bz=GH;Vz({target:"Object",stat:!0},{fromEntries:function(e){var n={};return Wz(e,function(i,r){Bz(n,i,r)},{AS_ENTRIES:!0}),n}});var FC=gn,Fg=Set.prototype,cs={Set,add:FC(Fg.add),has:FC(Fg.has),remove:FC(Fg.delete),proto:Fg},jz=cs.has,Fu=function(t){return jz(t),t},Uz=Sn,Vu=function(t,e,n){for(var i=n?t:t.iterator,r=t.next,o,s;!(o=Uz(r,i)).done;)if(s=e(o.value),s!==void 0)return s},KH=gn,zz=Vu,XH=cs,Yz=XH.Set,qH=XH.proto,Gz=KH(qH.forEach),ZH=KH(qH.keys),Kz=ZH(new Yz).next,hg=function(t,e,n){return n?zz({iterator:ZH(t),next:Kz},e):Gz(t,e)},JH=cs,Xz=hg,qz=JH.Set,Zz=JH.add,WE=function(t){var e=new qz;return Xz(t,function(n){Zz(e,n)}),e},Jz=NH,Qz=cs,dg=Jz(Qz.proto,"size","get")||function(t){return t.size},hs=function(t){return{iterator:t,next:t.next,done:!1}},XP=Wi,QH=Rn,qP=Sn,eY=lg,tY=hs,ZP="Invalid size",nY=RangeError,iY=TypeError,rY=Math.max,eN=function(t,e){this.set=t,this.size=rY(e,0),this.has=XP(t.has),this.keys=XP(t.keys)};eN.prototype={getIterator:function(){return tY(QH(qP(this.keys,this.set)))},includes:function(t){return qP(this.has,this.set,t)}};var Wu=function(t){QH(t);var e=+t.size;if(e!==e)throw new iY(ZP);var n=eY(e);if(n<0)throw new nY(ZP);return new eN(t,n)},oY=Fu,tN=cs,sY=WE,aY=dg,lY=Wu,uY=hg,cY=Vu,hY=tN.has,JP=tN.remove,dY=function(e){var n=oY(this),i=lY(e),r=sY(n);return aY(n)<=i.size?uY(n,function(o){i.includes(o)&&JP(r,o)}):cY(i.getIterator(),function(o){hY(r,o)&&JP(r,o)}),r},fY=Ah,QP=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},eI=function(t){return{size:t,has:function(){return!0},keys:function(){throw new Error("e")}}},Bu=function(t,e){var n=fY("Set");try{new n()[t](QP(0));try{return new n()[t](QP(-1)),!1}catch{if(!e)return!0;try{return new n()[t](eI(-1/0)),!1}catch{var i=new n([1,2]);return e(i[t](eI(1/0)))}}}catch{return!1}},gY=St,mY=dY,pY=fn,wY=Bu,vY=!wY("difference",function(t){return t.size===0}),CY=vY||pY(function(){var t={size:1,has:function(){return!0},keys:function(){var n=0;return{next:function(){var i=n++>1;return e.has(1)&&e.clear(),{done:i,value:2}}}}},e=new Set([1,2,3,4]);return e.difference(t).size!==3});gY({target:"Set",proto:!0,real:!0,forced:CY},{difference:mY});var yY=Fu,BE=cs,bY=dg,SY=Wu,RY=hg,EY=Vu,TY=BE.Set,tI=BE.add,_Y=BE.has,MY=function(e){var n=yY(this),i=SY(e),r=new TY;return bY(n)>i.size?EY(i.getIterator(),function(o){_Y(n,o)&&tI(r,o)}):RY(n,function(o){i.includes(o)&&tI(r,o)}),r},PY=St,IY=fn,xY=MY,OY=Bu,AY=!OY("intersection",function(t){return t.size===2&&t.has(1)&&t.has(2)})||IY(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});PY({target:"Set",proto:!0,real:!0,forced:AY},{intersection:xY});var HY=Fu,NY=cs.has,DY=dg,$Y=Wu,kY=hg,LY=Vu,FY=Bi,VY=function(e){var n=HY(this),i=$Y(e);if(DY(n)<=i.size)return kY(n,function(o){if(i.includes(o))return!1},!0)!==!1;var r=i.getIterator();return LY(r,function(o){if(NY(n,o))return FY(r,"normal",!1)})!==!1},WY=St,BY=VY,jY=Bu,UY=!jY("isDisjointFrom",function(t){return!t});WY({target:"Set",proto:!0,real:!0,forced:UY},{isDisjointFrom:BY});var zY=Fu,YY=dg,GY=hg,KY=Wu,XY=function(e){var n=zY(this),i=KY(e);return YY(n)>i.size?!1:GY(n,function(r){if(!i.includes(r))return!1},!0)!==!1},qY=St,ZY=XY,JY=Bu,QY=!JY("isSubsetOf",function(t){return t});qY({target:"Set",proto:!0,real:!0,forced:QY},{isSubsetOf:ZY});var eG=Fu,tG=cs.has,nG=dg,iG=Wu,rG=Vu,oG=Bi,sG=function(e){var n=eG(this),i=iG(e);if(nG(n)<i.size)return!1;var r=i.getIterator();return rG(r,function(o){if(!tG(n,o))return oG(r,"normal",!1)})!==!1},aG=St,lG=sG,uG=Bu,cG=!uG("isSupersetOf",function(t){return!t});aG({target:"Set",proto:!0,real:!0,forced:cG},{isSupersetOf:lG});var hG=Fu,jE=cs,dG=WE,fG=Wu,gG=Vu,mG=jE.add,pG=jE.has,wG=jE.remove,vG=function(e){var n=hG(this),i=fG(e).getIterator(),r=dG(n);return gG(i,function(o){pG(n,o)?wG(r,o):mG(r,o)}),r},nN=function(t){try{var e=new Set,n={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},i=e[t](n);return i.size===1&&i.values().next().value===4}catch{return!1}},CG=St,yG=vG,bG=nN,SG=Bu,RG=!SG("symmetricDifference")||!bG("symmetricDifference");CG({target:"Set",proto:!0,real:!0,forced:RG},{symmetricDifference:yG});var EG=Fu,TG=cs.add,_G=WE,MG=Wu,PG=Vu,IG=function(e){var n=EG(this),i=MG(e).getIterator(),r=_G(n);return PG(i,function(o){TG(r,o)}),r},xG=St,OG=IG,AG=nN,HG=Bu,NG=!HG("union")||!AG("union");xG({target:"Set",proto:!0,real:!0,forced:NG},{union:OG});var DG=sg,$G=TypeError,kG=function(t,e){if(DG(e,t))return t;throw new $G("Incorrect invocation")},LG=fn,FG=!LG(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),VG=fr,WG=On,BG=Hh,jG=HE,UG=FG,nI=jG("IE_PROTO"),QS=Object,zG=QS.prototype,iN=UG?QS.getPrototypeOf:function(t){var e=BG(t);if(VG(e,nI))return e[nI];var n=e.constructor;return WG(n)&&e instanceof n?n.prototype:e instanceof QS?zG:null},iI=PH,YG=ra,GG=function(t,e,n){return n.get&&iI(n.get,e,{getter:!0}),n.set&&iI(n.set,e,{setter:!0}),YG.f(t,e,n)},rN={},KG=xH,XG=LE,qG=Object.keys||function(e){return KG(e,XG)},ZG=kr,JG=RH,QG=ra,e2=Rn,t2=og,n2=qG;rN.f=ZG&&!JG?Object.defineProperties:function(e,n){e2(e);for(var i=t2(n),r=n2(n),o=r.length,s=0,a;o>s;)QG.f(e,a=r[s++],i[a]);return e};var i2=Ah,oN=i2("document","documentElement"),r2=Rn,o2=rN,rI=LE,s2=NE,a2=oN,l2=AE,u2=HE,oI=">",sI="<",eR="prototype",tR="script",sN=u2("IE_PROTO"),VC=function(){},aN=function(t){return sI+tR+oI+t+sI+"/"+tR+oI},aI=function(t){t.write(aN("")),t.close();var e=t.parentWindow.Object;return t=null,e},c2=function(){var t=l2("iframe"),e="java"+tR+":",n;return t.style.display="none",a2.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(aN("document.F=Object")),n.close(),n.F},Vg,Hp=function(){try{Vg=new ActiveXObject("htmlfile")}catch{}Hp=typeof document<"u"?document.domain&&Vg?aI(Vg):c2():aI(Vg);for(var t=rI.length;t--;)delete Hp[eR][rI[t]];return Hp()};s2[sN]=!0;var lN=Object.create||function(e,n){var i;return e!==null?(VC[eR]=r2(e),i=new VC,VC[eR]=null,i[sN]=e):i=Hp(),n===void 0?i:o2.f(i,n)},h2=fn,d2=On,f2=dr,lI=iN,g2=kE,m2=vo,nR=m2("iterator"),Eu,WC,BC;[].keys&&(BC=[].keys(),"next"in BC&&(WC=lI(lI(BC)),WC!==Object.prototype&&(Eu=WC)));var p2=!f2(Eu)||h2(function(){var t={};return Eu[nR].call(t)!==t});p2&&(Eu={});d2(Eu[nR])||g2(Eu,nR,function(){return this});var uN={IteratorPrototype:Eu},w2=St,v2=dn,C2=kG,y2=Rn,b2=On,S2=iN,R2=GG,E2=GH,T2=fn,UE=fr,_2=vo,os=uN.IteratorPrototype,M2=kr,jC="constructor",cN="Iterator",uI=_2("toStringTag"),hN=TypeError,UC=v2[cN],dN=!b2(UC)||UC.prototype!==os||!T2(function(){UC({})}),zE=function(){if(C2(this,os),S2(this)===os)throw new hN("Abstract class Iterator not directly constructable")},fN=function(t,e){M2?R2(os,t,{configurable:!0,get:function(){return e},set:function(n){if(y2(this),this===os)throw new hN("You can't redefine this property");UE(this,t)?this[t]=n:E2(this,t,n)}}):os[t]=e};UE(os,uI)||fN(uI,cN);(dN||!UE(os,jC)||os[jC]===Object)&&fN(jC,zE);zE.prototype=os;w2({global:!0,constructor:!0,forced:dN},{Iterator:zE});var P2=kE,I2=function(t,e,n){for(var i in e)P2(t,i,e[i],n);return t},x2=function(t,e){return{value:t,done:e}},O2=Bi,A2=function(t,e,n){for(var i=t.length-1;i>=0;i--)if(t[i]!==void 0)try{n=O2(t[i].iterator,e,n)}catch(r){e="throw",n=r}if(e==="throw")throw n;return n},H2=Sn,N2=lN,D2=Nh,$2=I2,k2=vo,gN=DE,L2=ag,F2=uN.IteratorPrototype,Wg=x2,Bg=Bi,V2=A2,W2=k2("toStringTag"),mN="IteratorHelper",pN="WrapForValidIterator",zC="normal",cI="throw",B2=gN.set,wN=function(t){var e=gN.getterFor(t?pN:mN);return $2(N2(F2),{next:function(){var i=e(this);if(t)return i.nextHandler();if(i.done)return Wg(void 0,!0);try{var r=i.nextHandler();return i.returnHandlerResult?r:Wg(r,i.done)}catch(o){throw i.done=!0,o}},return:function(){var n=e(this),i=n.iterator;if(n.done=!0,t){var r=L2(i,"return");return r?H2(r,i):Wg(void 0,!0)}if(n.inner)try{Bg(n.inner.iterator,zC)}catch(o){return Bg(i,cI,o)}if(n.openIters)try{V2(n.openIters,zC)}catch(o){return Bg(i,cI,o)}return i&&Bg(i,zC),Wg(void 0,!0)}})},j2=wN(!0),vN=wN(!1);D2(vN,W2,"Iterator Helper");var YE=function(t,e,n){var i=function(o,s){s?(s.iterator=o.iterator,s.next=o.next):s=o,s.type=e?pN:mN,s.returnHandlerResult=!!n,s.nextHandler=t,s.counter=0,s.done=!1,B2(this,s)};return i.prototype=e?j2:vN,i},U2=Rn,z2=Bi,CN=function(t,e,n,i){try{return i?e(U2(n)[0],n[1]):e(n)}catch(r){z2(t,"throw",r)}},GE=function(t,e){var n=typeof Iterator=="function"&&Iterator.prototype[t];if(n)try{n.call({next:null},e).next()}catch{return!0}},Y2=dn,sl=function(t,e){var n=Y2.Iterator,i=n&&n.prototype,r=i&&i[t],o=!1;if(r)try{r.call({next:function(){return{done:!0}},return:function(){o=!0}},-1)}catch(s){s instanceof e||(o=!1)}if(!o)return r},G2=St,yN=Sn,K2=Wi,bN=Rn,X2=hs,q2=YE,Z2=CN,J2=Bi,Q2=GE,eK=sl,SN=!Q2("filter",function(){}),iR=!SN&&eK("filter",TypeError),tK=SN||iR,nK=q2(function(){for(var t=this.iterator,e=this.predicate,n=this.next,i,r,o;;){if(i=bN(yN(n,t)),r=this.done=!!i.done,r)return;if(o=i.value,Z2(t,e,[o,this.counter++],!0))return o}});G2({target:"Iterator",proto:!0,real:!0,forced:tK},{filter:function(e){bN(this);try{K2(e)}catch(n){J2(this,"throw",n)}return iR?yN(iR,this,e):new nK(X2(this),{predicate:e})}});var iK=St,rK=Sn,oK=$h,sK=Wi,aK=Rn,lK=hs,uK=Bi,cK=sl,YC=cK("forEach",TypeError);iK({target:"Iterator",proto:!0,real:!0,forced:YC},{forEach:function(e){aK(this);try{sK(e)}catch(r){uK(this,"throw",r)}if(YC)return rK(YC,this,e);var n=lK(this),i=0;oK(n,function(r){e(r,i++)},{IS_RECORD:!0})}});var hK=St,RN=Sn,dK=Wi,EN=Rn,fK=hs,gK=YE,mK=CN,pK=Bi,wK=GE,vK=sl,TN=!wK("map",function(){}),rR=!TN&&vK("map",TypeError),CK=TN||rR,yK=gK(function(){var t=this.iterator,e=EN(RN(this.next,t)),n=this.done=!!e.done;if(!n)return mK(t,this.mapper,[e.value,this.counter++],!0)});hK({target:"Iterator",proto:!0,real:!0,forced:CK},{map:function(e){EN(this);try{dK(e)}catch(n){pK(this,"throw",n)}return rR?RN(rR,this,e):new yK(fK(this),{mapper:e})}});var bK=gn,KE=bK([].slice),SK=TypeError,_N=function(t,e){if(t<e)throw new SK("Not enough arguments");return t},RK=Ev,EK=/(?:ipad|iphone|ipod).*applewebkit/i.test(RK),qh=dn,TK=Ev,_K=ku,jg=function(t){return TK.slice(0,t.length)===t},MN=function(){return jg("Bun/")?"BUN":jg("Cloudflare-Workers")?"CLOUDFLARE":jg("Deno/")?"DENO":jg("Node.js/")?"NODE":qh.Bun&&typeof Bun.version=="string"?"BUN":qh.Deno&&typeof Deno.version=="object"?"DENO":_K(qh.process)==="process"?"NODE":qh.window&&qh.document?"BROWSER":"REST"}(),MK=MN,PK=MK==="NODE",ur=dn,IK=cg,xK=zH,hI=On,OK=fr,PN=fn,dI=oN,AK=KE,fI=AE,HK=_N,NK=EK,DK=PK,oR=ur.setImmediate,sR=ur.clearImmediate,$K=ur.process,GC=ur.Dispatch,kK=ur.Function,gI=ur.MessageChannel,LK=ur.String,KC=0,cf={},mI="onreadystatechange",Df,hl,XC,qC;PN(function(){Df=ur.location});var XE=function(t){if(OK(cf,t)){var e=cf[t];delete cf[t],e()}},ZC=function(t){return function(){XE(t)}},pI=function(t){XE(t.data)},wI=function(t){ur.postMessage(LK(t),Df.protocol+"//"+Df.host)};(!oR||!sR)&&(oR=function(e){HK(arguments.length,1);var n=hI(e)?e:kK(e),i=AK(arguments,1);return cf[++KC]=function(){IK(n,void 0,i)},hl(KC),KC},sR=function(e){delete cf[e]},DK?hl=function(t){$K.nextTick(ZC(t))}:GC&&GC.now?hl=function(t){GC.now(ZC(t))}:gI&&!NK?(XC=new gI,qC=XC.port2,XC.port1.onmessage=pI,hl=xK(qC.postMessage,qC)):ur.addEventListener&&hI(ur.postMessage)&&!ur.importScripts&&Df&&Df.protocol!=="file:"&&!PN(wI)?(hl=wI,ur.addEventListener("message",pI,!1)):mI in fI("script")?hl=function(t){dI.appendChild(fI("script"))[mI]=function(){dI.removeChild(this),XE(t)}}:hl=function(t){setTimeout(ZC(t),0)});var IN={set:oR,clear:sR},FK=St,VK=dn,vI=IN.clear;FK({global:!0,bind:!0,enumerable:!0,forced:VK.clearImmediate!==vI},{clearImmediate:vI});var xN=dn,WK=cg,BK=On,jK=MN,UK=Ev,zK=KE,YK=_N,GK=xN.Function,KK=/MSIE .\./.test(UK)||jK==="BUN"&&function(){var t=xN.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),XK=function(t,e){var n=e?2:1;return KK?function(i,r){var o=YK(arguments.length,1)>n,s=BK(i)?i:GK(i),a=o?zK(arguments,n):[],l=o?function(){WK(s,this,a)}:s;return e?t(l,r):t(l)}:t},qK=St,ON=dn,CI=IN.set,ZK=XK,yI=ON.setImmediate?ZK(CI,!1):CI;qK({global:!0,bind:!0,enumerable:!0,forced:ON.setImmediate!==yI},{setImmediate:yI});/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:AN,setPrototypeOf:bI,isFrozen:JK,getPrototypeOf:QK,getOwnPropertyDescriptor:e3}=Object;let{freeze:yi,seal:Dr,create:aR}=Object,{apply:lR,construct:uR}=typeof Reflect<"u"&&Reflect;yi||(yi=function(e){return e});Dr||(Dr=function(e){return e});lR||(lR=function(e,n){for(var i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];return e.apply(n,r)});uR||(uR=function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return new e(...i)});const Ug=bi(Array.prototype.forEach),t3=bi(Array.prototype.lastIndexOf),SI=bi(Array.prototype.pop),Zh=bi(Array.prototype.push),n3=bi(Array.prototype.splice),Np=bi(String.prototype.toLowerCase),JC=bi(String.prototype.toString),QC=bi(String.prototype.match),Jh=bi(String.prototype.replace),i3=bi(String.prototype.indexOf),r3=bi(String.prototype.trim),Qr=bi(Object.prototype.hasOwnProperty),ai=bi(RegExp.prototype.test),Qh=o3(TypeError);function bi(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return lR(t,e,i)}}function o3(t){return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return uR(t,n)}}function ze(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Np;bI&&bI(t,null);let i=e.length;for(;i--;){let r=e[i];if(typeof r=="string"){const o=n(r);o!==r&&(JK(e)||(e[i]=o),r=o)}t[r]=!0}return t}function s3(t){for(let e=0;e<t.length;e++)Qr(t,e)||(t[e]=null);return t}function jo(t){const e=aR(null);for(const[n,i]of AN(t))Qr(t,n)&&(Array.isArray(i)?e[n]=s3(i):i&&typeof i=="object"&&i.constructor===Object?e[n]=jo(i):e[n]=i);return e}function ed(t,e){for(;t!==null;){const i=e3(t,e);if(i){if(i.get)return bi(i.get);if(typeof i.value=="function")return bi(i.value)}t=QK(t)}function n(){return null}return n}const RI=yi(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ey=yi(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ty=yi(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),a3=yi(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ny=yi(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),l3=yi(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),EI=yi(["#text"]),TI=yi(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),iy=yi(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),_I=yi(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),zg=yi(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),u3=Dr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),c3=Dr(/<%[\w\W]*|[\w\W]*%>/gm),h3=Dr(/\$\{[\w\W]*/gm),d3=Dr(/^data-[\-\w.\u00B7-\uFFFF]+$/),f3=Dr(/^aria-[\-\w]+$/),HN=Dr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),g3=Dr(/^(?:\w+script|data):/i),m3=Dr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),NN=Dr(/^html$/i),p3=Dr(/^[a-z][.\w]*(-[.\w]+)+$/i);var MI=Object.freeze({__proto__:null,ARIA_ATTR:f3,ATTR_WHITESPACE:m3,CUSTOM_ELEMENT:p3,DATA_ATTR:d3,DOCTYPE_NAME:NN,ERB_EXPR:c3,IS_ALLOWED_URI:HN,IS_SCRIPT_OR_DATA:g3,MUSTACHE_EXPR:u3,TMPLIT_EXPR:h3});const td={element:1,text:3,progressingInstruction:7,comment:8,document:9},w3=function(){return typeof window>"u"?null:window},v3=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const r="data-tt-policy-suffix";n&&n.hasAttribute(r)&&(i=n.getAttribute(r));const o="dompurify"+(i?"#"+i:"");try{return e.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},PI=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function DN(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:w3();const e=we=>DN(we);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==td.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const i=n,r=i.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:a,Element:l,NodeFilter:u,NamedNodeMap:c=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,p=l.prototype,v=ed(p,"cloneNode"),b=ed(p,"remove"),P=ed(p,"nextSibling"),_=ed(p,"childNodes"),F=ed(p,"parentNode");if(typeof s=="function"){const we=n.createElement("template");we.content&&we.content.ownerDocument&&(n=we.content.ownerDocument)}let I,W="";const{implementation:k,createNodeIterator:$,createDocumentFragment:Y,getElementsByTagName:J}=n,{importNode:U}=i;let oe=PI();e.isSupported=typeof AN=="function"&&typeof F=="function"&&k&&k.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:j,ERB_EXPR:Z,TMPLIT_EXPR:re,DATA_ATTR:pe,ARIA_ATTR:Xe,IS_SCRIPT_OR_DATA:xe,ATTR_WHITESPACE:Oe,CUSTOM_ELEMENT:Re}=MI;let{IS_ALLOWED_URI:Ae}=MI,Ze=null;const gt=ze({},[...RI,...ey,...ty,...ny,...EI]);let ke=null;const G=ze({},[...TI,...iy,..._I,...zg]);let g=Object.seal(aR(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),w=null,y=null;const T=Object.seal(aR(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let D=!0,m=!0,C=!1,S=!0,x=!1,E=!0,R=!1,N=!1,M=!1,A=!1,L=!1,V=!1,z=!0,se=!1;const Q="user-content-";let ye=!0,Be=!1,et={},Se=null;const je=ze({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let rt=null;const Xt=ze({},["audio","video","img","source","image","track"]);let Bn=null;const mr=ze({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),qt="http://www.w3.org/1998/Math/MathML",Ui="http://www.w3.org/2000/svg",_t="http://www.w3.org/1999/xhtml";let Rt=_t,Je=!1,ca=null;const ha=ze({},[qt,Ui,_t],JC);let yo=ze({},["mi","mo","mn","ms","mtext"]),da=ze({},["annotation-xml"]);const pr=ze({},["title","style","font","a","script"]);let jn=null;const Ag=["application/xhtml+xml","text/html"],Hg="text/html";let En=null,Xu=null;const lV=n.createElement("form"),XM=function(H){return H instanceof RegExp||H instanceof Function},bC=function(){let H=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Xu&&Xu===H)){if((!H||typeof H!="object")&&(H={}),H=jo(H),jn=Ag.indexOf(H.PARSER_MEDIA_TYPE)===-1?Hg:H.PARSER_MEDIA_TYPE,En=jn==="application/xhtml+xml"?JC:Np,Ze=Qr(H,"ALLOWED_TAGS")?ze({},H.ALLOWED_TAGS,En):gt,ke=Qr(H,"ALLOWED_ATTR")?ze({},H.ALLOWED_ATTR,En):G,ca=Qr(H,"ALLOWED_NAMESPACES")?ze({},H.ALLOWED_NAMESPACES,JC):ha,Bn=Qr(H,"ADD_URI_SAFE_ATTR")?ze(jo(mr),H.ADD_URI_SAFE_ATTR,En):mr,rt=Qr(H,"ADD_DATA_URI_TAGS")?ze(jo(Xt),H.ADD_DATA_URI_TAGS,En):Xt,Se=Qr(H,"FORBID_CONTENTS")?ze({},H.FORBID_CONTENTS,En):je,w=Qr(H,"FORBID_TAGS")?ze({},H.FORBID_TAGS,En):jo({}),y=Qr(H,"FORBID_ATTR")?ze({},H.FORBID_ATTR,En):jo({}),et=Qr(H,"USE_PROFILES")?H.USE_PROFILES:!1,D=H.ALLOW_ARIA_ATTR!==!1,m=H.ALLOW_DATA_ATTR!==!1,C=H.ALLOW_UNKNOWN_PROTOCOLS||!1,S=H.ALLOW_SELF_CLOSE_IN_ATTR!==!1,x=H.SAFE_FOR_TEMPLATES||!1,E=H.SAFE_FOR_XML!==!1,R=H.WHOLE_DOCUMENT||!1,A=H.RETURN_DOM||!1,L=H.RETURN_DOM_FRAGMENT||!1,V=H.RETURN_TRUSTED_TYPE||!1,M=H.FORCE_BODY||!1,z=H.SANITIZE_DOM!==!1,se=H.SANITIZE_NAMED_PROPS||!1,ye=H.KEEP_CONTENT!==!1,Be=H.IN_PLACE||!1,Ae=H.ALLOWED_URI_REGEXP||HN,Rt=H.NAMESPACE||_t,yo=H.MATHML_TEXT_INTEGRATION_POINTS||yo,da=H.HTML_INTEGRATION_POINTS||da,g=H.CUSTOM_ELEMENT_HANDLING||{},H.CUSTOM_ELEMENT_HANDLING&&XM(H.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(g.tagNameCheck=H.CUSTOM_ELEMENT_HANDLING.tagNameCheck),H.CUSTOM_ELEMENT_HANDLING&&XM(H.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(g.attributeNameCheck=H.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),H.CUSTOM_ELEMENT_HANDLING&&typeof H.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(g.allowCustomizedBuiltInElements=H.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),x&&(m=!1),L&&(A=!0),et&&(Ze=ze({},EI),ke=[],et.html===!0&&(ze(Ze,RI),ze(ke,TI)),et.svg===!0&&(ze(Ze,ey),ze(ke,iy),ze(ke,zg)),et.svgFilters===!0&&(ze(Ze,ty),ze(ke,iy),ze(ke,zg)),et.mathMl===!0&&(ze(Ze,ny),ze(ke,_I),ze(ke,zg))),H.ADD_TAGS&&(typeof H.ADD_TAGS=="function"?T.tagCheck=H.ADD_TAGS:(Ze===gt&&(Ze=jo(Ze)),ze(Ze,H.ADD_TAGS,En))),H.ADD_ATTR&&(typeof H.ADD_ATTR=="function"?T.attributeCheck=H.ADD_ATTR:(ke===G&&(ke=jo(ke)),ze(ke,H.ADD_ATTR,En))),H.ADD_URI_SAFE_ATTR&&ze(Bn,H.ADD_URI_SAFE_ATTR,En),H.FORBID_CONTENTS&&(Se===je&&(Se=jo(Se)),ze(Se,H.FORBID_CONTENTS,En)),H.ADD_FORBID_CONTENTS&&(Se===je&&(Se=jo(Se)),ze(Se,H.ADD_FORBID_CONTENTS,En)),ye&&(Ze["#text"]=!0),R&&ze(Ze,["html","head","body"]),Ze.table&&(ze(Ze,["tbody"]),delete w.tbody),H.TRUSTED_TYPES_POLICY){if(typeof H.TRUSTED_TYPES_POLICY.createHTML!="function")throw Qh('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof H.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Qh('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');I=H.TRUSTED_TYPES_POLICY,W=I.createHTML("")}else I===void 0&&(I=v3(f,r)),I!==null&&typeof W=="string"&&(W=I.createHTML(""));yi&&yi(H),Xu=H}},qM=ze({},[...ey,...ty,...a3]),ZM=ze({},[...ny,...l3]),uV=function(H){let q=F(H);(!q||!q.tagName)&&(q={namespaceURI:Rt,tagName:"template"});const de=Np(H.tagName),Ht=Np(q.tagName);return ca[H.namespaceURI]?H.namespaceURI===Ui?q.namespaceURI===_t?de==="svg":q.namespaceURI===qt?de==="svg"&&(Ht==="annotation-xml"||yo[Ht]):!!qM[de]:H.namespaceURI===qt?q.namespaceURI===_t?de==="math":q.namespaceURI===Ui?de==="math"&&da[Ht]:!!ZM[de]:H.namespaceURI===_t?q.namespaceURI===Ui&&!da[Ht]||q.namespaceURI===qt&&!yo[Ht]?!1:!ZM[de]&&(pr[de]||!qM[de]):!!(jn==="application/xhtml+xml"&&ca[H.namespaceURI]):!1},bo=function(H){Zh(e.removed,{element:H});try{F(H).removeChild(H)}catch{b(H)}},cl=function(H,q){try{Zh(e.removed,{attribute:q.getAttributeNode(H),from:q})}catch{Zh(e.removed,{attribute:null,from:q})}if(q.removeAttribute(H),H==="is")if(A||L)try{bo(q)}catch{}else try{q.setAttribute(H,"")}catch{}},JM=function(H){let q=null,de=null;if(M)H="<remove></remove>"+H;else{const pn=QC(H,/^[\r\n\t ]+/);de=pn&&pn[0]}jn==="application/xhtml+xml"&&Rt===_t&&(H='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+H+"</body></html>");const Ht=I?I.createHTML(H):H;if(Rt===_t)try{q=new d().parseFromString(Ht,jn)}catch{}if(!q||!q.documentElement){q=k.createDocument(Rt,"template",null);try{q.documentElement.innerHTML=Je?W:Ht}catch{}}const Xn=q.body||q.documentElement;return H&&de&&Xn.insertBefore(n.createTextNode(de),Xn.childNodes[0]||null),Rt===_t?J.call(q,R?"html":"body")[0]:R?q.documentElement:Xn},QM=function(H){return $.call(H.ownerDocument||H,H,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},SC=function(H){return H instanceof h&&(typeof H.nodeName!="string"||typeof H.textContent!="string"||typeof H.removeChild!="function"||!(H.attributes instanceof c)||typeof H.removeAttribute!="function"||typeof H.setAttribute!="function"||typeof H.namespaceURI!="string"||typeof H.insertBefore!="function"||typeof H.hasChildNodes!="function")},eP=function(H){return typeof a=="function"&&H instanceof a};function ps(we,H,q){Ug(we,de=>{de.call(e,H,q,Xu)})}const tP=function(H){let q=null;if(ps(oe.beforeSanitizeElements,H,null),SC(H))return bo(H),!0;const de=En(H.nodeName);if(ps(oe.uponSanitizeElement,H,{tagName:de,allowedTags:Ze}),E&&H.hasChildNodes()&&!eP(H.firstElementChild)&&ai(/<[/\w!]/g,H.innerHTML)&&ai(/<[/\w!]/g,H.textContent)||H.nodeType===td.progressingInstruction||E&&H.nodeType===td.comment&&ai(/<[/\w]/g,H.data))return bo(H),!0;if(!(T.tagCheck instanceof Function&&T.tagCheck(de))&&(!Ze[de]||w[de])){if(!w[de]&&iP(de)&&(g.tagNameCheck instanceof RegExp&&ai(g.tagNameCheck,de)||g.tagNameCheck instanceof Function&&g.tagNameCheck(de)))return!1;if(ye&&!Se[de]){const Ht=F(H)||H.parentNode,Xn=_(H)||H.childNodes;if(Xn&&Ht){const pn=Xn.length;for(let Ei=pn-1;Ei>=0;--Ei){const ws=v(Xn[Ei],!0);ws.__removalCount=(H.__removalCount||0)+1,Ht.insertBefore(ws,P(H))}}}return bo(H),!0}return H instanceof l&&!uV(H)||(de==="noscript"||de==="noembed"||de==="noframes")&&ai(/<\/no(script|embed|frames)/i,H.innerHTML)?(bo(H),!0):(x&&H.nodeType===td.text&&(q=H.textContent,Ug([j,Z,re],Ht=>{q=Jh(q,Ht," ")}),H.textContent!==q&&(Zh(e.removed,{element:H.cloneNode()}),H.textContent=q)),ps(oe.afterSanitizeElements,H,null),!1)},nP=function(H,q,de){if(z&&(q==="id"||q==="name")&&(de in n||de in lV))return!1;if(!(m&&!y[q]&&ai(pe,q))){if(!(D&&ai(Xe,q))){if(!(T.attributeCheck instanceof Function&&T.attributeCheck(q,H))){if(!ke[q]||y[q]){if(!(iP(H)&&(g.tagNameCheck instanceof RegExp&&ai(g.tagNameCheck,H)||g.tagNameCheck instanceof Function&&g.tagNameCheck(H))&&(g.attributeNameCheck instanceof RegExp&&ai(g.attributeNameCheck,q)||g.attributeNameCheck instanceof Function&&g.attributeNameCheck(q,H))||q==="is"&&g.allowCustomizedBuiltInElements&&(g.tagNameCheck instanceof RegExp&&ai(g.tagNameCheck,de)||g.tagNameCheck instanceof Function&&g.tagNameCheck(de))))return!1}else if(!Bn[q]){if(!ai(Ae,Jh(de,Oe,""))){if(!((q==="src"||q==="xlink:href"||q==="href")&&H!=="script"&&i3(de,"data:")===0&&rt[H])){if(!(C&&!ai(xe,Jh(de,Oe,"")))){if(de)return!1}}}}}}}return!0},iP=function(H){return H!=="annotation-xml"&&QC(H,Re)},rP=function(H){ps(oe.beforeSanitizeAttributes,H,null);const{attributes:q}=H;if(!q||SC(H))return;const de={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ke,forceKeepAttr:void 0};let Ht=q.length;for(;Ht--;){const Xn=q[Ht],{name:pn,namespaceURI:Ei,value:ws}=Xn,qu=En(pn),RC=ws;let Un=pn==="value"?RC:r3(RC);if(de.attrName=qu,de.attrValue=Un,de.keepAttr=!0,de.forceKeepAttr=void 0,ps(oe.uponSanitizeAttribute,H,de),Un=de.attrValue,se&&(qu==="id"||qu==="name")&&(cl(pn,H),Un=Q+Un),E&&ai(/((--!?|])>)|<\/(style|title|textarea)/i,Un)){cl(pn,H);continue}if(qu==="attributename"&&QC(Un,"href")){cl(pn,H);continue}if(de.forceKeepAttr)continue;if(!de.keepAttr){cl(pn,H);continue}if(!S&&ai(/\/>/i,Un)){cl(pn,H);continue}x&&Ug([j,Z,re],sP=>{Un=Jh(Un,sP," ")});const oP=En(H.nodeName);if(!nP(oP,qu,Un)){cl(pn,H);continue}if(I&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!Ei)switch(f.getAttributeType(oP,qu)){case"TrustedHTML":{Un=I.createHTML(Un);break}case"TrustedScriptURL":{Un=I.createScriptURL(Un);break}}if(Un!==RC)try{Ei?H.setAttributeNS(Ei,pn,Un):H.setAttribute(pn,Un),SC(H)?bo(H):SI(e.removed)}catch{cl(pn,H)}}ps(oe.afterSanitizeAttributes,H,null)},cV=function we(H){let q=null;const de=QM(H);for(ps(oe.beforeSanitizeShadowDOM,H,null);q=de.nextNode();)ps(oe.uponSanitizeShadowNode,q,null),tP(q),rP(q),q.content instanceof o&&we(q.content);ps(oe.afterSanitizeShadowDOM,H,null)};return e.sanitize=function(we){let H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},q=null,de=null,Ht=null,Xn=null;if(Je=!we,Je&&(we="<!-->"),typeof we!="string"&&!eP(we))if(typeof we.toString=="function"){if(we=we.toString(),typeof we!="string")throw Qh("dirty is not a string, aborting")}else throw Qh("toString is not a function");if(!e.isSupported)return we;if(N||bC(H),e.removed=[],typeof we=="string"&&(Be=!1),Be){if(we.nodeName){const ws=En(we.nodeName);if(!Ze[ws]||w[ws])throw Qh("root node is forbidden and cannot be sanitized in-place")}}else if(we instanceof a)q=JM("<!---->"),de=q.ownerDocument.importNode(we,!0),de.nodeType===td.element&&de.nodeName==="BODY"||de.nodeName==="HTML"?q=de:q.appendChild(de);else{if(!A&&!x&&!R&&we.indexOf("<")===-1)return I&&V?I.createHTML(we):we;if(q=JM(we),!q)return A?null:V?W:""}q&&M&&bo(q.firstChild);const pn=QM(Be?we:q);for(;Ht=pn.nextNode();)tP(Ht),rP(Ht),Ht.content instanceof o&&cV(Ht.content);if(Be)return we;if(A){if(L)for(Xn=Y.call(q.ownerDocument);q.firstChild;)Xn.appendChild(q.firstChild);else Xn=q;return(ke.shadowroot||ke.shadowrootmode)&&(Xn=U.call(i,Xn,!0)),Xn}let Ei=R?q.outerHTML:q.innerHTML;return R&&Ze["!doctype"]&&q.ownerDocument&&q.ownerDocument.doctype&&q.ownerDocument.doctype.name&&ai(NN,q.ownerDocument.doctype.name)&&(Ei="<!DOCTYPE "+q.ownerDocument.doctype.name+`>
`+Ei),x&&Ug([j,Z,re],ws=>{Ei=Jh(Ei,ws," ")}),I&&V?I.createHTML(Ei):Ei},e.setConfig=function(){let we=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};bC(we),N=!0},e.clearConfig=function(){Xu=null,N=!1},e.isValidAttribute=function(we,H,q){Xu||bC({});const de=En(we),Ht=En(H);return nP(de,Ht,q)},e.addHook=function(we,H){typeof H=="function"&&Zh(oe[we],H)},e.removeHook=function(we,H){if(H!==void 0){const q=t3(oe[we],H);return q===-1?void 0:n3(oe[we],q,1)[0]}return SI(oe[we])},e.removeHooks=function(we){oe[we]=[]},e.removeAllHooks=function(){oe=PI()},e}var C3=DN();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var $N;function K(){return $N.apply(null,arguments)}function y3(t){$N=t}function fo(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function yu(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function st(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function qE(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(st(t,e))return!1;return!0}function Hi(t){return t===void 0}function Qs(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function fg(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function kN(t,e){var n=[],i,r=t.length;for(i=0;i<r;++i)n.push(e(t[i],i));return n}function za(t,e){for(var n in e)st(e,n)&&(t[n]=e[n]);return st(e,"toString")&&(t.toString=e.toString),st(e,"valueOf")&&(t.valueOf=e.valueOf),t}function ds(t,e,n,i){return sD(t,e,n,i,!0).utc()}function b3(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function De(t){return t._pf==null&&(t._pf=b3()),t._pf}var cR;Array.prototype.some?cR=Array.prototype.some:cR=function(t){var e=Object(this),n=e.length>>>0,i;for(i=0;i<n;i++)if(i in e&&t.call(this,e[i],i,e))return!0;return!1};function ZE(t){var e=null,n=!1,i=t._d&&!isNaN(t._d.getTime());if(i&&(e=De(t),n=cR.call(e.parsedDateParts,function(r){return r!=null}),i=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(i=i&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=i;else return i;return t._isValid}function Mv(t){var e=ds(NaN);return t!=null?za(De(e),t):De(e).userInvalidated=!0,e}var II=K.momentProperties=[],ry=!1;function JE(t,e){var n,i,r,o=II.length;if(Hi(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Hi(e._i)||(t._i=e._i),Hi(e._f)||(t._f=e._f),Hi(e._l)||(t._l=e._l),Hi(e._strict)||(t._strict=e._strict),Hi(e._tzm)||(t._tzm=e._tzm),Hi(e._isUTC)||(t._isUTC=e._isUTC),Hi(e._offset)||(t._offset=e._offset),Hi(e._pf)||(t._pf=De(e)),Hi(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)i=II[n],r=e[i],Hi(r)||(t[i]=r);return t}function gg(t){JE(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),ry===!1&&(ry=!0,K.updateOffset(this),ry=!1)}function go(t){return t instanceof gg||t!=null&&t._isAMomentObject!=null}function LN(t){K.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Lr(t,e){var n=!0;return za(function(){if(K.deprecationHandler!=null&&K.deprecationHandler(null,t),n){var i=[],r,o,s,a=arguments.length;for(o=0;o<a;o++){if(r="",typeof arguments[o]=="object"){r+=`
[`+o+"] ";for(s in arguments[0])st(arguments[0],s)&&(r+=s+": "+arguments[0][s]+", ");r=r.slice(0,-2)}else r=arguments[o];i.push(r)}LN(t+`
Arguments: `+Array.prototype.slice.call(i).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var xI={};function FN(t,e){K.deprecationHandler!=null&&K.deprecationHandler(t,e),xI[t]||(LN(e),xI[t]=!0)}K.suppressDeprecationWarnings=!1;K.deprecationHandler=null;function fs(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function S3(t){var e,n;for(n in t)st(t,n)&&(e=t[n],fs(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function hR(t,e){var n=za({},t),i;for(i in e)st(e,i)&&(yu(t[i])&&yu(e[i])?(n[i]={},za(n[i],t[i]),za(n[i],e[i])):e[i]!=null?n[i]=e[i]:delete n[i]);for(i in t)st(t,i)&&!st(e,i)&&yu(t[i])&&(n[i]=za({},n[i]));return n}function QE(t){t!=null&&this.set(t)}var dR;Object.keys?dR=Object.keys:dR=function(t){var e,n=[];for(e in t)st(t,e)&&n.push(e);return n};var R3={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function E3(t,e,n){var i=this._calendar[t]||this._calendar.sameElse;return fs(i)?i.call(e,n):i}function as(t,e,n){var i=""+Math.abs(t),r=e-i.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+i}var e0=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Yg=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,oy={},hh={};function ve(t,e,n,i){var r=i;typeof i=="string"&&(r=function(){return this[i]()}),t&&(hh[t]=r),e&&(hh[e[0]]=function(){return as(r.apply(this,arguments),e[1],e[2])}),n&&(hh[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),t)})}function T3(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function _3(t){var e=t.match(e0),n,i;for(n=0,i=e.length;n<i;n++)hh[e[n]]?e[n]=hh[e[n]]:e[n]=T3(e[n]);return function(r){var o="",s;for(s=0;s<i;s++)o+=fs(e[s])?e[s].call(r,t):e[s];return o}}function Dp(t,e){return t.isValid()?(e=VN(e,t.localeData()),oy[e]=oy[e]||_3(e),oy[e](t)):t.localeData().invalidDate()}function VN(t,e){var n=5;function i(r){return e.longDateFormat(r)||r}for(Yg.lastIndex=0;n>=0&&Yg.test(t);)t=t.replace(Yg,i),Yg.lastIndex=0,n-=1;return t}var M3={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function P3(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(e0).map(function(i){return i==="MMMM"||i==="MM"||i==="DD"||i==="dddd"?i.slice(1):i}).join(""),this._longDateFormat[t])}var I3="Invalid date";function x3(){return this._invalidDate}var O3="%d",A3=/\d{1,2}/;function H3(t){return this._ordinal.replace("%d",t)}var N3={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function D3(t,e,n,i){var r=this._relativeTime[n];return fs(r)?r(t,e,n,i):r.replace(/%d/i,t)}function $3(t,e){var n=this._relativeTime[t>0?"future":"past"];return fs(n)?n(e):n.replace(/%s/i,e)}var OI={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Fr(t){return typeof t=="string"?OI[t]||OI[t.toLowerCase()]:void 0}function t0(t){var e={},n,i;for(i in t)st(t,i)&&(n=Fr(i),n&&(e[n]=t[i]));return e}var k3={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function L3(t){var e=[],n;for(n in t)st(t,n)&&e.push({unit:n,priority:k3[n]});return e.sort(function(i,r){return i.priority-r.priority}),e}var WN=/\d/,gr=/\d\d/,BN=/\d{3}/,n0=/\d{4}/,Pv=/[+-]?\d{6}/,At=/\d\d?/,jN=/\d\d\d\d?/,UN=/\d\d\d\d\d\d?/,Iv=/\d{1,3}/,i0=/\d{1,4}/,xv=/[+-]?\d{1,6}/,kh=/\d+/,Ov=/[+-]?\d+/,F3=/Z|[+-]\d\d:?\d\d/gi,Av=/Z|[+-]\d\d(?::?\d\d)?/gi,V3=/[+-]?\d+(\.\d{1,3})?/,mg=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Lh=/^[1-9]\d?/,r0=/^([1-9]\d|\d)/,dw;dw={};function ue(t,e,n){dw[t]=fs(e)?e:function(i,r){return i&&n?n:e}}function W3(t,e){return st(dw,t)?dw[t](e._strict,e._locale):new RegExp(B3(t))}function B3(t){return Ks(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,i,r,o){return n||i||r||o}))}function Ks(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Or(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Qe(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Or(e)),n}var fR={};function yt(t,e){var n,i=e,r;for(typeof t=="string"&&(t=[t]),Qs(e)&&(i=function(o,s){s[e]=Qe(o)}),r=t.length,n=0;n<r;n++)fR[t[n]]=i}function pg(t,e){yt(t,function(n,i,r,o){r._w=r._w||{},e(n,r._w,r,o)})}function j3(t,e,n){e!=null&&st(fR,t)&&fR[t](e,n._a,n,t)}function Hv(t){return t%4===0&&t%100!==0||t%400===0}var si=0,Ws=1,Qo=2,xn=3,co=4,Bs=5,uu=6,U3=7,z3=8;ve("Y",0,0,function(){var t=this.year();return t<=9999?as(t,4):"+"+t});ve(0,["YY",2],0,function(){return this.year()%100});ve(0,["YYYY",4],0,"year");ve(0,["YYYYY",5],0,"year");ve(0,["YYYYYY",6,!0],0,"year");ue("Y",Ov);ue("YY",At,gr);ue("YYYY",i0,n0);ue("YYYYY",xv,Pv);ue("YYYYYY",xv,Pv);yt(["YYYYY","YYYYYY"],si);yt("YYYY",function(t,e){e[si]=t.length===2?K.parseTwoDigitYear(t):Qe(t)});yt("YY",function(t,e){e[si]=K.parseTwoDigitYear(t)});yt("Y",function(t,e){e[si]=parseInt(t,10)});function hf(t){return Hv(t)?366:365}K.parseTwoDigitYear=function(t){return Qe(t)+(Qe(t)>68?1900:2e3)};var zN=Fh("FullYear",!0);function Y3(){return Hv(this.year())}function Fh(t,e){return function(n){return n!=null?(YN(this,t,n),K.updateOffset(this,e),this):$f(this,t)}}function $f(t,e){if(!t.isValid())return NaN;var n=t._d,i=t._isUTC;switch(e){case"Milliseconds":return i?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return i?n.getUTCSeconds():n.getSeconds();case"Minutes":return i?n.getUTCMinutes():n.getMinutes();case"Hours":return i?n.getUTCHours():n.getHours();case"Date":return i?n.getUTCDate():n.getDate();case"Day":return i?n.getUTCDay():n.getDay();case"Month":return i?n.getUTCMonth():n.getMonth();case"FullYear":return i?n.getUTCFullYear():n.getFullYear();default:return NaN}}function YN(t,e,n){var i,r,o,s,a;if(!(!t.isValid()||isNaN(n))){switch(i=t._d,r=t._isUTC,e){case"Milliseconds":return void(r?i.setUTCMilliseconds(n):i.setMilliseconds(n));case"Seconds":return void(r?i.setUTCSeconds(n):i.setSeconds(n));case"Minutes":return void(r?i.setUTCMinutes(n):i.setMinutes(n));case"Hours":return void(r?i.setUTCHours(n):i.setHours(n));case"Date":return void(r?i.setUTCDate(n):i.setDate(n));case"FullYear":break;default:return}o=n,s=t.month(),a=t.date(),a=a===29&&s===1&&!Hv(o)?28:a,r?i.setUTCFullYear(o,s,a):i.setFullYear(o,s,a)}}function G3(t){return t=Fr(t),fs(this[t])?this[t]():this}function K3(t,e){if(typeof t=="object"){t=t0(t);var n=L3(t),i,r=n.length;for(i=0;i<r;i++)this[n[i].unit](t[n[i].unit])}else if(t=Fr(t),fs(this[t]))return this[t](e);return this}function X3(t,e){return(t%e+e)%e}var ln;Array.prototype.indexOf?ln=Array.prototype.indexOf:ln=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function o0(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=X3(e,12);return t+=(e-n)/12,n===1?Hv(t)?29:28:31-n%7%2}ve("M",["MM",2],"Mo",function(){return this.month()+1});ve("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});ve("MMMM",0,0,function(t){return this.localeData().months(this,t)});ue("M",At,Lh);ue("MM",At,gr);ue("MMM",function(t,e){return e.monthsShortRegex(t)});ue("MMMM",function(t,e){return e.monthsRegex(t)});yt(["M","MM"],function(t,e){e[Ws]=Qe(t)-1});yt(["MMM","MMMM"],function(t,e,n,i){var r=n._locale.monthsParse(t,i,n._strict);r!=null?e[Ws]=r:De(n).invalidMonth=t});var q3="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),GN="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),KN=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Z3=mg,J3=mg;function Q3(t,e){return t?fo(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||KN).test(e)?"format":"standalone"][t.month()]:fo(this._months)?this._months:this._months.standalone}function e4(t,e){return t?fo(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[KN.test(e)?"format":"standalone"][t.month()]:fo(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function t4(t,e,n){var i,r,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)o=ds([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(r=ln.call(this._shortMonthsParse,s),r!==-1?r:null):(r=ln.call(this._longMonthsParse,s),r!==-1?r:null):e==="MMM"?(r=ln.call(this._shortMonthsParse,s),r!==-1?r:(r=ln.call(this._longMonthsParse,s),r!==-1?r:null)):(r=ln.call(this._longMonthsParse,s),r!==-1?r:(r=ln.call(this._shortMonthsParse,s),r!==-1?r:null))}function n4(t,e,n){var i,r,o;if(this._monthsParseExact)return t4.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(r=ds([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),!n&&!this._monthsParse[i]&&(o="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[i].test(t))return i;if(n&&e==="MMM"&&this._shortMonthsParse[i].test(t))return i;if(!n&&this._monthsParse[i].test(t))return i}}function XN(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Qe(e);else if(e=t.localeData().monthsParse(e),!Qs(e))return t}var n=e,i=t.date();return i=i<29?i:Math.min(i,o0(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,i):t._d.setMonth(n,i),t}function qN(t){return t!=null?(XN(this,t),K.updateOffset(this,!0),this):$f(this,"Month")}function i4(){return o0(this.year(),this.month())}function r4(t){return this._monthsParseExact?(st(this,"_monthsRegex")||ZN.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(st(this,"_monthsShortRegex")||(this._monthsShortRegex=Z3),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function o4(t){return this._monthsParseExact?(st(this,"_monthsRegex")||ZN.call(this),t?this._monthsStrictRegex:this._monthsRegex):(st(this,"_monthsRegex")||(this._monthsRegex=J3),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function ZN(){function t(l,u){return u.length-l.length}var e=[],n=[],i=[],r,o,s,a;for(r=0;r<12;r++)o=ds([2e3,r]),s=Ks(this.monthsShort(o,"")),a=Ks(this.months(o,"")),e.push(s),n.push(a),i.push(a),i.push(s);e.sort(t),n.sort(t),i.sort(t),this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function s4(t,e,n,i,r,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,i,r,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,i,r,o,s),a}function kf(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function fw(t,e,n){var i=7+e-n,r=(7+kf(t,0,i).getUTCDay()-e)%7;return-r+i-1}function JN(t,e,n,i,r){var o=(7+n-i)%7,s=fw(t,i,r),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=hf(l)+a):a>hf(t)?(l=t+1,u=a-hf(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Lf(t,e,n){var i=fw(t.year(),e,n),r=Math.floor((t.dayOfYear()-i-1)/7)+1,o,s;return r<1?(s=t.year()-1,o=r+Xs(s,e,n)):r>Xs(t.year(),e,n)?(o=r-Xs(t.year(),e,n),s=t.year()+1):(s=t.year(),o=r),{week:o,year:s}}function Xs(t,e,n){var i=fw(t,e,n),r=fw(t+1,e,n);return(hf(t)-i+r)/7}ve("w",["ww",2],"wo","week");ve("W",["WW",2],"Wo","isoWeek");ue("w",At,Lh);ue("ww",At,gr);ue("W",At,Lh);ue("WW",At,gr);pg(["w","ww","W","WW"],function(t,e,n,i){e[i.substr(0,1)]=Qe(t)});function a4(t){return Lf(t,this._week.dow,this._week.doy).week}var l4={dow:0,doy:6};function u4(){return this._week.dow}function c4(){return this._week.doy}function h4(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function d4(t){var e=Lf(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}ve("d",0,"do","day");ve("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});ve("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});ve("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});ve("e",0,0,"weekday");ve("E",0,0,"isoWeekday");ue("d",At);ue("e",At);ue("E",At);ue("dd",function(t,e){return e.weekdaysMinRegex(t)});ue("ddd",function(t,e){return e.weekdaysShortRegex(t)});ue("dddd",function(t,e){return e.weekdaysRegex(t)});pg(["dd","ddd","dddd"],function(t,e,n,i){var r=n._locale.weekdaysParse(t,i,n._strict);r!=null?e.d=r:De(n).invalidWeekday=t});pg(["d","e","E"],function(t,e,n,i){e[i]=Qe(t)});function f4(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function g4(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function s0(t,e){return t.slice(e,7).concat(t.slice(0,e))}var m4="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),QN="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),p4="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),w4=mg,v4=mg,C4=mg;function y4(t,e){var n=fo(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?s0(n,this._week.dow):t?n[t.day()]:n}function b4(t){return t===!0?s0(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function S4(t){return t===!0?s0(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function R4(t,e,n){var i,r,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)o=ds([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(r=ln.call(this._weekdaysParse,s),r!==-1?r:null):e==="ddd"?(r=ln.call(this._shortWeekdaysParse,s),r!==-1?r:null):(r=ln.call(this._minWeekdaysParse,s),r!==-1?r:null):e==="dddd"?(r=ln.call(this._weekdaysParse,s),r!==-1||(r=ln.call(this._shortWeekdaysParse,s),r!==-1)?r:(r=ln.call(this._minWeekdaysParse,s),r!==-1?r:null)):e==="ddd"?(r=ln.call(this._shortWeekdaysParse,s),r!==-1||(r=ln.call(this._weekdaysParse,s),r!==-1)?r:(r=ln.call(this._minWeekdaysParse,s),r!==-1?r:null)):(r=ln.call(this._minWeekdaysParse,s),r!==-1||(r=ln.call(this._weekdaysParse,s),r!==-1)?r:(r=ln.call(this._shortWeekdaysParse,s),r!==-1?r:null))}function E4(t,e,n){var i,r,o;if(this._weekdaysParseExact)return R4.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(r=ds([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(r,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(r,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(r,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(o="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[i]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[i].test(t))return i;if(n&&e==="ddd"&&this._shortWeekdaysParse[i].test(t))return i;if(n&&e==="dd"&&this._minWeekdaysParse[i].test(t))return i;if(!n&&this._weekdaysParse[i].test(t))return i}}function T4(t){if(!this.isValid())return t!=null?this:NaN;var e=$f(this,"Day");return t!=null?(t=f4(t,this.localeData()),this.add(t-e,"d")):e}function _4(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function M4(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=g4(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function P4(t){return this._weekdaysParseExact?(st(this,"_weekdaysRegex")||a0.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(st(this,"_weekdaysRegex")||(this._weekdaysRegex=w4),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function I4(t){return this._weekdaysParseExact?(st(this,"_weekdaysRegex")||a0.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(st(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=v4),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function x4(t){return this._weekdaysParseExact?(st(this,"_weekdaysRegex")||a0.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(st(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=C4),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function a0(){function t(c,h){return h.length-c.length}var e=[],n=[],i=[],r=[],o,s,a,l,u;for(o=0;o<7;o++)s=ds([2e3,1]).day(o),a=Ks(this.weekdaysMin(s,"")),l=Ks(this.weekdaysShort(s,"")),u=Ks(this.weekdays(s,"")),e.push(a),n.push(l),i.push(u),r.push(a),r.push(l),r.push(u);e.sort(t),n.sort(t),i.sort(t),r.sort(t),this._weekdaysRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function l0(){return this.hours()%12||12}function O4(){return this.hours()||24}ve("H",["HH",2],0,"hour");ve("h",["hh",2],0,l0);ve("k",["kk",2],0,O4);ve("hmm",0,0,function(){return""+l0.apply(this)+as(this.minutes(),2)});ve("hmmss",0,0,function(){return""+l0.apply(this)+as(this.minutes(),2)+as(this.seconds(),2)});ve("Hmm",0,0,function(){return""+this.hours()+as(this.minutes(),2)});ve("Hmmss",0,0,function(){return""+this.hours()+as(this.minutes(),2)+as(this.seconds(),2)});function eD(t,e){ve(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}eD("a",!0);eD("A",!1);function tD(t,e){return e._meridiemParse}ue("a",tD);ue("A",tD);ue("H",At,r0);ue("h",At,Lh);ue("k",At,Lh);ue("HH",At,gr);ue("hh",At,gr);ue("kk",At,gr);ue("hmm",jN);ue("hmmss",UN);ue("Hmm",jN);ue("Hmmss",UN);yt(["H","HH"],xn);yt(["k","kk"],function(t,e,n){var i=Qe(t);e[xn]=i===24?0:i});yt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});yt(["h","hh"],function(t,e,n){e[xn]=Qe(t),De(n).bigHour=!0});yt("hmm",function(t,e,n){var i=t.length-2;e[xn]=Qe(t.substr(0,i)),e[co]=Qe(t.substr(i)),De(n).bigHour=!0});yt("hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[xn]=Qe(t.substr(0,i)),e[co]=Qe(t.substr(i,2)),e[Bs]=Qe(t.substr(r)),De(n).bigHour=!0});yt("Hmm",function(t,e,n){var i=t.length-2;e[xn]=Qe(t.substr(0,i)),e[co]=Qe(t.substr(i))});yt("Hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[xn]=Qe(t.substr(0,i)),e[co]=Qe(t.substr(i,2)),e[Bs]=Qe(t.substr(r))});function A4(t){return(t+"").toLowerCase().charAt(0)==="p"}var H4=/[ap]\.?m?\.?/i,N4=Fh("Hours",!0);function D4(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var nD={calendar:R3,longDateFormat:M3,invalidDate:I3,ordinal:O3,dayOfMonthOrdinalParse:A3,relativeTime:N3,months:q3,monthsShort:GN,week:l4,weekdays:m4,weekdaysMin:p4,weekdaysShort:QN,meridiemParse:H4},Lt={},nd={},Ff;function $4(t,e){var n,i=Math.min(t.length,e.length);for(n=0;n<i;n+=1)if(t[n]!==e[n])return n;return i}function AI(t){return t&&t.toLowerCase().replace("_","-")}function k4(t){for(var e=0,n,i,r,o;e<t.length;){for(o=AI(t[e]).split("-"),n=o.length,i=AI(t[e+1]),i=i?i.split("-"):null;n>0;){if(r=Nv(o.slice(0,n).join("-")),r)return r;if(i&&i.length>=n&&$4(o,i)>=n-1)break;n--}e++}return Ff}function L4(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Nv(t){var e=null,n;if(Lt[t]===void 0&&typeof module<"u"&&module&&module.exports&&L4(t))try{e=Ff._abbr,n=require,n("./locale/"+t),Ja(e)}catch{Lt[t]=null}return Lt[t]}function Ja(t,e){var n;return t&&(Hi(e)?n=oa(t):n=u0(t,e),n?Ff=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Ff._abbr}function u0(t,e){if(e!==null){var n,i=nD;if(e.abbr=t,Lt[t]!=null)FN("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=Lt[t]._config;else if(e.parentLocale!=null)if(Lt[e.parentLocale]!=null)i=Lt[e.parentLocale]._config;else if(n=Nv(e.parentLocale),n!=null)i=n._config;else return nd[e.parentLocale]||(nd[e.parentLocale]=[]),nd[e.parentLocale].push({name:t,config:e}),null;return Lt[t]=new QE(hR(i,e)),nd[t]&&nd[t].forEach(function(r){u0(r.name,r.config)}),Ja(t),Lt[t]}else return delete Lt[t],null}function F4(t,e){if(e!=null){var n,i,r=nD;Lt[t]!=null&&Lt[t].parentLocale!=null?Lt[t].set(hR(Lt[t]._config,e)):(i=Nv(t),i!=null&&(r=i._config),e=hR(r,e),i==null&&(e.abbr=t),n=new QE(e),n.parentLocale=Lt[t],Lt[t]=n),Ja(t)}else Lt[t]!=null&&(Lt[t].parentLocale!=null?(Lt[t]=Lt[t].parentLocale,t===Ja()&&Ja(t)):Lt[t]!=null&&delete Lt[t]);return Lt[t]}function oa(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Ff;if(!fo(t)){if(e=Nv(t),e)return e;t=[t]}return k4(t)}function V4(){return dR(Lt)}function c0(t){var e,n=t._a;return n&&De(t).overflow===-2&&(e=n[Ws]<0||n[Ws]>11?Ws:n[Qo]<1||n[Qo]>o0(n[si],n[Ws])?Qo:n[xn]<0||n[xn]>24||n[xn]===24&&(n[co]!==0||n[Bs]!==0||n[uu]!==0)?xn:n[co]<0||n[co]>59?co:n[Bs]<0||n[Bs]>59?Bs:n[uu]<0||n[uu]>999?uu:-1,De(t)._overflowDayOfYear&&(e<si||e>Qo)&&(e=Qo),De(t)._overflowWeeks&&e===-1&&(e=U3),De(t)._overflowWeekday&&e===-1&&(e=z3),De(t).overflow=e),t}var W4=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,B4=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,j4=/Z|[+-]\d\d(?::?\d\d)?/,Gg=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],sy=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],U4=/^\/?Date\((-?\d+)/i,z4=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Y4={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function iD(t){var e,n,i=t._i,r=W4.exec(i)||B4.exec(i),o,s,a,l,u=Gg.length,c=sy.length;if(r){for(De(t).iso=!0,e=0,n=u;e<n;e++)if(Gg[e][1].exec(r[1])){s=Gg[e][0],o=Gg[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(r[3]){for(e=0,n=c;e<n;e++)if(sy[e][1].exec(r[3])){a=(r[2]||" ")+sy[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(r[4])if(j4.exec(r[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),d0(t)}else t._isValid=!1}function G4(t,e,n,i,r,o){var s=[K4(t),GN.indexOf(e),parseInt(n,10),parseInt(i,10),parseInt(r,10)];return o&&s.push(parseInt(o,10)),s}function K4(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function X4(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function q4(t,e,n){if(t){var i=QN.indexOf(t),r=new Date(e[0],e[1],e[2]).getDay();if(i!==r)return De(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function Z4(t,e,n){if(t)return Y4[t];if(e)return 0;var i=parseInt(n,10),r=i%100,o=(i-r)/100;return o*60+r}function rD(t){var e=z4.exec(X4(t._i)),n;if(e){if(n=G4(e[4],e[3],e[2],e[5],e[6],e[7]),!q4(e[1],n,t))return;t._a=n,t._tzm=Z4(e[8],e[9],e[10]),t._d=kf.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),De(t).rfc2822=!0}else t._isValid=!1}function J4(t){var e=U4.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(iD(t),t._isValid===!1)delete t._isValid;else return;if(rD(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:K.createFromInputFallback(t)}K.createFromInputFallback=Lr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function jc(t,e,n){return t??e??n}function Q4(t){var e=new Date(K.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function h0(t){var e,n,i=[],r,o,s;if(!t._d){for(r=Q4(t),t._w&&t._a[Qo]==null&&t._a[Ws]==null&&eX(t),t._dayOfYear!=null&&(s=jc(t._a[si],r[si]),(t._dayOfYear>hf(s)||t._dayOfYear===0)&&(De(t)._overflowDayOfYear=!0),n=kf(s,0,t._dayOfYear),t._a[Ws]=n.getUTCMonth(),t._a[Qo]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=i[e]=r[e];for(;e<7;e++)t._a[e]=i[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[xn]===24&&t._a[co]===0&&t._a[Bs]===0&&t._a[uu]===0&&(t._nextDay=!0,t._a[xn]=0),t._d=(t._useUTC?kf:s4).apply(null,i),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[xn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(De(t).weekdayMismatch=!0)}}function eX(t){var e,n,i,r,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=jc(e.GG,t._a[si],Lf(Ot(),1,4).year),i=jc(e.W,1),r=jc(e.E,1),(r<1||r>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Lf(Ot(),o,s),n=jc(e.gg,t._a[si],u.year),i=jc(e.w,u.week),e.d!=null?(r=e.d,(r<0||r>6)&&(l=!0)):e.e!=null?(r=e.e+o,(e.e<0||e.e>6)&&(l=!0)):r=o),i<1||i>Xs(n,o,s)?De(t)._overflowWeeks=!0:l!=null?De(t)._overflowWeekday=!0:(a=JN(n,i,r,o,s),t._a[si]=a.year,t._dayOfYear=a.dayOfYear)}K.ISO_8601=function(){};K.RFC_2822=function(){};function d0(t){if(t._f===K.ISO_8601){iD(t);return}if(t._f===K.RFC_2822){rD(t);return}t._a=[],De(t).empty=!0;var e=""+t._i,n,i,r,o,s,a=e.length,l=0,u,c;for(r=VN(t._f,t._locale).match(e0)||[],c=r.length,n=0;n<c;n++)o=r[n],i=(e.match(W3(o,t))||[])[0],i&&(s=e.substr(0,e.indexOf(i)),s.length>0&&De(t).unusedInput.push(s),e=e.slice(e.indexOf(i)+i.length),l+=i.length),hh[o]?(i?De(t).empty=!1:De(t).unusedTokens.push(o),j3(o,i,t)):t._strict&&!i&&De(t).unusedTokens.push(o);De(t).charsLeftOver=a-l,e.length>0&&De(t).unusedInput.push(e),t._a[xn]<=12&&De(t).bigHour===!0&&t._a[xn]>0&&(De(t).bigHour=void 0),De(t).parsedDateParts=t._a.slice(0),De(t).meridiem=t._meridiem,t._a[xn]=tX(t._locale,t._a[xn],t._meridiem),u=De(t).era,u!==null&&(t._a[si]=t._locale.erasConvertYear(u,t._a[si])),h0(t),c0(t)}function tX(t,e,n){var i;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(i=t.isPM(n),i&&e<12&&(e+=12),!i&&e===12&&(e=0)),e)}function nX(t){var e,n,i,r,o,s,a=!1,l=t._f.length;if(l===0){De(t).invalidFormat=!0,t._d=new Date(NaN);return}for(r=0;r<l;r++)o=0,s=!1,e=JE({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[r],d0(e),ZE(e)&&(s=!0),o+=De(e).charsLeftOver,o+=De(e).unusedTokens.length*10,De(e).score=o,a?o<i&&(i=o,n=e):(i==null||o<i||s)&&(i=o,n=e,s&&(a=!0));za(t,n||e)}function iX(t){if(!t._d){var e=t0(t._i),n=e.day===void 0?e.date:e.day;t._a=kN([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(i){return i&&parseInt(i,10)}),h0(t)}}function rX(t){var e=new gg(c0(oD(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function oD(t){var e=t._i,n=t._f;return t._locale=t._locale||oa(t._l),e===null||n===void 0&&e===""?Mv({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),go(e)?new gg(c0(e)):(fg(e)?t._d=e:fo(n)?nX(t):n?d0(t):oX(t),ZE(t)||(t._d=null),t))}function oX(t){var e=t._i;Hi(e)?t._d=new Date(K.now()):fg(e)?t._d=new Date(e.valueOf()):typeof e=="string"?J4(t):fo(e)?(t._a=kN(e.slice(0),function(n){return parseInt(n,10)}),h0(t)):yu(e)?iX(t):Qs(e)?t._d=new Date(e):K.createFromInputFallback(t)}function sD(t,e,n,i,r){var o={};return(e===!0||e===!1)&&(i=e,e=void 0),(n===!0||n===!1)&&(i=n,n=void 0),(yu(t)&&qE(t)||fo(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=r,o._l=n,o._i=t,o._f=e,o._strict=i,rX(o)}function Ot(t,e,n,i){return sD(t,e,n,i,!1)}var sX=Lr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ot.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Mv()}),aX=Lr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ot.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Mv()});function aD(t,e){var n,i;if(e.length===1&&fo(e[0])&&(e=e[0]),!e.length)return Ot();for(n=e[0],i=1;i<e.length;++i)(!e[i].isValid()||e[i][t](n))&&(n=e[i]);return n}function lX(){var t=[].slice.call(arguments,0);return aD("isBefore",t)}function uX(){var t=[].slice.call(arguments,0);return aD("isAfter",t)}var cX=function(){return Date.now?Date.now():+new Date},id=["year","quarter","month","week","day","hour","minute","second","millisecond"];function hX(t){var e,n=!1,i,r=id.length;for(e in t)if(st(t,e)&&!(ln.call(id,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(i=0;i<r;++i)if(t[id[i]]){if(n)return!1;parseFloat(t[id[i]])!==Qe(t[id[i]])&&(n=!0)}return!0}function dX(){return this._isValid}function fX(){return Co(NaN)}function Dv(t){var e=t0(t),n=e.year||0,i=e.quarter||0,r=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=hX(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+r+i*3+n*12,this._data={},this._locale=oa(),this._bubble()}function $p(t){return t instanceof Dv}function gR(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function gX(t,e,n){var i=Math.min(t.length,e.length),r=Math.abs(t.length-e.length),o=0,s;for(s=0;s<i;s++)Qe(t[s])!==Qe(e[s])&&o++;return o+r}function lD(t,e){ve(t,0,0,function(){var n=this.utcOffset(),i="+";return n<0&&(n=-n,i="-"),i+as(~~(n/60),2)+e+as(~~n%60,2)})}lD("Z",":");lD("ZZ","");ue("Z",Av);ue("ZZ",Av);yt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=f0(Av,t)});var mX=/([\+\-]|\d\d)/gi;function f0(t,e){var n=(e||"").match(t),i,r,o;return n===null?null:(i=n[n.length-1]||[],r=(i+"").match(mX)||["-",0,0],o=+(r[1]*60)+Qe(r[2]),o===0?0:r[0]==="+"?o:-o)}function g0(t,e){var n,i;return e._isUTC?(n=e.clone(),i=(go(t)||fg(t)?t.valueOf():Ot(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),K.updateOffset(n,!1),n):Ot(t).local()}function mR(t){return-Math.round(t._d.getTimezoneOffset())}K.updateOffset=function(){};function pX(t,e,n){var i=this._offset||0,r;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=f0(Av,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(r=mR(this)),this._offset=t,this._isUTC=!0,r!=null&&this.add(r,"m"),i!==t&&(!e||this._changeInProgress?hD(this,Co(t-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,K.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?i:mR(this)}function wX(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function vX(t){return this.utcOffset(0,t)}function CX(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(mR(this),"m")),this}function yX(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=f0(F3,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function bX(t){return this.isValid()?(t=t?Ot(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function SX(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function RX(){if(!Hi(this._isDSTShifted))return this._isDSTShifted;var t={},e;return JE(t,this),t=oD(t),t._a?(e=t._isUTC?ds(t._a):Ot(t._a),this._isDSTShifted=this.isValid()&&gX(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function EX(){return this.isValid()?!this._isUTC:!1}function TX(){return this.isValid()?this._isUTC:!1}function uD(){return this.isValid()?this._isUTC&&this._offset===0:!1}var _X=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,MX=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Co(t,e){var n=t,i=null,r,o,s;return $p(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Qs(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(i=_X.exec(t))?(r=i[1]==="-"?-1:1,n={y:0,d:Qe(i[Qo])*r,h:Qe(i[xn])*r,m:Qe(i[co])*r,s:Qe(i[Bs])*r,ms:Qe(gR(i[uu]*1e3))*r}):(i=MX.exec(t))?(r=i[1]==="-"?-1:1,n={y:dl(i[2],r),M:dl(i[3],r),w:dl(i[4],r),d:dl(i[5],r),h:dl(i[6],r),m:dl(i[7],r),s:dl(i[8],r)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=PX(Ot(n.from),Ot(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new Dv(n),$p(t)&&st(t,"_locale")&&(o._locale=t._locale),$p(t)&&st(t,"_isValid")&&(o._isValid=t._isValid),o}Co.fn=Dv.prototype;Co.invalid=fX;function dl(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function HI(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function PX(t,e){var n;return t.isValid()&&e.isValid()?(e=g0(e,t),t.isBefore(e)?n=HI(t,e):(n=HI(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function cD(t,e){return function(n,i){var r,o;return i!==null&&!isNaN(+i)&&(FN(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=i,i=o),r=Co(n,i),hD(this,r,t),this}}function hD(t,e,n,i){var r=e._milliseconds,o=gR(e._days),s=gR(e._months);t.isValid()&&(i=i??!0,s&&XN(t,$f(t,"Month")+s*n),o&&YN(t,"Date",$f(t,"Date")+o*n),r&&t._d.setTime(t._d.valueOf()+r*n),i&&K.updateOffset(t,o||s))}var IX=cD(1,"add"),xX=cD(-1,"subtract");function dD(t){return typeof t=="string"||t instanceof String}function OX(t){return go(t)||fg(t)||dD(t)||Qs(t)||HX(t)||AX(t)||t===null||t===void 0}function AX(t){var e=yu(t)&&!qE(t),n=!1,i=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],r,o,s=i.length;for(r=0;r<s;r+=1)o=i[r],n=n||st(t,o);return e&&n}function HX(t){var e=fo(t),n=!1;return e&&(n=t.filter(function(i){return!Qs(i)&&dD(t)}).length===0),e&&n}function NX(t){var e=yu(t)&&!qE(t),n=!1,i=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],r,o;for(r=0;r<i.length;r+=1)o=i[r],n=n||st(t,o);return e&&n}function DX(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function $X(t,e){arguments.length===1&&(arguments[0]?OX(arguments[0])?(t=arguments[0],e=void 0):NX(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Ot(),i=g0(n,this).startOf("day"),r=K.calendarFormat(this,i)||"sameElse",o=e&&(fs(e[r])?e[r].call(this,n):e[r]);return this.format(o||this.localeData().calendar(r,this,Ot(n)))}function kX(){return new gg(this)}function LX(t,e){var n=go(t)?t:Ot(t);return this.isValid()&&n.isValid()?(e=Fr(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function FX(t,e){var n=go(t)?t:Ot(t);return this.isValid()&&n.isValid()?(e=Fr(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function VX(t,e,n,i){var r=go(t)?t:Ot(t),o=go(e)?e:Ot(e);return this.isValid()&&r.isValid()&&o.isValid()?(i=i||"()",(i[0]==="("?this.isAfter(r,n):!this.isBefore(r,n))&&(i[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function WX(t,e){var n=go(t)?t:Ot(t),i;return this.isValid()&&n.isValid()?(e=Fr(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(i=n.valueOf(),this.clone().startOf(e).valueOf()<=i&&i<=this.clone().endOf(e).valueOf())):!1}function BX(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function jX(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function UX(t,e,n){var i,r,o;if(!this.isValid())return NaN;if(i=g0(t,this),!i.isValid())return NaN;switch(r=(i.utcOffset()-this.utcOffset())*6e4,e=Fr(e),e){case"year":o=kp(this,i)/12;break;case"month":o=kp(this,i);break;case"quarter":o=kp(this,i)/3;break;case"second":o=(this-i)/1e3;break;case"minute":o=(this-i)/6e4;break;case"hour":o=(this-i)/36e5;break;case"day":o=(this-i-r)/864e5;break;case"week":o=(this-i-r)/6048e5;break;default:o=this-i}return n?o:Or(o)}function kp(t,e){if(t.date()<e.date())return-kp(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),i=t.clone().add(n,"months"),r,o;return e-i<0?(r=t.clone().add(n-1,"months"),o=(e-i)/(i-r)):(r=t.clone().add(n+1,"months"),o=(e-i)/(r-i)),-(n+o)||0}K.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";K.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function zX(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function YX(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Dp(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):fs(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Dp(n,"Z")):Dp(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function GX(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,i,r,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',i=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+i+r+o)}function KX(t){t||(t=this.isUtc()?K.defaultFormatUtc:K.defaultFormat);var e=Dp(this,t);return this.localeData().postformat(e)}function XX(t,e){return this.isValid()&&(go(t)&&t.isValid()||Ot(t).isValid())?Co({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function qX(t){return this.from(Ot(),t)}function ZX(t,e){return this.isValid()&&(go(t)&&t.isValid()||Ot(t).isValid())?Co({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function JX(t){return this.to(Ot(),t)}function fD(t){var e;return t===void 0?this._locale._abbr:(e=oa(t),e!=null&&(this._locale=e),this)}var gD=Lr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function mD(){return this._locale}var gw=1e3,dh=60*gw,mw=60*dh,pD=(365*400+97)*24*mw;function fh(t,e){return(t%e+e)%e}function wD(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-pD:new Date(t,e,n).valueOf()}function vD(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-pD:Date.UTC(t,e,n)}function QX(t){var e,n;if(t=Fr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?vD:wD,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=fh(e+(this._isUTC?0:this.utcOffset()*dh),mw);break;case"minute":e=this._d.valueOf(),e-=fh(e,dh);break;case"second":e=this._d.valueOf(),e-=fh(e,gw);break}return this._d.setTime(e),K.updateOffset(this,!0),this}function eq(t){var e,n;if(t=Fr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?vD:wD,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=mw-fh(e+(this._isUTC?0:this.utcOffset()*dh),mw)-1;break;case"minute":e=this._d.valueOf(),e+=dh-fh(e,dh)-1;break;case"second":e=this._d.valueOf(),e+=gw-fh(e,gw)-1;break}return this._d.setTime(e),K.updateOffset(this,!0),this}function tq(){return this._d.valueOf()-(this._offset||0)*6e4}function nq(){return Math.floor(this.valueOf()/1e3)}function iq(){return new Date(this.valueOf())}function rq(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function oq(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function sq(){return this.isValid()?this.toISOString():null}function aq(){return ZE(this)}function lq(){return za({},De(this))}function uq(){return De(this).overflow}function cq(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}ve("N",0,0,"eraAbbr");ve("NN",0,0,"eraAbbr");ve("NNN",0,0,"eraAbbr");ve("NNNN",0,0,"eraName");ve("NNNNN",0,0,"eraNarrow");ve("y",["y",1],"yo","eraYear");ve("y",["yy",2],0,"eraYear");ve("y",["yyy",3],0,"eraYear");ve("y",["yyyy",4],0,"eraYear");ue("N",m0);ue("NN",m0);ue("NNN",m0);ue("NNNN",bq);ue("NNNNN",Sq);yt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,i){var r=n._locale.erasParse(t,i,n._strict);r?De(n).era=r:De(n).invalidEra=t});ue("y",kh);ue("yy",kh);ue("yyy",kh);ue("yyyy",kh);ue("yo",Rq);yt(["y","yy","yyy","yyyy"],si);yt(["yo"],function(t,e,n,i){var r;n._locale._eraYearOrdinalRegex&&(r=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[si]=n._locale.eraYearOrdinalParse(t,r):e[si]=parseInt(t,10)});function hq(t,e){var n,i,r,o=this._eras||oa("en")._eras;for(n=0,i=o.length;n<i;++n){switch(typeof o[n].since){case"string":r=K(o[n].since).startOf("day"),o[n].since=r.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":r=K(o[n].until).startOf("day").valueOf(),o[n].until=r.valueOf();break}}return o}function dq(t,e,n){var i,r,o=this.eras(),s,a,l;for(t=t.toUpperCase(),i=0,r=o.length;i<r;++i)if(s=o[i].name.toUpperCase(),a=o[i].abbr.toUpperCase(),l=o[i].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[i];break;case"NNNN":if(s===t)return o[i];break;case"NNNNN":if(l===t)return o[i];break}else if([s,a,l].indexOf(t)>=0)return o[i]}function fq(t,e){var n=t.since<=t.until?1:-1;return e===void 0?K(t.since).year():K(t.since).year()+(e-t.offset)*n}function gq(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].name;return""}function mq(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].narrow;return""}function pq(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].abbr;return""}function wq(){var t,e,n,i,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=r[t].since<=r[t].until?1:-1,i=this.clone().startOf("day").valueOf(),r[t].since<=i&&i<=r[t].until||r[t].until<=i&&i<=r[t].since)return(this.year()-K(r[t].since).year())*n+r[t].offset;return this.year()}function vq(t){return st(this,"_erasNameRegex")||p0.call(this),t?this._erasNameRegex:this._erasRegex}function Cq(t){return st(this,"_erasAbbrRegex")||p0.call(this),t?this._erasAbbrRegex:this._erasRegex}function yq(t){return st(this,"_erasNarrowRegex")||p0.call(this),t?this._erasNarrowRegex:this._erasRegex}function m0(t,e){return e.erasAbbrRegex(t)}function bq(t,e){return e.erasNameRegex(t)}function Sq(t,e){return e.erasNarrowRegex(t)}function Rq(t,e){return e._eraYearOrdinalRegex||kh}function p0(){var t=[],e=[],n=[],i=[],r,o,s,a,l,u=this.eras();for(r=0,o=u.length;r<o;++r)s=Ks(u[r].name),a=Ks(u[r].abbr),l=Ks(u[r].narrow),e.push(s),t.push(a),n.push(l),i.push(s),i.push(a),i.push(l);this._erasRegex=new RegExp("^("+i.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}ve(0,["gg",2],0,function(){return this.weekYear()%100});ve(0,["GG",2],0,function(){return this.isoWeekYear()%100});function $v(t,e){ve(0,[t,t.length],0,e)}$v("gggg","weekYear");$v("ggggg","weekYear");$v("GGGG","isoWeekYear");$v("GGGGG","isoWeekYear");ue("G",Ov);ue("g",Ov);ue("GG",At,gr);ue("gg",At,gr);ue("GGGG",i0,n0);ue("gggg",i0,n0);ue("GGGGG",xv,Pv);ue("ggggg",xv,Pv);pg(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,i){e[i.substr(0,2)]=Qe(t)});pg(["gg","GG"],function(t,e,n,i){e[i]=K.parseTwoDigitYear(t)});function Eq(t){return CD.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function Tq(t){return CD.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function _q(){return Xs(this.year(),1,4)}function Mq(){return Xs(this.isoWeekYear(),1,4)}function Pq(){var t=this.localeData()._week;return Xs(this.year(),t.dow,t.doy)}function Iq(){var t=this.localeData()._week;return Xs(this.weekYear(),t.dow,t.doy)}function CD(t,e,n,i,r){var o;return t==null?Lf(this,i,r).year:(o=Xs(t,i,r),e>o&&(e=o),xq.call(this,t,e,n,i,r))}function xq(t,e,n,i,r){var o=JN(t,e,n,i,r),s=kf(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}ve("Q",0,"Qo","quarter");ue("Q",WN);yt("Q",function(t,e){e[Ws]=(Qe(t)-1)*3});function Oq(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}ve("D",["DD",2],"Do","date");ue("D",At,Lh);ue("DD",At,gr);ue("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});yt(["D","DD"],Qo);yt("Do",function(t,e){e[Qo]=Qe(t.match(At)[0])});var yD=Fh("Date",!0);ve("DDD",["DDDD",3],"DDDo","dayOfYear");ue("DDD",Iv);ue("DDDD",BN);yt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Qe(t)});function Aq(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}ve("m",["mm",2],0,"minute");ue("m",At,r0);ue("mm",At,gr);yt(["m","mm"],co);var Hq=Fh("Minutes",!1);ve("s",["ss",2],0,"second");ue("s",At,r0);ue("ss",At,gr);yt(["s","ss"],Bs);var Nq=Fh("Seconds",!1);ve("S",0,0,function(){return~~(this.millisecond()/100)});ve(0,["SS",2],0,function(){return~~(this.millisecond()/10)});ve(0,["SSS",3],0,"millisecond");ve(0,["SSSS",4],0,function(){return this.millisecond()*10});ve(0,["SSSSS",5],0,function(){return this.millisecond()*100});ve(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});ve(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});ve(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});ve(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ue("S",Iv,WN);ue("SS",Iv,gr);ue("SSS",Iv,BN);var Ya,bD;for(Ya="SSSS";Ya.length<=9;Ya+="S")ue(Ya,kh);function Dq(t,e){e[uu]=Qe(("0."+t)*1e3)}for(Ya="S";Ya.length<=9;Ya+="S")yt(Ya,Dq);bD=Fh("Milliseconds",!1);ve("z",0,0,"zoneAbbr");ve("zz",0,0,"zoneName");function $q(){return this._isUTC?"UTC":""}function kq(){return this._isUTC?"Coordinated Universal Time":""}var X=gg.prototype;X.add=IX;X.calendar=$X;X.clone=kX;X.diff=UX;X.endOf=eq;X.format=KX;X.from=XX;X.fromNow=qX;X.to=ZX;X.toNow=JX;X.get=G3;X.invalidAt=uq;X.isAfter=LX;X.isBefore=FX;X.isBetween=VX;X.isSame=WX;X.isSameOrAfter=BX;X.isSameOrBefore=jX;X.isValid=aq;X.lang=gD;X.locale=fD;X.localeData=mD;X.max=aX;X.min=sX;X.parsingFlags=lq;X.set=K3;X.startOf=QX;X.subtract=xX;X.toArray=rq;X.toObject=oq;X.toDate=iq;X.toISOString=YX;X.inspect=GX;typeof Symbol<"u"&&Symbol.for!=null&&(X[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});X.toJSON=sq;X.toString=zX;X.unix=nq;X.valueOf=tq;X.creationData=cq;X.eraName=gq;X.eraNarrow=mq;X.eraAbbr=pq;X.eraYear=wq;X.year=zN;X.isLeapYear=Y3;X.weekYear=Eq;X.isoWeekYear=Tq;X.quarter=X.quarters=Oq;X.month=qN;X.daysInMonth=i4;X.week=X.weeks=h4;X.isoWeek=X.isoWeeks=d4;X.weeksInYear=Pq;X.weeksInWeekYear=Iq;X.isoWeeksInYear=_q;X.isoWeeksInISOWeekYear=Mq;X.date=yD;X.day=X.days=T4;X.weekday=_4;X.isoWeekday=M4;X.dayOfYear=Aq;X.hour=X.hours=N4;X.minute=X.minutes=Hq;X.second=X.seconds=Nq;X.millisecond=X.milliseconds=bD;X.utcOffset=pX;X.utc=vX;X.local=CX;X.parseZone=yX;X.hasAlignedHourOffset=bX;X.isDST=SX;X.isLocal=EX;X.isUtcOffset=TX;X.isUtc=uD;X.isUTC=uD;X.zoneAbbr=$q;X.zoneName=kq;X.dates=Lr("dates accessor is deprecated. Use date instead.",yD);X.months=Lr("months accessor is deprecated. Use month instead",qN);X.years=Lr("years accessor is deprecated. Use year instead",zN);X.zone=Lr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",wX);X.isDSTShifted=Lr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",RX);function Lq(t){return Ot(t*1e3)}function Fq(){return Ot.apply(null,arguments).parseZone()}function SD(t){return t}var at=QE.prototype;at.calendar=E3;at.longDateFormat=P3;at.invalidDate=x3;at.ordinal=H3;at.preparse=SD;at.postformat=SD;at.relativeTime=D3;at.pastFuture=$3;at.set=S3;at.eras=hq;at.erasParse=dq;at.erasConvertYear=fq;at.erasAbbrRegex=Cq;at.erasNameRegex=vq;at.erasNarrowRegex=yq;at.months=Q3;at.monthsShort=e4;at.monthsParse=n4;at.monthsRegex=o4;at.monthsShortRegex=r4;at.week=a4;at.firstDayOfYear=c4;at.firstDayOfWeek=u4;at.weekdays=y4;at.weekdaysMin=S4;at.weekdaysShort=b4;at.weekdaysParse=E4;at.weekdaysRegex=P4;at.weekdaysShortRegex=I4;at.weekdaysMinRegex=x4;at.isPM=A4;at.meridiem=D4;function pw(t,e,n,i){var r=oa(),o=ds().set(i,e);return r[n](o,t)}function RD(t,e,n){if(Qs(t)&&(e=t,t=void 0),t=t||"",e!=null)return pw(t,e,n,"month");var i,r=[];for(i=0;i<12;i++)r[i]=pw(t,i,n,"month");return r}function w0(t,e,n,i){typeof t=="boolean"?(Qs(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Qs(e)&&(n=e,e=void 0),e=e||"");var r=oa(),o=t?r._week.dow:0,s,a=[];if(n!=null)return pw(e,(n+o)%7,i,"day");for(s=0;s<7;s++)a[s]=pw(e,(s+o)%7,i,"day");return a}function Vq(t,e){return RD(t,e,"months")}function Wq(t,e){return RD(t,e,"monthsShort")}function Bq(t,e,n){return w0(t,e,n,"weekdays")}function jq(t,e,n){return w0(t,e,n,"weekdaysShort")}function Uq(t,e,n){return w0(t,e,n,"weekdaysMin")}Ja("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Qe(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});K.lang=Lr("moment.lang is deprecated. Use moment.locale instead.",Ja);K.langData=Lr("moment.langData is deprecated. Use moment.localeData instead.",oa);var vs=Math.abs;function zq(){var t=this._data;return this._milliseconds=vs(this._milliseconds),this._days=vs(this._days),this._months=vs(this._months),t.milliseconds=vs(t.milliseconds),t.seconds=vs(t.seconds),t.minutes=vs(t.minutes),t.hours=vs(t.hours),t.months=vs(t.months),t.years=vs(t.years),this}function ED(t,e,n,i){var r=Co(e,n);return t._milliseconds+=i*r._milliseconds,t._days+=i*r._days,t._months+=i*r._months,t._bubble()}function Yq(t,e){return ED(this,t,e,1)}function Gq(t,e){return ED(this,t,e,-1)}function NI(t){return t<0?Math.floor(t):Math.ceil(t)}function Kq(){var t=this._milliseconds,e=this._days,n=this._months,i=this._data,r,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=NI(pR(n)+e)*864e5,e=0,n=0),i.milliseconds=t%1e3,r=Or(t/1e3),i.seconds=r%60,o=Or(r/60),i.minutes=o%60,s=Or(o/60),i.hours=s%24,e+=Or(s/24),l=Or(TD(e)),n+=l,e-=NI(pR(l)),a=Or(n/12),n%=12,i.days=e,i.months=n,i.years=a,this}function TD(t){return t*4800/146097}function pR(t){return t*146097/4800}function Xq(t){if(!this.isValid())return NaN;var e,n,i=this._milliseconds;if(t=Fr(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+i/864e5,n=this._months+TD(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(pR(this._months)),t){case"week":return e/7+i/6048e5;case"day":return e+i/864e5;case"hour":return e*24+i/36e5;case"minute":return e*1440+i/6e4;case"second":return e*86400+i/1e3;case"millisecond":return Math.floor(e*864e5)+i;default:throw new Error("Unknown unit "+t)}}function sa(t){return function(){return this.as(t)}}var _D=sa("ms"),qq=sa("s"),Zq=sa("m"),Jq=sa("h"),Qq=sa("d"),e6=sa("w"),t6=sa("M"),n6=sa("Q"),i6=sa("y"),r6=_D;function o6(){return Co(this)}function s6(t){return t=Fr(t),this.isValid()?this[t+"s"]():NaN}function ju(t){return function(){return this.isValid()?this._data[t]:NaN}}var a6=ju("milliseconds"),l6=ju("seconds"),u6=ju("minutes"),c6=ju("hours"),h6=ju("days"),d6=ju("months"),f6=ju("years");function g6(){return Or(this.days()/7)}var $s=Math.round,th={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function m6(t,e,n,i,r){return r.relativeTime(e||1,!!n,t,i)}function p6(t,e,n,i){var r=Co(t).abs(),o=$s(r.as("s")),s=$s(r.as("m")),a=$s(r.as("h")),l=$s(r.as("d")),u=$s(r.as("M")),c=$s(r.as("w")),h=$s(r.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=i,m6.apply(null,d)}function w6(t){return t===void 0?$s:typeof t=="function"?($s=t,!0):!1}function v6(t,e){return th[t]===void 0?!1:e===void 0?th[t]:(th[t]=e,t==="s"&&(th.ss=e-1),!0)}function C6(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,i=th,r,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(i=Object.assign({},th,e),e.s!=null&&e.ss==null&&(i.ss=e.s-1)),r=this.localeData(),o=p6(this,!n,i,r),n&&(o=r.pastFuture(+this,o)),r.postformat(o)}var ay=Math.abs;function Ju(t){return(t>0)-(t<0)||+t}function kv(){if(!this.isValid())return this.localeData().invalidDate();var t=ay(this._milliseconds)/1e3,e=ay(this._days),n=ay(this._months),i,r,o,s,a=this.asSeconds(),l,u,c,h;return a?(i=Or(t/60),r=Or(i/60),t%=60,i%=60,o=Or(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Ju(this._months)!==Ju(a)?"-":"",c=Ju(this._days)!==Ju(a)?"-":"",h=Ju(this._milliseconds)!==Ju(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(r||i||t?"T":"")+(r?h+r+"H":"")+(i?h+i+"M":"")+(t?h+s+"S":"")):"P0D"}var it=Dv.prototype;it.isValid=dX;it.abs=zq;it.add=Yq;it.subtract=Gq;it.as=Xq;it.asMilliseconds=_D;it.asSeconds=qq;it.asMinutes=Zq;it.asHours=Jq;it.asDays=Qq;it.asWeeks=e6;it.asMonths=t6;it.asQuarters=n6;it.asYears=i6;it.valueOf=r6;it._bubble=Kq;it.clone=o6;it.get=s6;it.milliseconds=a6;it.seconds=l6;it.minutes=u6;it.hours=c6;it.days=h6;it.weeks=g6;it.months=d6;it.years=f6;it.humanize=C6;it.toISOString=kv;it.toString=kv;it.toJSON=kv;it.locale=fD;it.localeData=mD;it.toIsoString=Lr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",kv);it.lang=gD;ve("X",0,0,"unix");ve("x",0,0,"valueOf");ue("x",Ov);ue("X",V3);yt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});yt("x",function(t,e,n){n._d=new Date(Qe(t))});//! moment.js
K.version="2.30.1";y3(Ot);K.fn=X;K.min=lX;K.max=uX;K.now=cX;K.utc=ds;K.unix=Lq;K.months=Vq;K.isDate=fg;K.locale=Ja;K.invalid=Mv;K.duration=Co;K.isMoment=go;K.weekdays=Bq;K.parseZone=Fq;K.localeData=oa;K.isDuration=$p;K.monthsShort=Wq;K.weekdaysMin=Uq;K.defineLocale=u0;K.updateLocale=F4;K.locales=V4;K.weekdaysShort=jq;K.normalizeUnits=Fr;K.relativeTimeRounding=w6;K.relativeTimeThreshold=v6;K.calendarFormat=DX;K.prototype=X;K.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};var y6=St,b6=$h,S6=Wi,R6=Rn,E6=hs,T6=Bi,_6=sl,M6=cg,P6=fn,MD=TypeError,PD=P6(function(){[].keys().reduce(function(){},void 0)}),ly=!PD&&_6("reduce",MD);y6({target:"Iterator",proto:!0,real:!0,forced:PD||ly},{reduce:function(e){R6(this);try{S6(e)}catch(s){T6(this,"throw",s)}var n=arguments.length<2,i=n?void 0:arguments[1];if(ly)return M6(ly,this,n?[e]:[e,i]);var r=E6(this),o=0;if(b6(r,function(s){n?(n=!1,i=s):i=e(i,s,o),o++},{IS_RECORD:!0}),n)throw new MD("Reduce of empty iterator with no initial value");return i}});function I6(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function DI(t,e){const n=e.length;let i=0;for(;i<n;)t.push(e[i]),i+=1}function Lp(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,i=t[0].length;for(let r=0;r<n;r++)for(let o=0;o<i;o++)e[o]||(e[o]=[]),e[o][r]=t[r][o];return e}function ji(t,e,n,i){let r=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r+=1;r<a;)s=e(s,o[r],r,o),r+=1;return s}function Tu(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length,o=[];let s=-1;for(;n<r;){const a=i[n];e(a,n,i)&&(s+=1,o[s]=a),n+=1}return o}function tt(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length,o=[];let s=-1;for(;n<r;){const a=i[n];s+=1,o[s]=e(a,n,i),n+=1}return o}function O(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length;for(;n<r&&e(i[n],n,i)!==!1;)n+=1;return t}function x6(t){const e=[];return O(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function $I(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=[...e];let o=i;return O(r,s=>{o=o.filter(a=>!s.includes(a))}),o}function kI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function nt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return ji(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function bh(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];const r=document.createElement("template");r.innerHTML=t.reduce((a,l,u)=>{var c;return a+l+((c=n[u])!==null&&c!==void 0?c:"")},"");const o=r.content.cloneNode(!0),s={};return o.querySelectorAll("[data-ref]").forEach(a=>{const l=a.getAttribute("data-ref");a.removeAttribute("data-ref"),s[l]=a}),{fragment:o,refs:s}}function Tt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function te(t){return typeof t<"u"}function xt(t){return typeof t>"u"}function rn(t){return t===null||t===""||xt(t)}function O6(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Qd="length",df=t=>parseInt(t,16),LI=t=>parseInt(t,10),ww=(t,e,n)=>t.substr(e,n),ff=t=>t.codePointAt(0)-65,wR=t=>`${t}`.replace(/\-/g,""),A6=t=>df(ww(wR(t),df("12"),ff("F")))/(df(ww(wR(t),ff("B"),~~![][Qd]))||9),H6=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let FI=!1;const VI={invalid:()=>nt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return nt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>nt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},WI={invalid:()=>nt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return nt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>nt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function N6(t,e){const n=!rn(t),i=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",r="16.2.0";let o,s="invalid",a="invalid";t=wR(t||"");const l=D6(t);if(n||i||l)if(l){const u=K("25/11/2025","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=A6(t);o=K((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else i?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(H6()&&(s="valid",a="valid"),!FI&&s!=="valid"&&(VI[s]({keyValidityDate:o,hotVersion:r})&&console[s==="non_commercial"?"info":"warn"](VI[s]({keyValidityDate:o,hotVersion:r})),FI=!0),a!=="valid"&&e&&WI[a]({keyValidityDate:o,hotVersion:r})){const c=document.createElement("div");c.className="handsontable hot-display-license-info",c.innerHTML=WI[a]({keyValidityDate:o,hotVersion:r}),e.appendChild(c)}}function D6(t){let e=[][Qd],n=e;if(t[Qd]!==ff("Z"))return!1;for(let i="",r="B<H4P+".split(""),o=ff(r.shift());o;o=ff(r.shift()||"A"))--o<""[Qd]?n=n|(LI(`${LI(df(i)+(df(ww(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:i=ww(t,o,o?r[Qd]===1?9:8:6);return n===e}function mo(t){return t[0].toUpperCase()+t.substr(1)}function ID(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function $6(t){if(typeof t!="string")return!1;try{const e=JSON.parse(t);return typeof e=="object"&&e!==null}catch{return!1}}function xD(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function v0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,i)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[i]===void 0?"":e[i])}function qs(t){return C0(`${t}`,{ALLOWED_TAGS:[]})}function C0(t,e){return C3.sanitize(t,e)}const po=t=>["tabindex",t],k6=()=>["role","treegrid"],js=()=>["role","presentation"],L6=()=>["role","gridcell"],F6=()=>["role","gridcell button"],V6=()=>["role","rowheader"],OD=()=>["role","rowgroup"],W6=()=>["role","columnheader"],AD=()=>["role","row"],B6=()=>["role","menu"],j6=()=>["role","menuitem"],U6=()=>["role","menuitemcheckbox"],z6=()=>["role","combobox"],HD=()=>["role","listbox"],Y6=()=>["role","option"],G6=()=>["role","checkbox"],K6=()=>["role","dialog"],X6=()=>["role","alertdialog"],q6=()=>["scope","col"],Z6=()=>["scope","row"],J6=()=>["type","text"],lr=t=>["aria-label",t],Q6=t=>["aria-labelledby",t],e9=t=>["aria-describedby",t],Uu=()=>["aria-hidden","true"],ef=function(){return["aria-disabled",arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0]},t9=()=>["aria-multiselectable","true"],ND=t=>["aria-haspopup",t],DD=t=>["aria-rowcount",t],Lv=t=>["aria-colcount",t],$D=t=>["aria-rowindex",t],y0=t=>["aria-colindex",t],Nr=t=>["aria-expanded",t],n9=t=>["aria-sort",t],BI=()=>["aria-readonly","true"],jI=()=>["aria-invalid","true"],kD=t=>["aria-checked",t],b0=()=>["aria-selected","true"],i9=()=>["aria-autocomplete","list"],r9=t=>["aria-controls",t],o9=t=>["aria-activedescendant",t],s9=t=>["aria-live",t],a9=t=>["aria-relevant",t],l9=t=>["aria-setsize",t],u9=t=>["aria-posinset",t],c9=()=>["aria-modal","true"];var h9=dr,d9=DE.get,f9=function(e){if(!h9(e))return!1;var n=d9(e);return!!n&&n.type==="RawJSON"},S0=gn,g9=fr,Kg=SyntaxError,m9=parseInt,p9=String.fromCharCode,w9=S0("".charAt),UI=S0("".slice),zI=S0(/./.exec),YI={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},v9=/^[\da-f]{4}$/i,C9=/^[\u0000-\u001F]$/,y9=function(t,e){for(var n=!0,i="";e<t.length;){var r=w9(t,e);if(r==="\\"){var o=UI(t,e,e+2);if(g9(YI,o))i+=YI[o],e+=2;else if(o==="\\u"){e+=2;var s=UI(t,e,e+4);if(!zI(v9,s))throw new Kg("Bad Unicode escape at: "+e);i+=p9(m9(s,16)),e+=4}else throw new Kg('Unknown escape sequence: "'+o+'"')}else if(r==='"'){n=!1,e++;break}else{if(zI(C9,r))throw new Kg("Bad control character in string literal at: "+e);i+=r,e++}}if(n)throw new Kg("Unterminated string at: "+e);return{value:i,end:e}},b9=fn,S9=!b9(function(){var t="9007199254740993",e=JSON.rawJSON(t);return!JSON.isRawJSON(e)||JSON.stringify(e)!==t}),R9=St,LD=Ah,E9=cg,FD=Sn,zu=gn,VD=fn,GI=BH,vw=On,T9=f9,KI=PE,XI=ku,_9=_v,M9=KE,P9=y9,I9=OE,x9=ME,uy=S9,WD=String,Qa=LD("JSON","stringify"),Xg=zu(/./.exec),vR=zu("".charAt),O9=zu("".charCodeAt),A9=zu("".replace),cy=zu("".slice),CR=zu([].push),H9=zu(1.1.toString),N9=/[\uD800-\uDFFF]/g,qI=/^[\uD800-\uDBFF]$/,ZI=/^[\uDC00-\uDFFF]$/,yR=I9(),JI=yR.length,BD=!x9||VD(function(){var t=LD("Symbol")("stringify detection");return Qa([t])!=="[null]"||Qa({a:t})!=="{}"||Qa(Object(t))!=="{}"}),QI=VD(function(){return Qa("\uDF06\uD834")!=='"\\udf06\\ud834"'||Qa("\uDEAD")!=='"\\udead"'}),D9=BD?function(t,e){var n=M9(arguments),i=jD(e);if(!(!vw(i)&&(t===void 0||KI(t))))return n[1]=function(r,o){if(vw(i)&&(o=FD(i,this,WD(r),o)),!KI(o))return o},E9(Qa,null,n)}:Qa,$9=function(t,e,n){var i=vR(n,e-1),r=vR(n,e+1);return Xg(qI,t)&&!Xg(ZI,r)||Xg(ZI,t)&&!Xg(qI,i)?"\\u"+H9(O9(t,0),16):t},jD=function(t){if(vw(t))return t;if(GI(t)){for(var e=t.length,n=[],i=0;i<e;i++){var r=t[i];typeof r=="string"?CR(n,r):(typeof r=="number"||XI(r)==="Number"||XI(r)==="String")&&CR(n,_9(r))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(GI(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}};Qa&&R9({target:"JSON",stat:!0,arity:3,forced:BD||QI||!uy},{stringify:function(e,n,i){var r=jD(n),o=[],s=D9(e,function(f,p){var v=vw(r)?FD(r,this,WD(f),p):p;return!uy&&T9(v)?yR+(CR(o,v.rawJSON)-1):v},i);if(typeof s!="string"||(QI&&(s=A9(s,N9,$9)),uy))return s;for(var a="",l=s.length,u=0;u<l;u++){var c=vR(s,u);if(c==='"'){var h=P9(s,++u).end-1,d=cy(s,u,h);a+=cy(d,0,JI)===yR?o[cy(d,JI)]:'"'+d+'"',u=h}else a+=c}return a}});function Vf(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},We(t,(n,i)=>{i!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[i]=Vf(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[i]=[Vf(n[0])]:e[i]=[]:e[i]=null)})),e}function k9(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function bn(t,e,n){const i=Array.isArray(n);return We(e,(r,o)=>{(i===!1||n.includes(o))&&(t[o]=r)}),t}function Fv(t,e){We(e,(n,i)=>{e[i]&&typeof e[i]=="object"?(t[i]||(Array.isArray(e[i])?t[i]=[]:Object.prototype.toString.call(e[i])==="[object Date]"?t[i]=e[i]:t[i]={}),Fv(t[i],e[i])):t[i]=e[i]})}function Si(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function ls(t){const e={};return We(t,(n,i)=>{e[i]=n}),e}function ct(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return O(n,r=>{t.MIXINS.push(r.MIXIN_NAME),We(r,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=p=>{let v=p;return(Array.isArray(v)||me(v))&&(v=Si(v)),v};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function Vv(t,e){return JSON.stringify(t)===JSON.stringify(e)}function me(t){return Object.prototype.toString.call(t)==="[object Object]"}function aa(t,e,n,i){i.value=n,i.writable=i.writable!==!1,i.enumerable=i.enumerable!==!1,i.configurable=i.configurable!==!1,Object.defineProperty(t,e,i)}function We(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function bR(t,e){const n=e.split(".");let i=t;return We(n,r=>{if(i=i[r],i===void 0)return i=void 0,!1}),i}function hy(t,e,n){if(typeof e!="string")return;const i=e.split(".");let r=t;i.forEach((o,s)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(s!==i.length-1?(nn(r,o)||(r[o]={}),r=r[o]):r[o]=n)})}function R0(t){if(!me(t))return 0;const e=function(n){let i=0;return me(n)?We(n,(r,o)=>{o!=="__children"&&(i+=e(r))}):i+=1,i};return e(t)}function cr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,i={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(i,e,{get(){return this[n]},set(r){this._touched=!0,this[n]=r},enumerable:!0,configurable:!0}),i}function nn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Fp(t,e){if(typeof t!="object"||t===null)return e;if(typeof e!="object"||e===null)return t;const n={};return Object.keys(e).forEach(i=>{typeof e[i]=="object"&&e[i]!==null&&!Array.isArray(e[i])?n[i]=Fp(t[i],e[i]):n[i]=nn(t,i)&&t[i]!==void 0?t[i]:e[i]}),Object.keys(t).forEach(i=>{nn(n,i)||(n[i]=t[i])}),n}function Cw(t){return window.requestAnimationFrame(t)}function yw(t){window.cancelAnimationFrame(t)}function UD(){return"ontouchstart"in window}function L9(){return typeof window<"u"}let Qu;function F9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Qu||(typeof Intl=="object"?Qu=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Qu=(n,i)=>`${n}`.localeCompare(i):Qu=(n,i)=>n===i?0:n>i?-1:1,Qu)}const _r=t=>{const e={value:!1};return e.test=(n,i)=>{e.value=t(n,i)},e},al={chrome:_r((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:_r(t=>/CriOS/.test(t)),edge:_r(t=>/Edge/.test(t)),edgeWebKit:_r(t=>/EdgiOS/.test(t)),firefox:_r(t=>/Firefox/.test(t)),firefoxWebKit:_r(t=>/FxiOS/.test(t)),mobile:_r(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:_r((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},wg={mac:_r(t=>/^Mac/.test(t)),win:_r(t=>/^Win/.test(t)),linux:_r(t=>/^Linux/.test(t)),ios:_r(t=>/iPhone|iPad|iPod/i.test(t))};function V9(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};We(al,n=>{let{test:i}=n;return void i(t,e)})}function W9(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};We(wg,e=>{let{test:n}=e;return void n(t)})}L9()&&(V9(),W9());function zD(){return al.chrome.value}function B9(){return al.chromeWebKit.value}function dy(){return al.firefox.value}function j9(){return al.firefoxWebKit.value}function Wv(){return al.safari.value}function U9(){return al.edge.value}function rs(){return al.mobile.value}function YD(){return wg.ios.value}function E0(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&wg.mac.value}function SR(){return wg.win.value}function ex(){return wg.mac.value}function z9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,i=null,r=t;for(;r!==null;){if(n===e){i=r;break}r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:(n+=1,r=r.parentNode)}return i}function Vp(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function Y9(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function il(t){return Y9(t)&&t.parent}function _u(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:i,DOCUMENT_FRAGMENT_NODE:r}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===i&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===r?o=l:o=o.parentNode}return null}function qg(t,e,n){const i=[];let r=t;for(;r&&(r=_u(r,e,n),!(!r||n&&!n.contains(r)));)i.push(r),r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:r=r.parentNode;const o=i.length;return o?i[o-1]:null}function G9(t,e){const n={element:void 0,classNames:[]};let i=t;for(;i!==null&&i!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&i.classList.contains(e))n.element=i,n.classNames.push(e);else if(e instanceof RegExp){const r=Array.from(i.classList).filter(o=>e.test(o));r.length&&(n.element=i,n.classNames.push(...r))}i=i.parentElement}return n}function bu(t,e){let n=t.parentNode,i=[];for(typeof e=="string"?t.defaultView?i=Array.prototype.slice.call(t.querySelectorAll(e),0):i=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):i.push(e);n!==null;){if(i.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function K9(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function fl(t,e,n){const i=n.parentElement.querySelector(`.ht_clone_${t}`);return i?i.contains(e):null}function GD(t){return!t||!t.length?[]:t.filter(e=>!!e)}function KD(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],i=[];return i.push(...t.filter(r=>{const o=r instanceof RegExp;return o&&e&&n.push(r),!o})),{regexFree:i,regexes:n}}function Ce(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function B(t,e){typeof e=="string"&&(e=e.split(" ")),e=GD(e),e.length>0&&t.classList.add(...e)}function ae(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:i}=KD(e,!0);n=GD(n),n.length>0&&t.classList.remove(...n),i.forEach(r=>{t.classList.forEach(o=>{r.test(o)&&t.classList.remove(o)})})}function le(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(i=>{Array.isArray(i)&&i[0]!==""&&t.setAttribute(...i)})}function Zs(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:i}=KD(e,!0);n.forEach(r=>{r!==""&&t.removeAttribute(r)}),i.forEach(r=>{t.getAttributeNames().forEach(o=>{r.test(o)&&t.removeAttribute(o)})})}function XD(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)XD(e[n])}}function ea(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const X9=/(<(.*)>|&(.*);)/;function Yu(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;X9.test(e)?t.innerHTML=n?C0(e):e:Mu(t,e)}function Mu(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(ea(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Pu(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let i=t;for(;i!==e;){if(i===null)return!1;if(i.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(i.host){if(i.host.impl)return Pu(i.host.impl);if(i.host)return Pu(i.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(i).display==="none")return!1;i=i.parentNode}return!0}function q9(t){const n=t.ownerDocument.defaultView;let i=t;for(;i.parentNode;){if(i.style.height==="0px"||i.style.height==="0")return n.getComputedStyle(i).overflow==="hidden";i=i.parentNode}return!1}function oi(t){const e=t.ownerDocument,n=e.defaultView,i=e.documentElement;let r=t,o,s,a;for(o=r.offsetLeft,s=r.offsetTop,a=r;(r=r.offsetParent)&&!(r===e.body||!("offsetLeft"in r));)o+=r.offsetLeft,s+=r.offsetTop,a=r;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||i.scrollLeft,s+=n.pageYOffset||i.scrollTop),{left:o,top:s}}function qD(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function T0(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function _0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?qD(e):t.scrollTop}function ZD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?T0(e):t.scrollLeft}function bw(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const i=["auto","scroll"];let r=t.parentNode;for(;r&&r.style&&e.body!==r;){let{overflow:o,overflowX:s,overflowY:a}=r.style;if([o,s,a].includes("scroll"))return r;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(r),i.includes(o)||i.includes(s)||i.includes(a)||r.clientHeight<=r.scrollHeight+1&&(i.includes(a)||i.includes(o))||r.clientWidth<=r.scrollWidth+1&&(i.includes(s)||i.includes(o)))return r;r=r.parentNode}return n}function Z9(t){return t.scrollHeight-t.clientHeight}function J9(t){return t.scrollWidth-t.clientWidth}function Wf(t){const e=t.ownerDocument,n=e.defaultView;let i=t.parentNode;for(;i&&i.style&&e.body!==i;){if(i.style.overflow!=="visible"&&i.style.overflow!=="")return i;const r=n.getComputedStyle(i),o=["scroll","hidden","auto"],s=r.getPropertyValue("overflow"),a=r.getPropertyValue("overflow-y"),l=r.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return i;i=i.parentNode}return n}function Sw(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const i=t.style[e];if(i!==""&&i!==void 0)return i;const r=n.getComputedStyle(t);if(r[e]!==""&&r[e]!==void 0)return r[e]}function cn(t){return t.offsetWidth}function yn(t){return t.getBoundingClientRect().height}function gf(t){return t.clientHeight||t.innerHeight}function JD(t){return t.clientWidth||t.innerWidth}function QD(t){return t.selectionStart?t.selectionStart:0}function Q9(t){return t.selectionEnd?t.selectionEnd:0}function tx(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Bv(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const r=t.parentNode,o=r.style.display;r.style.display="block",t.setSelectionRange(e,n),r.style.display=o}}}let fy;function e7(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return SR()?Number.isInteger(t.defaultView.devicePixelRatio||1)?0:2:0}function t7(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");Wv()&&!rs()&&!E0()&&n.classList.add("htScrollbarSafariTest"),n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const i=e.getBoundingClientRect().width;n.style.overflow="scroll";let r=e.getBoundingClientRect().width;return i===r&&(r=n.clientWidth),(t.body||t.documentElement).removeChild(n),parseFloat((i-r).toFixed(3))}function hn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return fy===void 0&&(fy=t7(t)),fy}function e$(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function t$(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function M0(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function jv(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Wp(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function n$(t){return Wp(t)&&t.hasAttribute("data-hot-input")===!1}function i$(t){return!t.parentNode}function n7(t,e){new IntersectionObserver((i,r)=>{i.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),r.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function r$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=t.ownerDocument,r=i.createRange(),o=i.defaultView.getSelection();le(t,"contenteditable",!0),n&&le(t,...Uu()),e&&B(t,"invisibleSelection"),r.selectNodeContents(t),o.removeAllRanges(),o.addRange(r)}function o$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&ae(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function i7(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;r$(t,n),e(),o$(t,n)}function Js(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}function ot(t){return typeof t=="function"}function Uv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,i;function r(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{i=t.apply(this,s)},e),i}return r}function s$(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function r7(t){const e=t.length;function n(i){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=i.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function RR(t,e,n,i,r,o,s,a){return te(a)?t.call(e,n,i,r,o,s,a):te(s)?t.call(e,n,i,r,o,s):te(o)?t.call(e,n,i,r,o):te(r)?t.call(e,n,i,r):te(i)?t.call(e,n,i):te(n)?t.call(e,n):t.call(e)}const ge={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:dy()?182:174,AUDIO_MUTE:dy()?181:173,AUDIO_UP:dy()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},o7=[ge.ALT,ge.ARROW_DOWN,ge.ARROW_LEFT,ge.ARROW_RIGHT,ge.ARROW_UP,ge.AUDIO_DOWN,ge.AUDIO_MUTE,ge.AUDIO_UP,ge.BACKSPACE,ge.CAPS_LOCK,ge.DELETE,ge.END,ge.ENTER,ge.ESCAPE,ge.F1,ge.F2,ge.F3,ge.F4,ge.F5,ge.F6,ge.F7,ge.F8,ge.F9,ge.F10,ge.F11,ge.F12,ge.F13,ge.F14,ge.F15,ge.F16,ge.F17,ge.F18,ge.F19,ge.HOME,ge.INSERT,ge.MEDIA_NEXT,ge.MEDIA_PLAY_PAUSE,ge.MEDIA_PREV,ge.MEDIA_STOP,ge.NULL,ge.NUM_LOCK,ge.PAGE_DOWN,ge.PAGE_UP,ge.PAUSE,ge.SCROLL_LOCK,ge.SHIFT,ge.TAB];function s7(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function a$(t){return o7.includes(t)}function a7(t){return[ge.CONTROL,ge.COMMAND_LEFT,ge.COMMAND_RIGHT,ge.COMMAND_FIREFOX].includes(t)}function Sh(t,e){const n=e.split("|");let i=!1;return O(n,r=>{if(t===ge[r])return i=!0,!1}),i}function $r(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function nu(t){return t.isImmediatePropagationEnabled===!1}function Iu(t){return t.button===2}function P0(t){return t.button===0}function l7(t){return typeof TouchEvent<"u"&&t instanceof TouchEvent}function u7(t,e){const n={x:t.offsetX,y:t.offsetY};let i=t.target;if(!Js(e)||i!==e&&i.contains(e))return n;for(;i!==e;)n.x+=i.offsetLeft,n.y+=i.offsetTop,i=i.offsetParent;return n}function $e(){te(console)&&console.warn(...arguments)}function l$(t){te(console)&&console.warn(`Deprecated: ${t}`)}function I0(){te(console)&&console.error(...arguments)}const iu=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceCacheUpdate","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceCacheUpdate","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","beforeSelectAll","afterSelectAll","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeHeightChange","beforeWidthChange","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","beforePageChange","afterPageChange","beforePageSizeChange","afterPageSizeChange","afterPageSizeVisibilityChange","afterPageCounterVisibilityChange","afterPageNavigationVisibilityChange","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterDialogHide","afterDialogShow","beforeDialogHide","beforeDialogShow","dialogFocusPreviousElement","dialogFocusNextElement","afterDialogFocus","beforeLoadingShow","afterLoadingShow","beforeLoadingHide","afterLoadingHide","beforeEmptyDataStateShow","afterEmptyDataStateShow","beforeEmptyDataStateHide","afterEmptyDataStateHide","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],gy=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),my=new Map([[]]);var c7=Dh,h7=function(t,e,n){for(var i=0,r=arguments.length>2?n:c7(e),o=new t(r);r>i;)o[i]=e[i++];return o},d7=dn,f7=function(t,e){var n=d7[t],i=n&&n.prototype;return i&&i[e]},g7=vo,m7=lN,p7=ra.f,ER=g7("unscopables"),TR=Array.prototype;TR[ER]===void 0&&p7(TR,ER,{configurable:!0,value:m7(null)});var zv=function(t){TR[ER][t]=!0},w7=St,v7=gn,C7=Wi,y7=og,b7=h7,S7=f7,R7=zv,E7=Array,T7=v7(S7("Array","sort"));w7({target:"Array",proto:!0},{toSorted:function(e){e!==void 0&&C7(e);var n=y7(this),i=b7(E7,n);return T7(i,e)}});R7("toSorted");var _7=St,M7=Sn,P7=$h,I7=Wi,x7=Rn,O7=hs,A7=Bi,H7=sl,py=H7("find",TypeError);_7({target:"Iterator",proto:!0,real:!0,forced:py},{find:function(e){x7(this);try{I7(e)}catch(r){A7(this,"throw",r)}if(py)return M7(py,this,e);var n=O7(this),i=0;return P7(n,function(r,o){if(e(r,i++))return o(r)},{IS_RECORD:!0,INTERRUPTED:!0}).result}});function N7(t,e){u$(t,e),e.add(t)}function wy(t,e,n){u$(t,e),e.set(t,n)}function u$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nx(t,e,n){return t.set(Rw(t,e),n),n}function Yn(t,e){return t.get(Rw(t,e))}function Rw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const D7=100;var Zi=new WeakMap,Uc=new WeakMap,vy=new WeakMap,Cy=new WeakSet;class ix{constructor(){N7(this,Cy),wy(this,Zi,new Map),wy(this,Uc,new Map),wy(this,vy,new Set),iu.forEach(e=>Rw(Cy,this,rx).call(this,e))}getHooks(e){var n;return(n=Yn(Zi,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Yn(Zi,this).has(e)||(Rw(Cy,this,rx).call(this,e),iu.push(e));const r=Yn(Zi,this).get(e),o=r.find(c=>c.callback===n);if(o){o.skip===!0&&(o.skip=!1);return}const s=Number.isInteger(i.orderIndex)?i.orderIndex:0,a=!!i.runOnce,l=!!i.initialHook;let u=!1;if(l){const c=r.find(h=>h.initialHook);c&&(c.callback=n,u=!0)}if(!u){r.push({callback:n,orderIndex:s,runOnce:a,initialHook:l,skip:!1});let c=Yn(vy,this).has(e);!c&&s!==0&&(c=!0,Yn(vy,this).add(e)),c&&r.length>1&&Yn(Zi,this).set(e,r.toSorted((h,d)=>h.orderIndex-d.orderIndex))}}has(e){return Yn(Zi,this).has(e)&&Yn(Zi,this).get(e).length>0}remove(e,n){if(!Yn(Zi,this).has(e))return!1;const i=Yn(Zi,this).get(e),r=i.find(o=>o.callback===n);if(r){let o=Yn(Uc,this).get(e);return r.skip=!0,o+=1,o>D7&&(Yn(Zi,this).set(e,i.filter(s=>!s.skip)),o=0),Yn(Uc,this).set(e,o),!0}return!1}destroy(){Yn(Zi,this).clear(),Yn(Uc,this).clear(),nx(Zi,this,null),nx(Uc,this,null)}}function rx(t){Yn(Zi,this).set(t,[]),Yn(Uc,this).set(t,0)}function $7(t,e,n){return(e=k7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function k7(t){var e=L7(t,"string");return typeof e=="symbol"?e:e+""}function L7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const F7=nt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class ie{constructor(){$7(this,"globalBucket",new ix)}static getSingleton(){return W7()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new ix),e.pluginHookBucket):this.globalBucket}add(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?O(n,o=>this.add(e,o,i)):(gy.has(e)&&$e(v0(F7,{hookName:e,removedInVersion:gy.get(e)})),my.has(e)&&$e(my.get(e)),this.getBucket(i).add(e,n,{orderIndex:r,runOnce:!1})),this}once(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?O(n,o=>this.once(e,o,i)):this.getBucket(i).add(e,n,{orderIndex:r,runOnce:!0}),this}addAsFixed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?O(n,r=>this.addAsFixed(e,r,i)):this.getBucket(i).add(e,n,{initialHook:!0}),this}remove(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(i).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,i,r,o,s,a,l){{const u=this.getBucket().getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=RR(u[h].callback,e,i,r,o,s,a,l);d!==void 0&&(i=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback),h+=1}}{const u=this.getBucket(e).getHooks(n),c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=RR(u[h].callback,e,i,r,o,s,a,l);d!==void 0&&(i=d),u[h]&&u[h].runOnce&&this.remove(n,u[h].callback,e),h+=1}}return i}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||iu.push(e)}deregister(e){this.isRegistered(e)&&iu.splice(iu.indexOf(e),1)}isDeprecated(e){return my.has(e)||gy.has(e)}isRegistered(e){return iu.indexOf(e)>=0}getRegistered(){return iu}}const V7=new ie;function W7(){return V7}const cu=new Map;function Vr(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";cu.has(t)||cu.set(t,new Map);const e=cu.get(t);function n(l,u){e.set(l,u)}function i(l){return e.get(l)}function r(l){return e.has(l)}function o(){return[...e.keys()]}function s(){return[...e.values()]}function a(){cu.delete(t),e.clear()}return{register:n,getItem:i,hasItem:r,getNames:o,getValues:s,clear:a}}function B7(t,e){var n;return cu==null||(n=cu.get(t.guid))===null||n===void 0?void 0:n.get(e)}const _R=new WeakMap,{register:j7,getItem:c$,hasItem:h$,getNames:VSe,getValues:WSe}=Vr("editors");function U7(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(i){return i.guid in e||(e[i.guid]=new n(i)),e[i.guid]},ie.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function d$(t,e){let n;if(typeof t=="function")_R.get(t)||er(null,t),n=_R.get(t);else if(typeof t=="string")n=c$(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function MR(t){if(typeof t=="function")return t;if(!h$(t))throw Error(`No registered editor found under "${t}" name`);return c$(t).getConstructor()}function er(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new U7(e);typeof t=="string"&&j7(t,n),_R.set(e,n)}function z7(t,e,n){return(e=Y7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y7(t){var e=G7(t,"string");return typeof e=="symbol"?e:e+""}function G7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wo{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;z7(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){i.call(this,K7(s))}return this.context.eventListeners.push({element:e,event:n,callback:i,callbackProxy:o,options:r,eventManager:this}),e.addEventListener(n,o,r),()=>{this.removeEventListener(e,n,i)}}removeEventListener(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(i&&i!==s.callback||r&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const i=this.context.eventListeners[n];e&&i.eventManager!==this||(this.context.eventListeners.splice(n,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let i=e.document,r=e;i||(i=e.ownerDocument?e.ownerDocument:e,r=i.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let s;i.createEvent?(s=i.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,i.body.parentNode)):s=i.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function K7(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),$r(this)},t}function X7(t,e){q7(t,e),e.add(t)}function q7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gl(t,e,n){return(e=Z7(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z7(t){var e=J7(t,"string");return typeof e=="symbol"?e:e+""}function J7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yy(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Zg=new WeakSet;class PR{constructor(e,n,i){X7(this,Zg),gl(this,"hot",void 0),gl(this,"tableMeta",void 0),gl(this,"selection",void 0),gl(this,"eventManager",void 0),gl(this,"destroyed",!1),gl(this,"activeEditor",void 0),gl(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=i,this.eventManager=new wo(e),this.hot.addHook("afterDocumentKeyDown",r=>yy(Zg,this,ox).call(this,r)),this.hot.addHook("beforeCompositionStart",r=>yy(Zg,this,ox).call(this,r)),this.hot.view._wt.update("onCellDblClick",(r,o,s)=>yy(Zg,this,Q7).call(this,r,o,s))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:i,col:r}=n,o=this.hot.runHooks("modifyGetCellCoords",i,r,!1,"meta");let s=i,a=r;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(i,r,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=d$(u,this.hot),this.activeEditor.prepare(i,r,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const r=this.hot.getSelectedRangeActive();let o=this.hot.runHooks("beforeBeginEditing",r.highlight.row,r.highlight.col,e,n,i);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&r.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,i){this.activeEditor?this.activeEditor.finishEditing(e,n,i):i&&i(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeActive();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:i,col:r}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(i))||s.isHidden(this.hot.toPhysicalColumn(r));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function ox(t){const e=this.hot.getSelectedRangeActive();if(!this.hot.isListening()||!e||e.highlight.isHeader()||nu(t))return;const{keyCode:n}=t,i=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!a$(n)&&!a7(n)&&!i&&!this.isEditorOpened()&&this.openEditor("",t)}function Q7(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const sx=new WeakMap;PR.getInstance=function(t,e,n){let i=sx.get(t);return i||(i=new PR(t,e,n),sx.set(t,i)),i};var e5=dr,t5=ku,n5=vo,i5=n5("match"),r5=function(t){var e;return e5(t)&&((e=t[i5])!==void 0?!!e:t5(t)==="RegExp")},o5=dn,s5=fn,ax=o5.RegExp,a5=!s5(function(){var t=!0;try{ax(".","d")}catch{t=!1}var e={},n="",i=t?"dgimsy":"gimsy",r=function(l,u){Object.defineProperty(e,l,{get:function(){return n+=u,!0}})},o={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};t&&(o.hasIndices="d");for(var s in o)r(s,o[s]);var a=Object.getOwnPropertyDescriptor(ax.prototype,"flags").get.call(e);return a!==i||n!==i}),l5={correct:a5},u5=Rn,c5=function(){var t=u5(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},h5=Sn,d5=fr,f5=sg,lx=l5,g5=c5,m5=RegExp.prototype,p5=lx.correct?function(t){return t.flags}:function(t){return!lx.correct&&f5(m5,t)&&!d5(t,"flags")?h5(g5,t):t.flags},x0=gn,w5=Hh,v5=Math.floor,by=x0("".charAt),C5=x0("".replace),Sy=x0("".slice),y5=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,b5=/\$([$&'`]|\d{1,2})/g,S5=function(t,e,n,i,r,o){var s=n+t.length,a=i.length,l=b5;return r!==void 0&&(r=w5(r),l=y5),C5(o,l,function(u,c){var h;switch(by(c,0)){case"$":return"$";case"&":return t;case"`":return Sy(e,0,n);case"'":return Sy(e,s);case"<":h=r[Sy(c,1,-1)];break;default:var d=+c;if(d===0)return u;if(d>a){var f=v5(d/10);return f===0?u:f<=a?i[f-1]===void 0?by(c,1):i[f-1]+by(c,1):u}h=i[d-1]}return h===void 0?"":h})},R5=St,E5=Sn,O0=gn,ux=rg,T5=On,_5=dr,M5=r5,rd=_v,P5=ag,I5=p5,x5=S5,O5=vo,A5=O5("replace"),H5=TypeError,Ry=O0("".indexOf);O0("".replace);var cx=O0("".slice),N5=Math.max;R5({target:"String",proto:!0},{replaceAll:function(e,n){var i=ux(this),r,o,s,a,l,u,c,h,d,f,p=0,v="";if(_5(e)){if(r=M5(e),r&&(o=rd(ux(I5(e))),!~Ry(o,"g")))throw new H5("`.replaceAll` does not allow non-global regexes");if(s=P5(e,A5),s)return E5(s,e,i,n)}for(a=rd(i),l=rd(e),u=T5(n),u||(n=rd(n)),c=l.length,h=N5(1,c),d=Ry(a,l);d!==-1;)f=u?rd(n(l,d,a)):x5(l,a,d,[],void 0,n),v+=cx(a,p,d)+f,p=d+c,d=d+h>a.length?-1:Ry(a,l,d+h);return p<a.length&&(v+=cx(a,p)),v}});const f$={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},D5=new RegExp(Object.keys(f$).map(t=>`(${t})`).join("|"),"gi");function $5(t){return(t&&t.nodeName||"")==="TABLE"}function hx(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),i=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],r=t.getData(...i),o=r.length,s=o>0?r[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,p=[];for(let b=0;b<s;b+=1){const P=!f&&n&&b===0;let _="";if(f)_=`<th>${t.getColHeader(b-c)}</th>`;else if(P)_=`<th>${t.getRowHeader(d-h)}</th>`;else{const F=r[d][b],{hidden:I,rowspan:W,colspan:k}=t.getCellMeta(d-h,b-c);if(!I){const $=[];if(W&&$.push(`rowspan="${W}"`),k&&$.push(`colspan="${k}"`),rn(F))_=`<td ${$.join(" ")}></td>`;else{const Y=F.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");_=`<td ${$.join(" ")}>${Y}</td>`}}}p.push(_)}const v=["<tr>",...p,"</tr>"].join("");f?l.splice(1,0,v):u.splice(-1,0,v)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function dx(t){const e=t.length,n=["<table>"];for(let i=0;i<e;i+=1){const r=t[i],o=r.length,s=[];i===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=r[a],u=rn(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),i+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function fx(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},i=e.createDocumentFragment(),r=e.createElement("div");i.appendChild(r);let o=t;if(typeof o=="string"){const F=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,I=>{const W=I.match(/<td\b[^>]*?>/g)[0],k=/<p.*?>/g,$=I.substring(W.length,I.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(k,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${W}${$}</td>`});r.insertAdjacentHTML("afterbegin",`${F}`),o=r.querySelector("table")}if(!o||!$5(o))return;const s=r.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((F,I)=>F+I.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,p=0;if(o.tHead){const F=Array.from(o.tHead.rows).filter(I=>{const W=I.querySelector("td")!==null;return W&&h.push(I),!W});f=F.length,d=f>0,f>1?n.nestedHeaders=Array.from(F).reduce((I,W)=>{const k=Array.from(W.cells).reduce(($,Y,J)=>{if(a&&J===0)return $;const{colSpan:U,innerHTML:oe}=Y,j=U>1?{label:oe,colspan:U}:oe;return $.push(j),$},[]);return I.push(k),I},[]):d&&(n.colHeaders=Array.from(F[0].children).reduce((I,W,k)=>(a&&k===0||I.push(W.innerHTML),I),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const v=[...h,...Array.from(o.tBodies).reduce((F,I)=>(F.push(...Array.from(I.rows)),F),[]),...c];p=v.length;const b=new Array(p);for(let F=0;F<p;F++)b[F]=new Array(u);const P=[],_=[];for(let F=0;F<p;F++){const I=v[F],W=Array.from(I.cells),k=W.length;for(let $=0;$<k;$++){const Y=W[$],{nodeName:J,innerHTML:U,rowSpan:oe,colSpan:j}=Y,Z=b[F].findIndex(re=>re===void 0);if(J==="TD"){if(oe>1||j>1){for(let xe=F;xe<F+oe;xe++)if(xe<p)for(let Oe=Z;Oe<Z+j;Oe++)b[xe][Oe]=null;const pe=Y.getAttribute("style");pe&&pe.includes("mso-ignore:colspan")||P.push({col:Z,row:F,rowspan:oe,colspan:j})}let re="";s&&/excel/gi.test(s.content)?re=U.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):re=U.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),b[F][Z]=re.replace(D5,pe=>f$[pe])}else _.push(U)}}return P.length&&(n.mergeCells=P),_.length&&(n.rowHeaders=_),b.length&&(n.data=b),n}function Ci(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const i=Array.from(new Set([".",...e])).map(r=>`\\${r}`).join("|");return new RegExp(`^[+-]?(((${i})?\\d+((${i})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function k5(t){return Ci(t,[","])}function he(t,e,n){let i=-1;for(typeof e=="function"?(n=e,e=t):i=t-1;++i<=e&&n(i)!==!1;);}function gx(t,e,n){let i=t+1;for(typeof e=="function"&&(n=e,e=0);--i>=e&&n(i)!==!1;);}function g$(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Ue(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}function L5(t){const e=t.replace(",",".");return isNaN(parseFloat(e))===!1?parseFloat(e):null}function gh(t){return Number.isInteger(t)&&t>=0}const IR="asc",F5="desc",mx=new Map([[IR,[-1,1]],[F5,[1,-1]]]),V5=t=>`The priority '${t}' is already declared in a map.`,W5=t=>`The priority '${t}' is not a number.`;function B5(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=ot(t)?t:V5,e=ot(e)?e:W5;function i(o,s){if(!Ci(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function r(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:IR;const[s,a]=mx.get(o)||mx.get(IR);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:i,getItems:r}}const j5=t=>`The id '${t}' is already declared in a map.`;function vg(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=ot(t)?t:j5;function n(c,h){if(u(c))throw new Error(t(c));e.set(c,h)}function i(c){return e.delete(c)}function r(){e.clear()}function o(c){const[h]=a().find(d=>{let[f,p]=d;return c===p?f:!1})||[null];return h}function s(c){return e.get(c)}function a(){return[...e]}function l(){return[...e.values()]}function u(c){return e.has(c)}return{addItem:n,clear:r,getId:o,getItem:s,getItems:a,getValues:l,hasItem:u,removeItem:i}}const U5=t=>`'${t}' value is already declared in a unique set.`;function z5(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=ot(t)?t:U5;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function i(){return[...e]}function r(){e.clear()}return{addItem:n,clear:r,getItems:i}}const A0=t=>`There is already registered "${t}" plugin.`,Y5=t=>`There is already registered plugin on priority "${t}".`,G5=t=>`The priority "${t}" is not a number.`,m$=B5({errorPriorityExists:Y5,errorPriorityNaN:G5}),p$=z5({errorItemExists:A0}),xR=vg({errorIdExists:A0});function w$(){return[...m$.getItems(),...p$.getItems()]}function H0(t){const e=mo(t);return xR.getItem(e)}function K5(t){return!!H0(t)}function Ye(t,e,n){[t,e,n]=q5(t,e,n),H0(t)===void 0&&X5(t,e,n)}function X5(t,e,n){const i=mo(t);if(xR.hasItem(i))throw new Error(A0(i));n===void 0?p$.addItem(i):m$.addItem(n,i),xR.addItem(i,e)}function q5(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:Z5,getItem:J5,hasItem:v$,getNames:BSe,getValues:jSe}=Vr("renderers");function OR(t){if(typeof t=="function")return t;if(!v$(t))throw Error(`No registered renderer found under "${t}" name`);return J5(t)}function Rr(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),Z5(t,e)}const{register:Q5,getItem:e8,hasItem:C$,getNames:USe,getValues:zSe}=Vr("validators");function t8(t){if(typeof t=="function")return t;if(!C$(t))throw Error(`No registered validator found under "${t}" name`);return e8(t)}function zc(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),Q5(t,e)}var n8=St,i8=Hh,r8=Dh,o8=lg,s8=zv;n8({target:"Array",proto:!0},{at:function(e){var n=i8(this),i=r8(n),r=o8(e),o=r>=0?r:i+r;return o<0||o>=i?void 0:n[o]}});s8("at");var a8=St,l8=gn,u8=rg,c8=lg,h8=_v,d8=fn,f8=l8("".charAt),g8=d8(function(){return"ð ®·".at(-2)!=="\uD842"});a8({target:"String",proto:!0,forced:g8},{at:function(e){var n=h8(u8(this)),i=n.length,r=c8(e),o=r>=0?r:i+r;return o<0||o>=i?void 0:f8(n,o)}});function od(t,e,n){return(e=m8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m8(t){var e=p8(t,"string");return typeof e=="symbol"?e:e+""}function p8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class w8{constructor(){od(this,"count",0),od(this,"startColumn",null),od(this,"endColumn",null),od(this,"startPosition",null),od(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:o,columnWidth:s}=n,a=r>0?o+1:o;i>=r&&i+s<=r+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:i,viewportWidth:r,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const p=u[this.endColumn]+c-u[this.startColumn-1];if(p<=r&&(this.startColumn-=1),p>=r)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?r+1:r,d=i+r-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*o||i>u.at(-1)||-1*i-r>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function sd(t,e,n){return(e=v8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v8(t){var e=C8(t,"string");return typeof e=="symbol"?e:e+""}function C8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y8{constructor(){sd(this,"count",0),sd(this,"startRow",null),sd(this,"endRow",null),sd(this,"startPosition",null),sd(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:o,rowHeight:s}=n;i>=r&&i+s<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=r-o&&(this.startRow-=1),d>=r-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const c=i+r-o,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||i>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function ad(t,e,n){return(e=b8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b8(t){var e=S8(t,"string");return typeof e=="symbol"?e:e+""}function S8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y${constructor(){ad(this,"count",0),ad(this,"startColumn",null),ad(this,"endColumn",null),ad(this,"startPosition",null),ad(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:o}=n;i<=r&&(this.startColumn=e);const s=r>0?o+1:o;i>=r&&i<=r+s&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:i,viewportWidth:r,inlineStartOffset:o,zeroBasedScrollOffset:s,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>r)break}this.startPosition=(n=u[this.startColumn])!==null&&n!==void 0?n:null;const h=s>0?r+1:r;i+r-h<-1*o||i>u.at(-1)+c||-1*i-r>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function ld(t,e,n){return(e=R8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R8(t){var e=E8(t,"string");return typeof e=="symbol"?e:e+""}function E8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class b${constructor(){ld(this,"count",0),ld(this,"startRow",null),ld(this,"endRow",null),ld(this,"startPosition",null),ld(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:o}=n;i<=r&&(this.startRow=e),i>=r&&i<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:o,totalRows:s,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===s-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=r-o)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,i+r-o<0||i>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function ud(t,e,n){return(e=T8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T8(t){var e=_8(t,"string");return typeof e=="symbol"?e:e+""}function _8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M8{constructor(){ud(this,"count",0),ud(this,"startColumn",0),ud(this,"endColumn",0),ud(this,"startPosition",0),ud(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function cd(t,e,n){return(e=P8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P8(t){var e=I8(t,"string");return typeof e=="symbol"?e:e+""}function I8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x8{constructor(){cd(this,"count",0),cd(this,"startRow",0),cd(this,"endRow",0),cd(this,"startPosition",0),cd(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function px(t,e,n){return(e=O8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O8(t){var e=A8(t,"string");return typeof e=="symbol"?e:e+""}function A8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class H8 extends y${constructor(){super(...arguments),px(this,"columnStartOffset",0),px(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:i,totalColumns:r,startPositions:o}=e;if(this.startColumn!==null&&typeof i=="function"){const s=this.startColumn,a=this.endColumn;i(this),this.columnStartOffset=s-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,r<this.endColumn&&(this.endColumn=r-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function wx(t,e,n){return(e=N8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N8(t){var e=D8(t,"string");return typeof e=="symbol"?e:e+""}function D8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $8 extends b${constructor(){super(...arguments),wx(this,"rowStartOffset",0),wx(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:i,totalRows:r,startPositions:o}=e;if(this.startRow!==null&&typeof i=="function"){const s=this.startRow,a=this.endRow;i(this),this.rowStartOffset=s-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,r<this.endRow&&(this.endRow=r-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function vx(t,e,n){return(e=k8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function k8(t){var e=L8(t,"string");return typeof e=="symbol"?e:e+""}function L8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S${constructor(e){vx(this,"calculationTypes",[]),vx(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[i,r]=n;this.calculationResults.set(i,r),r.initialize(e)})}_process(e,n){this.calculationTypes.forEach(i=>{let[,r]=i;return r.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,i]=n;return i.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Br(t,e,n){return(e=F8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F8(t){var e=V8(t,"string");return typeof e=="symbol"?e:e+""}function V8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Rh=50;class W8 extends S${constructor(e){let{calculationTypes:n,viewportWidth:i,scrollOffset:r,totalColumns:o,columnWidthFn:s,overrideFn:a,inlineStartOffset:l}=e;super(n),Br(this,"viewportWidth",0),Br(this,"scrollOffset",0),Br(this,"zeroBasedScrollOffset",0),Br(this,"totalColumns",0),Br(this,"columnWidthFn",null),Br(this,"columnWidth",0),Br(this,"overrideFn",null),Br(this,"inlineStartOffset",0),Br(this,"totalCalculatedWidth",0),Br(this,"startPositions",[]),Br(this,"needReverse",!0),this.viewportWidth=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?Rh:n}}function wr(t,e,n){return(e=B8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B8(t){var e=j8(t,"string");return typeof e=="symbol"?e:e+""}function j8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class U8 extends S${constructor(e){let{calculationTypes:n,viewportHeight:i,scrollOffset:r,totalRows:o,defaultRowHeight:s,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:u}=e;super(n),wr(this,"viewportHeight",0),wr(this,"scrollOffset",0),wr(this,"zeroBasedScrollOffset",0),wr(this,"totalRows",0),wr(this,"rowHeightFn",null),wr(this,"rowHeight",0),wr(this,"overrideFn",null),wr(this,"horizontalScrollbarHeight",0),wr(this,"innerViewportHeight",0),wr(this,"totalCalculatedHeight",0),wr(this,"startPositions",[]),wr(this,"needReverse",!0),this.defaultHeight=s,this.viewportHeight=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalRows=o,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=u??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function z8(t,e,n){Y8(t,e),e.set(t,n)}function Y8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cx(t,e,n){return(e=G8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function G8(t){var e=K8(t,"string");return typeof e=="symbol"?e:e+""}function K8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ec(t,e){return t.get(R$(t,e))}function yx(t,e,n){return t.set(R$(t,e),n),n}function R$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Cs=new WeakMap;class xu{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Cx(this,"row",null),Cx(this,"col",null),z8(this,Cs,!1),yx(Cs,this,i),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:i,countRowHeaders:r,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-r||this.row>=n||this.col>=i)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return ec(Cs,this)}isSouthEastOf(e){return this.row>=e.row&&(ec(Cs,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(ec(Cs,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(ec(Cs,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(ec(Cs,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof xu&&yx(Cs,this,e.isRtl()),this}clone(){return new xu(this.row,this.col,ec(Cs,this))}toObject(){return{row:this.row,col:this.col}}}function X8(t,e,n){q8(t,e),e.set(t,n)}function q8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ey(t,e,n){return(e=Z8(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z8(t){var e=J8(t,"string");return typeof e=="symbol"?e:e+""}function J8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vr(t,e){return t.get(E$(t,e))}function Q8(t,e,n){return t.set(E$(t,e),n),n}function E$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ti=new WeakMap;class Vh{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Ey(this,"highlight",null),Ey(this,"from",null),Ey(this,"to",null),X8(this,Ti,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=i.clone(),Q8(Ti,this,r)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:i}=e,r=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<=n&&o.row>=n&&r.col<=i&&o.col>=i}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>i.row||e.col>i.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(i.row,e.row),Math.max(i.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const i=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),o=this.getDirection(),s=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(i.row,s.row),u=Math.min(i.col,s.col),c=Math.max(r.row,a.row),h=Math.max(r.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return vr(Ti,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return vr(Ti,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return vr(Ti,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return vr(Ti,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return vr(Ti,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return vr(Ti,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return vr(Ti,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return vr(Ti,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof xu))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},r=[];return n.top===i.top&&r.push("top"),n.right===i.right&&r.push(vr(Ti,this)?"left":"right"),n.bottom===i.bottom&&r.push("bottom"),n.left===i.left&&r.push(vr(Ti,this)?"right":"left"),r}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[];for(let r=e.row;r<=n.row;r++)for(let o=e.col;o<=n.col;o++)!(this.from.row===r&&this.from.col===o)&&!(this.to.row===r&&this.to.col===o)&&i.push(this._createCellCoords(r,o));return i}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[];for(let r=e.row;r<=n.row;r++)for(let o=e.col;o<=n.col;o++)e.row===r&&e.col===o?i.push(e):n.row===r&&n.col===o?i.push(n):i.push(this._createCellCoords(r,o));return i}forAll(e){const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let r=n.row;r<=i.row;r++)for(let o=n.col;o<=i.col;o++)if(e(r,o)===!1)return}clone(){return new Vh(this.highlight,this.from,this.to,vr(Ti,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new xu(e,n,vr(Ti,this))}}function To(t,e,n){eZ(t,e),e.set(t,n)}function eZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fe(t,e){return t.get(T$(t,e))}function fa(t,e,n){return t.set(T$(t,e),n),n}function T$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Cr=new WeakMap,Ty=new WeakMap,Hn=new WeakMap,tc=new WeakMap,Jg=new WeakMap,jr=new WeakMap,_y=new WeakMap,hd=new WeakMap,ml=new WeakMap,_o=new WeakMap;let _$=class{constructor(e,n,i,r,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;To(this,Cr,void 0),To(this,Ty,void 0),To(this,Hn,void 0),To(this,tc,void 0),To(this,Jg,void 0),To(this,jr,void 0),To(this,_y,void 0),To(this,hd,void 0),To(this,ml,[null,null]),To(this,_o,[null,null]),fa(Cr,this,i),fa(Ty,this,n),fa(Hn,this,o),fa(tc,this,s),fa(Jg,this,a),fa(jr,this,r),fa(_y,this,e),this.registerEvents()}registerEvents(){fe(jr,this).addEventListener(fe(Hn,this).holder,"contextmenu",i=>this.onContextMenu(i)),fe(jr,this).addEventListener(fe(Hn,this).TABLE,"mouseover",i=>this.onMouseOver(i)),fe(jr,this).addEventListener(fe(Hn,this).TABLE,"mouseout",i=>this.onMouseOut(i));const e=()=>{fe(jr,this).addEventListener(fe(Hn,this).holder,"touchstart",i=>this.onTouchStart(i)),fe(jr,this).addEventListener(fe(Hn,this).holder,"touchend",i=>this.onTouchEnd(i)),this.momentumScrolling||(this.momentumScrolling={}),fe(jr,this).addEventListener(fe(Hn,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||fe(Cr,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,fe(Cr,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{fe(jr,this).addEventListener(fe(Hn,this).holder,"mouseup",i=>this.onMouseUp(i)),fe(jr,this).addEventListener(fe(Hn,this).holder,"mousedown",i=>this.onMouseDown(i))};rs()?e():(UD()&&e(),n())}selectedCellWasTouched(e){const i=this.parentCell(e).coords;if(fe(hd,this)&&i){const[r,o]=[i.row,fe(hd,this).from.row],[s,a]=[i.col,fe(hd,this).from.col];return r===o&&s===a}return!1}parentCell(e){const n={},i=fe(Hn,this).TABLE,r=qg(e,["TD","TH"],i);return r?(n.coords=fe(Hn,this).getCoords(r),n.TD=r):Ce(e,"wtBorder")&&Ce(e,"current")?(n.coords=fe(tc,this).getFocusSelection().cellRange.highlight,n.TD=fe(Hn,this).getCell(n.coords)):Ce(e,"wtBorder")&&Ce(e,"area")&&fe(tc,this).getAreaSelection().cellRange&&(n.coords=fe(tc,this).getAreaSelection().cellRange.to,n.TD=fe(Hn,this).getCell(n.coords)),n}onMouseDown(e){const n=fe(Ty,this).rootDocument.activeElement,i=s$(z9,e.target),r=e.target;if(!["TD","TH"].includes(n.nodeName)&&(r===n||i(0)===n||i(1)===n))return;const o=this.parentCell(r);Ce(r,"corner")?fe(Cr,this).getSetting("onCellCornerMouseDown",e,r):o.TD&&fe(Cr,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(fe(_o,this)[0]=o.TD,clearTimeout(fe(ml,this)[0]),fe(ml,this)[0]=setTimeout(()=>{fe(_o,this)[0]=null},1e3))}onContextMenu(e){if(fe(Cr,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!fe(Cr,this).has("onCellMouseOver"))return;const n=fe(Hn,this).TABLE,i=qg(e.target,["TD","TH"],n),r=fe(Jg,this)||this;i&&i!==r.lastMouseOver&&bu(i,n)&&(r.lastMouseOver=i,this.callListener("onCellMouseOver",e,fe(Hn,this).getCoords(i),i))}onMouseOut(e){if(!fe(Cr,this).has("onCellMouseOut"))return;const n=fe(Hn,this).TABLE,i=qg(e.target,["TD","TH"],n),r=qg(e.relatedTarget,["TD","TH"],n),o=fe(Jg,this)||this;i&&i!==r&&bu(i,n)&&(this.callListener("onCellMouseOut",e,fe(Hn,this).getCoords(i),i),r===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&fe(Cr,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===fe(_o,this)[0]&&n.TD===fe(_o,this)[1]?(Ce(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),fe(_o,this)[0]=null,fe(_o,this)[1]=null):n.TD===fe(_o,this)[0]&&(fe(_o,this)[1]=n.TD,clearTimeout(fe(ml,this)[1]),fe(ml,this)[1]=setTimeout(()=>{fe(_o,this)[1]=null},500)))}onTouchStart(e){fa(hd,this,fe(tc,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const i=e.target,r=(n=this.parentCell(i))===null||n===void 0?void 0:n.coords,o=te(r)&&r.row>=0&&r.col>=0;if(e.cancelable&&o&&fe(Cr,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];YD()&&(B9()||j9())&&this.selectedCellWasTouched(i)&&!a.includes(i.tagName)?e.preventDefault():this.selectedCellWasTouched(i)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,i,r){const o=fe(Cr,this).getSettingPure(e);o&&o(n,i,r,fe(_y,this).call(this))}destroy(){clearTimeout(fe(ml,this)[0]),clearTimeout(fe(ml,this)[1]),fe(jr,this).destroy()}};function My(t,e,n){return(e=tZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tZ(t){var e=nZ(t,"string");return typeof e=="symbol"?e:e+""}function nZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iZ{constructor(e,n,i){My(this,"offset",void 0),My(this,"total",void 0),My(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Py(t,e,n){return(e=rZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rZ(t){var e=oZ(t,"string");return typeof e=="symbol"?e:e+""}function oZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sZ{constructor(e,n,i){Py(this,"offset",void 0),Py(this,"total",void 0),Py(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function Qg(t,e,n){return(e=aZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aZ(t){var e=lZ(t,"string");return typeof e=="symbol"?e:e+""}function lZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uZ{constructor(){Qg(this,"currentSize",0),Qg(this,"nextSize",0),Qg(this,"currentOffset",0),Qg(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const cZ=0,bx=1,AR=2;function Iy(t,e,n){return(e=hZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hZ(t){var e=dZ(t,"string");return typeof e=="symbol"?e:e+""}function dZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fZ{constructor(){Iy(this,"size",new uZ),Iy(this,"workingSpace",cZ),Iy(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=bx,e.workingSpace=AR,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=AR,e.workingSpace=bx,this.sharedSize=e.getViewSize()}}var Sx=Tv,gZ=TypeError,mZ=function(t,e){if(!delete t[e])throw new gZ("Cannot delete property "+Sx(e)+" of "+Sx(t))},pZ=St,wZ=Hh,vZ=Dh,CZ=jH,yZ=mZ,bZ=UH,SZ=[].unshift(0)!==1,RZ=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},EZ=SZ||!RZ();pZ({target:"Array",proto:!0,arity:1,forced:EZ},{unshift:function(e){var n=wZ(this),i=vZ(n),r=arguments.length;if(r){bZ(i+r);for(var o=i;o--;){var s=o+r;o in n?n[s]=n[o]:yZ(n,s)}for(var a=0;a<r;a++)n[a]=arguments[a]}return CZ(n,i+r)}});function TZ(t,e,n){return(e=_Z(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _Z(t){var e=MZ(t,"string");return typeof e=="symbol"?e:e+""}function MZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rx{constructor(e,n){TZ(this,"order",[]),this.order=[...Array(n).keys()].map(i=>e+i)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function PZ(t,e,n){return(e=IZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IZ(t){var e=xZ(t,"string");return typeof e=="symbol"?e:e+""}function xZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OZ{constructor(e){PZ(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:i}=e.getViewSize();let r=Math.max(i,n);if(r===0)return[];const{currentOffset:o,nextOffset:s}=e.getViewSize(),a=new Rx(o,n),l=new Rx(s,i),u=[];for(let c=0;c<r;c++){const h=a.get(c),d=l.get(c);if(d===-1)u.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(AR)?u.push(["append",d]):u.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),i<=a.length&&(r-=1)),u.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);u.push(["insert_before",d,h,f])}else u.push(["none",d])}return u}}function nc(t,e,n){return(e=AZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AZ(t){var e=HZ(t,"string");return typeof e=="symbol"?e:e+""}function HZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M${constructor(e,n){nc(this,"rootNode",void 0),nc(this,"nodesPool",void 0),nc(this,"sizeSet",new fZ),nc(this,"collectedNodes",[]),nc(this,"viewDiffer",new OZ(this.sizeSet)),nc(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[i,r,o,s]=e,a=this.nodesPool(r);switch(this.collectedNodes.push(a),i){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(o)),n.removeChild(this.nodesPool(s));break;case"replace":n.replaceChild(a,this.nodesPool(o));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class P$ extends M${prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function Ex(t,e,n){return(e=NZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NZ(t){var e=DZ(t,"string");return typeof e=="symbol"?e:e+""}function DZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $Z{constructor(e){Ex(this,"nodeType",void 0),Ex(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const r=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(r))return this.pool.get(r);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(r,o),o}}function dd(t,e,n){return(e=kZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kZ(t){var e=LZ(t,"string");return typeof e=="symbol"?e:e+""}function LZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cg{constructor(e,n){dd(this,"nodesPool",null),dd(this,"nodeType",void 0),dd(this,"rootNode",void 0),dd(this,"table",null),dd(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new $Z(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function Tx(t,e,n){return(e=FZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FZ(t){var e=VZ(t,"string");return typeof e=="symbol"?e:e+""}function VZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WZ extends Cg{constructor(){super("TH"),Tx(this,"orderViews",new WeakMap),Tx(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new P$(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:i,rows:r,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=r.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(i).setOffset(0).start();for(let h=i-1;h>=0;h--){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Zs(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&le(d,[V6(),Z6(),y0(h+1),po(-1)]),n[h](a,d,h)}u.end()}}}class BZ extends Cg{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let i=this.rootNode.firstChild;if(e){const{columnsToRender:r}=this.table,o=r+n;for(let a=0,l=e;a<l;a++){for(i=this.rootNode.childNodes[a],i||(i=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(i)),this.renderedNodes=i.childNodes.length;this.renderedNodes<o;)i.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)i.removeChild(i.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else i&&ea(i)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&le(this.rootNode,[OD()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:i,columnsToRender:r,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&le(s,[AD(),$D(n+1)]);for(let a=-1*o;a<r;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Zs(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&le(u,[y0(a+1+this.table.rowHeadersCount),po(-1),W6(),...a>=0?[q6()]:[F6(),lr("Select whole grid")]]),i[n](l,u,n)}}}}let _x=!1;class jZ extends Cg{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,i=e+n;for(;this.renderedNodes<i;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>i;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!_x&&e>1e3&&(_x=!0,$e(nt`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let r=0;r<n;r++){const o=this.table.renderedColumnToSource(r),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[r].style.width=`${s}px`}for(let r=0;r<e;r++){const o=this.table.renderedColumnToSource(r),s=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[r+n].style.width=`${s}px`}const i=this.rootNode.firstChild;i&&B(i,"rowHeader")}}function UZ(t,e,n){return(e=zZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zZ(t){var e=YZ(t,"string");return typeof e=="symbol"?e:e+""}function YZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ic={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let Mx=!1;class GZ extends Cg{constructor(e){super("TR",e),UZ(this,"orderView",void 0),this.orderView=new M$(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!Mx&&e>1e3&&(Mx=!0,$e(nt`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&le(this.rootNode,[OD()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let r=0;r<e;r++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(r);if(this.table.isAriaEnabled()){var n,i;le(o,[AD(),$D(s+((n=(i=this.table.rowUtils)===null||i===void 0||(i=i.dataAccessObject)===null||i===void 0?void 0:i.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(s+1)%2===0?Ce(o,ic.rowEven)||(ae(o,ic.rowOdd),B(o,ic.rowEven)):Ce(o,ic.rowOdd)||(ae(o,ic.rowEven),B(o,ic.rowOdd))}this.orderView.end()}}function Px(t,e,n){return(e=KZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KZ(t){var e=XZ(t,"string");return typeof e=="symbol"?e:e+""}function XZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qZ extends Cg{constructor(){super("TD"),Px(this,"orderViews",new WeakMap),Px(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new P$(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:i,rowHeaders:r}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=i.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=r.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){c.render();const f=this.table.renderedColumnToSource(d),p=c.getCurrentNode();if(Ce(p,"hide")||(p.className=""),p.removeAttribute("style"),p.removeAttribute("dir"),Zs(p,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,p),this.table.isAriaEnabled()){var o,s;le(p,[...p.hasAttribute("role")?[]:[L6()],po(-1),y0(f+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function wn(t,e,n){return(e=ZZ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZZ(t){var e=JZ(t,"string");return typeof e=="symbol"?e:e+""}function JZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QZ{constructor(e){let{cellRenderer:n,stylesHandler:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};wn(this,"rootNode",void 0),wn(this,"rootDocument",void 0),wn(this,"rowHeaders",null),wn(this,"columnHeaders",null),wn(this,"colGroup",null),wn(this,"rows",null),wn(this,"cells",null),wn(this,"rowFilter",null),wn(this,"columnFilter",null),wn(this,"rowUtils",null),wn(this,"columnUtils",null),wn(this,"rowsToRender",0),wn(this,"columnsToRender",0),wn(this,"rowHeaderFunctions",[]),wn(this,"rowHeadersCount",0),wn(this,"columnHeaderFunctions",[]),wn(this,"columnHeadersCount",0),wn(this,"cellRenderer",void 0),wn(this,"activeOverlayName",void 0),wn(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=i}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:i,rows:r,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),i.setTable(this),r.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=i,this.rows=r,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let i=0;i<e;i++){const r=n.getRenderedNode(i),o=this.rowUtils;if(r.firstChild){const s=this.renderedRowToSource(i),a=o.getHeightByOverlayName(s,this.activeOverlayName),u=this.stylesHandler.areCellsBorderBox()?0:1;a?r.firstChild.style.height=`${a-u}px`:r.firstChild.style.height=""}}}}class eJ{constructor(){let{TABLE:e,THEAD:n,COLGROUP:i,TBODY:r,rowUtils:o,columnUtils:s,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new QZ(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new WZ,columnHeaders:new BZ(n),colGroup:new jZ(i),rows:new GZ(r),cells:new qZ}),this.renderer.setAxisUtils(o,s)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function xy(t,e,n){return(e=tJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tJ(t){var e=nJ(t,"string");return typeof e=="symbol"?e:e+""}function nJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iJ{constructor(e,n){xy(this,"dataAccessObject",void 0),xy(this,"wtSettings",void 0),xy(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return i!==void 0&&(n=n?Math.max(n,i):i),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const i=e.getSetting("rowHeaders").length,r=e.getSetting("defaultColumnWidth");for(let o=0;o<i;o++){let s=Array.isArray(n)?n[o]:n;s=s??r,this.headerWidths.set(o,s)}}}}function Ix(t,e,n){return(e=rJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rJ(t){var e=oJ(t,"string");return typeof e=="symbol"?e:e+""}function oJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sJ{constructor(e,n){Ix(this,"dataAccessObject",void 0),Ix(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}getHeightByOverlayName(e,n){let i=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(i=i===void 0?r:Math.max(i,r)),i}}function Mo(t,e,n){return(e=aJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aJ(t){var e=lJ(t,"string");return typeof e=="symbol"?e:e+""}function lJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wh{constructor(e,n,i,r,o){Mo(this,"wtSettings",null),Mo(this,"domBindings",void 0),Mo(this,"TBODY",null),Mo(this,"THEAD",null),Mo(this,"COLGROUP",null),Mo(this,"hasTableHeight",!0),Mo(this,"hasTableWidth",!0),Mo(this,"isTableVisible",!1),Mo(this,"tableOffset",0),Mo(this,"holderOffset",0),this.domBindings=i,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=r,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=i.rootTable,XD(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new sJ(this.dataAccessObject,this.wtSettings),this.columnUtils=new iJ(this.dataAccessObject,this.wtSettings),this.tableRenderer=new eJ({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ce(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",n&&n.insertBefore(i,e),i.appendChild(e)),i.style.position="relative",this.wtSettings.getSetting("ariaTags")&&le(i,[js()]),i}createHider(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ce(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",n&&n.insertBefore(i,e),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&le(i,[js()]),i}createHolder(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ce(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",this.isMaster&&le(i,[po(-1)]),n&&n.insertBefore(i,e),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&le(i.parentNode,[js()])),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&le(i,[js()]),i}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:i,wtViewport:r}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(i.beforeDraw(),this.holderOffset=oi(this.holder),h=r.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=i.inlineStartOverlay.getScrollPosition(),p=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,p!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&i.refresh(!0);else{this.isMaster?this.tableOffset=oi(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),p=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new sZ(f,o,c),this.columnFilter=new iZ(p,s,l);let v=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const b={};this.wtSettings.getSetting("beforeDraw",!0,b),v=b.skipRender!==!0}v&&(this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(es)||this.is(el))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(es))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||r.createVisibleCalculators(),i.refresh(!1),i.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(es)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(d=i.bottomOverlay.resetFixedPosition()||d),d=i.inlineStartOverlay.resetFixedPosition()||d,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(i.refreshAll(),i.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&i.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let i=this.wtSettings.getSetting("columnHeaders").length;const r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;i;)i-=1,o=this.getColumnHeaderHeight(i),s=this.getColumnHeader(n,i),s&&(a=gf(s),(!o&&r<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=a),Array.isArray(l)?l[i]!==null&&l[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(l[i]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,r=e.getSetting("columnHeaders");for(let o=0,s=r.length;o<s;o++)if(i[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${i[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(es))&&!e.getSetting("externalRowCalculator")){const i=this.getRenderedRowsCount();for(let r=0;r<i;r++){const o=this.rowFilter.renderedToSource(r);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,i=e.col;const r=this.wtSettings.getSetting("onModifyGetCellCoords",n,i,!this.isMaster,"render");if(r&&Array.isArray(r)&&([n,i]=r),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!s&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,i=null;if(e<0){var r;n=(r=this.rowFilter)===null||r===void 0?void 0:r.sourceRowToVisibleColHeadedRow(e),i=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),i=this.TBODY}return n!==void 0&&i!==void 0?i.childNodes.length<n+1?!1:i.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.THEAD.childNodes[n];return i==null?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(r=>{const o=r.childNodes[i];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.wtSettings.getSetting("rowHeaders").length;if(n>=i)return;const r=this.rowFilter.sourceToRendered(e),o=r<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):r,a=(r<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],i=this.wtSettings.getSetting("rowHeaders").length;for(let r=0;r<i;r++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[r];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=_u(n,["TD","TH"])),n===null)return null;const i=n.parentNode;if(!i)return null;const r=i.parentNode;let o=K9(i),s=n.cellIndex;fl(Hu,n,this.wtRootElement)||fl(Ou,n,this.wtRootElement)?r.nodeName==="THEAD"&&(o-=r.childNodes.length):fl(el,n,this.wtRootElement)||fl(es,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-r.childNodes.length+o:r===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),fl(Hu,n,this.wtRootElement)||fl(Au,n,this.wtRootElement)||fl(el,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return a&&Array.isArray(a)&&([o,s]=a),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=this.wtSettings.getSetting("stylesHandler"),i=e*n.getDefaultRowHeight(),r=gf(this.TBODY)-1,o=n.areCellsBorderBox(),s=o?yn:gf,a=o?0:1,l=o?1:0;let u,c,h,d,f;if(!(i===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),u=this.getRowHeight(h),d=this.getTrForRow(h),f=d.querySelector("th");const p=h===0?l:0;f?c=s(f):c=s(d)-a,(!u&&n.getDefaultRowHeight()<c-p||u<c)&&(o||(c+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=c)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=i}isRowHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=i}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return cn(this.TABLE)}getHeight(){return yn(this.TABLE)}getTotalWidth(){const e=cn(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=yn(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Pu(this.TABLE)}_modifyRowHeaderWidth(e){let n=ot(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const uJ="stickyRowsBottom",N0={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};aa(N0,"MIXIN_NAME",uJ,{writable:!1,enumerable:!1});const cJ="stickyColumnsStart",Yv={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};aa(Yv,"MIXIN_NAME",cJ,{writable:!1,enumerable:!1});class D0 extends Wh{constructor(e,n,i,r){super(e,n,i,r,el)}}ct(D0,N0);ct(D0,Yv);const Ou="top",es="bottom",Au="inline_start",Hu="top_inline_start_corner",el="bottom_inline_start_corner",I$=[Ou,es,Au,Hu,el],hJ=new Map([[Ou,`ht_clone_${Ou}`],[es,`ht_clone_${es}`],[Au,`ht_clone_${Au} ht_clone_left`],[Hu,`ht_clone_${Hu} ht_clone_top_left_corner`],[el,`ht_clone_${el} ht_clone_bottom_left_corner`]]);function dJ(t,e){fJ(t,e),e.add(t)}function fJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gJ(t,e,n){return(e=mJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mJ(t){var e=pJ(t,"string");return typeof e=="symbol"?e:e+""}function pJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function em(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var fd=new WeakSet;class wJ{constructor(e){dJ(this,fd),gJ(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,i){if(e.col<0||e.row<0)return!1;const r=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,i);return r||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:i,totalColumns:r}=this.dataAccessObject;if(!i)return!1;const o=cr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>r)return!1;n=o.value;const{fixedColumnsStart:s,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<s)return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(l&&(e<u||e>c)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:i,totalRows:r}=this.dataAccessObject;if(!i)return!1;const o=cr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>r)return!1;n=o.value;const{fixedRowsBottom:s,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,u=n==="auto";if(u&&(e<a||e>r-s-1))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(u&&(e<c||e>h)||!u)&&(d=l.scrollTo(e,u?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return em(fd,this,Ox).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return em(fd,this,Ox).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return em(fd,this,xx).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return em(fd,this,xx).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function xx(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:i,wtViewport:r,totalColumns:o,rootWindow:s}=this.dataAccessObject;if(n.mainTableScrollableElement===s){const a=e.getSetting("rtlMode");let l=null;if(a){const c=i.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=oi(i.wtRootElement).left;const u=Math.abs(ZD(s,s));if(l>u){const c=JD(s);let h=r.getRowHeaderWidth();for(let d=1;d<=o;d++)if(h+=n.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function Ox(t){const{topOverlay:e,wtTable:n,wtViewport:i,totalRows:r,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const s=oi(n.wtRootElement),a=_0(o,o);if(s.top>a){const l=gf(o);let u=i.getColumnHeaderHeight();for(let c=1;c<=r;c++)if(u+=e.sumCellSizes(c-1,c),s.top+u-a>=l){t=c-2;break}}}return t}function yr(t,e,n){return(e=vJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vJ(t){var e=CJ(t,"string");return typeof e=="symbol"?e:e+""}function CJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $0{get eventManager(){return new wo(this)}constructor(e,n){yr(this,"wtTable",void 0),yr(this,"wtScroll",void 0),yr(this,"wtViewport",void 0),yr(this,"wtOverlays",void 0),yr(this,"selectionManager",void 0),yr(this,"wtEvent",void 0),yr(this,"guid",`wt_${ID()}`),yr(this,"drawInterrupted",!1),yr(this,"drawn",!1),yr(this,"activeOverlayName","master"),yr(this,"domBindings",void 0),yr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new wJ(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,i){Mu(i,e[n])}])}}createCellCoords(e,n){return new xu(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,i){return new Vh(e,n,i,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||q9(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const i=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<r&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=i-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<i&&e.row>=i-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,i){return this.wtScroll.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function Ax(t,e,n){return(e=yJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yJ(t){var e=bJ(t,"string");return typeof e=="symbol"?e:e+""}function bJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class SJ extends $0{constructor(e,n,i){super(e,n),Ax(this,"cloneSource",void 0),Ax(this,"cloneOverlay",void 0);const r=this.wtSettings.getSetting("facade",this);this.cloneSource=i.source,this.cloneOverlay=i.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=i.viewport,this.selectionManager=i.selectionManager,this.wtEvent=new _$(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,i.event),this.findOriginalHeaders()}}function RJ(t,e,n){return(e=EJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EJ(t){var e=TJ(t,"string");return typeof e=="symbol"?e:e+""}function TJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yg{constructor(e,n,i,r,o){RJ(this,"wtSettings",null),aa(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=r;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=i,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Wf(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Wf(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=bw(e.TABLE)}getRelativeCellPosition(e,n,i){if(this.clone.wtTable.holder.contains(e)===!1){$e(`The provided element is not a child of the ${this.type} overlay`);return}const r=this.mainTableScrollableElement===this.domBindings.rootWindow,o=i<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return r?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,i,r){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=r.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+hn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=r.top,{start:i.start+s,top:i.top+a}}getRelativeCellPositionWithinHolder(e,n,i,r,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(i||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:r.start-a,top:r.top-l}}makeClone(){if(I$.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,o=i.createElement("div"),s=i.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${hJ.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&le(o,[js()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Ou||u==="vertical"&&this.type===Au?this.mainTableScrollableElement=r:r.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=bw(e.TABLE),new SJ(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,i=e.style,r=n.style,o=e.parentNode.style;[i,r,o].forEach(s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class _J extends yg{constructor(e,n,i,r,o,s){super(e,n,el,i,r),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new D0(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else jv(n),this.repositionOverlay();let i=yn(this.clone.wtTable.TABLE);const r=cn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),n.style.height=`${i}px`,n.style.width=`${r}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=hn(i)),r.style.bottom=`${o}px`}}const MJ="calculatedColumns",Gv={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};aa(Gv,"MIXIN_NAME",MJ,{writable:!1,enumerable:!1});class k0 extends Wh{constructor(e,n,i,r){super(e,n,i,r,es)}}ct(k0,N0);ct(k0,Gv);function PJ(t,e,n){return(e=IJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IJ(t){var e=xJ(t,"string");return typeof e=="symbol"?e:e+""}function xJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OJ extends yg{constructor(e,n,i,r){super(e,n,es,i,r),PJ(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new k0(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let i=0;const r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!r||r!=="vertical")?(i=this.getOverlayOffset(),n.style.bottom=`${i}px`):(i=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=hn(i)),r.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,i=this.mainTableScrollableElement;let r=!1;if(i===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(T0(n),top),r=o!==n.scrollY}else if(e!==i.scrollTop){const o=i.scrollTop;i.scrollTop=e,r=o!==i.scrollTop}return r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:i,wtSettings:r}=this.wot,o=r.getSetting("stylesHandler").getDefaultRowHeight();let s=e,a=0;for(;s<n;){const l=i.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=hn(i)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=yn(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let i=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=hn(this.domBindings.rootDocument)),n?(i+=this.sumCellSizes(0,e+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),i+=s,this.setScrollPosition(i)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return _0(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=r-o,a=this.domBindings.rootDocument.documentElement.clientHeight;i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+r,0),i>s&&(i=0)}return i}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==n,r=this.wtSettings.getSetting("columnHeaders");let o=!1;if((i||n===0)&&r.length>0){const s=this.wot.wtTable.holder.parentNode,a=Ce(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(B(s,"innerBorderBottom"),o=!a):(ae(s,"innerBorderBottom"),o=a)}return o}}const AJ="calculatedRows",L0={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};aa(L0,"MIXIN_NAME",AJ,{writable:!1,enumerable:!1});class F0 extends Wh{constructor(e,n,i,r){super(e,n,i,r,Au)}}ct(F0,L0);ct(F0,Yv);const HJ="localHooks",An={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},removeLocalHook(t,e){if(this._localHooks[t]){const n=this._localHooks[t].indexOf(e);n>-1&&this._localHooks[t].splice(n,1)}return this},runLocalHooks(t,e,n,i,r,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)RR(this._localHooks[t][l],this,e,n,i,r,o,s)}},clearLocalHooks(){return this._localHooks={},this}};aa(An,"MIXIN_NAME",HJ,{writable:!1,enumerable:!1});let x$=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};ct(x$,An);const O$="active-header",V0="header",W0="area",Ew="focus",NJ="fill",DJ="row",$J="column",kJ="custom-selection",B0=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),i=e.getCSSVariableValue("cell-autofill-border-width"),r=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:i,borderStyle:"solid",borderColor:r})};var LJ=zv;LJ("flat");function FJ(t,e){A$(t,e),e.add(t)}function Hx(t,e,n){A$(t,e),e.set(t,n)}function A$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wt(t,e){return t.get(mf(t,e))}function Nx(t,e,n){return t.set(mf(t,e),n),n}function mf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Xr=new WeakMap,ti=new WeakMap,tm=new WeakSet;class VJ{constructor(){FJ(this,tm),Hx(this,Xr,void 0),Hx(this,ti,void 0)}setActiveOverlay(e){return Nx(ti,this,e),this}setActiveSelection(e){return Nx(Xr,this,e),this}scan(){const e=Wt(Xr,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i))):e==="area"?this.scanCellsRange(i=>n.add(i)):e==="focus"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i)),this.scanCellsRange(i=>n.add(i))):e==="fill"?this.scanCellsRange(i=>n.add(i)):e==="header"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i))):e==="row"?(this.scanRowsInHeadersRange(i=>n.add(i)),this.scanRowsInCellsRange(i=>n.add(i))):e==="column"&&(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanColumnsInCellsRange(i=>n.add(i))),n}scanColumnsInHeadersRange(e){const[n,i,r,o]=Wt(Xr,this).getCorners(),{wtTable:s}=Wt(ti,this),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<i||h>o)){for(let d=-l;d<0;d++){if(d<n||d>r)continue;const f=d+l;let p=s.getColumnHeader(h,f);const v=Wt(ti,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:Wt(Xr,this).settings.selectionType,columnCursor:u,selectionWidth:o-i+1});v!==null&&(v!==h&&(p=s.getColumnHeader(v,f)),e(p))}u+=1}}}scanRowsInHeadersRange(e){const[n,i,r,o]=Wt(Xr,this).getCorners(),{wtTable:s}=Wt(ti,this),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>r)){for(let d=-l;d<0;d++){if(d<i||d>o)continue;const f=d+l;let p=s.getRowHeader(h,f);const v=Wt(ti,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:Wt(Xr,this).settings.selectionType,rowCursor:u,selectionHeight:r-n+1});v!==null&&(v!==h&&(p=s.getRowHeader(v,f)),e(p))}u+=1}}}scanCellsRange(e){const{wtTable:n}=Wt(ti,this);mf(tm,this,WJ).call(this,(i,r)=>{const o=n.getCell(Wt(ti,this).createCellCoords(i,r)),s=Wt(ti,this).getSetting("onAfterDrawSelection",i,r,Wt(Xr,this).settings.layerLevel);typeof s=="string"&&B(o,s),e(o)})}scanRowsInCellsRange(e){const[n,,i]=Wt(Xr,this).getCorners(),{wtTable:r}=Wt(ti,this);mf(tm,this,Dx).call(this,(o,s)=>{if(o>=n&&o<=i){const a=r.getCell(Wt(ti,this).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,i]=Wt(Xr,this).getCorners(),{wtTable:r}=Wt(ti,this);mf(tm,this,Dx).call(this,(o,s)=>{if(s>=n&&s<=i){const a=r.getCell(Wt(ti,this).createCellCoords(o,s));e(a)}})}}function WJ(t){let[e,n,i,r]=Wt(Xr,this).getCorners();if(e<0&&i<0||n<0&&r<0)return;const{wtTable:o}=Wt(ti,this),s=e!==i||n!==r;if(n=Math.max(n,0),r=Math.max(r,0),e=Math.max(e,0),i=Math.max(i,0),s){if(n=Math.max(n,o.getFirstRenderedColumn()),r=Math.min(r,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),i=Math.min(i,o.getLastRenderedRow()),r<n||i<e)return}else{const a=o.getCell(Wt(ti,this).createCellCoords(e,n));if(!Js(a))return}for(let a=e;a<=i;a+=1)for(let l=n;l<=r;l+=1)t(a,l)}function Dx(t){const{wtTable:e}=Wt(ti,this),n=e.getRenderedRowsCount(),i=e.getRenderedColumnsCount();for(let r=0;r<n;r+=1){const o=e.rowFilter.renderedToSource(r);for(let s=0;s<i;s+=1)t(o,e.columnFilter.renderedToSource(s))}}const $x="ht-border-style-",BJ="-vertical",jJ="-horizontal";class kx{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=B0(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,i=this.main.childNodes.length;n<i;n++){const r=this.main.childNodes[n];this.eventManager.addEventListener(r,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),$r(e);const i=this,r=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(i.eventManager.removeEventListener(r,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(r,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const i=["top","start","bottom","end","corner"];let r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(let a=0;a<5;a++){const l=i[a],u=n.createElement("div"),c=d=>this.settings[l]&&this.settings[l][d]?this.settings[l][d]:e.border[d];u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),r=u.style;const h=c("style");h?(["start","end"].includes(l)?u.className+=` ${$x}${h}${BJ}`:u.className+=` ${$x}${h}${jJ}`,r.setProperty("--ht-custom-border-size",`${c("width")}px`),r.setProperty("--ht-custom-border-color",c("color"))):r.backgroundColor=c("color"),r.height=`${c("width")}px`,r.width=`${c("width")}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),rs()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:n}=this.wot,i=n.getSetting("stylesHandler"),r=i.getCSSVariableValue("cell-mobile-handle-size"),o=i.getCSSVariableValue("cell-mobile-handle-border-radius"),s=i.getCSSVariableValue("cell-mobile-handle-background-color"),a=i.getCSSVariableValue("cell-mobile-handle-border-width"),l=i.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const u=10,c=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const h={position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`};We(h,(f,p)=>{this.selectionHandles.styles.bottomHitArea[p]=f,this.selectionHandles.styles.topHitArea[p]=f});const d=i.isClassicTheme()?{position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${o}px`,background:`${s}`,border:`${a}px solid ${l}`};We(d,(f,p)=>{this.selectionHandles.styles.bottom[p]=f,this.selectionHandles.styles.top[p]=f}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const i=this.wot.selectionManager.getAreaSelection();return!!(i.cellRange&&(e!==i.cellRange.to.row||n!==i.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,i,r,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),p=parseInt(u.width,10),v=parseInt(c.width,10),b=this.wot.wtTable.getWidth(),P=this.wot.wtTable.getHeight();u.top=`${parseInt(i-p-1,10)}px`,u[l]=`${parseInt(r-p-1,10)}px`,c.top=`${parseInt(i-v/4*3,10)}px`,c[l]=`${parseInt(r-v/4*3,10)}px`;const _=Math.min(parseInt(r+o,10),b-p-f*2),F=Math.min(parseInt(r+o-v/4,10),b-v-f*2);h[l]=`${_}px`,d[l]=`${F}px`;const I=Math.min(parseInt(i+s,10),P-p-f*2),W=Math.min(parseInt(i+s-v/4,10),P-v-f*2);h.top=`${I}px`,d.top=`${W}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;let[n,i,r,o]=e;if(n<0&&r<0||i<0&&o<0){this.disappear();return}const{wtTable:s,rootDocument:a,rootWindow:l}=this.wot,u=n!==r||i!==o,c=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),h=s.getFirstRenderedRow(),d=s.getLastRenderedRow(),f=s.getFirstRenderedColumn(),p=s.getLastRenderedColumn();if(f<0&&p<0||h<0&&d<0){this.disappear();return}let v;if(u){if(i=Math.max(i,f),o=Math.min(o,p),n=Math.max(n,h),r=Math.min(r,d),o<i||r<n){this.disappear();return}v=s.getCell(this.wot.createCellCoords(n,i))}else if(v=s.getCell(this.wot.createCellCoords(n,i)),!Js(v)){this.disappear();return}const b=u?s.getCell(this.wot.createCellCoords(r,o)):v,P=oi(v),_=u?oi(b):P,F=oi(s.TABLE),I=P.top,W=P.left,k=this.wot.wtSettings.getSetting("rtlMode");let $=0,Y=0;if(k){const Oe=cn(s.TABLE),Re=cn(v),Ae=l.innerWidth-F.left-Oe;Y=W+Re-_.left,$=l.innerWidth-W-Re-Ae-1}else Y=_.left+cn(b)-W,$=W-F.left-1;if(this.isEntireColumnSelected(n,r)){const Oe=n,Re=this.getDimensionsFromHeader("columns",i,o,Oe,F);let Ae=null;Re&&([Ae,$,Y]=Re),Ae&&(v=Ae)}let J=I-F.top-1,U=_.top+yn(b)-I;if(this.isEntireRowSelected(i,o)){const Oe=i,Re=this.getDimensionsFromHeader("rows",n,r,Oe,F);let Ae=null;Re&&([Ae,J,U]=Re),Ae&&(v=Ae)}const oe=l.getComputedStyle(v);parseInt(oe.borderTopWidth,10)>0&&(J+=1,U=U>0?U-1:0),parseInt(oe[k?"borderRightWidth":"borderLeftWidth"],10)>0&&($+=1,Y=Y>0?Y-1:0);const j=k?"right":"left",Z=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${J}px`,this.topStyle[j]=`${$}px`,this.topStyle.width=`${Y+Z}px`,this.topStyle.display="block",this.startStyle.top=`${J}px`,this.startStyle[j]=`${$}px`,this.startStyle.height=`${U+Z}px`,this.startStyle.display="block",this.bottomStyle.top=`${J+U-parseInt(this.bottomStyle.height,10)+Z}px`,this.bottomStyle[j]=`${$}px`,this.bottomStyle.width=`${Y+Z}px`,this.bottomStyle.display="block",this.endStyle.top=`${J}px`,this.endStyle[j]=`${$+Y-parseInt(this.endStyle.width,10)+Z}px`,this.endStyle.height=`${U+Z}px`,this.endStyle.display="block";let re=this.settings.border.cornerVisible;re=typeof re=="function"?re(this.settings.layerLevel):re;const pe=this.wot.getSetting("onModifyGetCellCoords",r,o,!1,"render");let[Xe,xe]=[r,o];if(pe&&Array.isArray(pe)&&([,,Xe,xe]=pe),rs()||!re||this.isPartRange(Xe,xe))this.cornerStyle.display="none";else{this.cornerStyle.top=`${J+U+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[j]=`${$+Y+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Oe=Wf(s.TABLE);const Re=Oe===l;Re&&(Oe=a.documentElement);const Ae=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Ze=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),gt=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const ke=Re?b.getBoundingClientRect().left:b.offsetLeft;let G=!1,g=0;if(k?(g=ke-parseInt(this.cornerDefaultStyle.width,10)/2,G=g<0):(g=ke+cn(b)+parseInt(this.cornerDefaultStyle.width,10)/2,G=g>=JD(Oe)),G){const w=Math.floor($+Y+this.cornerCenterPointOffset-Ze-Ae);c?(this.cornerStyle[j]=`${w}px`,this.cornerStyle[k?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[j]=`${w-1}px`}}if(r===this.wot.getSetting("totalRows")-1&&(Re?b.getBoundingClientRect().top:b.offsetTop)+yn(b)+parseInt(this.cornerDefaultStyle.height,10)/2>=gf(Oe)){const w=Math.floor(J+U+this.cornerCenterPointOffset-gt-Ae);c?(this.cornerStyle.top=`${w}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${w-1}px`}this.cornerStyle.display="block"}rs()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(r,o,J,$,Y,U)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,i,r,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,p=null,v=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return yn(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return cn(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const b=this.wot.getSetting("columnHeaders").length;if(p=l(n,b-r),v=l(i,b-r),!p||!v)return!1;const P=oi(p),_=oi(v);return p&&v&&(h=P[f]-o[f]-1,d=_[f]+u(v)-P[f]),[p,h,d]}return!1}changeBorderStyle(e,n){const i=this[e].style,r=n[e];!r||r.hide?B(this[e],"hidden"):(Ce(this[e],"hidden")&&ae(this[e],"hidden"),i.backgroundColor=r.color,(e==="top"||e==="bottom")&&(i.height=`${r.width}px`),(e==="start"||e==="end")&&(i.width=`${r.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},i=this[e].style;i.backgroundColor=n.color,i.width=`${n.width}px`,i.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?B(this[e],"hidden"):ae(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",rs()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function UJ(t,e){H$(t,e),e.add(t)}function rc(t,e,n){H$(t,e),e.set(t,n)}function H$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fe(t,e){return t.get(j0(t,e))}function Lx(t,e,n){return t.set(j0(t,e),n),n}function j0(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ni=new WeakMap,Ni=new WeakMap,Oy=new WeakMap,tf=new WeakMap,Ay=new WeakMap,pl=new WeakMap,Fx=new WeakSet;class zJ{constructor(e){UJ(this,Fx),rc(this,ni,void 0),rc(this,Ni,void 0),rc(this,Oy,new VJ),rc(this,tf,new WeakMap),rc(this,Ay,new WeakSet),rc(this,pl,new Map),Lx(Ni,this,e)}setActiveOverlay(e){return Lx(ni,this,e),Fe(Oy,this).setActiveOverlay(Fe(ni,this)),Fe(tf,this).has(Fe(ni,this))||Fe(tf,this).set(Fe(ni,this),new Set),this}getFocusSelection(){return Fe(Ni,this)!==null?Fe(Ni,this).getFocus():null}getAreaSelection(){return Fe(Ni,this)!==null?Fe(Ni,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Fe(pl,this).has(e)){const i=Fe(pl,this).get(e);if(i.has(Fe(ni,this)))return i.get(Fe(ni,this));const r=new kx(Fe(ni,this),e.settings);return i.set(Fe(ni,this),r),r}const n=new kx(Fe(ni,this),e.settings);return Fe(pl,this).set(e,new Map([[Fe(ni,this),n]])),n}getBorderInstances(e){var n,i;return Array.from((n=(i=Fe(pl,this).get(e))===null||i===void 0?void 0:i.values())!==null&&n!==void 0?n:[])}destroyBorders(e){Fe(pl,this).get(e).forEach(n=>n.destroy()),Fe(pl,this).delete(e)}render(e){if(Fe(Ni,this)===null)return;e&&j0(Fx,this,YJ).call(this);const n=Array.from(Fe(Ni,this)),i=new Map,r=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;Fe(Ay,this).has(s)||(Fe(Ay,this).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&Fe(Oy,this).setActiveSelection(s).scan().forEach(p=>{if(i.has(p)){const v=i.get(p);v.has(a)&&u===!0?v.set(a,v.get(a)+1):v.set(a,1)}else i.set(p,new Map([[a,1]]));l&&(r.has(p)||r.set(p,[]),p.nodeName==="TH"&&r.get(p).push(...l))});const d=s.getCorners();Fe(ni,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}i.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>Fe(tf,this).get(Fe(ni,this)).add(u)),B(s,l),s.nodeName==="TD"&&Array.isArray((a=Fe(Ni,this).options)===null||a===void 0?void 0:a.cellAttributes)&&le(s,Fe(Ni,this).options.cellAttributes)}),Array.from(r.keys()).forEach(o=>{le(o,[...r.get(o)])})}}function YJ(){const t=Fe(tf,this).get(Fe(ni,this)),e=Fe(ni,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var i,r;const o=Fe(ni,this).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((i=Fe(Ni,this).options)===null||i===void 0?void 0:i.cellAttributes)&&(s=Fe(Ni,this).options.cellAttributes.map(a=>a[0])),Array.isArray((r=Fe(Ni,this).options)===null||r===void 0?void 0:r.headerAttributes)&&(s=[...s,...Fe(Ni,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)ae(o[a],n),Zs(o[a],s)}),t.clear()}class GJ extends yg{constructor(e,n,i,r){super(e,n,Au,i,r)}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new F0(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!r||r!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),M0(i,`${o}px`,"0px")):(o=this.getScrollPosition(),jv(i));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let i=!1;this.isRtl()&&(e=-e);const r=this.mainTableScrollableElement;if(r===n&&e!==n.scrollX){const o=n.scrollX;n.scrollTo(e,qD(n)),i=o!==n.scrollX}else if(e!==r.scrollLeft){const o=r.scrollLeft;r.scrollLeft=e,i=o!==r.scrollLeft}return i}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const i=this.wtSettings.getSetting("defaultColumnWidth");let r=e,o=0;for(;r<n;)o+=this.wot.wtTable.getColumnWidth(r)||i,r+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let u=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(u-=hn(i)),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=cn(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=B0(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:i}=this,r=i.getSetting("rowHeaders"),o=i.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=o===0&&r.length>0&&!Ce(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(c=hn(this.domBindings.rootDocument)),n?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,J9(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(ZD(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?i=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const r=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=r-o;i>s&&(i=0)}return i}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,r=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),s=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";s?ae(i,"emptyRows"):B(i,"emptyRows");let l=!1;if(!a){if(o&&!r.length)B(i,"innerBorderLeft innerBorderInlineStart");else if(!o&&r.length){const u=Ce(i,"innerBorderInlineStart");e?(B(i,"innerBorderLeft innerBorderInlineStart"),l=!u):(ae(i,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const KJ="stickyRowsTop",U0={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};aa(U0,"MIXIN_NAME",KJ,{writable:!1,enumerable:!1});class z0 extends Wh{constructor(e,n,i,r){super(e,n,i,r,Hu)}}ct(z0,U0);ct(z0,Yv);function Vx(t,e,n){return(e=XJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XJ(t){var e=qJ(t,"string");return typeof e=="symbol"?e:e+""}function qJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZJ extends yg{constructor(e,n,i,r,o,s){super(e,n,Hu,i,r),Vx(this,"topOverlay",void 0),Vx(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new z0(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const r=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();M0(e,`${r}px`,`${o}px`)}else jv(e);let n=yn(this.clone.wtTable.TABLE);const i=cn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${i}px`,!1}}class Y0 extends Wh{constructor(e,n,i,r){super(e,n,i,r,Ou)}}ct(Y0,U0);ct(Y0,Gv);function JJ(t,e,n){return(e=QJ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QJ(t){var e=eQ(t,"string");return typeof e=="symbol"?e:e+""}function eQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tQ extends yg{constructor(e,n,i,r){super(e,n,Ou,i,r),JJ(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new Y0(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow");let r=0,o=!1;if(this.trimmingContainer===n&&(!i||i!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,r=this.getOverlayOffset(),M0(e,"0px",`${r}px`)}else r=this.getScrollPosition(),jv(e);const s=this.adjustHeaderBordersPosition(r,o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings,i=this.mainTableScrollableElement;let r=!1;if(i===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(T0(n),e),r=o!==n.scrollY}else if(e!==i.scrollTop){const o=i.scrollTop;i.scrollTop=e,r=o!==i.scrollTop}return r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let r=e,o=0;for(;r<n;){const s=this.wot.wtTable.getRowHeight(r);o+=s===void 0?i:s,r+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=n.getWorkspaceWidth();n.hasVerticalScroll()&&(u-=hn(i)),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=yn(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=B0(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:i,wtSettings:r}=this,s=(i.cloneSource?i.cloneSource:i).wtTable.holder,a=r.getSetting("columnHeaders"),u=r.getSetting("fixedRowsTop")===0&&a.length>0&&!Ce(s.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(h=hn(this.domBindings.rootDocument)),n){const d=r.getSetting("fixedRowsBottom"),f=r.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=i.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(r.getSetting("fixedRowsTop"),e);return c+=h,Z9(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return _0(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=r-o;i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),i>s&&(i=0)}return i}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:i}=this,r=this.wot.wtTable.holder.parentNode,o=i.getSetting("totalColumns"),s=i.getSetting("preventOverflow")==="horizontal";o?ae(r,"emptyColumns"):B(r,"emptyColumns");let a=!1;if(!n&&!s){const l=i.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=i.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=Ce(r,"innerBorderTop");this.cachedFixedRowsTop=i.getSetting("fixedRowsTop"),e||i.getSetting("totalRows")===0?(B(r,"innerBorderTop"),a=!h):(ae(r,"innerBorderTop"),a=h)}}return a}}function nm(t,e,n){nQ(t,e),e.set(t,n)}function nQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ys(t,e,n){return(e=iQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iQ(t){var e=rQ(t,"string");return typeof e=="symbol"?e:e+""}function rQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wl(t,e,n){return t.set(N$(t,e),n),n}function bs(t,e){return t.get(N$(t,e))}function N$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var oc=new WeakMap,im=new WeakMap,sc=new WeakMap,rm=new WeakMap;class oQ{constructor(e,n,i,r,o,s){ys(this,"wot",null),nm(this,oc,[]),ys(this,"topOverlay",null),ys(this,"bottomOverlay",null),ys(this,"inlineStartOverlay",null),ys(this,"topInlineStartCornerOverlay",null),ys(this,"bottomInlineStartCornerOverlay",null),ys(this,"browserLineHeight",void 0),ys(this,"wtSettings",null),nm(this,im,!1),nm(this,sc,0),nm(this,rm,null),ys(this,"resizeObserver",new ResizeObserver(c=>{Cw(()=>{!Array.isArray(c)||!c.length||(wl(sc,this,bs(sc,this)+1),bs(sc,this)===300&&($e("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),bs(rm,this)!==null&&clearTimeout(bs(rm,this)),wl(rm,this,setTimeout(()=>{wl(sc,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=r,this.domBindings=i,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=hn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:bw(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...bs(oc,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,i=e.getComputedStyle(n.body),r=parseInt(i.lineHeight,10),o=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=r||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new tQ(...e),this.bottomOverlay=new OJ(...e),this.inlineStartOverlay=new GJ(...e),this.topInlineStartCornerOverlay=new ZJ(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new _J(...e,this.bottomOverlay,this.inlineStartOverlay),wl(oc,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){wl(im,this,bs(oc,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),bs(oc,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),bs(oc,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:i}=this.topOverlay,{mainTableScrollableElement:r}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0}),i!==r&&this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!zD())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let c;this.eventManager.addEventListener(n,"resize",()=>{Cw(()=>{clearTimeout(c),this.wtSettings.getSetting("onWindowResize"),c=setTimeout(()=>{wl(sc,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(r!==n&&o!==n&&!e.target.contains(r)||i!==n&&o!==n&&!e.target.contains(i))||this.syncScrollPositions(e)}onCloneWheel(e,n){if(e.ctrlKey)return;const{rootWindow:i}=this.domBindings,r=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==i&&s!==i&&!s.contains(o),l=r!==i&&s!==i&&!s.contains(r);if(this.keyPressed&&(a||l)||this.scrollableElement===i)return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==i&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Sh(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,i=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(i+=i*this.browserLineHeight,n+=n*this.browserLineHeight);const r=this.scrollVertically(n),o=this.scrollHorizontally(i);return r||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let i=this.scrollableElement.scrollLeft,r=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(i=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(r=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==i,this.verticalScrolling=this.lastScrollY!==r,this.lastScrollX=i,this.lastScrollY=r,this.horizontalScrolling){e.scrollLeft=i;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=i)}this.verticalScrolling&&(n.scrollTop=r),this.refreshAll()}syncScrollWithMaster(){if(!bs(im,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:i}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i),wl(im,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=bw(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,i=e.clientHeight,r=n!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=i),r}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:i}=this.domBindings,r=this.scrollableElement===i,o=this.wtSettings.getSetting("totalColumns"),s=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),l=e.getColumnHeaderHeight(),u=this.wtSettings.getSetting("externalRowCalculator")?0:1,c=l+this.topOverlay.sumCellSizes(0,s)+u,h=a+this.inlineStartOverlay.sumCellSizes(0,o),f=n.hider.style,p=()=>r?!1:this.scrollableElement.scrollTop>Math.max(0,c-n.holder.clientHeight),v=()=>r?!1:this.scrollableElement.scrollLeft>Math.max(0,h-n.holder.clientWidth),b=p()?1:0,P=v()?1:0;f.width=`${h+P}px`,f.height=`${c+b}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let i=null;return O(n,r=>{r&&r.clone&&r.clone.wtTable.TABLE.contains(e)&&(i=r.clone)}),i}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];O(n,i=>{i&&(i.clone.wtTable.TABLE.className=e.className)})}}function Wx(t,e,n){return(e=sQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sQ(t){var e=aQ(t,"string");return typeof e=="symbol"?e:e+""}function aQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lQ{constructor(e){Wx(this,"settings",{}),Wx(this,"defaults",Object.freeze(this.getDefaults())),We(this.defaults,(n,i)=>{if(e[i]!==void 0)this.settings[i]=e[i];else{if(n===void 0)throw new Error(`A required setting "${i}" was not provided`);this.settings[i]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,i)=>{const r=this.getSetting("data",e,n);Mu(i,r??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,n){return n===void 0?We(e,(i,r)=>{this.settings[r]=i}):this.settings[e]=n,this}getSetting(e,n,i,r,o){return typeof this.settings[e]=="function"?this.settings[e](n,i,r,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class G0 extends Wh{constructor(e,n,i,r){super(e,n,i,r,"master")}alignOverlaysWithTrimmingContainer(){const e=Wf(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const i=e.parentElement,r=Sw(e,"height",n),o=Sw(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(i&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?i.insertBefore(d,e.nextElementSibling):i.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);i.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=r==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Pu(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,i="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[i]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[i]=!0}}}ct(G0,L0);ct(G0,Gv);class uQ{constructor(e,n,i,r,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=i,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new x8:new $8],["fullyVisible",()=>new y8],["partiallyVisible",()=>new b$]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new M8:new H8],["fullyVisible",()=>new w8],["partiallyVisible",()=>new y$]]),this.eventManager=r,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let i=0;return n===this.domBindings.rootWindow?i=e.documentElement.clientHeight:i=yn(n)>0&&n.clientHeight>0?n.clientHeight:1/0,i}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let r;if(i===n){const o=this.wtSettings.getSetting("totalColumns");r=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>r&&(r=e.documentElement.clientWidth)}else r=i.clientWidth;return r}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,i=e.clientHeight,r=n.offsetHeight;return i<r?!0:r>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const r=this.domBindings.rootDocument.documentElement;return r.scrollWidth>r.clientWidth}const{hider:e}=this.wtTable,n=e.offsetWidth,i=this.hasVerticalScroll()?hn():0;return n>this.getWorkspaceWidth()-i}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let i=0,r=e;for(;r<n;)i+=this.wtTable.getColumnWidth(r),r+=1;return i}getWorkspaceOffset(){return oi(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=yn(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let i=0,r=n.length;i<r;i++)this.rowHeaderWidth+=e[i]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let i=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let r=0,o=n.length;r<o;r++)i?(this.rowHeaderWidth+=cn(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:i}=this;let r=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,r-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),r-=s),i.holder.clientHeight===i.holder.offsetHeight?o=0:o=hn(this.domBindings.rootDocument),new U8({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:r,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:n.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:h=>i.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:i}=this;let r=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,r-=a}return i.holder.clientWidth!==i.holder.offsetWidth&&(r-=hn(this.domBindings.rootDocument)),new W8({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:r,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>i.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,i=this.createRowsCalculator(),r=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=i.getResultsFor("fullyVisible"),s=i.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o,s)}if(e&&!n.getSetting("renderAllColumns")){const o=r.getResultsFor("fullyVisible"),s=r.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o,s)}return e||(this.rowsRenderCalculator=i.getResultsFor("rendered"),this.columnsRenderCalculator=r.getResultsFor("rendered")),this.rowsVisibleCalculator=i.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e,n){if(!this.rowsVisibleCalculator)return!1;let{startRow:i,endRow:r}=e;const{startRow:o,endRow:s}=n;if(i===null&&r===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isRowBeforeRenderedRows(o)&&!this.wtTable.isRowAfterRenderedRows(s))return!0;i=o,r=s}const{startRow:a,endRow:l,rowStartOffset:u,rowEndOffset:c}=this.rowsRenderCalculator,h=this.wtSettings.getSetting("totalRows")-1,d=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(d)&&d>0?(i=Math.max(0,i-Math.min(u,d)),r=Math.min(h,r+Math.min(c,d))):d==="auto"&&(i=Math.max(0,i-Math.ceil(u/2)),r=Math.min(h,r+Math.ceil(c/2))),i<a||i===a&&i>0?!1:!(r>l||r===l&&r<h)}areAllProposedVisibleColumnsAlreadyRendered(e,n){if(!this.columnsVisibleCalculator)return!1;let{startColumn:i,endColumn:r}=e;const{startColumn:o,endColumn:s}=n;if(i===null&&r===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isColumnBeforeRenderedColumns(o)&&!this.wtTable.isColumnAfterRenderedColumns(s))return!0;i=o,r=s}const{startColumn:a,endColumn:l,columnStartOffset:u,columnEndOffset:c}=this.columnsRenderCalculator,h=this.wtSettings.getSetting("totalColumns")-1,d=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(d)&&d>0?(i=Math.max(0,i-Math.min(u,d)),r=Math.min(h,r+Math.min(c,d))):d==="auto"&&(i=Math.max(0,i-Math.ceil(u/2)),r=Math.min(h,r+Math.ceil(c/2))),i<a||i===a&&i>0?!1:!(r>l||r===l&&r<h)}resetHasOversizedColumnHeadersMarked(){We(this.hasOversizedColumnHeadersMarked,(e,n,i)=>{i[n]=void 0})}}class cQ extends $0{constructor(e,n){super(e,new lQ(n));const i=this.wtSettings.getSetting("facade",this);this.wtTable=new G0(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=new uQ(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new zJ(this.wtSettings.getSetting("selections")),this.wtEvent=new _$(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new oQ(this,i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],i=[];We(e,(r,o)=>{this.wtSettings.getSetting(o).length&&i.push(r),n.push(r)}),ae(this.wtTable.wtRootElement.parentNode,n),B(this.wtTable.wtRootElement.parentNode,i)}getOverlayByName(e){var n;if(!I$.includes(e))return null;const i=e.replace(/_([a-z])/g,r=>r[1].toUpperCase());return(n=this.wtOverlays[`${i}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class K0{constructor(e){e instanceof $0?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const i=new K0(n);return()=>i},this._wot=new cQ(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,i){return this._wot.createCellRange(e,n,i)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,i){return this._wot.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,i,r,o){return this._wot.wtSettings.getSetting(e,n,i,r,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function Bx(t){let{isShiftKey:e,isLeftClick:n,isRightClick:i,coords:r,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&l)r.row>=0&&r.col>=0&&!s.cell?o.setRangeEnd(r):(u||c)&&r.row>=0&&r.col>=0&&!s.cell?o.setRangeEnd(a(r.row,r.col)):u&&r.row<0&&!s.column?o.setRangeEnd(a(l.to.row,r.col)):c&&r.col<0&&!s.row?o.setRangeEnd(a(r.row,l.to.col)):(!u&&!c&&r.col<0||u&&r.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),r.row,r.col):(!u&&!c&&r.row<0||c&&r.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),r.col,r.row);else{const h=!o.inInSelection(r),d=n||i&&h;r.row<0&&r.col>=0&&!s.column?d&&o.selectColumns(r.col,r.col,r.row):r.col<0&&r.row>=0&&!s.row?d&&o.selectRows(r.row,r.row,r.col):r.col>=0&&r.row>=0&&!s.cell?d&&o.setRangeStart(r):r.col<0&&r.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function hQ(t){let{isLeftClick:e,coords:n,selection:i,controller:r,cellCoordsFactory:o}=t;if(!e)return;const s=i.isSelectedByRowHeader(),a=i.isSelectedByColumnHeader(),l=i.tableProps.countCols(),u=i.tableProps.countRows();i.markSource("mouse"),a&&!r.column?i.setRangeEnd(o(u-1,n.col)):s&&!r.row?i.setRangeEnd(o(n.row,l-1)):r.cell||i.setRangeEnd(n),i.markEndSource()}function jx(t){let{isLeftClick:e,selection:n,cellRangeMapper:i}=t;if(!e||n.settings.selectionMode!=="multiple")return;const r=n.getSelectedRange(),o=r.clone().map(a=>i.toRenderable(a)),s=o.current();if(o.size()>1&&!s.isHeader()&&!n.isMultiple(s)){const a=o.findAll(s);a.length===o.size()?(r.pop(),n.refresh()):a.length>1&&(r.removeLayers(a.map(l=>{let{layer:u}=l;return u})),n.refresh())}}const dQ=new Map([["touchstart",Bx],["touchend",jx],["mousedown",Bx],["mouseover",hQ],["mouseup",jx]]);function Hy(t,e){dQ.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:P0(t)||t.type==="touchstart",isRightClick:Iu(t),...e})}const D$=new WeakMap,X0=Symbol("rootInstance");function fQ(t){D$.set(t,!0)}function gQ(t){return t===X0}function Uo(t){return D$.has(t)}function mQ(t,e){$$(t,e),e.add(t)}function ga(t,e,n){$$(t,e),e.set(t,n)}function $$(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ma(t,e,n){return(e=pQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pQ(t){var e=wQ(t,"string");return typeof e=="symbol"?e:e+""}function wQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sn(t,e){return t.get(mh(t,e))}function _i(t,e,n){return t.set(mh(t,e),n),n}function mh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ny=new WeakMap,om=new WeakMap,sm=new WeakMap,Ss=new WeakMap,Ur=new WeakMap,Dy=new WeakMap,$y=new WeakMap,ac=new WeakMap,nf=new WeakSet;class vQ{constructor(e){mQ(this,nf),ma(this,"hot",void 0),ma(this,"eventManager",void 0),ma(this,"settings",void 0),ma(this,"THEAD",void 0),ma(this,"TBODY",void 0),ma(this,"_wt",void 0),ma(this,"activeWt",void 0),ga(this,Ny,0),ga(this,om,0),ma(this,"postponedAdjustElementsSize",!1),ga(this,sm,!1),ga(this,Ss,void 0),ga(this,Ur,void 0),ga(this,Dy,0),ga(this,$y,0),ga(this,ac,null),this.hot=e,this.eventManager=new wo(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this._wt.draw(!e),mh(nf,this,yQ).call(this),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?this._wt.wtOverlays.adjustElementsSize():this.postponedAdjustElementsSize=!0}getCellAtCoords(e,n){const i=this._wt.getCell(e,n);return i<0?null:i}scrollViewport(e,n,i){return this._wt.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,i=e.getAttribute("style");i&&e.setAttribute("data-originalstyle",i),B(e,"handsontable"),_i(Ur,this,n.createElement("TABLE")),B(sn(Ur,this),"htCore"),this.hot.getSettings().tableClassName&&B(sn(Ur,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(le(sn(Ur,this),[js()]),le(e,[k6(),DD(-1),Lv(this.hot.countCols()),t9()])),this.THEAD=n.createElement("THEAD"),sn(Ur,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),sn(Ur,this).appendChild(this.TBODY),this.hot.table=sn(Ur,this),this.hot.container.insertBefore(sn(Ur,this),this.hot.container.firstChild)}registerEvents(){const{rootWrapperElement:e,rootElement:n,rootDocument:i,selection:r,rootWindow:o}=this.hot,s=i.documentElement;this.eventManager.addEventListener(n,"mousedown",l=>{_i(sm,this,!0),this.isTextSelectionAllowed(l.target)||(tx(o),l.preventDefault(),o.focus())}),this.eventManager.addEventListener(n,"mouseup",()=>{_i(sm,this,!1)}),this.eventManager.addEventListener(n,"mousemove",l=>{sn(sm,this)&&!this.isTextSelectionAllowed(l.target)&&(this.settings.fragmentSelection&&tx(o),l.preventDefault())}),this.eventManager.addEventListener(s,"keyup",l=>{r.isInProgress()&&!l.shiftKey&&r.finish()}),this.eventManager.addEventListener(s,"mouseup",l=>{r.isInProgress()&&P0(l)&&r.finish(),_i(Ss,this,!1);const u=n$(i.activeElement);Wp(i.activeElement)&&!u||(u||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!(e??n).contains(l.target)&&!Iu(l))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",l=>{r.isInProgress()&&Iu(l)&&(r.finish(),_i(Ss,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{r.isInProgress()&&r.finish(),_i(Ss,this,!1)}),this.eventManager.addEventListener(s,"mousedown",l=>{const u=l.target,c=l.x||l.clientX,h=l.y||l.clientY;let d=l.target;if(sn(Ss,this)||!n||!this.hot.view)return;const{holder:f}=this._wt.wtTable;if(d===f){const v=hn(i);if(i.elementFromPoint(c+v,h)!==f||i.elementFromPoint(c,h+v)!==f)return}else for(;d!==s;){if(d===null){if(l.isTargetWebComponent)break;return}if(d===n)return;d=d.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(u):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let a=il(o);for(;a!==null;)this.eventManager.addEventListener(a.document.documentElement,"click",()=>{this.hot.unlisten()}),a=il(a);this.eventManager.addEventListener(sn(Ur,this),"selectstart",l=>{this.settings.fragmentSelection||Wp(l.target)||l.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:i}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,i))}translateFromRenderableToVisualIndex(e,n){let i=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return i===null&&(i=e),r===null&&(r=n),[i,r]}countRenderableIndexes(e,n){const i=Math.min(e.getNotTrimmedIndexesLength(),n),r=e.getNearestNotHiddenIndex(i-1,-1);return r===null?0:e.getRenderableFromVisualIndex(r)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,i,r){if(isNaN(e)||e<0)return 0;const o=i.getNearestNotHiddenIndex(e,n),s=i.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=r-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let i=0;for(let r=e;r<=n;r++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(r)!==null&&(i+=1);return i}countRenderableRowsInRange(e,n){let i=0;for(let r=e;r<=n;r++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(r)!==null&&(i+=1);return i}addClassNameToLicenseElement(e){var n;const i=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");i&&B(i,e)}removeClassNameFromLicenseElement(e){var n;const i=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");i&&ae(i,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:sn(Ur,this),isDataViewInstance:()=>Uo(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),_i(om,this,o.length),this.hot.getSettings().ariaTags&&mh(nf,this,k$).call(this)===this.hot.countCols()&&mh(nf,this,CQ).call(this,sn(om,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),_i(Ny,this,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},rowHeightByOverlayName:(o,s)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),l=a===null?o:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u,!1,"meta");let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),p=this.hot.colToProp(d);let v=this.hot.getDataAtRowProp(h,p);this.hot.hasHook("beforeValueRender")&&(v=this.hot.runHooks("beforeValueRender",v,f)),this.hot.runHooks("beforeRenderer",a,l,u,p,v,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,p,v,f),this.hot.runHooks("afterRenderer",a,l,u,p,v,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Pu(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,_i(Ss,this,!0),_i(ac,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!nu(o)&&(Hy(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,_i(Ss,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!nu(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!nu(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!nu(o)&&(sn(Ss,this)&&(!sn(ac,this)||sn(ac,this).x!==o.clientX||sn(ac,this).y!==o.clientY)&&Hy(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt,_i(ac,this,null))},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(nu(o)||this.hot.isDestroyed)&&(Hy(o,{coords:u,selection:this.hot.selection,cellRangeMapper:B7(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,s)=>{const a=this.hot.rowIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollVertically",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:(o,s)=>{const a=this.hot.columnIndexMapper,l=o<0;let u=o;return!l&&(u=a.getVisualFromRenderableIndex(o),u===null)?o:(u=this.hot.runHooks("beforeViewportScrollHorizontally",u,s),this.hot.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a,l)=>{const u=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,h=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?u.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[p,v,b,P]=f;return[p>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(p,1)):p,v>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(v,1)):v,b>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(b,-1)):b,P>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(P,-1)):P]}},onModifyGetCoordsElement:(o,s)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,u=s>=0?l.getVisualFromRenderableIndex(s):s,c=o>=0?a.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCoordsElement",c,u);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.max(1,Math.ceil(u/a*12));o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.max(1,Math.ceil(u/a*6));o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new K0(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:i,height:r}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(i,r),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){var n,i;if(Wp(e))return!0;const r=bu(e,this._wt.wtTable.spreader);if(this.settings.fragmentSelection===!0&&r)return!0;const o=(n=(i=this.hot.getSelectedRangeActive())===null||i===void 0?void 0:i.isSingleCell())!==null&&n!==void 0?n:!1;return!!(this.settings.fragmentSelection==="cell"&&o&&r||!this.settings.fragmentSelection&&this.isCellEdited()&&o)}isMouseDown(){return sn(Ss,this)}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const i=n.firstChild;if(!Ce(i,"relative")){ea(n),this.appendRowHeader(e,n);return}this.updateCellHeader(i.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:i,getRowHeader:r}=this.hot,o=i.createElement("div"),s=i.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,r),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const s=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return s?s.split(" "):[]};if(n.firstChild){const s=n.firstChild;Ce(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,i,r),s.className="",B(s,["relative",...o()])):(ea(n),this.appendColHeader(e,n,i,r))}else{const{rootDocument:s}=this.hot,a=s.createElement("div"),l=s.createElement("span"),u=o();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(le(a,...js()),le(l,...js())),this.updateCellHeader(l,e,i,r),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,r)}updateCellHeader(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Ce(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):Ce(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?Yu(e,i(n,r)):(Mu(e,"Â "),B(e,"cornerHeader"))}maximumVisibleElementWidth(e){const i=this._wt.wtViewport.getWorkspaceWidth()-e;return i>0?i:0}maximumVisibleElementHeight(e){const i=this._wt.wtViewport.getWorkspaceHeight()-e;return i>0?i:0}setLastSize(e,n){_i(Dy,this,e),_i($y,this,n)}getLastSize(){return{width:sn(Dy,this),height:sn($y,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return sn(Ny,this)}getRowHeadersCount(){return sn(om,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTotalTableWidth(){return this._wt.wtTable.getTotalWidth()}getTotalTableHeight(){return this._wt.wtTable.getTotalHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getTableScrollPosition(){return{left:this._wt.wtTable.holder.scrollLeft,top:this._wt.wtTable.holder.scrollTop}}setTableScrollPosition(e){this._wt.wtTable.holder.scrollLeft=e.left,this._wt.wtTable.holder.scrollTop=e.top}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function k$(){return parseInt(this.hot.rootElement.getAttribute(Lv()[0]),10)}function CQ(t){const e=mh(nf,this,k$).call(this)+t;le(this.hot.rootElement,...Lv(e))}function yQ(){const t=this.hot.rootElement;this.hasVerticalScroll()?B(t,"htHasScrollY"):ae(t,"htHasScrollY"),this.isVerticallyScrollableByWindow()?B(t,"htVerticallyScrollableByWindow"):ae(t,"htVerticallyScrollableByWindow"),this.hasHorizontalScroll()?B(t,"htHasScrollX"):ae(t,"htHasScrollX"),this.isHorizontallyScrollableByWindow()?B(t,"htHorizontallyScrollableByWindow"):ae(t,"htHorizontallyScrollableByWindow")}var bQ=St,SQ=Sn,RQ=$h,EQ=Wi,TQ=Rn,_Q=hs,MQ=Bi,PQ=sl,ky=PQ("every",TypeError);bQ({target:"Iterator",proto:!0,real:!0,forced:ky},{every:function(e){TQ(this);try{EQ(e)}catch(r){MQ(this,"throw",r)}if(ky)return SQ(ky,this,e);var n=_Q(this),i=0;return!RQ(n,function(r,o){if(!e(r,i++))return o()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});const IQ="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Ux=IQ.length;function xQ(t){let e=t+1,n="",i;for(;e>0;)i=(e-1)%Ux,n=String.fromCharCode(65+i)+n,e=parseInt((e-i)/Ux,10);return n}function L$(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const i=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((r,o)=>{Array.isArray(r)?r.forEach((s,a)=>{i.push([o+e,a,s])}):Object.keys(r).forEach(s=>{i.push([o+e,s,r[s]])})}),i}function F$(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&me(t[0])&&(e=R0(t[0]))),e}function OQ(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function AQ(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}function gd(t,e,n){return(e=HQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HQ(t){var e=NQ(t,"string");return typeof e=="symbol"?e:e+""}function NQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DQ{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];gd(this,"hot",void 0),gd(this,"data",void 0),gd(this,"dataType","array"),gd(this,"colToProp",()=>{}),gd(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return O(this.data,(i,r)=>{const o=this.getAtCell(r,e);n.push(o)}),n}getAtRow(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&i===void 0,{dataDotNotation:s}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],o?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):he(n,i,u=>{l[u-n]=this.getAtPhysicalCell(e,u,a)});else if(me(a)||ot(a))if(r?l=[]:l={},!o||r){const c=this.countFirstRowKeys()-1;he(0,c,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(i||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);r?l.push(f):s?hy(l,d,f):l[d]=f}})}else We(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);s?hy(l,c,h):l[c]=h});return l}setAtCell(e,n,i){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const r=cr(i);this.hot.runHooks("modifySourceData",e,n,r,"set"),r.isTouched()&&(i=r.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=i:hy(this.data[e],n,i))}}getAtPhysicalCell(e,n,i){let r=null;if(i)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();r=o?bR(i,n):i[n]}else typeof n=="function"?r=n(i):r=i[n];if(this.hot.hasHook("modifySourceData")){const o=cr(r);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(r=o.value)}return r}getAtCell(e,n){const i=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),i)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=!1,o=null,s=null,a=null,l=null;e===null||n===null?(r=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return he(o,a,c=>{u.push(r?this.getAtRow(c,void 0,void 0,i):this.getAtRow(c,s,l,i))}),u}getCopyable(e,n){const i=this.propToCol(n);return this.hot.getCellMeta(e,i).copyable?this.getAtCell(this.hot.toPhysicalRow(e),i):""}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return F$(this.data)}destroy(){this.data=null,this.hot=null}}var $Q=St,kQ=Sn,LQ=$h,FQ=Wi,VQ=Rn,WQ=hs,BQ=Bi,jQ=sl,Ly=jQ("some",TypeError);$Q({target:"Iterator",proto:!0,real:!0,forced:Ly},{some:function(e){VQ(this);try{FQ(e)}catch(r){BQ(this,"throw",r)}if(Ly)return kQ(Ly,this,e);var n=WQ(this),i=0;return LQ(n,function(r,o){if(e(r,i++))return o()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});function zx(t,e,n){return(e=UQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UQ(t){var e=zQ(t,"string");return typeof e=="symbol"?e:e+""}function zQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;zx(this,"indexedValues",[]),zx(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,ot(this.initValueOrFn)?he(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):he(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}ct(Gu,An);function q0(t,e,n,i){const r=n.length?n[0]:void 0;return[...t.slice(0,r),...n.map((o,s)=>ot(i)?i(o,s):i),...r===void 0?[]:t.slice(r)]}function Z0(t,e){return Tu(t,(n,i)=>e.includes(i)===!1)}class ll extends Gu{insert(e,n){this.indexedValues=q0(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=Z0(this.indexedValues,e),super.remove(e)}}class Kv extends ll{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return ji(this.getValues(),(e,n,i)=>(n&&e.push(i),e),[])}}function J0(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function Bf(t,e){return Tu(t,n=>e.includes(n)===!1)}function Q0(t,e){return tt(t,n=>n-e.filter(i=>i<n).length)}function eT(t,e){const n=e[0],i=e.length;return tt(t,r=>r>=n?r+i:r)}function YQ(t,e,n){return(e=GQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GQ(t){var e=KQ(t,"string");return typeof e=="symbol"?e:e+""}function KQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xv extends Gu{constructor(){super(...arguments),YQ(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(i,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Bf(this.orderOfIndexes,[e]),ot(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=q0(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=eT(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=Z0(this.indexedValues,e),this.orderOfIndexes=Bf(this.orderOfIndexes,e),this.orderOfIndexes=Q0(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class bg extends ll{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return ji(this.getValues(),(e,n,i)=>(n&&e.push(i),e),[])}}const Yx=new Map([["indexesSequence",{getListWithInsertedItems:J0,getListWithRemovedItems:Bf}],["physicallyIndexed",{getListWithInsertedItems:q0,getListWithRemovedItems:Z0}]]),V$=t=>{if(Yx.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return Yx.get(t)};class W$ extends Gu{constructor(){super(e=>e)}insert(e,n){const i=eT(this.indexedValues,n);this.indexedValues=J0(i,e,n),super.insert(e,n)}remove(e){const n=Bf(this.indexedValues,e);this.indexedValues=Q0(n,e),super.remove(e)}}const Gx=new Map([["hiding",Kv],["index",Gu],["linkedPhysicalIndexToValue",Xv],["physicalIndexToValue",ll],["trimming",bg]]);function XQ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!Gx.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(Gx.get(t))(e)}function qQ(t,e,n){return(e=ZQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZQ(t){var e=JQ(t,"string");return typeof e=="symbol"?e:e+""}function JQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tT{constructor(){qQ(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)))}unregister(e){const n=this.collection.get(e);te(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n))}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return xt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(i=>{i.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}ct(tT,An);function Fy(t,e,n){return(e=QQ(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QQ(t){var e=eee(t,"string");return typeof e=="symbol"?e:e+""}function eee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kx extends tT{constructor(e,n){super(),Fy(this,"mergedValuesCache",[]),Fy(this,"aggregationFunction",void 0),Fy(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=tt(this.get(),o=>o.getValues()),i=[],r=te(n[0])&&n[0].length||0;for(let o=0;o<r;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);i.push(s)}return tt(i,this.aggregationFunction)}getMergedValueAtIndex(e,n){const i=this.getMergedValues(n)[e];return te(i)?i:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function tee(t,e,n){nee(t,e),e.set(t,n)}function nee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iee(t,e,n){return t.set(B$(t,e),n),n}function ree(t,e){return t.get(B$(t,e))}function B$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Vy=new WeakMap;class j${constructor(){tee(this,Vy,[])}subscribe(e){return this.addLocalHook("change",e),this._write(ree(Vy,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){iee(Vy,this,e)}}ct(j$,An);function Xx(t,e){const n=[];let i=0,r=0;for(;i<t.length&&r<e.length;i++,r++)t[i]!==e[r]&&n.push({op:"replace",index:r,oldValue:t[i],newValue:e[r]});for(;i<e.length;i++)n.push({op:"insert",index:i,oldValue:void 0,newValue:e[i]});for(;r<t.length;r++)n.push({op:"remove",index:r,oldValue:t[r],newValue:void 0});return n}function md(t,e,n){oee(t,e),e.set(t,n)}function oee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function br(t,e){return t.get(U$(t,e))}function am(t,e,n){return t.set(U$(t,e),n),n}function U$(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var lm=new WeakMap,pd=new WeakMap,um=new WeakMap,cm=new WeakMap,hm=new WeakMap;class see{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};md(this,lm,new Set),md(this,pd,[]),md(this,um,[]),md(this,cm,!1),md(this,hm,!1),am(hm,this,e??!1)}createObserver(){const e=new j$;return br(lm,this).add(e),e.addLocalHook("unsubscribe",()=>{br(lm,this).delete(e)}),e._writeInitialChanges(Xx(br(pd,this),br(um,this))),e}emit(e){let n=br(um,this);(!br(cm,this)||br(pd,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(br(hm,this)):am(pd,this,new Array(e.length).fill(br(hm,this))),br(cm,this)||(am(cm,this,!0),n=br(pd,this)));const i=Xx(n,e);br(lm,this).forEach(r=>r._write(i)),am(um,this,e)}}function li(t,e,n){return(e=aee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aee(t){var e=lee(t,"string");return typeof e=="symbol"?e:e+""}function lee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HR{constructor(){li(this,"indexesSequence",new W$),li(this,"trimmingMapsCollection",new Kx(e=>e.some(n=>n===!0),!1)),li(this,"hidingMapsCollection",new Kx(e=>e.some(n=>n===!0),!1)),li(this,"variousMapsCollection",new tT),li(this,"hidingChangesObservable",new see({initialIndexValue:!1})),li(this,"notTrimmedIndexesCache",[]),li(this,"notHiddenIndexesCache",[]),li(this,"isBatched",!1),li(this,"indexesSequenceChanged",!1),li(this,"indexesChangeSource",void 0),li(this,"trimmedIndexesChanged",!1),li(this,"hiddenIndexesChanged",!1),li(this,"renderablePhysicalIndexesCache",[]),li(this,"fromPhysicalToVisualIndexesCache",new Map),li(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,i){return this.registerMap(e,XQ(n,i))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof bg?this.trimmingMapsCollection.register(e,n):n instanceof Kv?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const i=this.getNumberOfIndexes();return i>0&&n.init(i),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return te(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return te(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return te(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return te(n)?n:null}getNearestNotHiddenIndex(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?i?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const i=[...Array(this.getNumberOfIndexes()-e).keys()].map(r=>r+e);this.removeIndexes(i)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(i=>this.isTrimmed(i)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(i=>this.isHidden(i)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(i=>this.isHidden(i)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const i=tt(e,u=>this.getPhysicalFromVisualIndex(u)),r=this.getNotTrimmedIndexesLength(),o=e.length,s=Bf(this.getIndexesSequence(),i),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<r){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(J0(s,l,i)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const r=this.getNotTrimmedIndexes()[e],o=te(r)?r:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),a=tt(new Array(n).fill(o),(u,c)=>u+c);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,a),this.indexesChangeSource=void 0;const l=i==="end"?a.map(u=>u+1):a;this.trimmingMapsCollection.insertToEvery(s,l),this.hidingMapsCollection.insertToEvery(s,l),this.variousMapsCollection.insertToEvery(s,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const i=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(i,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const i=this.getPhysicalFromRenderableIndex(n),r=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(r,n)}}}ct(HR,An);function uee(t,e){return We(e,(n,i)=>{xt(t[i])&&(t[i]=n)}),t}function z$(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function Y$(t){te(t)&&I0(nt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function cee(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}function G$(t,e){return Array.isArray(t)?t.map(n=>G$(n,e)):v0(t,e)}const{register:hee,getValues:dee}=Vr("phraseFormatters");function K$(t,e){hee(t,e)}function fee(){return dee()}K$("pluralize",cee);K$("substitute",G$);const nT="Common:",Tw=`${nT}ok`,iT=`${nT}cancel`,X$="ContextMenu:items",Me=X$,rT=`${Me}.noItems`,oT=`${Me}.insertRowAbove`,sT=`${Me}.insertRowBelow`,aT=`${Me}.insertColumnOnTheLeft`,lT=`${Me}.insertColumnOnTheRight`,uT=`${Me}.removeRow`,cT=`${Me}.removeColumn`,hT=`${Me}.undo`,dT=`${Me}.redo`,_w=`${Me}.readOnly`,fT=`${Me}.clearColumn`,gT=`${Me}.copy`,mT=`${Me}.copyWithHeaders`,pT=`${Me}.copyWithGroupHeaders`,wT=`${Me}.copyHeadersOnly`,vT=`${Me}.cut`,CT=`${Me}.freezeColumn`,yT=`${Me}.unfreezeColumn`,bT=`${Me}.mergeCells`,ST=`${Me}.unmergeCells`,RT=`${Me}.addComment`,ET=`${Me}.editComment`,TT=`${Me}.removeComment`,_T=`${Me}.readOnlyComment`,MT=`${Me}.align`,PT=`${Me}.align.left`,IT=`${Me}.align.center`,xT=`${Me}.align.right`,OT=`${Me}.align.justify`,AT=`${Me}.align.top`,HT=`${Me}.align.middle`,NT=`${Me}.align.bottom`,DT=`${Me}.borders`,$T=`${Me}.borders.top`,kT=`${Me}.borders.right`,LT=`${Me}.borders.bottom`,FT=`${Me}.borders.left`,VT=`${Me}.borders.remove`,WT=`${Me}.nestedHeaders.insertChildRow`,BT=`${Me}.nestedHeaders.detachFromParent`,jT=`${Me}.hideColumn`,UT=`${Me}.showColumn`,zT=`${Me}.hideRow`,YT=`${Me}.showRow`,Ri="Filters:",Kt=`${Ri}conditions`,qv=`${Kt}.none`,GT=`${Kt}.isEmpty`,KT=`${Kt}.isNotEmpty`,XT=`${Kt}.isEqualTo`,qT=`${Kt}.isNotEqualTo`,ZT=`${Kt}.beginsWith`,JT=`${Kt}.endsWith`,QT=`${Kt}.contains`,e_=`${Kt}.doesNotContain`,gee=`${Kt}.byValue`,t_=`${Kt}.greaterThan`,n_=`${Kt}.greaterThanOrEqualTo`,i_=`${Kt}.lessThan`,r_=`${Kt}.lessThanOrEqualTo`,o_=`${Kt}.isBetween`,s_=`${Kt}.isNotBetween`,a_=`${Kt}.after`,l_=`${Kt}.before`,u_=`${Kt}.today`,c_=`${Kt}.tomorrow`,h_=`${Kt}.yesterday`,d_=`${Ri}labels.filterByCondition`,f_=`${Ri}labels.filterByValue`,g_=`${Ri}labels.conjunction`,Zv=`${Ri}labels.disjunction`,Mw=`${Ri}values.blankCells`,m_=`${Ri}buttons.selectAll`,p_=`${Ri}buttons.clear`,w_=`${Ri}buttons.ok`,v_=`${Ri}buttons.cancel`,C_=`${Ri}buttons.placeholder.search`,y_=`${Ri}buttons.placeholder.value`,b_=`${Ri}buttons.placeholder.secondValue`,gs="Pagination:",S_=`${gs}section.pagination`,R_=`${gs}.pageSize.auto`,Pw=`${gs}section.pageSize`,E_=`${gs}section.counter`,T_=`${gs}section.navigation`,__=`${gs}firstPage`,M_=`${gs}prevPage`,P_=`${gs}nextPage`,I_=`${gs}lastPage`,x_="CheckboxRenderer:",O_=`${x_}checked`,A_=`${x_}unchecked`,q$="Loading:",H_=`${q$}title`,Bh="EmptyDataState:",N_=`${Bh}title`,D_=`${Bh}description`,$_=`${Bh}title.filters`,k_=`${Bh}description.filters`,L_=`${Bh}buttons.filters.reset`,mee=Object.freeze(Object.defineProperty({__proto__:null,CANCEL:iT,CHECKBOX_CHECKED:O_,CHECKBOX_RENDERER_NAMESPACE:x_,CHECKBOX_UNCHECKED:A_,COMMON_NAMESPACE:nT,CONTEXTMENU_ITEMS_ADD_COMMENT:RT,CONTEXTMENU_ITEMS_ALIGNMENT:MT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:NT,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:IT,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:OT,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:PT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:HT,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:xT,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:AT,CONTEXTMENU_ITEMS_BORDERS:DT,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:LT,CONTEXTMENU_ITEMS_BORDERS_LEFT:FT,CONTEXTMENU_ITEMS_BORDERS_RIGHT:kT,CONTEXTMENU_ITEMS_BORDERS_TOP:$T,CONTEXTMENU_ITEMS_CLEAR_COLUMN:fT,CONTEXTMENU_ITEMS_COPY:gT,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:wT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:pT,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:mT,CONTEXTMENU_ITEMS_CUT:vT,CONTEXTMENU_ITEMS_EDIT_COMMENT:ET,CONTEXTMENU_ITEMS_FREEZE_COLUMN:CT,CONTEXTMENU_ITEMS_HIDE_COLUMN:jT,CONTEXTMENU_ITEMS_HIDE_ROW:zT,CONTEXTMENU_ITEMS_INSERT_LEFT:aT,CONTEXTMENU_ITEMS_INSERT_RIGHT:lT,CONTEXTMENU_ITEMS_MERGE_CELLS:bT,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:BT,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:WT,CONTEXTMENU_ITEMS_NO_ITEMS:rT,CONTEXTMENU_ITEMS_READ_ONLY:_w,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:_T,CONTEXTMENU_ITEMS_REDO:dT,CONTEXTMENU_ITEMS_REMOVE_BORDERS:VT,CONTEXTMENU_ITEMS_REMOVE_COLUMN:cT,CONTEXTMENU_ITEMS_REMOVE_COMMENT:TT,CONTEXTMENU_ITEMS_REMOVE_ROW:uT,CONTEXTMENU_ITEMS_ROW_ABOVE:oT,CONTEXTMENU_ITEMS_ROW_BELOW:sT,CONTEXTMENU_ITEMS_SHOW_COLUMN:UT,CONTEXTMENU_ITEMS_SHOW_ROW:YT,CONTEXTMENU_ITEMS_UNDO:hT,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:yT,CONTEXTMENU_ITEMS_UNMERGE_CELLS:ST,CONTEXT_MENU_ITEMS_NAMESPACE:X$,EMPTY_DATA_STATE_BUTTONS_FILTERS_RESET:L_,EMPTY_DATA_STATE_DESCRIPTION:D_,EMPTY_DATA_STATE_DESCRIPTION_FILTERS:k_,EMPTY_DATA_STATE_NAMESPACE:Bh,EMPTY_DATA_STATE_TITLE:N_,EMPTY_DATA_STATE_TITLE_FILTERS:$_,FILTERS_BUTTONS_CANCEL:v_,FILTERS_BUTTONS_CLEAR:p_,FILTERS_BUTTONS_OK:w_,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:C_,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:b_,FILTERS_BUTTONS_PLACEHOLDER_VALUE:y_,FILTERS_BUTTONS_SELECT_ALL:m_,FILTERS_CONDITIONS_AFTER:a_,FILTERS_CONDITIONS_BEFORE:l_,FILTERS_CONDITIONS_BEGINS_WITH:ZT,FILTERS_CONDITIONS_BETWEEN:o_,FILTERS_CONDITIONS_BY_VALUE:gee,FILTERS_CONDITIONS_CONTAINS:QT,FILTERS_CONDITIONS_EMPTY:GT,FILTERS_CONDITIONS_ENDS_WITH:JT,FILTERS_CONDITIONS_EQUAL:XT,FILTERS_CONDITIONS_GREATER_THAN:t_,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:n_,FILTERS_CONDITIONS_LESS_THAN:i_,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:r_,FILTERS_CONDITIONS_NAMESPACE:Kt,FILTERS_CONDITIONS_NONE:qv,FILTERS_CONDITIONS_NOT_BETWEEN:s_,FILTERS_CONDITIONS_NOT_CONTAIN:e_,FILTERS_CONDITIONS_NOT_EMPTY:KT,FILTERS_CONDITIONS_NOT_EQUAL:qT,FILTERS_CONDITIONS_TODAY:u_,FILTERS_CONDITIONS_TOMORROW:c_,FILTERS_CONDITIONS_YESTERDAY:h_,FILTERS_DIVS_FILTER_BY_CONDITION:d_,FILTERS_DIVS_FILTER_BY_VALUE:f_,FILTERS_LABELS_CONJUNCTION:g_,FILTERS_LABELS_DISJUNCTION:Zv,FILTERS_NAMESPACE:Ri,FILTERS_VALUES_BLANK_CELLS:Mw,LOADING_NAMESPACE:q$,LOADING_TITLE:H_,OK:Tw,PAGINATION_COUNTER_SECTION:E_,PAGINATION_FIRST_PAGE:__,PAGINATION_LAST_PAGE:I_,PAGINATION_NAMESPACE:gs,PAGINATION_NAV_SECTION:T_,PAGINATION_NEXT_PAGE:P_,PAGINATION_PAGE_SIZE_AUTO:R_,PAGINATION_PAGE_SIZE_SECTION:Pw,PAGINATION_PREV_PAGE:M_,PAGINATION_SECTION:S_},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const Z$={languageCode:"en-US",[Tw]:"OK",[iT]:"Cancel",[rT]:"No available options",[oT]:"Insert row above",[sT]:"Insert row below",[aT]:"Insert column left",[lT]:"Insert column right",[uT]:["Remove row","Remove rows"],[cT]:["Remove column","Remove columns"],[hT]:"Undo",[dT]:"Redo",[_w]:"Read only",[fT]:"Clear column",[MT]:"Alignment",[PT]:"Left",[IT]:"Center",[xT]:"Right",[OT]:"Justify",[AT]:"Top",[HT]:"Middle",[NT]:"Bottom",[CT]:"Freeze column",[yT]:"Unfreeze column",[DT]:"Borders",[$T]:"Top",[kT]:"Right",[LT]:"Bottom",[FT]:"Left",[VT]:"Remove border(s)",[RT]:"Add comment",[ET]:"Edit comment",[TT]:"Delete comment",[_T]:"Read-only comment",[bT]:"Merge cells",[ST]:"Unmerge cells",[gT]:"Copy",[mT]:["Copy with header","Copy with headers"],[pT]:["Copy with group header","Copy with group headers"],[wT]:["Copy header only","Copy headers only"],[vT]:"Cut",[WT]:"Insert child row",[BT]:"Detach from parent",[jT]:["Hide column","Hide columns"],[UT]:["Show column","Show columns"],[zT]:["Hide row","Hide rows"],[YT]:["Show row","Show rows"],[qv]:"None",[GT]:"Is empty",[KT]:"Is not empty",[XT]:"Is equal to",[qT]:"Is not equal to",[ZT]:"Begins with",[JT]:"Ends with",[QT]:"Contains",[e_]:"Does not contain",[t_]:"Greater than",[n_]:"Greater than or equal to",[i_]:"Less than",[r_]:"Less than or equal to",[o_]:"Is between",[s_]:"Is not between",[a_]:"After",[l_]:"Before",[u_]:"Today",[c_]:"Tomorrow",[h_]:"Yesterday",[Mw]:"Blank cells",[d_]:"Filter by condition",[f_]:"Filter by value",[g_]:"And",[Zv]:"Or",[m_]:"Select all",[p_]:"Clear",[w_]:"OK",[v_]:"Cancel",[C_]:"Search",[y_]:"Value",[b_]:"Second value",[S_]:"Pagination",[Pw]:"Page size",[R_]:"Auto",[E_]:"[start] - [end] of [total]",[T_]:"Page [currentPage] of [totalPages]",[__]:"Go to first page",[M_]:"Go to previous page",[P_]:"Go to next page",[I_]:"Go to last page",[O_]:"Checked",[A_]:"Unchecked",[H_]:"Loading...",[N_]:"No data available",[D_]:"Thereâs nothing to display yet.",[$_]:"No results found",[k_]:"It looks like your current filters are hiding all results.",[L_]:"Reset filters"},pee=mee,NR=Z$.languageCode,{register:wee,getItem:J$,hasItem:vee,getValues:Cee}=Vr("languagesDictionaries");Q$(Z$);function Q$(t,e){let n=t,i=e;return me(t)&&(i=t,n=i.languageCode),yee(n,i),wee(n,Si(i)),Si(i)}function yee(t,e){t!==NR&&uee(e,J$(NR))}function ek(t){return F_(t)?Si(J$(t)):null}function F_(t){return vee(t)}function bee(){return Cee()}function tk(t,e,n){const i=ek(t);if(i===null)return null;const r=i[e];if(xt(r))return null;const o=See(r,n);return Array.isArray(o)?o[0]:o}function See(t,e){return fee().reduce((n,i)=>i(n,e),t)}function Ree(t){let e=z$(t);return F_(e)||(e=NR,Y$(t)),e}function Eee(t,e,n){return(e=Tee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tee(t){var e=_ee(t,"string");return typeof e=="symbol"?e:e+""}function _ee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class la extends x${constructor(e,n){super(e,null),Eee(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:i}=e,r=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(i,-1);return r===null||o===null?null:((r.row>o.row||r.col>o.col)&&(r=n,o=i),this.settings.createCellRange(r,r,o))}getNearestNotHiddenCoords(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(r===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,i);return o===null?null:this.settings.createCellCoords(r,o)}getNearestNotHiddenIndex(e,n,i){return n<0?n:e.getNearestNotHiddenIndex(n,i)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),i=e.getVerticalDirection()==="N-S"?1:-1,r=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,i,r)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const i=this.settings.visualToRenderableCoords(e),r=this.settings.visualToRenderableCoords(n);return i.row===null||i.col===null||r.row===null||r.col===null?null:this.settings.createCellRange(i,i,r)}}function Wy(t){let{activeHeaderClassName:e,...n}=t;return new la({className:e,...n,selectionType:O$})}function Mee(t){let{areaCornerVisible:e,...n}=t;return new la({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:W0})}function Pee(t){let{...e}=t;return new la({className:"highlight",...e,selectionType:W0})}function Iee(t){let{columnClassName:e,...n}=t;return new la({className:e,...n,selectionType:$J})}function xee(t){let{cellCornerVisible:e,...n}=t;return new la({className:"current",headerAttributes:[b0()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:Ew})}function Oee(t){let{border:e,visualCellRange:n,...i}=t;return new la({...e,...i,selectionType:kJ},n)}function Aee(t){let{...e}=t;return new la({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:NJ})}function qx(t){let{headerClassName:e,...n}=t;return new la({className:e,...n,selectionType:V0})}function Hee(t){let{rowClassName:e,...n}=t;return new la({className:e,...n,selectionType:DJ})}function Nee(t,e){Dee(t,e),e.add(t)}function Dee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mi(t,e,n){return(e=$ee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ee(t){var e=kee(t,"string");return typeof e=="symbol"?e:e+""}function kee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Po=new WeakSet;class Lee{constructor(e){Nee(this,Po),Mi(this,"options",void 0),Mi(this,"layerLevel",0),Mi(this,"focus",void 0),Mi(this,"fill",void 0),Mi(this,"layeredAreas",new Map),Mi(this,"areas",new Map),Mi(this,"rowHeaders",new Map),Mi(this,"columnHeaders",new Map),Mi(this,"activeRowHeaders",new Map),Mi(this,"activeColumnHeaders",new Map),Mi(this,"activeCornerHeaders",new Map),Mi(this,"rowHighlights",new Map),Mi(this,"columnHighlights",new Map),Mi(this,"customSelections",[]),this.options=e,this.focus=xee(e),this.fill=Aee(e)}isEnabledFor(e,n){let i=e;e===Ew&&(i="current");let r=this.options.disabledCellSelection(n.row,n.col);return typeof r=="string"&&(r=[r]),r===!1||Array.isArray(r)&&!r.includes(i)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Rs(Po,this,Es).call(this,this.layeredAreas,Mee)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Rs(Po,this,Es).call(this,this.areas,Pee)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Rs(Po,this,Es).call(this,this.rowHeaders,qx)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Rs(Po,this,Es).call(this,this.columnHeaders,qx)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Rs(Po,this,Es).call(this,this.activeRowHeaders,Wy)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Rs(Po,this,Es).call(this,this.activeColumnHeaders,Wy)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Rs(Po,this,Es).call(this,this.activeCornerHeaders,Wy)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Rs(Po,this,Es).call(this,this.rowHighlights,Hee)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Rs(Po,this,Es).call(this,this.columnHighlights,Iee)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(Oee({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),O(this.areas.values(),e=>void e.clear()),O(this.layeredAreas.values(),e=>void e.clear()),O(this.rowHeaders.values(),e=>void e.clear()),O(this.columnHeaders.values(),e=>void e.clear()),O(this.activeRowHeaders.values(),e=>void e.clear()),O(this.activeColumnHeaders.values(),e=>void e.clear()),O(this.activeCornerHeaders.values(),e=>void e.clear()),O(this.rowHighlights.values(),e=>void e.clear()),O(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Es(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const i=e({layerLevel:n,...this.options});return t.set(n,i),i}function Zx(t,e,n){return(e=Fee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fee(t){var e=Vee(t,"string");return typeof e=="symbol"?e:e+""}function Vee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class V_{constructor(e){Zx(this,"ranges",[]),Zx(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}push(e){return this.ranges.push(e),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((i,r)=>i.includes(e)&&n(i,r))}findAll(e){const n=[];return this.ranges.forEach((i,r)=>{i.isEqual(e)&&n.push({range:i,layer:r})}),n}remove(e){return this.ranges=this.ranges.filter(n=>!e.some(i=>i.isEqual(n))),this}removeLayers(e){return this.ranges=this.ranges.filter((n,i)=>!e.includes(i)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new V_(this.createCellRange);return e.ranges=this.ranges.map(n=>n.clone()),e}map(e){return this.ranges=this.ranges.map((n,i)=>e(n,i)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function Wee(t,e){nk(t,e),e.add(t)}function Bee(t,e,n){return(e=jee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jee(t){var e=Uee(t,"string");return typeof e=="symbol"?e:e+""}function Uee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function By(t,e,n){nk(t,e),e.set(t,n)}function nk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cn(t,e){return t.get(ut(t,e))}function nh(t,e,n){return t.set(ut(t,e),n),n}function ut(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ks=new WeakMap,ru=new WeakMap,hr=new WeakMap,dt=new WeakSet;class W_{constructor(e,n){Wee(this,dt),By(this,ks,void 0),By(this,ru,0),By(this,hr,{x:0,y:0}),Bee(this,"tableApi",void 0),nh(ks,this,e),this.tableApi=n}setActiveLayerIndex(e){nh(ru,this,e)}getCurrentSelection(){return Cn(ks,this).peekByIndex(Cn(ru,this))}transformStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;nh(hr,this,this.calculateOffset());const r=this.tableApi.createCellCoords(e,n);let o=this.getCurrentSelection().highlight;const s=this.tableApi.visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",r),s.row!==null&&s.col!==null){let{width:u,height:c}=ut(dt,this,DR).call(this);const{row:h,col:d}=ut(dt,this,tO).call(this,o),f=this.tableApi.fixedRowsBottom(),p=this.tableApi.minSpareRows(),v=this.tableApi.minSpareCols(),b=this.tableApi.autoWrapRow(),P=this.tableApi.autoWrapCol(),_=this.tableApi.createCellCoords(h+r.row,d+r.col);if(_.row>=c){const W=cr(i&&p>0&&f===0),k=_.col+1,$=k>=u,Y=this.tableApi.createCellCoords(_.row-c,$?k-u:k);if(this.runLocalHooks("beforeColumnWrap",W,ut(dt,this,lc).call(this,Y),$),W.value)this.runLocalHooks("insertRowRequire",this.countRenderableRows());else if(P){if(this.shouldSwitchSelectionLayer()&&$&&Cn(ks,this).size()>1){ut(dt,this,Jx).call(this);const J=ut(dt,this,dm).call(this,"forward");J!==null&&Y.assign(J)}_.assign(Y)}}else if(_.row<0){const W=cr(P),k=_.col-1,$=k<0,Y=this.tableApi.createCellCoords(c+_.row,$?u+k:k);if(this.runLocalHooks("beforeColumnWrap",W,ut(dt,this,lc).call(this,Y),$),P){if(this.shouldSwitchSelectionLayer()&&$&&Cn(ks,this).size()>1){ut(dt,this,Qx).call(this);const J=ut(dt,this,dm).call(this,"backward");J!==null&&Y.assign(J)}_.assign(Y)}}if({width:u,height:c}=ut(dt,this,DR).call(this),_.col>=u){const W=cr(i&&v>0),k=_.row+1,$=k>=c,Y=this.tableApi.createCellCoords($?k-c:k,_.col-u);if(this.runLocalHooks("beforeRowWrap",W,ut(dt,this,lc).call(this,Y),$),W.value)this.runLocalHooks("insertColRequire",this.countRenderableColumns());else if(b){if(this.shouldSwitchSelectionLayer()&&$&&Cn(ks,this).size()>1){ut(dt,this,Jx).call(this);const J=ut(dt,this,dm).call(this,"forward");J!==null&&Y.assign(J)}_.assign(Y)}}else if(_.col<0){const W=cr(b),k=_.row-1,$=k<0,Y=this.tableApi.createCellCoords($?c+k:k,u+_.col);if(this.runLocalHooks("beforeRowWrap",W,ut(dt,this,lc).call(this,Y),$),b){if(this.shouldSwitchSelectionLayer()&&$&&Cn(ks,this).size()>1){ut(dt,this,Qx).call(this);const J=ut(dt,this,dm).call(this,"backward");J!==null&&Y.assign(J)}_.assign(Y)}}const{rowDir:F,colDir:I}=ut(dt,this,eO).call(this,_);a=F,l=I,o=ut(dt,this,lc).call(this,_)}return this.runLocalHooks("afterTransformStart",o,a,l),{selectionLayer:Cn(ru,this),visualCoords:o}}transformEnd(e,n){nh(hr,this,this.calculateOffset());const i=this.tableApi.createCellCoords(e,n),r=this.getCurrentSelection(),o=this.tableApi.visualToRenderableCoords(r.highlight),s=ut(dt,this,Bp).call(this,r.to.row,r.from.row),a=ut(dt,this,jp).call(this,r.to.col,r.from.col),l=r.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",i),o.row!==null&&o.col!==null&&s!==null&&a!==null){const{row:h,col:d}=ut(dt,this,tO).call(this,r.highlight),f=this.tableApi.createCellCoords(s+i.row,a+i.col),p=r.getTopStartCorner(),v=r.getTopEndCorner(),b=r.getBottomEndCorner();if(i.col<0&&a>=d&&f.col<d){const I=f.col-d;f.col=ut(dt,this,jp).call(this,p.col,v.col)+I}else if(i.col>0&&a<=d&&f.col>d){const I=ut(dt,this,jp).call(this,v.col,p.col),W=Math.max(f.col-I,1);f.col=I+W}if(i.row<0&&s>=h&&f.row<h){const I=f.row-h;f.row=ut(dt,this,Bp).call(this,p.row,b.row)+I}else if(i.row>0&&s<=h&&f.row>h){const I=ut(dt,this,Bp).call(this,b.row,p.row),W=Math.max(f.row-I,1);f.row=I+W}const{rowDir:P,colDir:_}=ut(dt,this,eO).call(this,f);u=P,c=_;const F=ut(dt,this,lc).call(this,f);i.row===0&&i.col!==0?l.col=F.col:i.row!==0&&i.col===0?l.row=F.row:(l.row=F.row,l.col=F.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),{selectionLayer:Cn(ru,this),visualCoords:l}}calculateOffset(){throw new Error("`calculateOffset` is not implemented")}countRenderableRows(){throw new Error("`countRenderableRows` is not implemented")}countRenderableColumns(){throw new Error("`countRenderableColumns` is not implemented")}shouldSwitchSelectionLayer(){throw new Error("`shouldSwitchSelectionLayer` is not implemented")}}function Jx(){const t=Cn(ru,this)+1;this.setActiveLayerIndex(t>=Cn(ks,this).size()?0:t),nh(hr,this,this.calculateOffset())}function Qx(){const t=Cn(ru,this)-1;this.setActiveLayerIndex(t<0?Cn(ks,this).size()-1:t),nh(hr,this,this.calculateOffset())}function eO(t){const{width:e,height:n}=ut(dt,this,DR).call(this);let i=0,r=0;return t.row<0?(i=-1,t.row=0):t.row>0&&t.row>=n&&(i=1,t.row=n-1),t.col<0?(r=-1,t.col=0):t.col>0&&t.col>=e&&(r=1,t.col=e-1),{rowDir:i,colDir:r}}function DR(){return{width:Cn(hr,this).x+this.countRenderableColumns(),height:Cn(hr,this).y+this.countRenderableRows()}}function dm(t){if(!["forward","backward"].includes(t))return null;const e=this.getCurrentSelection().getTopStartCorner(),n=this.getCurrentSelection().getBottomEndCorner(),[i,r,o,s]=t==="forward"?[e.row,n.row,e.col,n.col]:[n.row,e.row,n.col,e.col],a=ut(dt,this,Bp).call(this,i,r),l=ut(dt,this,jp).call(this,o,s);return a===null||l===null?null:this.tableApi.createCellCoords(a,l)}function Bp(t,e){const n=this.tableApi.findFirstNonHiddenRenderableRow(t,e);return n===null?null:Cn(hr,this).y+n}function jp(t,e){const n=this.tableApi.findFirstNonHiddenRenderableColumn(t,e);return n===null?null:Cn(hr,this).x+n}function tO(t){const{row:e,col:n}=this.tableApi.visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return this.tableApi.createCellCoords(Cn(hr,this).y+e,Cn(hr,this).x+n)}function lc(t){const e=t.clone();return e.col=t.col-Cn(hr,this).x,e.row=t.row-Cn(hr,this).y,this.tableApi.renderableToVisualCoords(e)}ct(W_,An);class zee extends W_{calculateOffset(){return{x:this.tableApi.navigableHeaders()?this.tableApi.countRowHeaders():0,y:this.tableApi.navigableHeaders()?this.tableApi.countColHeaders():0}}countRenderableRows(){return this.tableApi.countRenderableRows()}countRenderableColumns(){return this.tableApi.countRenderableColumns()}shouldSwitchSelectionLayer(){return!1}}class Yee extends W_{calculateOffset(){const e=this.getCurrentSelection(),{row:n,col:i}=e.getOuterTopStartCorner(),r=this.tableApi.countRenderableColumnsInRange(0,i-1),o=this.tableApi.countRenderableRowsInRange(0,n-1),s=e.highlight.isHeader(),a=s?Math.abs(i):0,l=s?Math.abs(n):0;return{x:i<0?a:-r,y:n<0?l:-o}}countRenderableRows(){const e=this.getCurrentSelection();return this.tableApi.countRenderableRowsInRange(0,e.getOuterBottomEndCorner().row)}countRenderableColumns(){const e=this.getCurrentSelection();return this.tableApi.countRenderableColumnsInRange(0,e.getOuterBottomEndCorner().col)}transformEnd(){throw new Error("`transformEnd` is not valid for focus selection use `transformStart` instead")}shouldSwitchSelectionLayer(){return!0}}const Jv=0,Qv=1,ik=2,B_=3,Gee=[B_,ik],Kee=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],jy=Symbol("root"),nO=Symbol("child");function Eh(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:jy;if(e!==jy&&e!==nO)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),i=e===jy;let r=Jv;if(n){const o=t[0];t.length===0?r=Qv:i&&o instanceof Vh?r=B_:i&&Array.isArray(o)?r=Eh(o,nO):t.length>=2&&t.length<=4&&!t.some((a,l)=>!Kee[l].includes(typeof a))&&(r=ik)}return r}function jf(t){let{createCellCoords:e,createCellRange:n,keepDirection:i=!1,propToCol:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Gee.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===B_;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof r=="function"&&(typeof l=="string"&&(l=r(l)),typeof c=="string"&&(c=r(c))),xt(u)&&(u=a),xt(c)&&(c=l),!i){const p=a,v=l,b=u,P=c;a=Math.min(p,b),l=Math.min(v,P),u=Math.max(p,b),c=Math.max(v,P)}const h=s?o.highlight.clone():e(a,l),d=e(a,l),f=e(u,c);return n(h,d,f)}}function Xee(t){const e=Eh(t.getSelected());if(e===Jv||e===Qv)return[];const n=jf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;O(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;O(Array.from(new Array(c),(h,d)=>u+d),h=>{i.has(h)||i.add(h)})});const r=Array.from(i).sort((s,a)=>s-a);return ji(r,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function qee(t){const e=Eh(t.getSelected());if(e===Jv||e===Qv)return[];const n=jf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;O(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;O(Array.from(new Array(c),(h,d)=>u+d),h=>{i.has(h)||i.add(h)})});const r=Array.from(i).sort((s,a)=>s-a);return ji(r,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function vl(t,e,n){Zee(t,e),e.set(t,n)}function Zee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cl(t,e,n){return(e=Jee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jee(t){var e=Qee(t,"string");return typeof e=="symbol"?e:e+""}function Qee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nt(t,e){return t.get(rk(t,e))}function zi(t,e,n){return t.set(rk(t,e),n),n}function rk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Yi=new WeakMap,uc=new WeakMap,fm=new WeakMap,pa=new WeakMap,gm=new WeakMap,wd=new WeakMap,mm=new WeakMap;class ok{constructor(e,n){var i=this;Cl(this,"settings",void 0),Cl(this,"tableProps",void 0),Cl(this,"inProgress",!1),Cl(this,"selectedRange",new V_((r,o,s)=>this.tableProps.createCellRange(r,o,s))),Cl(this,"highlight",void 0),vl(this,Yi,void 0),vl(this,uc,void 0),Cl(this,"selectedByRowHeader",new Set),Cl(this,"selectedByColumnHeader",new Set),vl(this,fm,!1),vl(this,pa,!1),vl(this,gm,"unknown"),vl(this,wd,-1),vl(this,mm,0),this.settings=e,this.tableProps=n,this.highlight=new Lee({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[b0()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(r,o)=>this.tableProps.isDisabledCellSelection(r,o),cellCornerVisible:function(){return i.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return i.isAreaCornerVisible(...arguments)},visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),createCellCoords:(r,o)=>this.tableProps.createCellCoords(r,o),createCellRange:(r,o,s)=>this.tableProps.createCellRange(r,o,s)}),zi(Yi,this,new zee(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),zi(uc,this,new Yee(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Nt(Yi,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeModifyTransformStart",...o)}),Nt(Yi,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("afterModifyTransformStart",...o)}),Nt(Yi,this).addLocalHook("beforeTransformEnd",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeModifyTransformEnd",...o)}),Nt(Yi,this).addLocalHook("afterTransformEnd",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("afterModifyTransformEnd",...o)}),Nt(Yi,this).addLocalHook("insertRowRequire",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("insertRowRequire",...o)}),Nt(Yi,this).addLocalHook("insertColRequire",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("insertColRequire",...o)}),Nt(Yi,this).addLocalHook("beforeRowWrap",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeRowWrap",...o)}),Nt(Yi,this).addLocalHook("beforeColumnWrap",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeColumnWrap",...o)}),Nt(uc,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("beforeModifyTransformFocus",...o)}),Nt(uc,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}getActiveSelectedRange(){return this.selectedRange.peekByIndex(Nt(mm,this))}getActiveSelectionLayerIndex(){return Nt(mm,this)}setActiveSelectionLayerIndex(e){zi(mm,this,e)}markSource(e){zi(gm,this,e)}markEndSource(){zi(gm,this,"unknown")}getSelectionSource(){return Nt(gm,this)}setExpectedLayers(e){zi(wd,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,zi(wd,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=xt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();zi(pa,this,!1),zi(fm,this,!1),this.runLocalHooks(`beforeSetRangeStart${i?"Only":""}`,a),(!o||o&&!s&&xt(n))&&(this.selectedRange.clear(),O(this.highlight.getAreas(),l=>void l.clear()),O(this.highlight.getLayeredAreas(),l=>void l.clear()),O(this.highlight.getRowHeaders(),l=>void l.clear()),O(this.highlight.getColumnHeaders(),l=>void l.clear()),O(this.highlight.getActiveRowHeaders(),l=>void l.clear()),O(this.highlight.getActiveColumnHeaders(),l=>void l.clear()),O(this.highlight.getActiveCornerHeaders(),l=>void l.clear()),O(this.highlight.getRowHighlights(),l=>void l.clear()),O(this.highlight.getColumnHighlights(),l=>void l.clear())),this.selectedRange.add(a).current().setHighlight(r.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),i||this.setRangeEnd(e)}setRangeStartOnly(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,i)}setRangeEnd(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(n);const i=e.clone(),r=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.getActiveSelectedRange().clone().setTo(e).isSingleHeader();if((r>0||o>0)&&(r===0&&i.col<0&&!s||o===0&&i.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",i),this.begin();const a=this.getActiveSelectedRange();if(this.settings.navigableHeaders||a.highlight.normalize(),this.settings.selectionMode==="single")a.setFrom(a.highlight),a.setTo(a.highlight);else{const u=a.getHorizontalDirection(),c=a.getVerticalDirection(),h=this.isMultiple();a.setTo(i),h&&(u!==a.getHorizontalDirection()||a.getWidth()===1&&!a.includes(a.highlight))&&a.from.assign({col:a.highlight.col}),h&&(c!==a.getVerticalDirection()||a.getHeight()===1&&!a.includes(a.highlight))&&a.from.assign({row:a.highlight.row})}r>0&&o>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.getActiveSelectedRange().highlight,n),this.applyAndCommit(this.getActiveSelectedRange(),n);const l=Nt(wd,this)===-1||this.selectedRange.size()===Nt(wd,this);this.runLocalHooks("afterSetRangeEnd",e,l)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const i=this.tableProps.countRows(),r=this.tableProps.countCols();this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(W0,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),n===1)){const p=this.selectedRange.peekByIndex(n-1);this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(p.from).commit().syncWith(p),this.highlight.createLayeredArea().add(p.from).commit().syncWith(p),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(V0,e.highlight)){if(!e.isSingleHeader()){const b=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),P=this.tableProps.createCellCoords(e.to.row,-1),_=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),F=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(b).commit(),l.add(_).commit(),d.add(b).commit(),f.add(_).commit()):(a.add(b).add(P).commit(),l.add(_).add(F).commit(),d.add(b).add(P).commit(),f.add(_).add(F).commit())}const p=!Nt(pa,this)&&this.isEntireRowSelected()&&(r>0&&r===e.getWidth()||r===0&&this.isSelectedByRowHeader()),v=!Nt(pa,this)&&this.isEntireColumnSelected()&&(i>0&&i===e.getHeight()||i===0&&this.isSelectedByColumnHeader());p&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),v&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),p&&v&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(n),Nt(Yi,this).setActiveLayerIndex(n),Nt(uc,this).setActiveLayerIndex(n);const i=this.getActiveSelectedRange();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),i.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Ew,i.highlight)&&r.add(i.highlight).commit().syncWith(i),this.inProgress||(zi(fm,this,!0),this.runLocalHooks("afterSetFocus",i.highlight))}transformStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const{visualCoords:r}=Nt(Yi,this).transformStart(e,n,i);this.setRangeStart(r)}transformEnd(e,n){const{visualCoords:i,selectionLayer:r}=Nt(Yi,this).transformEnd(e,n);this.setRangeEnd(i,r)}transformFocus(e,n){const{selectionLayer:i,visualCoords:r}=Nt(uc,this).transformStart(e,n);this.setRangeFocus(r.normalize(),i)}shiftRows(e,n){if(!this.isSelected())return;const i=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||i.getOuterTopStartCorner().row>=e){const{from:r,to:o,highlight:s}=i,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(Ue(r.row+h,c,a-1),r.col),f=this.tableProps.createCellCoords(Ue(o.row+n,c,a-1),o.col);this.markSource("shift"),s.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(Ue(s.row+n,0,a-1),s.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const i=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||i.getOuterTopStartCorner().col>=e){const{from:r,to:o,highlight:s}=i,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(r.row,Ue(r.col+h,c,a-1)),f=this.tableProps.createCellCoords(o.row,Ue(o.col+n,c,a-1));this.markSource("shift"),s.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(s.row,Ue(s.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange();if(!this.isSelected())return!1;const n=cr(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",n),n.value}isFocusSelectionChanged(){return this.isSelected()&&Nt(fm,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=r=>{const{col:o}=r.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&r.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(r=>n(r));const i=this.selectedRange.peekByIndex(e);return i?n(i):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=r=>{const{row:o}=r.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&r.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(r=>n(r));const i=this.selectedRange.peekByIndex(e);return i?n(i):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=i?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getActiveSelectedRange())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=r;d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(Ue(d.row,u,o-1),Ue(d.col,c,s-1)));const p=this.tableProps.createCellCoords(u,c),v=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.runLocalHooks("beforeSelectAll",p,v,h),this.setRangeStartOnly(p,void 0,h),zi(pa,this,f),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.runLocalHooks("afterSelectAll",p,v,h),this.finish()}selectCells(e){var n=this;const i=Eh(e);if(i===Qv)return!1;if(i===Jv)throw new Error(nt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const r=jf(i,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=r(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),O(e,l=>{const{from:u,to:c}=r(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,r),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,p=0;Number.isInteger(i==null?void 0:i.row)&&Number.isInteger(i==null?void 0:i.col)?(f=Ue(i.row,u,s-1),p=Ue(i.col,Math.min(r,o),Math.max(r,o))):(f=Ue(i,u,s-1),p=r);const v=this.tableProps.createCellCoords(f,p),b=l===0?0:Ue(v.row,u,-1),P=s-1,_=this.tableProps.createCellCoords(b,r),F=this.tableProps.createCellCoords(P,o);this.runLocalHooks("beforeSelectColumns",_,F,v),this.setRangeStartOnly(_,void 0,v),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(F),this.runLocalHooks("afterSelectColumns",_,F,v),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:r,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(i==null?void 0:i.row)&&Number.isInteger(i==null?void 0:i.col)?(h=Ue(i.row,Math.min(e,n),Math.max(e,n)),d=Ue(i.col,a,o-1)):(h=e,d=Ue(i,a,o-1));const f=this.tableProps.createCellCoords(h,d),p=s===0?0:Ue(f.col,a,-1),v=o-1,b=this.tableProps.createCellCoords(e,p),P=this.tableProps.createCellCoords(n,v);this.runLocalHooks("beforeSelectRows",b,P,f),this.setRangeStartOnly(b,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(P),this.runLocalHooks("afterSelectRows",b,P,f),this.finish()}return c}importSelection(e){let{ranges:n,activeRange:i,activeSelectionLayer:r,selectedByRowHeader:o,selectedByColumnHeader:s,disableHeadersHighlight:a}=e;n.length!==0&&(this.selectedRange.clear(),this.highlight.clear(),this.inProgress=!1,zi(pa,this,a),this.selectedByRowHeader=new Set(o),this.selectedByColumnHeader=new Set(s),this.setActiveSelectionLayerIndex(0),n.forEach((l,u)=>{this.selectedRange.push(l),this.applyAndCommit(l,u)}),this.setRangeFocus(i.highlight,r),zi(pa,this,!1),this.inProgress=!1)}exportSelection(){return{ranges:Array.from(this.selectedRange).map(e=>e.clone()),activeRange:this.getActiveSelectedRange(),activeSelectionLayer:this.getActiveSelectionLayerIndex(),selectedByRowHeader:Array.from(this.selectedByRowHeader),selectedByColumnHeader:Array.from(this.selectedByColumnHeader),disableHeadersHighlight:Nt(pa,this)}}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const i=this.selectedRange.ranges.map(s=>s.clone());this.markSource("refresh");const r=new Set(this.selectedByRowHeader),o=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(i.length),i.forEach(s=>{const{from:a,to:l,highlight:u}=s,c=e-1,h=n-1;u.assign({row:Ue(u.row,this.settings.navigableHeaders?-1/0:0,c),col:Ue(u.col,this.settings.navigableHeaders?-1/0:0,h)}),a.assign({row:Ue(a.row,-1/0,c),col:Ue(a.col,-1/0,h)}),l.assign({row:Ue(l.row,-1/0,c),col:Ue(l.col,-1/0,h)}),this.setRangeStartOnly(a,!0,u),this.setRangeEnd(l)}),this.selectedByRowHeader=r,this.selectedByColumnHeader=o,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(r=>{r.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),i=this.getActiveSelectedRange();this.highlight.isEnabledFor(Ew,i.highlight)&&this.highlight.getFocus().commit().syncWith(i);for(let r=0;r<this.selectedRange.size();r+=1){this.highlight.useLayerLevel(r);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}ct(ok,An);const iO=/^(\r\n|\n\r|\r|\n)/,ete=/^[^\t\r\n]+/,rO=/^\t/;function tte(t){const e=[[""]];if(t.length===0)return e;let n=0,i=0,r;for(;t.length>0&&r!==t.length;)if(r=t.length,t.match(rO))t=t.replace(rO,""),n+=1,e[i][n]="";else if(t.match(iO))t=t.replace(iO,""),n=0,i+=1,e[i]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(ete);o=s?s[0]:"",t=t.slice(o.length)}e[i][n]=o}return e}function Iw(t){let e,n,i,r,o="",s;for(e=0,n=t.length;e<n;e+=1){for(r=t[e].length,i=0;i<r;i+=1)i>0&&(o+="	"),s=t[e][i],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function Uy(t,e){const{instance:n,visualRow:i,visualCol:r,valueSetter:o}=e;return ot(o)?o.call(n,t,i,r,e):t}function nte(t,e){const{instance:n,visualRow:i,visualCol:r,valueGetter:o}=e;return ot(o)?o.call(n,t,i,r,e):t}function yl(t,e,n){return(e=ite(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ite(t){var e=rte(t,"string");return typeof e=="symbol"?e:e+""}function rte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ih{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,i){yl(this,"hot",void 0),yl(this,"metaManager",void 0),yl(this,"tableMeta",void 0),yl(this,"dataSource",void 0),yl(this,"duckSchema",void 0),yl(this,"colToPropCache",void 0),yl(this,"propToColCache",void 0),this.hot=e,this.metaManager=i,this.tableMeta=i.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let i;if(this.colToPropCache=[],this.propToColCache=new Map,n){let r=0,o=0,s=!1;if(typeof n=="function"){const a=R0(e);r=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;r=Math.min(a,n.length)}for(i=0;i<r;i++){const a=s?n(i):n[i];if(me(a)){if(typeof a.data<"u"){const l=s?o:i;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return F$(this.dataSource)}recursiveDuckColumns(e,n,i){let r=n,o=i,s;return typeof r>"u"&&(r=0,o=""),typeof e=="object"&&!Array.isArray(e)&&We(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,r),r+=1):r=this.recursiveDuckColumns(a,r,`${l}.`)}),r}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&te(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(te(n))return this.hot.toVisualColumn(n);const i=this.hot.toVisualColumn(e);return i===null?e:i}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Vf(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:r="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,i)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let p=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?p=Si(this.getSchema()):(p=[],he(h-1,()=>p.push(null))):this.hot.dataType==="function"?p=this.tableMeta.dataSchema(l+a):(p={},Fv(p,this.getSchema())),d.push(p),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),r==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):i!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,i),{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:r="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),u=this.hot.countSourceRows(),c=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",c,n,i)===!1)return{delta:0};const h=c<l?this.hot.toPhysicalColumn(c):a,d=r==="end"?Math.min(h+1,a):h;let f=0;for(let p=d;f<n&&l+f<s;p++){if(typeof c!="number"||c>=l+f)if(u>0)for(let v=0;v<u;v+=1)typeof o[v]>"u"&&(o[v]=[]),o[v].push(null);else o.push([null]);else for(let v=0;v<u;v++)o[v].splice(p,0,null);f+=1}return f>0&&(e==null?this.metaManager.createColumn(null,f):i!=="auto"&&this.metaManager.createColumn(d,n)),this.hot.columnIndexMapper.insertIndexes(c,f,r),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(d),f,i),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:d}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(r,n),s=this.hot.countSourceRows();if(r=(s+r)%s,this.hot.runHooks("beforeRemoveRow",r,o.length,o,i)===!1)return!1;const l=o.length;if(this.filterData(r,l,o),r<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=te(this.tableMeta.columns)||te(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!c&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",r,l,o,i),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let r=typeof e!="number"?-n:e;r=(this.hot.countCols()+r)%this.hot.countCols();const o=this.visualColumnsToPhysical(r,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",r,n,o,i)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return r<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",r,n,o,i),this.refreshDuckSchema(),!0}spliceCol(e,n,i){const r=this.hot.getDataAtCol(e),o=r.slice(n,n+i),s=r.slice(n+i);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];DI(l,s);let c=0;for(;c<i;)l.push(null),c+=1;return I6(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,i){const r=this.hot.getSourceDataAtRow(e),o=r.slice(n,n+i),s=r.slice(n+i);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];DI(l,s);let c=0;for(;c<i;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,i){if(this.hot.runHooks("beforeDataSplice",e,n,i)!==!1){const o=[...this.dataSource.slice(0,e),...i,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,i){let r=this.hot.runHooks("filterData",e,n,i);Array.isArray(r)===!1&&(r=this.dataSource.filter((o,s)=>i.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}get(e,n){const i=this.hot.toPhysicalRow(e);let r=this.dataSource[i];const o=this.hot.runHooks("modifyRowData",i);r=isNaN(o)?o:r;const{dataDotNotation:s}=this.hot.getSettings();let a=null;if(r&&r.hasOwnProperty&&nn(r,n))a=r[n];else if(s&&typeof n=="string"&&n.indexOf(".")>-1){let c=r;if(!c)return null;const h=n.split(".");for(let d=0,f=h.length;d<f;d++)if(c=c[h[d]],typeof c>"u")return null;a=c}else typeof n=="function"&&(a=n(this.dataSource.slice(i,i+1)[0]));const l=this.propToCol(n),u=this.hot.toPhysicalColumn(l);if(gh(i)&&gh(u)&&(a=nte(a,this.metaManager.getCellMeta(i,u,{visualRow:e,visualColumn:l,skipMetaExtension:!0}))),this.hot.hasHook("modifyData")){const c=cr(a);this.hot.runHooks("modifyData",e,l,c,"get"),c.isTouched()&&(a=c.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,i){const r=this.hot.toPhysicalRow(e);let o=i,s=this.dataSource[r];const a=this.hot.runHooks("modifyRowData",r);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const u=cr(o);this.hot.runHooks("modifyData",e,this.propToCol(n),u,"set"),u.isTouched()&&(o=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(s&&s.hasOwnProperty&&nn(s,n))s[n]=o;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let u=s,c=0,h;const d=n.split(".");for(c=0,h=d.length-1;c<h;c++){if(d[c]==="__proto__"||d[c]==="constructor"||d[c]==="prototype")return;typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]]}u[d[c]]=o}else if(typeof n=="function")n(this.dataSource.slice(r,r+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;s[n]=o}}visualRowsToPhysical(e,n){const i=this.hot.countSourceRows(),r=[];let o=(i+e)%i,s=n,a;for(;o<i&&s;)a=this.hot.toPhysicalRow(o),r.push(a),s-=1,o+=1;return r}visualColumnsToPhysical(e,n){const i=this.hot.countCols(),r=[];let o=(i+e)%i,s=n;for(;o<i&&s;){const a=this.hot.toPhysicalColumn(o);r.push(a),s-=1,o+=1}return r}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,ih.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,i){const r=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=i===ih.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&r.push(a)}return r}getText(e,n){return Iw(this.getRange(e,n,ih.DESTINATION_RENDERER))}getCopyableText(e,n){return Iw(this.getRange(e,n,ih.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:ote,getItem:ste,hasItem:sk,getNames:KSe,getValues:XSe}=Vr("cellTypes");function ate(t){if(!sk(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return ste(t)}function qr(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:i,validator:r}=e;n&&er(t,n),i&&Rr(t,i),r&&zc(t,r),ote(t,e)}function lte(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!nn(e,t)}function eC(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const i=typeof e.type=="string"?ate(e.type):e.type;if(t._automaticallyAssignedMetaProps&&We(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!me(i))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const r={};We(i,(o,s)=>{if(lte(s,n)){var a;r[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),bn(t,r)}function ute(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}k9(n,t);for(let i=0;i<e.length;i++)n.prototype[e[i]]=void 0;return n}function Up(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function rf(t){return t==null}const ak=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dialog:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,emptyDataState:!1,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,initialState:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,i;for(e=0,n=this.countRows();e<n;e++)if(i=this.getDataAtCell(e,t),rn(i)===!1)return!1;return!0},isEmptyRow(t){let e,n,i,r;for(e=0,n=this.countCols();e<n;e++)if(i=this.getDataAtCell(t,e),rn(i)===!1)return typeof i=="object"?(r=this.getCellMeta(t,e),Vv(this.getSchema()[r.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",loading:!1,manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRowHeights:void 0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,pagination:void 0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,valueGetter:void 0,valueSetter:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function oO(t,e,n){return(e=cte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cte(t){var e=hte(t,"string");return typeof e=="symbol"?e:e+""}function hte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dte(){return class{}}class fte{constructor(e){oO(this,"metaCtor",dte()),oO(this,"meta",void 0),this.meta=this.metaCtor.prototype,bn(this.meta,ak()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;bn(this.meta,e),eC(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function gte(t,e,n){return(e=mte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mte(t){var e=pte(t,"string");return typeof e=="symbol"?e:e+""}function pte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wte{constructor(e){gte(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){bn(this.meta,e),eC(this.meta,e,e)}}function pm(t,e,n){return(e=vte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vte(t){var e=Cte(t,"string");return typeof e=="symbol"?e:e+""}function Cte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xw{constructor(e){pm(this,"valueFactory",void 0),pm(this,"data",[]),pm(this,"index",[]),pm(this,"holes",new Set),this.valueFactory=e}obtain(e){Up(()=>gh(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let i;if(n>=0)i=this.data[n],i===void 0&&(i=this.valueFactory(e),this.data[n]=i);else if(i=this.valueFactory(e),this.holes.size>0){const r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=i,this.index[e]=r}else this.data.push(i),this.index[e]=this.data.length-1;return i}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Up(()=>gh(e)||rf(e),"Expecting an unsigned number or null/undefined argument.");const i=[],r=this.data.length;for(let s=0;s<n;s++)i.push(r+s),this.data.push(void 0);const o=rf(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...i,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Up(()=>gh(e)||rf(e),"Expecting an unsigned number or null/undefined argument.");const i=this.index.splice(rf(e)?this.index.length-n:e,n);for(let r=0;r<i.length;r++){const o=i[r];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let i=0;i<this.data.length;i++){const r=this._getKeyByStorageIndex(i);r!==-1&&this.data[i]!==void 0&&e.push([r,this.data[i]])}let n=0;return{next:()=>{if(n<e.length){const i=e[n];return n+=1,{value:i,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function sO(t,e,n){return(e=yte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yte(t){var e=bte(t,"string");return typeof e=="symbol"?e:e+""}function bte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ste=["data","width"];class Rte{constructor(e){sO(this,"globalMeta",void 0),sO(this,"metas",new xw(()=>this._createMeta())),this.globalMeta=e,this.metas=new xw(()=>this._createMeta())}updateMeta(e,n){const i=this.getMeta(e);bn(i,n),eC(i,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return ute(this.globalMeta.getMetaConstructor(),Ste).prototype}}function aO(t,e,n){return(e=Ete(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ete(t){var e=Tte(t,"string");return typeof e=="symbol"?e:e+""}function Tte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _te{constructor(e){aO(this,"columnMeta",void 0),aO(this,"metas",new xw(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,i){const r=this.getMeta(e,n);bn(r,i),eC(r,i)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(e,n)}getMeta(e,n,i){const r=this.metas.obtain(e).obtain(n);return i===void 0?r:r[i]}setMeta(e,n,i,r){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(i),s[i]=r}removeMeta(e,n,i){const r=this.metas.obtain(e).obtain(n);delete r[i]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let i=0;i<n.length;i++)te(n[i])&&e.push(...n[i].values());return e}getMetasAtRow(e){Up(()=>gh(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new xw(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class lk{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new fte(e),this.tableMeta=new wte(this.globalMeta),this.columnMeta=new Rte(this.globalMeta),this.cellMeta=new _te(this.columnMeta),i.forEach(r=>new r(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,i){const r=this.cellMeta.getMeta(e,n);return r.visualRow=i.visualRow,r.visualCol=i.visualColumn,r.row=e,r.col=n,i.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",r),r}getCellMetaKeyValue(e,n,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,i)}setCellMeta(e,n,i,r){this.cellMeta.setMeta(e,n,i,r)}updateCellMeta(e,n,i){this.cellMeta.updateMeta(e,n,i)}removeCellMeta(e,n,i){this.cellMeta.removeMeta(e,n,i)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}ct(lk,An);function lO(t,e,n,i){const{hotInstance:r,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=i,h=mo(a),d=r.getSettings();Array.isArray(d.dataSchema)?r.dataType="array":ot(d.dataSchema)?r.dataType="function":r.dataType="object",o&&o.destroy(),t=r.runHooks(`before${h}`,t,c,l);const f=new ih(r,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const p=f.getSchema();t=[];let v,b=0,P=0;for(b=0,P=d.startRows;b<P;b++)if((r.dataType==="object"||r.dataType==="function")&&d.dataSchema)v=Si(p),t.push(v);else if(r.dataType==="array")v=Si(p[0]),t.push(v);else{v=[];for(let _=0,F=d.startCols;_<F;_++)v.push(null);t.push(v)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(r.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=r.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),r.runHooks(`after${h}`,t,c,l),c||(r.runHooks("afterChange",null,a),r.view.adjustElementsSize(),r.render()),r.getSettings().ariaTags&&le(r.rootElement,[DD(-1),Lv(r.countCols()+(r.view?r.countRowHeaders():0))])}function uO(t,e,n){return(e=Mte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mte(t){var e=Pte(t,"string");return typeof e=="symbol"?e:e+""}function Pte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ite{constructor(e){var n=this;uO(this,"metaManager",void 0),uO(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),ie.getSingleton().add("beforeRender",i=>{i&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:i,col:r}=e;if((n=this.metaSyncMemo.get(i))!==null&&n!==void 0&&n.has(r))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=nn(e,"type")?e.type:null;let c=ot(e.cells)?e.cells(i,r,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(i,r,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(r)}}function xte(t,e,n){Ote(t,e),e.set(t,n)}function Ote(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zy(t,e,n){return(e=Ate(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ate(t){var e=Hte(t,"string");return typeof e=="symbol"?e:e+""}function Hte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nte(t,e){return t.get(Dte(t,e))}function Dte(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var cO=new WeakMap;class $te{constructor(e){zy(this,"metaManager",void 0),zy(this,"usageTracker",new Set),zy(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),xte(this,cO,(n,i,r)=>{if(!r)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:i,target:r,onChange:o}=e,s=typeof r=="string",a=s?r:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],o?(this.installPropWatcher(n,l,o),s&&this.installPropWatcher(r,l,o)):i&&(this.installPropWatcher(n,l,Nte(cO,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,i){const r=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!r.usageTracker.has(e);r.usageTracker.add(e),i.call(r,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}function kte(t,e){uk(t,e),e.add(t)}function hO(t,e,n){uk(t,e),e.set(t,n)}function uk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dO(t,e){return t.get(Th(t,e))}function fO(t,e,n){return t.set(Th(t,e),n),n}function Th(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var $R=new WeakMap,kR=new WeakMap,pf=new WeakSet;class Lte{constructor(e){let{rowIndexMapper:n,columnIndexMapper:i}=e;kte(this,pf),hO(this,$R,void 0),hO(this,kR,void 0),fO($R,this,n),fO(kR,this,i)}toRenderable(e){const n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,r=Th(pf,this,gO).call(this,e.from,n,i);if(r===null)return null;const o=Th(pf,this,gO).call(this,e.to,-n,-i);if(o===null)return null;const s=e.clone();return s.from=r,s.to=o,s.includes(e.highlight)||(s.highlight=r),s}}function gO(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const i=Th(pf,this,mO).call(this,dO($R,this),t.row,e);if(i===null)return null;const r=Th(pf,this,mO).call(this,dO(kR,this),t.col,n);return r===null?null:t.clone().assign({row:i,col:r})}function mO(t,e,n){return e<0?e:t.getNearestNotHiddenIndex(e,n)}function jh(t){Js(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function tC(t){const{selection:e,view:n}=t,i=t.getSelectedRangeActive(),r=e.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),s=n.getLastFullyVisibleColumn(),a=i.getTopStartCorner().col,l=i.getBottomEndCorner().col,u=a<=o,c=l>=s,h=n.getFirstFullyVisibleRow(),d=n.getLastFullyVisibleRow(),f=i.getTopStartCorner().row,p=i.getBottomEndCorner().row,v=f<=h,b=p>=d;return{getComputedColumnTarget(P){return r==="mouse"||r==="keyboard"?P.col:u&&c?i.highlight.col:u?a:c?l:P.col},getComputedRowTarget(P){return r==="mouse"||r==="keyboard"?P.row:v&&b?i.highlight.row:v?f:b?p:P.row}}}function Fte(t){return e=>{const n=tC(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const i=!!t.getSettings().colHeaders;jh(t.getCell(i?-1:0,n,!0))})}}function Vte(){return()=>{}}function Wte(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const n=t.getSelectedRangeActive();if(!n)return;const{row:i,col:r}=n.highlight;jh(t.getCell(i,r,!0))})}}function Bte(t){return e=>{const n=tC(t),i={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(i,()=>{const{row:r,col:o}=i;jh(t.getCell(r,o,!0))})}}function jte(t){return e=>{const n=tC(t),i={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(i,()=>{const{row:r,col:o}=i;jh(t.getCell(r,o,!0))})}}function Ute(t){return e=>{const n=tC(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const i=!!t.getSettings().rowHeaders;jh(t.getCell(n,i?-1:0,!0))})}}function zte(t){return e=>{const n=t.selection.getSelectionSource(),{row:i,col:r}=e,o=()=>{jh(t.getCell(i,r,!0))};if(i<0&&r>=0)t.scrollViewportTo({col:r},o);else if(r<0&&i>=0)t.scrollViewportTo({row:i},o);else{if(n==="mouse"&&(r===t.view.getLastPartiallyVisibleColumn()||i===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:i,col:r},o)}}}function Yte(t){const{selection:e}=t;let n=!1,i=!1;return{resume(){i=!1},suspend(){i=!0},skipNextScrollCycle(){n=!0},scrollTo(r){var o;if(n||i){n=!1;return}let s;e.isFocusSelectionChanged()?s=Wte(t):e.isSelectedByCorner()?s=Vte():e.isSelectedByRowHeader()?s=Ute(t):e.isSelectedByColumnHeader()?s=Fte(t):e.getSelectedRange().size()===1&&e.isMultiple()?s=Bte(t):e.getSelectedRange().size()===1&&!e.isMultiple()?s=zte(t):e.getSelectedRange().size()>1&&(s=jte(t)),(o=s)===null||o===void 0||o(r)}}}const Gte=Object.freeze({INLINE:"inline",MODAL:"modal"}),hu=Object.freeze({UNKNOWN:"unknown",CLICK:"click",TAB_FROM_ABOVE:"tab_from_above",TAB_FROM_BELOW:"tab_from_below"}),Kte="grid";function Xte(t,e){const n=pO(t,hu.TAB_FROM_ABOVE),i=pO(t,hu.TAB_FROM_BELOW);return e.prepend(n),e.append(i),{activate(){n.tabIndex=0,i.tabIndex=0},deactivate(){n.tabIndex=-1,i.tabIndex=-1},destroy(){n.remove(),i.remove()}}}function pO(t,e){const i=t.rootDocument.createElement("input");return i.type="text",i.name="htFocusCatcher",i.classList.add("htFocusCatcher"),i.dataset.htFocusSource=e,t.getSettings().ariaTags&&le(i,[lr("Focus catcher")]),i}function qte(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i={shortcutsContextName:Kte,type:Gte.INLINE,contains:f=>f===e||e.contains(f),runOnlyIf:()=>!0,...n},r=Xte(t,e);return{getType:()=>i.type,hasContainerDetached:()=>!t.rootWrapperElement.contains(e),getShortcutsContextName:()=>i.shortcutsContextName,runOnlyIf:()=>i.runOnlyIf(),contains:f=>i.contains(f),activate:function(){var f;let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:hu.UNKNOWN;(f=i.onActivate)===null||f===void 0||f.call(i,p)},deactivate:()=>{var f;(f=i.onDeactivate)===null||f===void 0||f.call(i)},activateFocusCatchers:()=>{r==null||r.activate()},deactivateFocusCatchers:()=>{r==null||r.deactivate()},enable:()=>{e.removeAttribute("inert")},disable:()=>{e.setAttribute("inert","true")},destroy:()=>{r==null||r.destroy()}}}function Zte(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=!1;function i(c){if(!n){var h;(h=e.onFocus)===null||h===void 0||h.call(e,c)}}function r(c){var h;(h=e.onClick)===null||h===void 0||h.call(e,c)}function o(c){if(c.key==="Tab"){var h;(h=e.onTabKeyDown)===null||h===void 0||h.call(e,c)}}function s(){n=!0}function a(){n=!1}return{mount:()=>{let c=t;for(;c;){const{documentElement:h}=c.document;h.addEventListener("focusin",i),h.addEventListener("click",r),h.addEventListener("keydown",o),h.addEventListener("mousedown",s),h.addEventListener("mouseup",a),c=il(c)}},unmount:()=>{let c=t;for(;c;){const{documentElement:h}=c.document;h.removeEventListener("focusin",i),h.removeEventListener("click",r),h.removeEventListener("keydown",o),h.removeEventListener("mousedown",s),h.removeEventListener("mouseup",a),c=il(c)}}}}function Jte(t){const e=vg({errorIdExists:p=>`The "${p}" focus scope is already registered.`}),n=t.getShortcutManager();let i=null;function r(){return i?e.getId(i):null}function o(p,v){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(e.hasItem(p))throw new Error(`Scope with id "${p}" already registered`);const P=qte(t,v,b);e.addItem(p,P),n.getOrCreateContext(P.getShortcutsContextName())}function s(p){if(!e.hasItem(p))throw new Error(`Scope with id "${p}" not found`);e.getItem(p).destroy(),e.removeItem(p)}function a(p){if(!e.hasItem(p))throw new Error(`Scope with id "${p}" not found`);u(e.getItem(p))}function l(p){if(!e.hasItem(p))throw new Error(`Scope with id "${p}" not found`);c(e.getItem(p))}function u(p){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:hu.UNKNOWN;i!==p&&(i!==null&&c(i),i=p,i.activate(v),n.setActiveContextName(p.getShortcutsContextName()))}function c(p){h(),i===p&&(i=null,p.deactivate())}function h(){const p=e.getValues(),v=p.filter(b=>b.runOnlyIf()&&b.getType()==="modal");p.forEach(b=>{v.length>0&&v.includes(b)||v.length===0||b.hasContainerDetached()?b.enable():b.disable(),b===i?b.contains(t.rootDocument.activeElement)?b.deactivateFocusCatchers():b.activateFocusCatchers():b.runOnlyIf()?b.activateFocusCatchers():b.deactivateFocusCatchers()})}function d(p,v){if(!p.isConnected||!Pu(p))return;const b=e.getValues().filter(_=>_.runOnlyIf());let P=!1;b.forEach(_=>{!P&&_.contains(p)&&(P=!0,v!==hu.UNKNOWN&&t.listen(),u(_,v))}),!P&&i&&(c(i),t.unlisten())}const f=Zte(t.rootWindow,{onFocus:p=>{var v;d(p.target,(v=p.target.dataset.htFocusSource)!==null&&v!==void 0?v:hu.UNKNOWN)},onClick:p=>{d(p.target,hu.CLICK)},onTabKeyDown:()=>{h()}});return f.mount(),{getActiveScopeId:r,registerScope:o,unregisterScope:s,activateScope:p=>a(p),deactivateScope:p=>l(p),destroy:()=>f.unmount()}}function Qte(t,e){ck(t,e),e.add(t)}function cc(t,e,n){ck(t,e),e.set(t,n)}function ck(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vt(t,e){return t.get(uo(t,e))}function ou(t,e,n){return t.set(uo(t,e),n),n}function uo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ph=Object.freeze({CELL:"cell",MIXED:"mixed"});var Jt=new WeakMap,wm=new WeakMap,vm=new WeakMap,Cm=new WeakMap,ym=new WeakMap,Ow=new WeakMap,Zo=new WeakSet;class ene{constructor(e){Qte(this,Zo),cc(this,Jt,void 0),cc(this,wm,void 0),cc(this,vm,1),cc(this,Cm,null),cc(this,ym,new Map),cc(this,Ow,!1),ou(Jt,this,e)}init(){var e=this;const n=vt(Jt,this).getSettings();ou(wm,this,n.imeFastEdit?ph.MIXED:ph.CELL),vt(Jt,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return uo(Zo,e,rne).call(e,...r)}),vt(Jt,this).addHook("afterSelection",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return uo(Zo,e,wO).call(e,...r)}),vt(Jt,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return uo(Zo,e,wO).call(e,...r)}),vt(Jt,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return uo(Zo,e,nne).call(e,...r)}),vt(Jt,this).addHook("afterRender",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return uo(Zo,e,ine).call(e,...r)})}getFocusMode(){return vt(wm,this)}setFocusMode(e){Object.values(ph).includes(e)?ou(wm,this,e):$e(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return vt(vm,this)}setRefocusDelay(e){ou(vm,this,e)}setRefocusElementGetter(e){ou(Cm,this,e)}getRefocusElement(){var e;return typeof vt(Cm,this)=="function"?vt(Cm,this).call(this):(e=vt(Jt,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=i=>{var r,o;const s=(r=vt(Jt,this).getSelectedRangeActive())===null||r===void 0?void 0:r.highlight;if(!s)return;let a=vt(Jt,this).runHooks("modifyFocusedElement",s.row,s.col,i);Js(a)||(a=i),a&&!((o=vt(Jt,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):uo(Zo,this,j_).call(this,i=>n(i))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:vt(vm,this);if(vt(Jt,this).getSettings().imeFastEdit&&!((e=vt(Jt,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var i,r;(i=vt(Jt,this).getActiveEditor())===null||i===void 0||(r=i.refreshValue)===null||r===void 0||r.call(i),vt(ym,this).has(n)||vt(ym,this).set(n,Uv(()=>{if(!vt(Jt,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},n)),vt(ym,this).get(n)()}}}function j_(t){var e;const n=(e=vt(Jt,this).getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!n||!vt(Jt,this).selection.isCellVisible(n)){t(null);return}const i=vt(Jt,this).getCell(n.row,n.col,!0);i===null?vt(Jt,this).addHookOnce("afterScroll",()=>{t(vt(Jt,this).getCell(n.row,n.col,!0))}):t(i)}function tne(){uo(Zo,this,j_).call(this,t=>{const{activeElement:e}=vt(Jt,this).rootDocument;e&&n$(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function nne(){uo(Zo,this,j_).call(this,t=>{this.getFocusMode()===ph.MIXED&&(t==null?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function wO(){ou(Ow,this,!0)}function ine(){vt(Ow,this)&&(ou(Ow,this,!1),uo(Zo,this,tne).call(this))}function rne(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?ph.MIXED:ph.CELL)}function one(t){return e=>{if(!e)return null;const{rowIndexMapper:n,columnIndexMapper:i}=t;if(n.isHidden(e.row)||i.isHidden(e.col))return null;const r=LR(t),o=FR(t);return r===null||o===null?null:(e.row=Ue(e.row,r.row,o.row),e.col=Ue(e.col,r.col,o.col),e)}}function LR(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:i}=t.getSettings();let r=i&&t.countColHeaders()>0?-t.countColHeaders():0,o=i&&t.countRowHeaders()>0?-t.countRowHeaders():0;return r===0&&(r=e.getVisualFromRenderableIndex(r)),o===0&&(o=n.getVisualFromRenderableIndex(o)),r===null||o===null?null:t._createCellCoords(r,o)}function FR(t){var e,n;const{rowIndexMapper:i,columnIndexMapper:r}=t,{navigableHeaders:o}=t.getSettings();let s=i.getRenderableIndexesLength()-1,a=r.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=i.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=r.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}const wf="gridDefault",U_="grid",Aw="grid.tabNavigation",ul="editorManager.handlingEditor",sne="editor",ane={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},lne="hooksRefRegisterer",hk={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){O(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){We(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};aa(hk,"MIXIN_NAME",lne,{writable:!1,enumerable:!1});function zr(t,e,n){return(e=une(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function une(t){var e=cne(t,"string");return typeof e=="symbol"?e:e+""}function cne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const hne="base",Qt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Uh{static get EDITOR_TYPE(){return hne}constructor(e){zr(this,"hot",void 0),zr(this,"state",Qt.VIRGIN),zr(this,"_opened",!1),zr(this,"_fullEditMode",!1),zr(this,"_closeCallback",null),zr(this,"TD",null),zr(this,"row",null),zr(this,"col",null),zr(this,"prop",null),zr(this,"originalValue",null),zr(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,i,r,o,s){this.TD=r,this.row=e,this.col=n,this.prop=i,this.originalValue=o,this.cellProperties=s,this.state=this.isOpened()?this.state:Qt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let i,r,o,s;if(n){const l=this.hot.getSelectedRangeActive(),u=l.getTopStartCorner(),c=l.getBottomEndCorner();i=u.row,r=u.col,o=c.row,s=c.col}else[i,r,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",i,r,!1,"meta");Array.isArray(a)&&([i,r]=a),this.hot.populateFromArray(i,r,e,o,s,"edit")}beginEditing(e,n){if(this.state!==Qt.VIRGIN)return;const i=this.hot,r=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=i.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=Qt.EDITING,this.isInFullEditMode()){const l=this.cellProperties.valueGetter?this.cellProperties.valueGetter(this.originalValue):this.originalValue,u=typeof e=="string"?e:Tt(l);this.setValue(u)}this.open(n),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),i.view.scrollViewport(i._createCellCoords(r,o))||(this.hot.removeHook("afterScroll",s),s()),this.addHook("beforeDialogShow",()=>this.cancelChanges())}finishEditing(e,n,i){let r;if(i){const o=this._closeCallback;this._closeCallback=s=>{o&&o(s),i(s),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Qt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Qt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?r=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:r=[[o]],this.state=Qt.WAITING,this.saveValue(r,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",s=>{this.state=Qt.FINISHED,this.discardEditor(s)}):(this.state=Qt.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Qt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Qt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Qt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Qt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Qt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:i,wtViewport:r}=this.hot.view._wt,o=this.hot.rootWindow,s=oi(n),a=cn(n),l=oi(this.hot.rootElement),u=cn(this.hot.rootElement),c=i.topOverlay.holder,h=i.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,p=o.innerWidth-l.left-u,{wtTable:v}=(e=i.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,b=v.name,P=["master","inline_start"].includes(b)?d:0,_=["master","top","bottom"].includes(b)?f:0,F=s.top===l.top?0:1;let I=s.top-l.top-F-P,W=0;this.hot.isRtl()?W=o.innerWidth-s.left-a-p-1+_:W=s.left-l.left-1-_,["top","top_inline_start_corner"].includes(b)&&(I+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(b)&&(W+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));const k=this.hot.hasColHeaders(),$=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),Y=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),U=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(k&&$<=0||$===U)&&(I+=1),Y<=0&&(W+=1);const oe=r.rowsRenderCalculator.startPosition,j=r.columnsRenderCalculator.startPosition,Z=Math.abs(i.inlineStartOverlay.getScrollPosition()),re=i.topOverlay.getScrollPosition(),pe=hn(this.hot.rootDocument);let Xe=n.offsetTop;if(["inline_start","master"].includes(b)&&(Xe+=oe-re),["bottom","bottom_inline_start_corner"].includes(b)){const{wtViewport:T,wtTable:D}=i.bottomOverlay.clone;Xe+=T.getWorkspaceHeight()-D.getHeight()-pe}let xe=n.offsetLeft;this.hot.isRtl()?(xe>=0?xe=v.getWidth()-n.offsetLeft:xe=Math.abs(xe),xe+=j-Z-a):["top","master","bottom"].includes(b)&&(xe+=j-Z);const Oe=o.getComputedStyle(this.TD),Re=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Ae=parseInt(Oe[Re],10)>0?0:1,Ze=parseInt(Oe.borderTopWidth,10)>0?0:1,gt=cn(n)+Ae,ke=yn(n)+Ze,G=e$(c)?pe:0,g=t$(h)?pe:0,w=this.hot.view.maximumVisibleElementWidth(xe)-G+Ae,y=Math.max(this.hot.view.maximumVisibleElementHeight(Xe)-g+Ze,this.hot.stylesHandler.getDefaultRowHeight());return{top:I,start:W,height:ke,maxHeight:y,width:gt,maxWidth:w}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}ct(Uh,hk);const dne={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const i=t._getEditorManager(),r=i.getActiveEditor();r.isInFullEditMode()&&r.state===Qt.EDITING||(i.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},fne={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},gne={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},mne={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeActive();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},pne={name:"editorOpen",callback(t,e,n){const{selection:i}=t,r=t._getEditorManager(),o=t.getSelectedRange(),s=t.getSelectedRangeActive(),{highlight:a}=s;if((o.some(l=>i.isMultiple(l))||o.length>1)&&!s.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const l=t.getSettings(),u=typeof l.enterMoves=="function"?l.enterMoves(e):l.enterMoves;n.includes("shift")?i.transformFocus(-u.row,-u.col):i.transformFocus(u.row,u.col);return}a.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),$r(e))}};function wne(){return[ane,dne,fne,gne,mne,pne]}const vne={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},Cne={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:i}=t.getSelectedRangeActive(),r=Math.min(i.row+t.countVisibleRows(),t.countRows()-1),o=n.getNearestNotHiddenIndex(r,-1);if(o!==null){const s=t._createCellCoords(o,i.col),a=i.row-t.getFirstFullyVisibleRow(),l=Math.min(s.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(s,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},yne={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},bne={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},Sne={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(i.col,r.col,n),e.markEndSource()}},Rne={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeActive(),s=i.isHeader()&&e.isSelectedByRowHeader();if(i.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=r.clone();l.row=i.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},Ene={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&i.isCell()){const s=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=r.clone();a.col=i.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},Tne={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&i.isCell()){const s=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(s,1),l=r.clone();l.col=i.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},_ne={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeActive(),s=i.isHeader()&&e.isSelectedByColumnHeader();if(i.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=r.clone();l.col=i.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},Mne={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeActive(),s=i.isHeader()&&e.isSelectedByColumnHeader();if(i.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=r.clone();l.col=i.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},Pne={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeActive(),s=i.isHeader()&&e.isSelectedByRowHeader();if(i.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1),l=r.clone();l.row=i.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col)),e.markEndSource()}}},Ine={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(i.row,r.row,n),e.markEndSource()}},xne={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},One={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:i}=t.getSelectedRangeActive(),r=Math.max(i.row-t.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(r,1);if(o!==null){const s=t._createCellCoords(o,i.col),a=i.row-t.getFirstFullyVisibleRow(),l=Math.max(s.row-a,0);e.markSource("keyboard"),e.setRangeEnd(s,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function Ane(){return[vne,Cne,yne,bne,Sne,Rne,Ene,Tne,_ne,Mne,Pne,Ine,xne,One]}const Hne={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},Nne={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),i=n?t.countColHeaders():0,{row:r}=t.getSelectedRangeActive().highlight;let o=t.countVisibleRows()+i;o=o===0?1:o,r===t.countRows()-1?o=1:r+o>t.countRows()&&(o=t.countRows()-r-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}},Dne={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,i=t.getSettings(),r=t.getSelectedRange(),o=t.getSelectedRangeActive(),s=typeof i.tabMoves=="function"?i.tabMoves(e):i.tabMoves;n.markSource("keyboard"),(r.some(a=>n.isMultiple(a))||r.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-s.row,-s.col):n.transformStart(-s.row,-s.col),n.markEndSource()}},$ne={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,i=t.getSettings(),r=t.getSelectedRange(),o=t.getSelectedRangeActive(),s=typeof i.tabMoves=="function"?i.tabMoves(e):i.tabMoves;n.markSource("keyboard"),(r.some(a=>n.isMultiple(a))||r.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(s.row,s.col):n.transformStart(s.row,s.col),n.markEndSource()}},kne={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},Lne={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},Fne={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeActive().highlight;let i=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);i===null&&(i=-1),e.setRangeStart(t._createCellCoords(i,n))}},Vne={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-r-1,-1),s=i.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},Wne={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeActive().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},Bne={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedColumnsStart,10),r=t.getSelectedRangeActive().highlight.row,o=n.getNearestNotHiddenIndex(i,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,o)),e.markEndSource()}},jne={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,i=t.getSelectedRangeActive().highlight.row;let r=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);r===null&&(r=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,r)),e.markEndSource()}},Une={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:i}=t.getSelectedRangeActive().highlight;let r=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);r===null&&(r=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,r)),e.markEndSource()}},zne={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeActive().highlight;let i=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);i===null&&(i=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,n)),e.markEndSource()}},Yne={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(r,1),a=i.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},Gne={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},Kne={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),i=n?t.countColHeaders():0,{row:r}=t.getSelectedRangeActive().highlight;let o=t.countVisibleRows()+i;o=o===0?-1:-o,r===-i?o=-1:r+o<i&&(o=-(r+i)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}};function Xne(){return[Hne,Nne,Dne,$ne,kne,Lne,Fne,Vne,Wne,Bne,jne,Une,zne,Yne,Gne,Kne]}const qne={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},Zne={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeActive(),n=t.getFirstFullyVisibleRow()-1,i=t.getFirstFullyVisibleColumn()-1,r=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,i),a=t._createCellCoords(r,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},Jne={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},Qne={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},eie={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:i}=e[e.length-1].highlight.normalize(),r=t.getDataAtCell(n,i),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==i)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,r])}});t.setDataAtCell(Array.from(o.values()))}},tie={name:"tabNavigation",callback(t){const e={wrapped:!1,flipped:!1};let n=!1,i=!1;return t.addHook("afterSelection",(r,o,s,a,l)=>{n&&(e.wrapped&&e.flipped||i)&&(i=!1,l.value=!0)}),t.addHook("beforeRowWrap",(r,o,s)=>{e.wrapped=!0,e.flipped=s}),{before(){const{tabNavigation:r}=t.getSettings();n=!0,r||(i=!0)},after(r){const{tabNavigation:o,autoWrapRow:s}=t.getSettings();if(n=!1,!o||!t.selection.isSelected()||s&&e.wrapped&&e.flipped||!s&&e.wrapped)return e.wrapped=!1,e.flipped=!1,t.deselectCell(),!1;r.preventDefault()}}}},nie=[...wne(),...Ane(),...Xne(),qne,Zne,Jne,Qne,eie,tie];function dk(t){const e={};return nie.forEach(n=>{let{name:i,callback:r}=n;e[i]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return r(t,...s)}}),e}function iie(t){const e=t.getShortcutManager().addContext(sne),n=dk(t),i={group:ul};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(r,o)=>n.editorCloseAndSaveByEnter(r,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(r,o)=>n.editorCloseAndSaveByEnter(r,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext(U_),callback:(r,o)=>n.editorCloseAndSave(r,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(r,o)=>n.editorCloseAndSaveByArrowKeys(r,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],i)}function rie(t){const e=t.getShortcutManager().addContext(U_),n=dk(t),i={runOnlyIf:()=>{const{navigableHeaders:o}=t.getSettings();return te(t.getSelected())&&(o||!o&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:wf};e.addShortcuts([{keys:[["F2"]],callback:o=>n.editorFastOpen(o)},{keys:[["Enter"],["Enter","Shift"]],callback:(o,s)=>n.editorOpen(o,s)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:ul,runOnlyIf:()=>te(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var o;return!((o=t.getSelectedRangeActive())!==null&&o!==void 0&&o.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var o;return(o=t.getSelectedRangeActive())===null||o===void 0?void 0:o.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var o,s;return!((o=t.getSelectedRangeActive())!==null&&o!==void 0&&o.highlight.isHeader())&&((s=t.getSelectedRangeActive())===null||s===void 0?void 0:s.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:o=>n.moveCellSelectionInlineStart(o)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:o=>n.moveCellSelectionInlineEnd(o)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],i);const r=n.tabNavigation();e.addShortcuts([{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:wf,group:Aw,position:"before",callback:o=>r.before(o)},{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:wf,group:Aw,callback:o=>r.after(o),position:"after"}])}function oie(t){[rie,iie].forEach(e=>e(t))}function sie(t){var e;const n=one(t),i={wrapped:!1,flipped:!1};let r,o=!0,s=!1;t.addHook("afterSelection",()=>{if(o){var u;r=(u=t.getSelectedRangeActive())===null||u===void 0?void 0:u.highlight}}),t.addHook("beforeRowWrap",(u,c,h)=>{i.wrapped=!0,i.flipped=h}),t.addHook("beforeEmptyDataStateShow",()=>{s=!0}),t.addHook("beforeEmptyDataStateHide",()=>{s=!1}),t.getShortcutManager().getContext(U_).addShortcuts([{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:wf,group:Aw,position:"before",callback(){const{tabNavigation:u}=t.getSettings();t.getSelectedRangeActive()&&!u&&(o=!1)}},{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:wf,group:Aw,callback(u){const{tabNavigation:c,autoWrapRow:h}=t.getSettings();o=!0,(!c||!t.selection.isSelected()||h&&i.wrapped&&i.flipped||!h&&i.wrapped)&&(h&&i.wrapped&&i.flipped&&(r=u.shiftKey?LR(t):FR(t)),i.wrapped=!1,i.flipped=!1)},position:"after"}]);const l=(e=t.rootGridElement)!==null&&e!==void 0?e:t.rootElement;t.getFocusScopeManager().registerScope("grid",l,{contains:u=>l===u||l.contains(u)?!0:u.closest(".htMenu")!==null?!1:t.rootPortalElement.contains(u),runOnlyIf:()=>{const{navigableHeaders:u}=t.getSettings();return(s||!u)&&t.countRenderedRows()===0&&t.countRenderedCols()===0&&t.countRowHeaders()>0&&t.countColHeaders()>0?!1:!u&&t.countRenderedRows()>0&&t.countRenderedCols()>0||u&&(t.countRowHeaders()>0||t.countColHeaders()>0)},onActivate:u=>{if(u==="tab_from_above"){var c;const d=(c=n(r))!==null&&c!==void 0?c:LR(t);d&&t.runHooks("modifyFocusOnTabNavigation","from_above",d)!==!1&&t.selectCell(d.row,d.col)}else if(u==="tab_from_below"){var h;const d=(h=n(r))!==null&&h!==void 0?h:FR(t);d&&t.runHooks("modifyFocusOnTabNavigation","from_below",d)!==!1&&t.selectCell(d.row,d.col)}}})}function aie(t){[sie].forEach(e=>e(t))}const vO=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),bm=t=>t.map(e=>{const n=e.toLowerCase();return vO.has(n)?vO.get(n):n}).sort().join("+"),lie=t=>t.split("+"),CO=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),Yy=t=>{let{which:e,key:n}=t;if(CO.has(e))return CO.get(e);const i=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(i)?i:n.toLowerCase()},fk=Symbol("shortcut-context");function VR(t){return me(t)&&t.__kindOf===fk}const uie=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const n=vg({errorIdExists:u=>`The "${u}" shortcut is already registered in the "${t}" context.`}),i=function(){let{keys:u,callback:c,group:h,runOnlyIf:d=()=>!0,captureCtrl:f=!1,preventDefault:p=!0,stopPropagation:v=!1,relativeToGroup:b,position:P,forwardToContext:_}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(xt(h))throw new Error("You need to define the shortcut's group.");if(ot(c)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(u)===!1)throw new Error(nt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const F={callback:c,group:h,runOnlyIf:d,captureCtrl:f,preventDefault:p,stopPropagation:v};te(b)&&(F.relativeToGroup=b,F.position=P),VR(_)&&(F.forwardToContext=_),u.forEach(I=>{const W=bm(I);if(n.hasItem(W)){const $=n.getItem(W);let Y=$.findIndex(J=>J.group===b);Y!==-1?P==="before"?Y-=1:Y+=1:Y=$.length,$.splice(Y,0,F)}else n.addItem(W,[F])})},r=function(u){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};u.forEach(h=>{We(c,(d,f)=>{Object.prototype.hasOwnProperty.call(h,f)===!1&&(h[f]=c[f])}),i(h)})},o=u=>{const c=bm(u);n.removeItem(c)};return{__kindOf:fk,scope:e,addShortcut:i,addShortcuts:r,getShortcuts:u=>{const c=bm(u),h=n.getItem(c);return te(h)?h.slice():[]},hasShortcut:u=>{const c=bm(u);return n.hasItem(c)},removeShortcutsByKeys:o,removeShortcutsByGroup:u=>{n.getItems().forEach(h=>{let[d,f]=h;const p=f.filter(v=>v.group!==u);p.length===0?o(lie(d)):(f.length=0,f.push(...p))})}}};function cie(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const hie=["meta","alt","shift","control"],vd=cie(),Cd=[];let Sm=0;function die(t,e,n,i,r){const o=f=>hie.includes(f),s=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=[];return f.altKey&&v.push("alt"),p&&(f.ctrlKey||f.metaKey)?v.push("control/meta"):(f.ctrlKey&&v.push("control"),f.metaKey&&v.push("meta")),f.shiftKey&&v.push("shift"),v},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||nu(f))return;const v=Yy(f);let b=[];o(v)||(b=s(f));const P=[v].concat(b);!r(f,P)&&(ex()&&b.includes("meta")||!ex()&&b.includes("control"))&&r(f,[v].concat(s(f,!0))),i(f)},l=f=>{if(typeof f.key=="string"){const p=Yy(f);o(p)&&vd.press(p)}},u=f=>{if(typeof f.key=="string"){const p=Yy(f);o(p)&&vd.release(p)}},c=()=>{vd.releaseAll()};return{mount:()=>{let f=t;for(Sm+=1;f;)Sm===1&&(f.document.documentElement.addEventListener("keydown",l),Cd.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),Cd.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=il(f)},unmount:()=>{let f=t;for(Sm-=1;f;){if(Sm===0){for(let p=0;p<Cd.length;p++){const{event:v,listener:b}=Cd[p];f.document.documentElement.removeEventListener(v,b)}Cd.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=il(f)}},isPressed:f=>vd.isPressed(f),releasePressedKeys:()=>vd.releaseAll()}}const fie=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:i,afterKeyDown:r}=t;const o=vg({errorIdExists:b=>`The "${b}" context name is already registered.`});let s="grid";const a=function(b){let P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const _=uie(b,P);return o.addItem(b,_),_},l=()=>s,u=b=>o.getItem(b),c=function(b){var P;let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";return(P=u(b))!==null&&P!==void 0?P:a(b,_)},h=b=>{if(!o.hasItem(b))throw new Error(nt`You've tried to activate the "${b}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=b};let d=!1;const f=function(b,P){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const F=VR(_)?_:u(_);let I=!1;if(!F.hasShortcut(P))return I;const W=F.getShortcuts(P);for(let k=0;k<W.length;k++){const{callback:$,runOnlyIf:Y,preventDefault:J,stopPropagation:U,captureCtrl:oe,forwardToContext:j}=W[k];if(Y(b)===!0){if(d=oe,I=$(b,P)===!1,d=!1,J&&b.preventDefault(),U&&($r(b),b.stopPropagation()),I)break;j&&f(b,P,j)}}return I},v=die(e,b=>{const P=l(),_=VR(P)?P:u(P);return n(b,_.scope)},i,r,f);return v.mount(),{addContext:a,getActiveContextName:l,getContext:u,getOrCreateContext:c,setActiveContextName:h,isCtrlPressed:()=>!d&&(v.isPressed("control")||v.isPressed("meta")),releasePressedKeys:()=>v.releasePressedKeys(),destroy:()=>v.unmount()}};function yO(t){const{classNames:e}=G9(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function gie(t,e){gk(t,e),e.add(t)}function Ts(t,e,n){gk(t,e),e.set(t,n)}function gk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bt(t,e){return t.get(so(t,e))}function Di(t,e,n){return t.set(so(t,e),n),n}function so(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const bO=23;var Gy=new WeakMap,Io=new WeakMap,Hw=new WeakMap,z_=new WeakMap,WR=new WeakMap,Da=new WeakMap,of=new WeakMap,Uf=new WeakMap,yd=new WeakMap,Go=new WeakSet;class mie{constructor(e){let{hot:n,rootElement:i,rootDocument:r,onThemeChange:o=()=>{}}=e;gie(this,Go),Ts(this,Gy,void 0),Ts(this,Io,void 0),Ts(this,Hw,void 0),Ts(this,z_,void 0),Ts(this,WR,void 0),Ts(this,Da,!0),Ts(this,of,{}),Ts(this,Uf,{}),Ts(this,yd,void 0),Di(Gy,this,n),Di(Hw,this,i),Di(WR,this,r),Di(yd,this,o)}isClassicTheme(){return Bt(Da,this)}getCSSVariableValue(e){var n;if(Bt(Da,this))return null;if(Bt(of,this)[`--ht-${e}`])return Bt(of,this)[`--ht-${e}`];const i=(n=so(Go,this,vie).call(this,`--ht-${e}`))!==null&&n!==void 0?n:so(Go,this,mk).call(this,`--ht-${e}`);if(i!==null)return Bt(of,this)[`--ht-${e}`]=i,i}getStyleForTD(e){var n;return(n=Bt(Uf,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(e){if(Bt(Da,this))return bO;const n=so(Go,this,pie).call(this);return n?e!==void 0&&e===Bt(Gy,this).view.getFirstRenderedVisibleRow()?n+1:n:bO}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){Di(Io,this,void 0),Di(Da,this,!0),Bt(yd,this).call(this,Bt(Io,this)),so(Go,this,Ky).call(this);return}if(e&&e!==Bt(Io,this)){if(!/ht-theme-.*/.test(e)){$e(`Invalid theme name: ${e}. Please provide a valid theme name.`),Di(Io,this,void 0),Di(Da,this,!1),Bt(yd,this).call(this,Bt(Io,this)),so(Go,this,Ky).call(this);return}Bt(Io,this)&&so(Go,this,Cie).call(this),Di(Io,this,e),Di(Da,this,!1),Bt(yd,this).call(this,Bt(Io,this)),so(Go,this,Ky).call(this)}}getThemeName(){return Bt(Io,this)}}function pie(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function Ky(){this.isClassicTheme()||Di(z_,this,getComputedStyle(Bt(Hw,this)));const t=so(Go,this,wie).call(this,["box-sizing","border-bottom-width"]);Bt(Uf,this).td={...Bt(Uf,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function wie(t){const e=Bt(WR,this),n=Bt(Hw,this),i=e.createElement("table"),r=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),a=e.createElement("td");s.appendChild(a),r.appendChild(o),r.appendChild(s),i.appendChild(r),n.appendChild(i);const l=getComputedStyle(a),u={};return t.forEach(c=>{u[c]=l.getPropertyValue(c)}),n.removeChild(i),u}function vie(t){const e=Math.ceil(parseFloat(so(Go,this,mk).call(this,t)));return Number.isNaN(e)?null:e}function mk(t){const e=Bt(z_,this).getPropertyValue(t);return e===""?null:e}function Cie(){Di(Uf,this,{}),Di(of,this,{}),Di(Da,this,!0)}let ar=null,zp=0;function yie(t){const e=t.ownerDocument;if(!ar){ar=e.createElement("div"),ar.setAttribute("role","status"),ar.setAttribute("aria-live","assertive"),ar.setAttribute("aria-atomic","true");const n=ar.style;n.position="absolute",n.width="1px",n.height="1px",n.margin="-1px",n.overflow="hidden",n.clipPath="rect(0 0 0 0)",n.whiteSpace="nowrap",t.appendChild(ar)}zp+=1}function bie(){zp!==0&&(zp===1&&(ar.remove(),ar=null),zp-=1)}function Sie(t){ar&&(ar.textContent="",setTimeout(()=>{ar&&(ar.textContent=t)},100))}let Xy=null;const Rm=new WeakSet,qy=new Map;function pk(t,e){var n,i,r=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const a=new wo(s);let l,u,c,h,d,f,p=!0;const v={...e.initialState,...e};gQ(o)&&fQ(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootGridElement=void 0,this.rootPortalElement=void 0,this.rootElement=Uo(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,Uo(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootGridElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),B(this.rootElement,["ht-wrapper","handsontable"]),B(this.rootWrapperElement,"ht-root-wrapper"),B(this.rootGridElement,"ht-grid"),this.rootGridElement.appendChild(this.rootElement),this.rootWrapperElement.appendChild(this.rootGridElement),this.rootContainer.appendChild(this.rootWrapperElement),B(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const b=(n=v==null?void 0:v.layoutDirection)!==null&&n!==void 0?n:"inherit",P=["rtl","ltr"].includes(b)?b:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",P),(i=this.rootWrapperElement)===null||i===void 0||i.setAttribute("dir",P),this.isRtl=function(){return P==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},this.stylesHandler=new mie({hot:s,rootElement:s.rootElement,rootDocument:s.rootDocument,onThemeChange:g=>{Uo(this)&&(ae(this.rootWrapperElement,/ht-theme-.*/g),ae(this.rootPortalElement,/ht-theme-.*/g),g&&(B(this.rootWrapperElement,g),B(this.rootPortalElement,g),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||$e(`The "${g}" theme is enabled, but its stylesheets are missing or not imported correctly.               Import the correct CSS files in order to use that theme.`)))}}),v.language=Ree(v.language);const _=Object.fromEntries(Object.entries(v).filter(g=>{let[w]=g;return!(ie.getSingleton().isRegistered(w)||ie.getSingleton().isDeprecated(w))})),F=new lk(s,_,[Ite,$te]),I=F.getTableMeta(),W=F.getGlobalMeta(),k=vg();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),this.guid=`ht_${ID()}`,qy.set(this.guid,this),this.columnIndexMapper=new HR,this.rowIndexMapper=new HR,this.columnIndexMapper.addLocalHook("indexesSequenceChange",g=>{s.runHooks("afterColumnSequenceChange",g)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",g=>{s.runHooks("afterRowSequenceChange",g)}),a.addEventListener(this.rootDocument.documentElement,"compositionstart",g=>{s.runHooks("beforeCompositionStart",g)}),u=new DQ(s);const $=Vr(this.guid);$.register("cellRangeMapper",new Lte({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const Y=g=>{const{row:w,col:y}=g;return s._createCellCoords(w>=0?s.rowIndexMapper.getRenderableFromVisualIndex(w):w,y>=0?s.columnIndexMapper.getRenderableFromVisualIndex(y):y)},J=g=>{const{row:w,col:y}=g;return s._createCellCoords(w>=0?s.rowIndexMapper.getVisualFromRenderableIndex(w):w,y>=0?s.columnIndexMapper.getVisualFromRenderableIndex(y):y)},U=(g,w)=>{const y=w>g?1:-1,T=Math.min(g,w),D=Math.max(g,w),m=s.rowIndexMapper.getNearestNotHiddenIndex(g,y);return m===null||y===1&&m>D||y===-1&&m<T?null:m>=0?s.rowIndexMapper.getRenderableFromVisualIndex(m):m},oe=(g,w)=>{const y=w>g?1:-1,T=Math.min(g,w),D=Math.max(g,w),m=s.columnIndexMapper.getNearestNotHiddenIndex(g,y);return m===null||y===1&&m>D||y===-1&&m<T?null:m>=0?s.columnIndexMapper.getRenderableFromVisualIndex(m):m};let j=new ok(I,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:g=>l.propToCol(g),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(g,w)=>s._createCellCoords(g,w),createCellRange:(g,w,y)=>s._createCellRange(g,w,y),visualToRenderableCoords:Y,renderableToVisualCoords:J,findFirstNonHiddenRenderableRow:U,findFirstNonHiddenRenderableColumn:oe,isDisabledCellSelection:(g,w)=>g<0||w<0?s.getSettings().disableVisualSelection:s.getCellMeta(g,w).disableVisualSelection});this.selection=j;const Z=g=>{let{hiddenIndexesChanged:w}=g;this.forceFullRender=!0,w&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",g=>{Z(g),this.runHooks("afterColumnSequenceCacheUpdate",g)}),this.rowIndexMapper.addLocalHook("cacheUpdated",g=>{Z(g),this.runHooks("afterRowSequenceCacheUpdate",g)}),this.selection.addLocalHook("afterSetRangeEnd",(g,w)=>{const y=cr(!1),T=this.selection.getSelectedRange(),{from:D,to:m}=T.current(),C=T.size()-1;this.runHooks("afterSelection",D.row,D.col,m.row,m.col,y,C),this.runHooks("afterSelectionByProp",D.row,s.colToProp(D.col),m.row,s.colToProp(m.col),y,C),w&&(!y.isTouched()||y.isTouched()&&!y.value)&&f.scrollTo(g);const S=j.isSelectedByRowHeader(),x=j.isSelectedByColumnHeader();S&&x?B(this.rootElement,["ht__selection--rows","ht__selection--columns"]):S?(ae(this.rootElement,"ht__selection--columns"),B(this.rootElement,"ht__selection--rows")):x?(ae(this.rootElement,"ht__selection--rows"),B(this.rootElement,"ht__selection--columns")):ae(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(j.getSelectionSource())||h.closeEditor(null),j.getSelectionSource()!=="refresh"&&(s.view.render(),h.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",g=>{this.runHooks("beforeSelectionFocusSet",g.row,g.col)}),this.selection.addLocalHook("afterSetFocus",g=>{const w=cr(!1);this.runHooks("afterSelectionFocusSet",g.row,g.col,w),(!w.isTouched()||w.isTouched()&&!w.value)&&f.scrollTo(g),h.closeEditor(),s.view.render(),h.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",g=>{const w=g.length-1,{from:y,to:T}=g[w];this.runHooks("afterSelectionEnd",y.row,y.col,T.row,T.col,w),this.runHooks("afterSelectionEndByProp",y.row,s.colToProp(y.col),T.row,s.colToProp(T.col),w),j.getSelectionSource()==="refresh"&&(s.view.render(),h.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",g=>{const w=this.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=w)}),this.selection.addLocalHook("afterDeselect",()=>{h.closeEditor(),s.view.render(),ae(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("beforeSetRangeStart",...w)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("beforeSetRangeStartOnly",...w)}).addLocalHook("beforeSetRangeEnd",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("beforeSetRangeEnd",...w)}).addLocalHook("beforeSelectColumns",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("beforeSelectColumns",...w)}).addLocalHook("afterSelectColumns",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("afterSelectColumns",...w)}).addLocalHook("beforeSelectRows",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("beforeSelectRows",...w)}).addLocalHook("afterSelectRows",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("afterSelectRows",...w)}).addLocalHook("beforeSelectAll",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("beforeSelectAll",...w)}).addLocalHook("afterSelectAll",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("afterSelectAll",...w)}).addLocalHook("beforeModifyTransformStart",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("modifyTransformStart",...w)}).addLocalHook("afterModifyTransformStart",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("afterModifyTransformStart",...w)}).addLocalHook("beforeModifyTransformFocus",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("modifyTransformFocus",...w)}).addLocalHook("afterModifyTransformFocus",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("afterModifyTransformFocus",...w)}).addLocalHook("beforeModifyTransformEnd",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("modifyTransformEnd",...w)}).addLocalHook("afterModifyTransformEnd",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("afterModifyTransformEnd",...w)}).addLocalHook("beforeRowWrap",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("beforeRowWrap",...w)}).addLocalHook("beforeColumnWrap",function(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];return r.runHooks("beforeColumnWrap",...w)}).addLocalHook("insertRowRequire",g=>this.alter("insert_row_above",g,1,"auto")).addLocalHook("insertColRequire",g=>this.alter("insert_col_start",g,1,"auto")),c={alter(g,w){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,T=arguments.length>3?arguments[3]:void 0,D=arguments.length>4?arguments[4]:void 0;const m=C=>{if(C.length===0)return[];const S=[...C];return S.sort((E,R)=>{let[N]=E,[M]=R;return N===M?0:N>M?1:-1}),ji(S,(E,R)=>{let[N,M]=R;const A=E[E.length-1],[L,V]=A,z=L+V;if(N<=z){const se=Math.max(M-(z-N),0);A[1]+=se}else E.push([N,M]);return E},[S[0]])};switch(g){case"insert_row_below":case"insert_row_above":const C=s.countSourceRows();if(I.maxRows===C)return;const S=g==="insert_row_below"?"below":"above";w=w??(S==="below"?C:0);const{delta:x,startPhysicalIndex:E}=l.createRow(w,y,{source:T,mode:S});j.shiftRows(s.toVisualRow(E),x);break;case"insert_col_start":case"insert_col_end":const R=g==="insert_col_end"?"end":"start";w=w??(R==="end"?s.countSourceCols():0);const{delta:N,startPhysicalIndex:M}=l.createCol(w,y,{source:T,mode:R});if(N){if(Array.isArray(I.colHeaders)){const V=[s.toVisualColumn(M),0];V.length+=N,Array.prototype.splice.apply(I.colHeaders,V)}j.shiftColumns(s.toVisualColumn(M),N)}break;case"remove_row":const A=V=>{let z=0;O(V,se=>{let[Q,ye]=se;const Be=rn(Q)?s.countRows()-1:Math.max(Q-z,0);if(Number.isInteger(Q)&&(Q=Math.max(Q-z,0)),!l.removeRow(Q,ye,T))return;if(j.isSelected()){const{row:Xt}=s.getSelectedRangeActive().highlight;Xt>=Q&&Xt<=Q+ye-1&&h.closeEditor(!0)}const Se=s.countRows(),je=I.fixedRowsTop;je>=Be+1&&(I.fixedRowsTop-=Math.min(ye,je-Be));const rt=I.fixedRowsBottom;if(rt&&Be>=Se-rt&&(I.fixedRowsBottom-=Math.min(ye,rt)),Se===0)j.deselect();else if(T==="ContextMenu.removeRow"){const Xt=j.getSelectedRange(),Bn=Xt.pop();Xt.clear().set(Bn.from).current().setTo(Bn.to),j.refresh()}else j.shiftRows(Q,-ye);z+=ye})};Array.isArray(w)?A(m(w)):A([[w,y]]);break;case"remove_col":const L=V=>{let z=0;O(V,se=>{let[Q,ye]=se;const Be=rn(Q)?s.countCols()-1:Math.max(Q-z,0);let et=s.toPhysicalColumn(Be);if(Number.isInteger(Q)&&(Q=Math.max(Q-z,0)),!l.removeCol(Q,ye,T))return;if(j.isSelected()){const{col:Xt}=s.getSelectedRangeActive().highlight;Xt>=Q&&Xt<=Q+ye-1&&h.closeEditor(!0)}if(s.countCols()===0)j.deselect();else if(T==="ContextMenu.removeColumn"){const Xt=j.getSelectedRange(),Bn=Xt.pop();Xt.clear().set(Bn.from).current().setTo(Bn.to),j.refresh()}else j.shiftColumns(Q,-ye);const rt=I.fixedColumnsStart;rt>=Be+1&&(I.fixedColumnsStart-=Math.min(ye,rt-Be)),Array.isArray(I.colHeaders)&&(typeof et>"u"&&(et=-1),I.colHeaders.splice(et,ye)),z+=ye})};Array.isArray(w)?L(m(w)):L([[w,y]]);break;default:throw new Error(`There is no such action "${g}"`)}D||c.adjustRowsAndCols(),s.view.adjustElementsSize(),s.view.render()},adjustRowsAndCols(){const g=I.minRows,w=I.minSpareRows,y=I.minCols,T=I.minSpareCols;if(g){const D=s.countRows();D<g&&l.createRow(D,g-D,{source:"auto"})}if(w){const D=s.countEmptyRows(!0);if(D<w){const m=w-D,C=Math.min(m,I.maxRows-s.countSourceRows());l.createRow(s.countRows(),C,{source:"auto"})}}{let D;(y||T)&&(D=s.countEmptyCols(!0));let m=s.countCols();if(y&&!I.columns&&m<y){const C=y-m;D+=C,l.createCol(m,C,{source:"auto"})}if(T&&!I.columns&&s.dataType==="array"&&D<T){m=s.countCols();const C=T-D,S=Math.min(C,I.maxCols-m);l.createCol(m,S,{source:"auto"})}}},populateFromArray(g,w,y,T,D){let m,C,S,x;const E=[],R={},N=[],M=g.row,A=g.col;if(C=w.length,C===0)return!1;let L=0,V=0;switch(me(y)&&(L=y.col-A+1,V=y.row-M+1),D){case"shift_down":const se=Lp(w),Q=se.length,ye=Math.max(Q,L),Be=s.getData().slice(M),et=Lp(Be).slice(A,A+ye);for(S=0;S<ye;S+=1)if(S<Q){for(m=0,C=se[S].length;m<V-C;m+=1)se[S].push(se[S][m%C]);S<et.length?N.push(se[S].concat(et[S])):N.push(se[S].concat(new Array(Be.length).fill(null)))}else N.push(se[S%Q].concat(et[S]));s.populateFromArray(M,A,Lp(N));break;case"shift_right":const Se=w.length,je=Math.max(Se,V),rt=s.getData().slice(M).map(Je=>Je.slice(A));for(m=0;m<je;m+=1)if(m<Se){for(S=0,x=w[m].length;S<L-x;S+=1)w[m].push(w[m][S%x]);if(m<rt.length)for(let Je=0;Je<rt[m].length;Je+=1)w[m].push(rt[m][Je]);else w[m].push(...new Array(rt[0].length).fill(null))}else w.push(w[m%C].slice(0,je).concat(rt[m]));s.populateFromArray(M,A,w);break;case"overwrite":default:R.row=g.row,R.col=g.col;let Xt=0,Bn=0,mr=!0,qt;const Ui=function(ca){let ha=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const yo=w[ca%w.length];return ha!==null?yo[ha%yo.length]:yo},_t=w.length,Rt=y?y.row-g.row+1:0;for(y?C=Rt:C=Math.max(_t,Rt),m=0;m<C&&!(y&&R.row>y.row&&Rt>_t||!I.allowInsertRow&&R.row>s.countRows()-1||R.row>=I.maxRows);m++){const Je=m-Xt,ca=Ui(Je).length,ha=y?y.col-g.col+1:0;if(y?x=ha:x=Math.max(ca,ha),R.col=g.col,qt=s.getCellMeta(R.row,R.col),(T==="CopyPaste.paste"||T==="Autofill.fill")&&qt.skipRowOnPaste){Xt+=1,R.row+=1,C+=1;continue}for(Bn=0,S=0;S<x;S++){var z;if(y&&R.col>y.col&&ha>ca||!I.allowInsertColumn&&R.col>s.countCols()-1||R.col>=I.maxCols)break;if(qt=s.getCellMeta(R.row,R.col),(T==="CopyPaste.paste"||T==="Autofill.fill")&&qt.skipColumnOnPaste){Bn+=1,R.col+=1,x+=1;continue}if(qt.readOnly&&T!=="UndoRedo.undo"){R.col+=1;continue}const yo=S-Bn,da=!!qt.valueSetter;let pr=Ui(Je,yo),jn=(z=s.getSourceDataAtCell(R.row,R.col))!==null&&z!==void 0?z:null;if(pr!==null&&typeof pr=="object"){if(Array.isArray(pr)&&jn===null&&(jn=[]),!da&&(typeof jn!="object"||jn===null))mr=!1;else if(jn!==null){const Ag=Vf(Array.isArray(jn)?jn:jn[0]||jn),Hg=Vf(Array.isArray(pr)?pr:pr[0]||pr);da||Vv(Ag,Hg)||Array.isArray(Ag)&&Array.isArray(Hg)?pr=Si(pr):mr=!1}}else!da&&jn!==null&&typeof jn=="object"&&(mr=!1);mr&&E.push([R.row,R.col,pr]),mr=!0,R.col+=1}R.row+=1}s.setDataAtCell(E,null,null,T||"populateFromArray");break}}};function re(g){const w=z$(g);F_(w)?(s.runHooks("beforeLanguageChange",w),W.language=w,s.runHooks("afterLanguageChange",w)):Y$(g)}function pe(g,w){const y=g==="className"?s.rootElement:s.table;if(p)B(y,w);else{let T=[],D=[];W[g]&&(T=Array.isArray(W[g])?W[g]:kI(W[g])),w&&(D=Array.isArray(w)?w:kI(w));const m=$I(T,D),C=$I(D,T);m.length&&ae(y,m),C.length&&B(y,C)}W[g]=w}this.init=function(){u.setData(I.data),s.runHooks("beforeInit"),(rs()||E0())&&B(s.rootElement,"mobile"),this.updateSettings(v,!0),this.view=new vQ(this),h=PR.getInstance(s,I,j),f=Yte(s),d.init(),Uo(this)&&(yie(s.rootPortalElement),N6(v.licenseKey,this.rootWrapperElement)),s.runHooks("init"),this.render(),p&&s.rootElement.offsetParent===null&&n7(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.view.adjustElementsSize(),s.render()}),typeof p=="object"&&(s.runHooks("afterChange",p[0],p[1]),p=!1),s.runHooks("afterInit")};function Xe(){let g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&g===!1&&(g=!0,this.onQueueEmpty(this.valid))}}}function xe(g,w,y){if(!g.length){y();return}const T=s.getActiveEditor(),D=new Xe;let m=!0;D.onQueueEmpty=()=>{T&&m&&T.cancelChanges(),y()};for(let C=g.length-1;C>=0;C--){const[S,x,,E]=g[C],R=l.propToCol(x);let N;Number.isInteger(R)?N=s.getCellMeta(S,R):N={...Object.getPrototypeOf(I),...I},s.getCellValidator(N)&&(D.addValidatorToQueue(),s.validateCell(E,N,function(M,A){return function(L){if(typeof L!="boolean")throw new Error("Validation error: result is not boolean");L===!1&&A.allowInvalid===!1&&(m=!1,g.splice(M,1),A.valid=!0),D.removeValidatorFormQueue()}}(C,N),w))}D.checkIfQueueIsEmpty()}function Oe(g,w){for(let T=g.length-1;T>=0;T--){let D=!1;if(g[T]===null){g.splice(T,1);continue}if(!((g[T][2]===null||g[T][2]===void 0)&&(g[T][3]===null||g[T][3]===void 0))){if(I.allowInsertRow)for(;g[T][0]>s.countRows()-1;){const{delta:m}=l.createRow(void 0,void 0,{source:"auto"});if(m===0){D=!0;break}}if(s.dataType==="array"&&(!I.columns||I.columns.length===0)&&I.allowInsertColumn)for(;l.propToCol(g[T][1])>s.countCols()-1;){const{delta:m}=l.createCol(void 0,void 0,{source:"auto"});if(m===0){D=!0;break}}D||l.set(g[T][0],g[T][1],g[T][3])}}if(g.length>0){c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",g,w),h.closeEditor(),s.view.adjustElementsSize(),s.render(),h.prepareEditor(),s.runHooks("afterChange",g,w||"edit");const T=s.getActiveEditor();T&&te(T.refreshValue)&&T.refreshValue()}else s.render()}this._createCellCoords=function(g,w){return s.view._wt.createCellCoords(g,w)},this._createCellRange=function(g,w,y){return s.view._wt.createCellRange(g,w,y)},this.validateCell=function(g,w,y,T){let D=s.getCellValidator(w);function m(C){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||w.hidden===!0){y(C);return}const x=w.visualCol,E=w.visualRow,R=s.getCell(E,x,!0);if(R&&R.nodeName!=="TH"){const N=s.rowIndexMapper.getRenderableFromVisualIndex(E),M=s.columnIndexMapper.getRenderableFromVisualIndex(x);s.view._wt.getSetting("cellRenderer",N,M,R)}y(C)}O6(D)&&(D=function(C){return function(S,x){x(C.test(S))}}(D)),ot(D)?(g=s.runHooks("beforeValidate",g,w.visualRow,w.prop,T),s._registerImmediate(()=>{D.call(w,g,C=>{s&&(C=s.runHooks("afterValidate",C,g,w.visualRow,w.prop,T),w.valid=C,m(C),s.runHooks("postAfterValidate",C,g,w.visualRow,w.prop,T))})})):s._registerImmediate(()=>{w.valid=!0,m(w.valid,!1)})};function Re(g,w,y){return Array.isArray(g)?g:[[g,w,y]]}function Ae(g,w){const y=s.runHooks("beforeChange",g,w||"edit"),T=g.filter(m=>m!==null);if(y===!1||T.length===0){var D;return(D=s.getActiveEditor())===null||D===void 0||D.cancelChanges(),[]}for(let m=T.length-1;m>=0;m--){const[C,S,,x]=T[m],E=l.propToCol(S);let R;Number.isInteger(E)?R=s.getCellMeta(C,E):R={...Object.getPrototypeOf(I),...I},T[m][3]=Uy(x,R)}return T}this.setDataAtCell=function(g,w,y,T){const D=Re(g,w,y),m=[];let C=T,S,x,E;for(S=0,x=D.length;S<x;S++){const[N,M,A]=D[S];if(typeof D[S]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof M!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");M>=this.countCols()?E=M:E=l.colToProp(M),m.push([N,E,u.getAtCell(this.toPhysicalRow(N),M),A])}!C&&typeof g=="object"&&(C=w);const R=Ae(m,C);s.runHooks("afterSetDataAtCell",R,C),xe(R,C,()=>{Oe(R,C)})},this.setDataAtRowProp=function(g,w,y,T){const D=Re(g,w,y),m=[];let C=T,S,x;for(S=0,x=D.length;S<x;S++){const[R,N,M]=D[S];m.push([R,N,u.getAtCell(this.toPhysicalRow(R),N),M])}!C&&typeof g=="object"&&(C=w);const E=Ae(m,T);s.runHooks("afterSetDataAtRowProp",E,C),xe(E,C,()=>{Oe(E,C)})},this.listen=function(){s&&!s.isListening()&&(qy.forEach(g=>{s!==g&&g.unlisten()}),Xy=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Xy=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return Xy===s.guid},this.destroyEditor=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.closeEditor(g),s.view.render(),w&&j.isSelected()&&h.prepareEditor()},this.populateFromArray=function(g,w,y,T,D,m,C){if(!(typeof y=="object"&&typeof y[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const S=typeof T=="number"?s._createCellCoords(T,D):null;return c.populateFromArray(s._createCellCoords(g,w),y,S,m,C)},this.spliceCol=function(g,w,y){for(var T=arguments.length,D=new Array(T>3?T-3:0),m=3;m<T;m++)D[m-3]=arguments[m];return l.spliceCol(g,w,y,...D)},this.spliceRow=function(g,w,y){for(var T=arguments.length,D=new Array(T>3?T-3:0),m=3;m<T;m++)D[m-3]=arguments[m];return l.spliceRow(g,w,y,...D)},this.getSelected=function(){if(j.isSelected())return tt(j.getSelectedRange(),g=>{let{from:w,to:y}=g;return[w.row,w.col,y.row,y.col]})},this.getSelectedLast=function(){const g=this.getSelected();let w;return g&&g.length>0&&(w=g[g.length-1]),w},this.getSelectedActive=function(){const g=this.getSelectedRangeActive();if(!g)return;const{from:w,to:y}=g;return[w.row,w.col,y.row,y.col]},this.getSelectedRange=function(){if(j.isSelected())return Array.from(j.getSelectedRange())},this.getSelectedRangeLast=function(){const g=this.getSelectedRange();let w;return g&&g.length>0&&(w=g[g.length-1]),w},this.getSelectedRangeActive=function(){return j.getActiveSelectedRange()},this.getActiveSelectionLayerIndex=function(){return j.getActiveSelectionLayerIndex()},this.emptySelectedCells=function(g){if(!j.isSelected()||this.countRows()===0||this.countCols()===0)return;const w=[];O(j.getSelectedRange(),y=>{if(y.isSingleHeader())return;const T=y.getTopStartCorner(),D=y.getBottomEndCorner();he(T.row,D.row,m=>{he(T.col,D.col,C=>{this.getCellMeta(m,C).readOnly||w.push([m,C,null])})})}),w.length>0&&this.setDataAtCell(w,g)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const g=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(g,0),!this.isRenderSuspended()&&g===this.renderSuspendedCounter&&s.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(g){this.suspendRender();const w=g();return this.resumeRender(),w},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const w=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(w,0),(!this.isExecutionSuspended()&&w===this.executionSuspendedCounter||g)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const y=g();return this.resumeExecution(w),y},this.batch=function(g){this.suspendRender(),this.suspendExecution();const w=g();return this.resumeExecution(),this.resumeRender(),w},this.refreshDimensions=function(){if(!s.view)return;const g=s.view,{width:w,height:y}=g.getLastSize(),{width:T,height:D}=s.rootElement.getBoundingClientRect(),m=T!==w||D!==y;s.runHooks("beforeRefreshDimensions",{width:w,height:y},{width:T,height:D},m)!==!1&&((m||g._wt.wtOverlays.scrollableElement===s.rootWindow)&&(g.setLastSize(T,D),g.adjustElementsSize(),s.render()),s.runHooks("afterRefreshDimensions",{width:w,height:y},{width:T,height:D},m))},this.updateData=function(g,w){lO(g,y=>{l=y},y=>{l=y,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols(),j.refresh()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:w,metaManager:F,firstRun:p})},this.loadData=function(g,w){lO(g,y=>{l=y},()=>{F.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),j.refresh(),p&&(p=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:w,metaManager:F,firstRun:p})},this.getInitialColumnCount=function(){const g=I.columns;let w=0;if(Array.isArray(g))w=g.length;else if(ot(g))if(s.dataType==="array"){const y=this.countSourceCols();for(let T=0;T<y;T+=1)g(T)&&(w+=1)}else(s.dataType==="object"||s.dataType==="function")&&(w=l.colToPropCache.length);else if(te(I.dataSchema)){const y=l.getSchema();w=Array.isArray(y)?y.length:R0(y)}else w=this.countSourceCols();return w},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,w,y,T){return xt(g)?l.getAll():l.getRange(s._createCellCoords(g,w),s._createCellCoords(y,T),l.DESTINATION_RENDERER)},this.getCopyableText=function(g,w,y,T){return l.getCopyableText(s._createCellCoords(g,w),s._createCellCoords(y,T))},this.getCopyableData=function(g,w){return l.getCopyable(g,l.colToProp(w))},this.getCopyableSourceData=function(g,w){return u.getCopyable(g,l.colToProp(w))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const y=(p?s.loadData:s.updateData).bind(this);let T=!1,D,m;if(te(g.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(te(g.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(te(g.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');te(g.rowHeights)&&te(g.minRowHeights)&&$e("Both `rowHeights` and `minRowHeights` are defined in your configuration. As one is the alias of the other, only one of them can be used at a time. `rowHeights` will be used as the row height configuration.");for(D in g)if(!(D==="data"||D==="language"))if(D==="className")pe("className",g.className);else if(D==="tableClassName"&&s.table)pe("tableClassName",g.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames();else if(ie.getSingleton().isRegistered(D)||ie.getSingleton().isDeprecated(D)){const R=g[D];ot(R)?(ie.getSingleton().addAsFixed(D,R,s),I[D]=R):Array.isArray(R)&&(ie.getSingleton().add(D,R,s),I[D]=R)}else!w&&nn(g,D)&&(W[D]=g[D]);if(w)s.useTheme(I.themeName||yO(s.rootContainer));else{const R=s.getCurrentThemeName();nn(g,"themeName")&&R!==g.themeName&&s.useTheme(g.themeName)}Rm.has(s)&&s.stylesHandler.getThemeName()!==void 0&&Rm.delete(s),Uo(s)&&!Rm.has(s)&&s.stylesHandler.isClassicTheme()&&(l$("The stylesheet you are using is deprecated and will be removed in version 17.0. Please update your theme configuration to ensure compatibility with future releases."),Rm.add(s)),g.data===void 0&&I.data===void 0?y(null,"updateSettings"):g.data!==void 0?y(g.data,"updateSettings"):g.columns!==void 0&&(l.createMap(),s.initIndexMappers()),!p&&g.language&&re(g.language);const C=s.countCols(),S=I.columns;if(S&&ot(S)&&(T=!0),(g.cell!==void 0||g.cells!==void 0||g.columns!==void 0)&&F.clearCache(),C>0)for(D=0,m=0;D<C;D++){if(S){const R=T?S(D):S[m];R&&F.updateColumnMeta(m,R)}m+=1}te(g.cell)&&We(g.cell,R=>{s.setCellMetaObject(R.row,R.col,R)}),s.runHooks("afterCellMetaReset");let x=s.rootElement.style.height;x!==""&&(x=parseInt(s.rootElement.style.height,10)),w&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style"));let E=g.height;if(typeof g.height<"u")if(ot(E)&&(E=E()),E=s.runHooks("beforeHeightChange",E),E===null){const R=s.rootElement.getAttribute("data-initialstyle");R&&(R.indexOf("height")>-1||R.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",R):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else E!==void 0&&(s.rootElement.style.height=isNaN(E)?`${E}`:`${E}px`,s.rootElement.style.overflow="hidden");if(typeof g.width<"u"){let R=g.width;ot(R)&&(R=R()),R=s.runHooks("beforeWidthChange",R),s.rootElement.style.width=isNaN(R)?`${R}`:`${R}px`}w||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",g)),c.adjustRowsAndCols(),s.view&&!p&&(s.render(),s.view._wt.wtOverlays.adjustElementsSize()),!w&&s.view&&(x===""||E===""||E===void 0)&&x!==E&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const g=s.getSelectedRangeActive();if(I.getValue){if(ot(I.getValue))return I.getValue.call(s);if(g)return s.getData()[g.highlight.row][I.getValue]}else if(g)return s.getDataAtCell(g.highlight.row,g.highlight.col);return null},this.getSettings=function(){return I},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,w,y,T,D){c.alter(g,w,y,T,D)},this.getCell=function(g,w){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,T=w,D=g;if(w>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(w)))return null;T=this.columnIndexMapper.getRenderableFromVisualIndex(w)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;D=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return D===null||T===null||D===void 0||T===void 0?null:s.view.getCellAtCoords(s._createCellCoords(D,T),y)},this.getCoords=function(g){const w=this.view._wt.wtTable.getCoords(g);if(w===null)return null;const{row:y,col:T}=w;let D=y,m=T;return y>=0&&(D=this.rowIndexMapper.getVisualFromRenderableIndex(y)),T>=0&&(m=this.columnIndexMapper.getVisualFromRenderableIndex(T)),s._createCellCoords(D,m)},this.colToProp=function(g){return l.colToProp(g)},this.propToCol=function(g){return l.propToCol(g)},this.toVisualRow=g=>this.rowIndexMapper.getVisualFromPhysicalIndex(g),this.toVisualColumn=g=>this.columnIndexMapper.getVisualFromPhysicalIndex(g),this.toPhysicalRow=g=>this.rowIndexMapper.getPhysicalFromVisualIndex(g),this.toPhysicalColumn=g=>this.columnIndexMapper.getPhysicalFromVisualIndex(g),this.getDataAtCell=function(g,w){return l.get(g,l.colToProp(w))},this.getDataAtRowProp=function(g,w){return l.get(g,w)},this.getDataAtCol=function(g){const w=[],y=l.getRange(s._createCellCoords(0,g),s._createCellCoords(I.data.length-1,g),l.DESTINATION_RENDERER);for(let T=0;T<y.length;T+=1)for(let D=0;D<y[T].length;D+=1)w.push(y[T][D]);return w},this.getDataAtProp=function(g){const w=[],y=l.getRange(s._createCellCoords(0,l.propToCol(g)),s._createCellCoords(I.data.length-1,l.propToCol(g)),l.DESTINATION_RENDERER);for(let T=0;T<y.length;T+=1)for(let D=0;D<y[T].length;D+=1)w.push(y[T][D]);return w},this.getSourceData=function(g,w,y,T){let D;return g===void 0?D=u.getData():D=u.getByRange(s._createCellCoords(g,w),s._createCellCoords(y,T)),D},this.getSourceDataArray=function(g,w,y,T){let D;return g===void 0?D=u.getData(!0):D=u.getByRange(s._createCellCoords(g,w),s._createCellCoords(y,T),!0),D},this.getSourceDataAtCol=function(g){return u.getAtColumn(g)},this.setSourceDataAtCell=function(g,w,y,T){const D=Re(g,w,y),m=this.hasHook("afterSetSourceDataAtCell"),C=[],S=(E,R)=>{const N=this.toVisualRow(E),M=this.toVisualColumn(R);return Number.isInteger(M)?this.getCellMeta(N,M):{...Object.getPrototypeOf(I),...I}};m&&O(D,E=>{let[R,N,M]=E;const A=Uy(M,S(R,N));C.push([R,N,u.getAtCell(R,N),A])}),O(D,E=>{let[R,N,M]=E;const A=Uy(M,S(R,N));u.setAtCell(R,N,A)}),m&&this.runHooks("afterSetSourceDataAtCell",C,T),this.render();const x=s.getActiveEditor();x&&te(x.refreshValue)&&x.refreshValue()},this.getSourceDataAtRow=function(g){return u.getAtRow(g)},this.getSourceDataAtCell=function(g,w){return u.getAtCell(g,w)},this.getDataAtRow=function(g){return l.getRange(s._createCellCoords(g,0),s._createCellCoords(g,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(g,w,y,T){const D=g===void 0?[0,0,this.countRows(),this.countCols()]:[g,w,y,T],[m,C]=D;let[,,S,x]=D,E=null,R=null;S===void 0&&(S=m),x===void 0&&(x=C);let N="mixed";return he(Math.max(Math.min(m,S),0),Math.max(m,S),M=>{let A=!0;return he(Math.max(Math.min(C,x),0),Math.max(C,x),L=>(R=this.getCellMeta(M,L).type,E?A=E===R:E=R,A)),N=A?R:"mixed",A}),N},this.removeCellMeta=function(g,w,y){const[T,D]=[this.toPhysicalRow(g),this.toPhysicalColumn(w)];let m=F.getCellMetaKeyValue(T,D,y);s.runHooks("beforeRemoveCellMeta",g,w,y,m)!==!1&&(F.removeCellMeta(T,D,y),s.runHooks("afterRemoveCellMeta",g,w,y,m)),m=null},this.spliceCellsMeta=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var y=arguments.length,T=new Array(y>2?y-2:0),D=2;D<y;D++)T[D-2]=arguments[D];if(T.length>0&&!Array.isArray(T[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");w>0&&F.removeRow(this.toPhysicalRow(g),w),T.length>0&&O(T.reverse(),m=>{F.createRow(this.toPhysicalRow(g)),O(m,(C,S)=>this.setCellMetaObject(g,S,C))}),s.render()},this.setCellMetaObject=function(g,w,y){typeof y=="object"&&We(y,(T,D)=>{this.setCellMeta(g,w,D,T)})},this.setCellMeta=function(g,w,y,T){if(s.runHooks("beforeSetCellMeta",g,w,y,T)===!1)return;let m=g,C=w;g<this.countRows()&&(m=this.toPhysicalRow(g)),w<this.countCols()&&(C=this.toPhysicalColumn(w)),F.setCellMeta(m,C,y,T),s.runHooks("afterSetCellMeta",g,w,y,T)},this.getCellsMeta=function(){return F.getCellsMeta()},this.getCellMeta=function(g,w){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},T=this.toPhysicalRow(g),D=this.toPhysicalColumn(w);return T===null&&(T=g),D===null&&(D=w),F.getCellMeta(T,D,{visualRow:g,visualColumn:w,...y})},this.getColumnMeta=function(g){return F.getColumnMeta(this.toPhysicalColumn(g))},this.getCellMetaAtRow=function(g){return F.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||I.columns)},this.getCellRenderer=function(g,w){const y=typeof g=="number"?s.getCellMeta(g,w).renderer:g.renderer;return typeof y=="string"?OR(y):xt(y)?OR("text"):y},this.getCellEditor=function(g,w){const y=typeof g=="number"?s.getCellMeta(g,w).editor:g.editor;return typeof y=="string"?MR(y):xt(y)?MR("text"):y},this.getCellValidator=function(g,w){const y=typeof g=="number"?s.getCellMeta(g,w).validator:g.validator;return typeof y=="string"?t8(y):y},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,w){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(w,g)},this.validateColumns=function(g,w){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(w,void 0,g)},this._validateCells=function(g,w,y){const T=new Xe;g&&(T.onQueueEmpty=g);let D=s.countRows()-1;for(;D>=0;){if(w!==void 0&&w.indexOf(D)===-1){D-=1;continue}let m=s.countCols()-1;for(;m>=0;){if(y!==void 0&&y.indexOf(m)===-1){m-=1;continue}T.addValidatorToQueue(),s.validateCell(s.getDataAtCell(D,m),s.getCellMeta(D,m),C=>{if(typeof C!="boolean")throw new Error("Validation error: result is not boolean");C===!1&&(T.valid=!1),T.removeValidatorFormQueue()},"validateCells"),m-=1}D-=1}T.checkIfQueueIsEmpty()},this.getRowHeader=function(g){let w=I.rowHeaders,y=g;return y!==void 0&&(y=s.runHooks("modifyRowHeader",y)),y===void 0?(w=[],he(s.countRows()-1,T=>{w.push(s.getRowHeader(T))})):Array.isArray(w)&&w[y]!==void 0?w=w[y]:ot(w)?w=w(y):w&&typeof w!="string"&&typeof w!="number"&&(w=y+1),w},this.hasRowHeaders=function(){return!!I.rowHeaders},this.hasColHeaders=function(){if(I.colHeaders!==void 0&&I.colHeaders!==null)return!!I.colHeaders;for(let g=0,w=s.countCols();g<w;g++)if(s.getColHeader(g))return!0;return!1},this.getColHeader=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const y=s.runHooks("modifyColHeader",g);if(y===void 0){const S=[],x=s.countCols();for(let E=0;E<x;E++)S.push(s.getColHeader(E));return S}let T=I.colHeaders;const D=function(S){const x=[],E=s.countCols();let R=0;for(;R<E;R++)ot(I.columns)&&I.columns(R)&&x.push(R);return x[S]},m=s.toPhysicalColumn(y),C=D(m);return I.colHeaders===!1?T=null:I.columns&&ot(I.columns)&&I.columns(C)&&I.columns(C).title?T=I.columns(C).title:I.columns&&I.columns[m]&&I.columns[m].title?T=I.columns[m].title:Array.isArray(I.colHeaders)&&I.colHeaders[m]!==void 0?T=I.colHeaders[m]:ot(I.colHeaders)?T=I.colHeaders(m):I.colHeaders&&typeof I.colHeaders!="string"&&typeof I.colHeaders!="number"&&(T=xQ(y)),T=s.runHooks("modifyColumnHeaderValue",T,g,w),T},this._getColWidthFromSettings=function(g){let w;if(g>=0&&(w=s.getCellMeta(0,g).width),(w===void 0||w===I.width)&&(w=I.colWidths),w!=null){switch(typeof w){case"object":w=w[g];break;case"function":w=w(g);break}typeof w=="string"&&(w=Number.parseInt(w,10))}return w},this.getColWidth=function(g,w){let y=s._getColWidthFromSettings(g);return y=s.runHooks("modifyColWidth",y,g,w),y===void 0&&(y=Rh),y},this._getRowHeightFromSettings=function(g){var w;const y=s.stylesHandler.getDefaultRowHeight(g);let T=(w=I.rowHeights)!==null&&w!==void 0?w:I.minRowHeights;if(T!=null){switch(typeof T){case"object":T=T[g];break;case"function":T=T(g);break}typeof T=="string"&&(T=Number.parseInt(T,10))}return T!=null&&T<y?y:T},this.getRowHeight=function(g,w){let y=s._getRowHeightFromSettings(g);return y=s.runHooks("modifyRowHeight",y,g,w),y},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const g=I.maxCols,w=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,w)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return gx(s.countRows()-1,y=>{if(s.isEmptyRow(y))w+=1;else if(g===!0)return!1}),w},this.countEmptyCols=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=0;return gx(s.countCols()-1,y=>{if(s.isEmptyCol(y))w+=1;else if(g===!0)return!1}),w},this.isEmptyRow=function(g){return I.isEmptyRow.call(s,g)},this.isEmptyCol=function(g){return I.isEmptyCol.call(s,g)},this.selectCell=function(g,w,y,T){let D=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,m=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return xt(g)||xt(w)?!1:this.selectCells([[g,w,y,T]],D,m)},this.selectCells=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;w===!1&&f.suspend();const T=j.selectCells(g);return T&&y&&s.listen(),f.resume(),T},this.selectColumns=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,y=arguments.length>2?arguments[2]:void 0;return j.selectColumns(g,w,y)},this.selectRows=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,y=arguments.length>2?arguments[2]:void 0;return j.selectRows(g,w,y)},this.deselectCell=function(){j.deselect()},this.selectAll=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,y=arguments.length>2?arguments[2]:void 0;f.skipNextScrollCycle(),j.selectAll(g,w,y)};const Ze=(g,w)=>g.getNearestNotHiddenIndex(w,1,!0);this.scrollViewportTo=function(g,w){if(typeof g=="number"){var y;g={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(y=arguments[4])!==null&&y!==void 0?y:!0}}const{row:T,col:D,considerHiddenIndexes:m}=g??{};let C=T,S=D;if(ot(w)&&this.addHookOnce("afterScroll",w),m===void 0||m){const N=Number.isInteger(T)&&T>=0,M=Number.isInteger(D)&&D>=0,A=N?Ze(this.rowIndexMapper,T):void 0,L=M?Ze(this.columnIndexMapper,D):void 0;if(A===null||L===null)return!1;C=N?s.rowIndexMapper.getRenderableFromVisualIndex(A):T,S=M?s.columnIndexMapper.getRenderableFromVisualIndex(L):D}const x=Number.isInteger(C),E=Number.isInteger(S);let R=!1;return x&&C>=0&&E&&S>=0?R=s.view.scrollViewport(s._createCellCoords(C,S),g.horizontalSnap,g.verticalSnap):x&&C>=0&&(E&&S<0||!E)?R=s.view.scrollViewportVertically(C,g.verticalSnap):E&&S>=0&&(x&&C<0||!x)&&(R=s.view.scrollViewportHorizontally(S,g.horizontalSnap)),ot(w)&&(R?this.view.render():(this.removeHook("afterScroll",w),this._registerMicrotask(()=>w()))),R},this.scrollToFocusedCell=function(g){if(!this.selection.isSelected())return!1;ot(g)&&this.addHookOnce("afterScroll",g);const{highlight:w}=this.getSelectedRangeActive(),y=this.scrollViewportTo(w.toObject());return y?this.view.render():ot(g)&&(this.removeHook("afterScroll",g),this._registerMicrotask(()=>g())),y},this.destroy=function(){s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,Uo(this)&&(bie(),this.getFocusScopeManager().destroy()),this.getShortcutManager().destroy(),$.clear(),F.clearCache(),qy.delete(this.guid),a.destroy(),h&&h.destroy(),s.rootContainer&&ea(s.rootContainer),s.rootPortalElement&&s.rootPortalElement.remove(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),k.getItems().forEach(g=>{let[,w]=g;w.destroy()}),k.clear(),s.runHooks("afterDestroy")},!0),ie.getSingleton().destroy(s),We(s,(g,w,y)=>{ot(g)?y[w]=gt(w):w!=="guid"&&(y[w]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,j=null,h=null,s=null};function gt(g){return()=>{throw new Error(`The "${g}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(g){return k.getItem(mo(g))},this.getPluginName=function(g){return g===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:k.getId(g)},this.getInstance=function(){return s},this.addHook=function(g,w,y){ie.getSingleton().add(g,w,s,y)},this.hasHook=function(g){return ie.getSingleton().has(g,s)||ie.getSingleton().has(g)},this.addHookOnce=function(g,w,y){ie.getSingleton().once(g,w,s,y)},this.removeHook=function(g,w){ie.getSingleton().remove(g,w,s)},this.runHooks=function(g,w,y,T,D,m,C){return ie.getSingleton().run(s,g,w,y,T,D,m,C)},this.getTranslatedPhrase=function(g,w){return tk(I.language,g,w)},this.toHTML=()=>hx(this),this.toTableElement=()=>{const g=this.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",hx(this)),g.firstElementChild},this.timeouts=[],this.useTheme=g=>{const w=!!p;this.stylesHandler.useTheme(g);const y=this.stylesHandler.getThemeName();w||(s.render(),s.scrollViewportTo(0,0),yO(this.rootContainer)&&(ae(this.rootContainer,/ht-theme-.*/g),y&&B(this.rootContainer,y))),this.runHooks("afterSetTheme",y,w)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,y=g;typeof y=="function"&&(y=setTimeout(y,w)),this.timeouts.push(y)},this._clearTimeouts=function(){O(this.timeouts,g=>{clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(setImmediate(g))},this._clearImmediates=function(){O(this.immediates,g=>{clearImmediate(g)})},this._registerMicrotask=function(g){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||g()})},this._getEditorManager=function(){return h};const ke=fie({handleEvent(){return s.isListening()},beforeKeyDown:g=>this.runHooks("beforeKeyDown",g),afterKeyDown:g=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",g)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",g=>{g.ctrlKey===!1&&g.metaKey===!1&&ke.releasePressedKeys()}),this.getShortcutManager=function(){return ke},d=new ene(s);const G=Uo(this)?Jte(s):null;this.getFocusManager=function(){return d},this.getFocusScopeManager=function(){if(!Uo(s))throw new Error("The FocusScopeManager is only available for the main Handsontable instance.");return G},w$().forEach(g=>{const w=H0(g);k.addItem(g,new w(this))}),oie(s),Uo(this)&&aie(s),ke.setActiveContextName("grid"),ie.getSingleton().run(s,"construct")}function SO(t,e,n){t.addEventListener(e,n,!1)}function RO(t,e,n){t.removeEventListener(e,n,!1)}function Em(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function wk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},i=t.body,r=t.createTextNode(""),o=t.createElement("span");let s;function a(){var h,d;r.textContent=n.textContent(s),o.style.position="absolute",o.style.fontSize=Em(s).fontSize,o.style.fontFamily=Em(s).fontFamily,o.style.whiteSpace="pre",i.appendChild(o);const f=parseInt(((h=Em(s))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),p=parseInt(((d=Em(s))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),v=o.clientWidth+f+p+1;i.removeChild(o);const b=s.style;b.height=`${n.minHeight}px`,n.minWidth>v?b.width=`${n.minWidth}px`:v>n.maxWidth?b.width=`${n.maxWidth}px`:b.width=`${v}px`;const P=s.scrollHeight?s.scrollHeight-1:0;n.minHeight>P?b.height=`${n.minHeight}px`:n.maxHeight<P?(b.height=`${n.maxHeight}px`,b.overflowY="visible"):b.height=`${P}px`}function l(){t.defaultView.setTimeout(a,0)}function u(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=s.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=s.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=s.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=s.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(r))}function c(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=h,u(d),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${n.minHeight}px`,s.style.minWidth=`${n.minWidth}px`,s.style.maxWidth=`${n.maxWidth}px`,s.style.overflowY="hidden"),f&&(SO(s,"input",a),SO(s,"keydown",l)),a()}return{init:c,resize:a,unObserve(){RO(s,"input",a),RO(s,"keydown",l)}}}function EO(t,e){const n=QD(e),i=e.value.split(`
`);let r=n,o=0;for(let s=0;s<i.length;s++){const a=i[s];s!==0&&(o+=i[s-1].length+1);const l=o+a.length;if(t==="home"?r=o:t==="end"&&(r=l),n<=l)break}Bv(e,r)}function bl(t,e,n){return(e=Rie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rie(t){var e=Eie(t,"string");return typeof e=="symbol"?e:e+""}function Eie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Tie="ht_editor_visible",Tm="ht_editor_hidden",TO="textEditor",_ie="text";class Ku extends Uh{static get EDITOR_TYPE(){return _ie}constructor(e){super(e),bl(this,"eventManager",new wo(this)),bl(this,"autoResize",wk(this.hot.rootDocument)),bl(this,"TEXTAREA",void 0),bl(this,"textareaStyle",void 0),bl(this,"TEXTAREA_PARENT",void 0),bl(this,"textareaParentStyle",void 0),bl(this,"layerClass",void 0),this.eventManager=new wo(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),Vp(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,i,r,o,s){const a=this.state;if(super.prepare(e,n,i,r,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Qt.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===Qt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),Bv(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),le(this.TEXTAREA,[["data-hot-input",""],po(-1)]),B(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),B(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ce(this.TEXTAREA_PARENT,this.layerClass)&&ae(this.TEXTAREA_PARENT,this.layerClass),B(this.TEXTAREA_PARENT,Tm),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){U9()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",ae(this.TEXTAREA_PARENT,this.layerClass),B(this.TEXTAREA_PARENT,Tm)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;he(e.length-1,i=>{const r=e[i];if(Ce(r,"handsontableEditor"))return n=!0,!1}),Ce(this.TEXTAREA_PARENT,Tm)&&ae(this.TEXTAREA_PARENT,Tm),n?(this.layerClass=Tie,B(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),B(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Qt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:i,width:r,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${i}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(r,o),minHeight:Math.min(s,a),maxWidth:o,maxHeight:a},!0)}bindEvents(){YD()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Qt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Qt.EDITING&&this.focus()})}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),i={runOnlyIf:()=>te(this.hot.getSelected()),group:TO},r=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(r(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(r(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(r(),!1)},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;EO(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;EO(a,this.TEXTAREA)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(TO)}}const Mie="base",Pie="htTextEllipsis";function Sg(t,e,n,i,r,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&B(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(BI())):a&&c.push(BI()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(jI())):(u.push(s.invalidCellClassName),a&&c.push(jI()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),s.textEllipsis&&l.push(Pie),ae(e,u),B(e,l),Zs(e,c),le(e,h)}Sg.RENDERER_TYPE=Mie;const Iie="text";function ua(t,e,n,i,r,o,s){Sg.apply(this,[t,e,n,i,r,o,s]);let a=o;!a&&s.placeholder&&(a=s.placeholder),a=Tt(a),s.trimWhitespace&&(a=a.trim()),Mu(e,a)}ua.RENDERER_TYPE=Iie;const xie="text",vk={CELL_TYPE:xie,editor:Ku,renderer:ua};qr(vk);Ke.editors={BaseEditor:Uh};function Ke(t,e){const n=new pk(t,e||{},X0);return n.init(),n}Ke.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new pk(t,e,X0)};Ke.DefaultSettings=ak();Ke.hooks=ie.getSingleton();Ke.CellCoords=xu;Ke.CellRange=Vh;Ke.packageName="handsontable";Ke.buildDate="20/11/2025 13:26:54";Ke.version="16.2.0";Ke.languages={dictionaryKeys:pee,getLanguageDictionary:ek,getLanguagesDictionaries:bee,registerLanguageDictionary:Q$,getTranslatedPhrase:tk};function BR(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function Oie(t){if(Array.isArray(t))return BR(t)}function Aie(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zf(t,e,n){return e=Nw(e),Fie(t,Ck()?Reflect.construct(e,n||[],Nw(t).constructor):e.apply(t,n))}function _h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _O(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,yk(i.key),i)}}function Mh(t,e,n){return e&&_O(t.prototype,e),n&&_O(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Hie(t,e,n){return(e=yk(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nw(t){return Nw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Nw(t)}function Yf(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jR(t,e)}function Ck(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ck=function(){return!!t})()}function Nie(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Die(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MO(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function $ie(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?MO(Object(n),!0).forEach(function(i){Hie(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):MO(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function kie(t,e){if(t==null)return{};var n,i,r=Lie(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Lie(t,e){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.indexOf(i)!==-1)continue;n[i]=t[i]}return n}function Fie(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Aie(t)}function jR(t,e){return jR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},jR(t,e)}function Vie(t){return Oie(t)||Nie(t)||Bie(t)||Die()}function Wie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function yk(t){var e=Wie(t,"string");return typeof e=="symbol"?e:e+""}function Bie(t,e){if(t){if(typeof t=="string")return BR(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?BR(t,e):void 0}}var Zy=null,jie="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",Uie="The Handsontable instance bound to this component was destroyed and cannot be used properly.",Dw="global",zie="hot-wrapper-editor-container";function Yie(){if(typeof console<"u"){var t;(t=console).warn.apply(t,arguments)}}function UR(t,e){var n=Ut.Children.toArray(t),i=Ut.Children.count(t),r=null;return i!==0&&(i===1&&n[0].props[e]?r=n[0]:r=n.find(function(o){return o.props[e]!==void 0})),r||null}function bk(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function Sk(t,e){if(typeof t>"u"||e===null)return null;var n=Ek(e.props,!1);return n.className="".concat(zie," ").concat(n.className),rH.createPortal(Ut.createElement("div",Object.assign({},n),e),t.body)}function Rk(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Dw,i=UR(t,"hot-editor"),r=bk(i);return i?Ut.cloneElement(i,{emitEditorInstance:function(s,a){e.get(r)||e.set(r,new Map);var l=e.get(r);l.set(a??Dw,s)},editorColumnScope:n,isEditor:!0}):null}function Gie(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;n||(n=document),Zy||(Zy=n.createDocumentFragment());var o=r??n.createElement("DIV");Zy.appendChild(o);var s=Ut.cloneElement(t,$ie({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:rH.createPortal(s,o,i),portalContainer:o}}function Ek(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}function Kie(){return typeof window<"u"}var Tk=function(){function t(){_h(this,t)}return Mh(t,null,[{key:"getSettings",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=i.prevProps,o=r===void 0?{}:r,s=i.isInit,a=s===void 0?!1:s,l=i.initOnlySettingKeys,u=l===void 0?[]:l,c=function(b){return!a&&u.includes(b)?o[b]===n[b]:!1},h={};if(n.settings){var d=n.settings;for(var f in d)d.hasOwnProperty(f)&&!c(f)&&(h[f]=d[f])}for(var p in n)p!=="settings"&&p!=="children"&&!c(p)&&n.hasOwnProperty(p)&&(h[p]=n[p]);return h}}])}(),Xie=function(t){function e(){return _h(this,e),zf(this,e,arguments)}return Yf(e,t),Mh(e,[{key:"getSettingsProps",value:function(){var i=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(r){return!i.internalProps.includes(r)}).reduce(function(r,o){return r[o]=i.props[o],r},{})}},{key:"getLocalEditorElement",value:function(){return Rk(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var i=this.props._getChildElementByType(this.props.children,"hot-renderer"),r=this.getLocalEditorElement();this.columnSettings=Tk.getSettings(this.getSettingsProps()),i!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(i),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),r!==null&&(this.columnSettings.editor=this.props._getEditorClass(r,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var i=this.props._getOwnerDocument(),r=Sk(i,this.getLocalEditorElement());return Ut.createElement(Ut.Fragment,null,r)}}])}(Ut.Component),qie=function(t){function e(){var n;return _h(this,e),n=zf(this,e,arguments),n.state={portals:[]},n}return Yf(e,t),Mh(e,[{key:"render",value:function(){return Ut.createElement(Ut.Fragment,null,this.state.portals)}}])}(Ut.Component),Zie="16.2.0";function Jie(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var _k={exports:{}},Jy,PO;function Qie(){if(PO)return Jy;PO=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Jy=t,Jy}var Qy,IO;function ere(){if(IO)return Qy;IO=1;var t=Qie();function e(){}function n(){}return n.resetWarningCache=e,Qy=function(){function r(a,l,u,c,h,d){if(d!==t){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}r.isRequired=r;function o(){return r}var s={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:o,element:r,elementType:r,instanceOf:o,node:r,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:n,resetWarningCache:e};return s.PropTypes=s,s},Qy}_k.exports=ere()();var tre=_k.exports,eb=Jie(tre),Y_=function(t){function e(){var n;return _h(this,e),n=zf(this,e,arguments),n.id=null,n.__hotInstance=null,n.hotElementRef=null,n.columnSettings=[],n.renderersPortalManager=null,n.portalCache=new Map,n.portalContainerCache=new Map,n.renderedCellCache=new Map,n.editorCache=new Map,n.componentRendererColumns=new Map,n}return Yf(e,t),Mh(e,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(Uie),null)},set:function(i){this.__hotInstance=i}},{key:"_isHotInstanceDestroyed",value:function(){return this.__hotInstance&&this.__hotInstance.isDestroyed}},{key:"getPortalContainerCache",value:function(){return this.portalContainerCache}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return Kie()?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(i){this.hotElementRef=i}},{key:"getRendererWrapper",value:function(i){var r=this;return function(s,a,l,u,c,h,d){var f=r.getRenderedCellCache(),p=r.getPortalContainerCache(),v="".concat(l,"-").concat(u),b=s.guid,P="".concat(b,"-").concat(v),_="".concat(v,"-").concat(b);if(f.has(v)&&(a.innerHTML=f.get(v).innerHTML),a&&!a.getAttribute("ghost-table")){for(var F=r.portalCache.get(_),I=p.get(P);a.firstChild;)a.removeChild(a.firstChild);if(F&&I)a.appendChild(I);else{var W=Gie(i,{TD:a,row:l,col:u,prop:c,value:h,cellProperties:d,isRenderer:!0},a.ownerDocument,_,I),k=W.portal,$=W.portalContainer;p.set(P,$),a.appendChild($),r.portalCache.set(_,k)}}return f.set(v,a),a}}},{key:"getEditorClass",value:function(i){var r,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Dw,s=bk(i),a=(r=this.getEditorCache().get(s))===null||r===void 0?void 0:r.get(o);return this.makeEditorClass(a)}},{key:"makeEditorClass",value:function(i){var r=function(o){function s(a){var l;return _h(this,s),l=zf(this,s,[a]),i.hotCustomEditorInstance=l,l.editorComponent=i,l}return Yf(s,o),Mh(s,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(Ke.editors.BaseEditor);return Object.getOwnPropertyNames(Ke.editors.BaseEditor.prototype).forEach(function(o){o!=="constructor"&&(r.prototype[o]=function(){for(var s,a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return(s=i[o]).call.apply(s,[i].concat(l))})}),r}},{key:"getGlobalRendererElement",value:function(){return UR(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return Rk(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var i,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=this._isHotInstanceDestroyed()?[]:((i=this.hotInstance)===null||i===void 0||(i=i.getSettings())===null||i===void 0?void 0:i._initOnlySettings)||[],a=Tk.getSettings(this.props,{prevProps:o,isInit:r,initOnlySettingKeys:s}),l=this.getGlobalRendererElement(),u=this.getGlobalEditorElement();if(this.columnSettings.length&&(a.columns=this.columnSettings),u)a.editor=this.getEditorClass(u,Dw);else{var c;this.props.editor||(c=this.props.settings)!==null&&c!==void 0&&c.editor?a.editor=this.props.editor||this.props.settings.editor:a.editor=MR("text")}if(l)a.renderer=this.getRendererWrapper(l),this.componentRendererColumns.set("global",!0);else{var h;this.props.renderer||(h=this.props.settings)!==null&&h!==void 0&&h.renderer?a.renderer=this.props.renderer||this.props.settings.renderer:a.renderer=OR("text")}return a}},{key:"displayAutoSizeWarning",value:function(i){var r,o;this.hotInstance&&((r=this.hotInstance.getPlugin("autoRowSize"))!==null&&r!==void 0&&r.enabled||(o=this.hotInstance.getPlugin("autoColumnSize"))!==null&&o!==void 0&&o.enabled)&&this.componentRendererColumns.size>0&&Yie(jie)}},{key:"setHotColumnSettings",value:function(i,r){this.columnSettings[r]=i}},{key:"handsontableBeforeViewRender",value:function(){this.portalCache.clear(),this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){this.renderersPortalManager.setState({portals:Vie(this.portalCache.values())})}},{key:"updateHot",value:function(i){this.hotInstance&&this.hotInstance.updateSettings(i,!1)}},{key:"setRenderersPortalManagerRef",value:function(i){this.renderersPortalManager=i}},{key:"componentDidMount",value:function(){var i=this,r=this.createNewGlobalSettings(!0);this.hotInstance=new Ke.Core(this.hotElementRef,r),this.hotInstance.addHook("beforeViewRender",function(){return i.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return i.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(r)}},{key:"componentDidUpdate",value:function(i){this.clearCache();var r=this.createNewGlobalSettings(!1,i);this.updateHot(r),this.displayAutoSizeWarning(r)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var i=this,r=function(c){return c.type===Xie},o=Ut.Children.toArray(this.props.children),s=o.filter(function(u){return r(u)}).map(function(u,c){return Ut.cloneElement(u,{_componentRendererColumns:i.componentRendererColumns,_emitColumnSettings:i.setHotColumnSettings.bind(i),_columnIndex:c,_getChildElementByType:UR.bind(i),_getRendererWrapper:i.getRendererWrapper.bind(i),_getEditorClass:i.getEditorClass.bind(i),_getOwnerDocument:i.getOwnerDocument.bind(i),_getEditorCache:i.getEditorCache.bind(i),children:u.props.children})}),a=Ek(this.props),l=Sk(this.getOwnerDocument(),this.getGlobalEditorElement());return Ut.createElement(Ut.Fragment,null,Ut.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},a),s),Ut.createElement(qie,{ref:this.setRenderersPortalManagerRef.bind(this)}),l)}}],[{key:"version",get:function(){return Zie}}])}(Ut.Component);Y_.propTypes={style:eb.object,id:eb.string,className:eb.string};var nre=["children"],Mk=Ut.forwardRef(function(t,e){var n,i=t.children,r=kie(t,nre),o=typeof Ut.useId=="function"?Ut.useId():void 0,s=(n=r.id)!==null&&n!==void 0?n:o;return Ut.createElement(Y_,Object.assign({id:s},r,{ref:e}),i)});Mk.version=Y_.version;Ut.Component;function xO(t,e,n){return(e=ire(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ire(t){var e=rre(t,"string");return typeof e=="symbol"?e:e+""}function rre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const OO="handsontableEditor",ore="handsontable";class G_ extends Ku{constructor(){super(...arguments),xO(this,"isFlippedVertically",!1),xO(this,"isFlippedHorizontally",!1)}static get EDITOR_TYPE(){return ore}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Bv(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getTargetDropdownWidth(),height:this.getTargetDropdownHeight()}),this.refreshDimensions(),this.flipDropdownVerticallyIfNeeded(),this.flipDropdownHorizontallyIfNeeded()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&bn(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const i=this.hot.getSettings().onBeginEditing;i&&i()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedActive()){const r=this.htEditor.getValue();r!==void 0&&this.setValue(r)}super.finishEditing(e,n,i)}flipDropdownVerticallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let i=n.top;if(e.isVerticallyScrollableByWindow()){const a=e.getTableOffset().top-this.hot.rootWindow.scrollY;i=Math.max(i+a,0)}const r=this.getDropdownHeight(),o=e.getWorkspaceHeight()-i-n.height,s=r>o&&i>o+n.height;return s?this.flipDropdownVertically():this.unflipDropdownVertically(),{isFlipped:s,spaceAbove:i,spaceBelow:o}}flipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=`${-this.getDropdownHeight()}px`,this.isFlippedVertically=!0}unflipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.isFlippedVertically=!1}flipDropdownHorizontallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let i=n.start+n.width;if(e.isHorizontallyScrollableByWindow()){const a=e.getTableOffset().left-this.hot.rootWindow.scrollX;i=Math.max(i+a,0)}const r=this.getDropdownWidth(),o=e.getWorkspaceWidth()-i+n.width,s=r>o&&i>o;return s?this.flipDropdownHorizontally():this.unflipDropdownHorizontally(),{isFlipped:s,spaceInlineStart:i,spaceInlineEnd:o}}flipDropdownHorizontally(){const e=this.htEditor.rootElement.style,{width:n}=this.getEditedCellRect();e.position="absolute",e[this.hot.isRtl()?"right":"left"]=`${-(this.getDropdownWidth()-n)}px`,this.isFlippedHorizontally=!0}unflipDropdownHorizontally(){const e=this.htEditor.rootElement.style;e.position="absolute",e[this.hot.isRtl()?"right":"left"]="",this.isFlippedHorizontally=!1}getDropdownHeight(){return this.htEditor.getTableHeight()}getDropdownWidth(){return this.htEditor.getTableWidth()}getTargetDropdownWidth(){return this.htEditor.view.getTableWidth()}getTargetDropdownHeight(){return this.htEditor.view.getTableHeight()+1}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const i={group:OO,relativeToGroup:ul,position:"before"},r=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||this.isFlippedVertically&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),$r(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedActive()&&this.isFlippedVertically?a=s.countRows()-1:s.getSelectedActive()&&(this.isFlippedVertically?(l=s.getSelectedActive()[0],a=Math.max(0,l-1)):(l=s.getSelectedActive()[0],a=l-1)),r(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedActive()&&!this.isFlippedVertically)a=0;else if(s.getSelectedActive()){if(this.isFlippedVertically)a=s.getSelectedActive()[0]+1;else if(!this.isFlippedVertically){const u=s.countRows()-1;l=s.getSelectedActive()[0],a=Math.min(u,l+1)}}return r(a,o)},preventDefault:!1}],i)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(OO)}}function sre(t,e){Pk(t,e),e.add(t)}function AO(t,e,n){Pk(t,e),e.set(t,n)}function Pk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tb(t,e,n){return(e=are(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function are(t){var e=lre(t,"string");return typeof e=="symbol"?e:e+""}function lre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nb(t,e){return t.get($a(t,e))}function $a(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ure="autocomplete";var ib=new WeakMap,HO=new WeakMap,wa=new WeakSet;class K_ extends G_{constructor(){super(...arguments),sre(this,wa),tb(this,"query",null),tb(this,"strippedChoices",[]),tb(this,"rawChoices",[]),AO(this,ib,this.hot.guid.slice(0,9)),AO(this,HO,Uv(()=>{this.focus()},100))}static get EDITOR_TYPE(){return ure}getValue(){const e=this.rawChoices.find(n=>{const i=this.stripValueIfNeeded(n);return($a(wa,this,bd).call(this,i)?i.value:i)===this.TEXTAREA.value});return te(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),B(this.htContainer,"autocompleteEditor"),B(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&le(this.TEXTAREA,[J6(),z6(),ND("listbox"),i9()])}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s),this.hot.getSettings().ariaTags&&le(this.TEXTAREA,[Nr("false"),r9(`${nb(ib,this)}-listbox-${e}-${n}`)]),this.htOptions={...this.htOptions,valueGetter:a=>$a(wa,this,bd).call(this,a)?a.value:a}}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,i=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,r=i==null?void 0:i.length,{row:o,col:s}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",nb(HO,this)),this.htEditor.updateSettings({colWidths:e?[cn(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,u,c,h,d,f)=>{ua(a,l,u,c,h,d,f);const{filteringCaseSensitive:p,allowHtml:v,locale:b}=this.cellProperties,P=this.query;let _=Tt(d),F,I;_&&!v&&(F=p===!0?_.indexOf(P):_.toLocaleLowerCase(b).indexOf(P.toLocaleLowerCase(b)),F!==-1&&(I=_.substr(F,P.length),_=_.replace(I,`<strong>${I}</strong>`))),n&&le(l,[Y6(),...i?[l9(r)]:[],...i?[u9(i.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${c}`]]),l.innerHTML=_},afterSelectionEnd:(a,l)=>{if(n){const u=h=>{le(h,[b0()]),le(this.TEXTAREA,...o9(h.id))},c=this.htEditor.getCell(a,l,!0);c!==null?u(c):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);u(h)})}}}),n&&(le(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...js()),le(this.htEditor.rootElement,[HD(),s9("polite"),a9("text"),["id",`${nb(ib,this)}-listbox-${o}-${s}`]]),le(this.TEXTAREA,...Nr("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&le(this.TEXTAREA,[Nr("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}finishEditing(e,n,i){if(this.isOpened()){const r=this.hot.getSelectedRangeActive();(xt(r)||te(r)&&!r.includes(this.hot._createCellCoords(this.row,this.col)))&&(e=!0)}super.finishEditing(e,n,i)}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,i=>{this.rawChoices=i,this.updateChoicesList(this.stripValuesIfNeeded(i))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=QD(this.TEXTAREA),i=Q9(this.TEXTAREA),r=this.cellProperties.sortByRelevance,o=this.cellProperties.filter,s=this.stripValueIfNeeded(this.getValue()),a=$a(wa,this,bd).call(this,s)?s.value:s;let l=null,u=e;r||(u=u.toSorted());const c=[],h=this.cellProperties.locale,d=this.cellProperties.filteringCaseSensitive,f=d?a:a.toLocaleLowerCase(h);for(let p=0;p<u.length;p++){const v=$a(wa,this,bd).call(this,u[p])?qs(Tt(u[p].value)):qs(Tt(u[p]));if((d?v:v.toLocaleLowerCase(h)).indexOf(f)!==-1&&(c.push(p),o===!1))break}o===!1?s.length>0&&(l=c[0]):(u=c.map(p=>u[p]),l=u.indexOf(f)>-1?u.indexOf(f):0),this.strippedChoices=u,u.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Lp([u])),u.length>0&&(this.updateDropdownDimensions(),this.flipDropdownVerticallyIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(l)),this.hot.listen(),Bv(this.TEXTAREA,n,n===i?void 0:i)}flipDropdownVerticallyIfNeeded(){const e=super.flipDropdownVerticallyIfNeeded(),{isFlipped:n,spaceAbove:i,spaceBelow:r}=e;return this.limitDropdownIfNeeded(n?i:r),e}limitDropdownIfNeeded(e){const n=this.getDropdownHeight();if(n>e){let i=0,r=0,o=null;do r=this.htEditor.stylesHandler.getDefaultRowHeight(),i+=r;while(i<e);o=i-r,this.isFlippedVertically&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-o}px`),this.setDropdownHeight(i-r)}}updateDropdownDimensions(){const e=e7(),n=this.getTargetEditorWidth()+e,i=this.getTargetEditorHeight()+e;this.htEditor.updateSettings({width:n,height:i}),$a(wa,this,NO).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),$a(wa,this,NO).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getTargetEditorHeight(){let e=0;if(!this.hot.getCurrentThemeName()){const r=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)}const n=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:n},(r,o)=>o).reduce((r,o)=>{const s=this.hot.stylesHandler.getDefaultRowHeight()+(o===0?1:0);return r+s},0)+e}getTargetEditorWidth(){let e=0;if(!this.hot.getCurrentThemeName()){const n=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(n.borderInlineStartWidth,10)+parseInt(n.borderInlineEndWidth,10)}return this.htEditor.getColWidth(0)+e}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,i=r=>Tt(n?r:qs(r));return e.every(r=>$a(wa,this,bd).call(this,r))?e.map(r=>({key:i(r.key),value:i(r.value)})):e.map(r=>i(r))}onBeforeKeyDown(e){if(s7(e.keyCode)||e.keyCode===ge.BACKSPACE||e.keyCode===ge.DELETE||e.keyCode===ge.INSERT){let n=10;if(e.keyCode===ge.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function NO(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getTargetEditorWidth()+hn(this.hot.rootDocument)})}function bd(t){return me(t)&&te(t.key)&&te(t.value)}const cre="checkbox";class Ik extends Uh{static get EDITOR_TYPE(){return cre}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const i=this.TD.querySelector('input[type="checkbox"]');Ce(i,"htBadValue")||i.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Ga=()=>window,xr=()=>window.document,zR=(t,e)=>window.setTimeout(t,e),zo=function(t,e,n,i){t.addEventListener(e,n,!!i)},_s=function(t,e,n,i){t.removeEventListener(e,n,!!i)},hre=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Ji=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},rb=function(t,e){Ji(t,e)||(t.className=t.className===""?e:t.className+" "+e)},ob=function(t,e){t.className=hre((" "+t.className+" ").replace(" "+e+" "," "))},X_=function(t){return/Array/.test(Object.prototype.toString.call(t))},nr=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},dre=function(t){let e=t.getDay();return e===0||e===6},fre=function(t){return t%4===0&&t%100!==0||t%400===0},DO=function(t,e){return[31,fre(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},_m=function(t){nr(t)&&t.setHours(0,0,0,0)},Mm=function(t,e){return t.getTime()===e.getTime()},$w=function(t,e,n){let i,r;for(i in e)r=t[i]!==void 0,r&&typeof e[i]=="object"&&e[i]!==null&&e[i].nodeName===void 0?nr(e[i])?n&&(t[i]=new Date(e[i].getTime())):X_(e[i])?n&&(t[i]=e[i].slice(0)):t[i]=$w({},e[i],n):(n||!r)&&(t[i]=e[i]);return t},$O=function(t,e,n){let i=xr().createEvent("HTMLEvents");i.initEvent(e,!0,!1),i=$w(i,n),t.dispatchEvent(i)},kO=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},xo={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},LO=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},gre=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},mre=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),i=t.getDay(),r=e,o=r-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(i));let l=new Date(t.getFullYear(),0,r),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},pre=function(t,e,n,i,r){let o=new Date(i,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():mre(o,r))+"</td>"},wre=function(t,e,n,i){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(i?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},vre=function(t){return"<tbody>"+t.join("")+"</tbody>"},Cre=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+LO(t,e)+'">'+LO(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},yre=function(t,e,n,i,r,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,p,v=!0,b=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===r?s-e:12+s-e)+'"'+(s===i?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[i]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",X_(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return p='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=p+f:d+=f+p,c&&(i===0||u.minMonth>=i)&&(v=!1),h&&(i===11||u.maxMonth<=i)&&(b=!1),e===0&&(d+='<button class="pika-prev'+(v?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(b?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},bre=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+Cre(t)+vre(e)+"</table>"};function YR(t){let e=this,n=e.config(t);e._onMouseDown=function(r){if(!e._v)return;r=r||Ga().event;let o=r.target||r.srcElement;if(o)if(Ji(o,"is-disabled")||(Ji(o,"pika-button")&&!Ji(o,"is-empty")&&!Ji(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&zR(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):Ji(o,"pika-prev")?e.prevMonth():Ji(o,"pika-next")&&e.nextMonth()),Ji(o,"pika-select"))e._c=!0;else if(r.preventDefault)r.preventDefault();else return r.returnValue=!1,!1},e._onChange=function(r){r=r||Ga().event;let o=r.target||r.srcElement;o&&(Ji(o,"pika-select-month")?e.gotoMonth(o.value):Ji(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(r){if(r=r||Ga().event,e.isVisible())switch(r.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let r=this.moment(n.field.value,n.format,n.formatStrict);return r&&r.isValid()?r.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(r){let o;r.firedBy!==e&&(o=e._parseFieldValue(),nr(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let r=xr().activeElement;do if(Ji(r,"pika-single"))return;while(r=r.parentNode);e._c||(e._b=zR(function(){e.hide()},50)),e._c=!1},e._onClick=function(r){r=r||Ga().event;let o=r.target||r.srcElement,s=o;if(o){!hasEventListeners&&Ji(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),zo(o,"change",e._onChange)));do if(Ji(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=xr().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),zo(e.el,"mousedown",e._onMouseDown,!0),zo(e.el,"touchend",e._onMouseDown,!0),zo(e.el,"change",e._onChange),n.keyboardInput&&zo(xr(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?xr().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),zo(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let i=n.defaultDate;nr(i)?n.setDefaultDate?e.setDate(i,!0):e.gotoDate(i):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",zo(n.trigger,"click",e._onInputClick),zo(n.trigger,"focus",e._onInputFocus),zo(n.trigger,"blur",e._onInputBlur)):this.show()}YR.prototype={config:function(t){this._o||(this._o=$w({},xo,!0));let e=$w(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,nr(e.minDate)||(e.minDate=!1),nr(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),X_(e.yearRange)){let i=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||i,e.yearRange[1]=parseInt(e.yearRange[1],10)||i}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||xo.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,nr(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return nr(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",$O(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!nr(t))return;let n=this._o.minDate,i=this._o.maxDate;nr(n)&&t<n?t=n:nr(i)&&t>i&&(t=i),this._d=new Date(t.getTime()),_m(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),$O(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(nr(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),r=t.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),e=r<n.getTime()||i.getTime()<r}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,i=parseInt(e)*24*60*60*1e3,r;t==="add"?r=new Date(n.valueOf()+i):t==="subtract"&&(r=new Date(n.valueOf()-i)),this.setDate(r)},adjustCalendars:function(){this.calendars[0]=kO(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=kO({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(_m(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=xo.minDate,this._o.minYear=xo.minYear,this._o.minMonth=xo.minMonth,this._o.startRange=xo.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(_m(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=xo.maxDate,this._o.maxYear=xo.maxYear,this._o.maxMonth=xo.maxMonth,this._o.endRange=xo.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,i=e.maxYear,r=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(r)&&this._m<r&&(this._m=r)),this._y>=i&&(this._y=i,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+yre(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&zR(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,i,r,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,i=Ga().innerWidth||xr().documentElement.clientWidth,r=Ga().innerHeight||xr().documentElement.clientHeight,o=xr().body.scrollTop||xr().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+Ga().pageXOffset,a=l.bottom+Ga().pageYOffset,(this._o.reposition&&s+e>i||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>r+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",rb(this.el,u?"left-aligned":"right-aligned"),rb(this.el,c?"bottom-aligned":"top-aligned"),ob(this.el,u?"right-aligned":"left-aligned"),ob(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let i=this._o,r=new Date,o=DO(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];_m(r),i.firstDay>0&&(s-=i.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=DO(h,u),p=o+s,v=p;for(;v>7;)v-=7;p+=7-v;let b=!1;for(let P=0,_=0;P<p;P++){let F=new Date(t,e,1+(P-s)),I=nr(this._d)?Mm(F,this._d):!1,W=Mm(F,r),k=i.events.indexOf(F.toDateString())!==-1,$=P<s||P>=o+s,Y=1+(P-s),J=e,U=t,oe=i.startRange&&Mm(i.startRange,F),j=i.endRange&&Mm(i.endRange,F),Z=i.startRange&&i.endRange&&i.startRange<F&&F<i.endRange,re=i.minDate&&F<i.minDate||i.maxDate&&F>i.maxDate||i.disableWeekends&&dre(F)||i.disableDayFn&&i.disableDayFn(F);$&&(P<s?(Y=f+Y,J=u,U=h):(Y=Y-o,J=c,U=d));let pe={day:Y,month:J,year:U,hasEvent:k,isSelected:I,isToday:W,isDisabled:re,isEmpty:$,isStartRange:oe,isEndRange:j,isInRange:Z,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:i.enableSelectionDaysInNextAndPreviousMonths};i.pickWholeWeek&&I&&(b=!0),l.push(gre(pe)),++_===7&&(i.showWeekNumber&&l.unshift(pre(this,P-s,e,t,i.firstWeekOfYearMinDays)),a.push(wre(l,i.isRTL,i.pickWholeWeek,b)),l=[],_=0,b=!1)}return bre(i,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),ob(this.el,"is-hidden"),this._o.bound&&(zo(xr(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&_s(xr(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),rb(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),_s(this.el,"mousedown",this._onMouseDown,!0),_s(this.el,"touchend",this._onMouseDown,!0),_s(this.el,"change",this._onChange),t.keyboardInput&&_s(xr(),"keydown",this._onKeyChange),t.field&&(_s(t.field,"change",this._onInputChange),t.bound&&(_s(t.trigger,"click",this._onInputClick),_s(t.trigger,"focus",this._onInputFocus),_s(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function Sre(t,e){Rre(t,e),e.add(t)}function Rre(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FO(t,e,n){return(e=Ere(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ere(t){var e=Tre(t,"string");return typeof e=="symbol"?e:e+""}function Tre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const xk="date",VO="dateEditor",_re="DD/MM/YYYY";var Pm=new WeakSet;class Ok extends Ku{constructor(){super(...arguments),Sre(this,Pm),FO(this,"parentDestroyed",!1),FO(this,"$datePicker",null)}static get EDITOR_TYPE(){return xk}init(){if(typeof K!="function")throw new Error("You need to include moment.js to your project.");if(typeof YR!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),B(this.datePicker,"htDatepickerHolder"),this.hot.rootPortalElement.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{Ce(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const i=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),i.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:VO})}close(){var e;(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const r=this.hot._getEditorManager();r.closeEditor(),this.hot.view.render(),r.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(VO),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=sb(Pm,this,ab).call(this),i=this.hot.view.isMouseDown(),r=e?a$(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new YR(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(K),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,K(o,n,!0).isValid()&&this.$datePicker.setMoment(K(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!r&&!i&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,K(o,n,!0).isValid()&&this.$datePicker.setMoment(K(o,n),!0),!r&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,i={};this.cellProperties&&this.cellProperties.datePickerConfig&&Fv(i,this.cellProperties.datePickerConfig);const r=i.onSelect,o=i.onClose;return i.field=n,i.trigger=n,i.container=this.datePicker,i.bound=!1,i.keyboardInput=!1,i.format=(e=i.format)!==null&&e!==void 0?e:sb(Pm,this,ab).call(this),i.reposition=i.reposition||!1,i.isRTL=!1,i.onSelect=s=>{let a=s;isNaN(a.getTime())||(a=K(a).format(sb(Pm,this,ab).call(this))),this.setValue(a),r&&r(),rs()&&this.hideDatepicker()},i.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},i}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==Qt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:i,columnIndexMapper:r}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:s}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=i.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleRow()),l=i.getVisualFromRenderableIndex(s.getLastPartiallyVisibleRow()),u=r.getVisualFromRenderableIndex(s.getFirstPartiallyVisibleColumn()),c=r.getVisualFromRenderableIndex(s.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+yn(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-cn(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function ab(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:_re}const Mre="dropdown";class Ak extends K_{static get EDITOR_TYPE(){return Mre}prepare(e,n,i,r,o,s){s.filter=!1,s.strict=!0,super.prepare(e,n,i,r,o,s)}}const Pre="numeric";class Hk extends Ku{static get EDITOR_TYPE(){return Pre}}function Ire(t,e,n){return(e=xre(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xre(t){var e=Ore(t,"string");return typeof e=="symbol"?e:e+""}function Ore(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Are="password";class Nk extends Ku{constructor(){super(...arguments),Ire(this,"autoResize",wk(this.hot.rootDocument,{textContent:e=>"â¢".repeat(e.value.length)}))}static get EDITOR_TYPE(){return Are}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,ea(this.TEXTAREA_PARENT),this.TEXTAREA.setAttribute(...po(-1)),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const lb="ht_editor_visible",WO="selectEditor",Hre="select";class Dk extends Uh{static get EDITOR_TYPE(){return Hre}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...Uu()),e.appendChild(this.hot.rootDocument.createTextNode("â¼")),B(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",Ce(this.selectWrapper,lb)&&ae(this.selectWrapper,lb),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),ea(this.select),We(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Yu(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let i=0,r=e.length;i<r;i++)n[e[i]]=e[i];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Qt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:i,height:r}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${r}px`,o.width=`${i}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",B(this.selectWrapper,lb)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),i={group:WO};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const r=this.select.selectedIndex-1;r>=0&&(this.select[r].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const r=this.select.selectedIndex+1;r<=this.select.length-1&&(this.select[r].selected=!0)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(WO)}}const Nre="time";class $k extends Ku{static get EDITOR_TYPE(){return Nre}prepare(e,n,i,r,o,s){super.prepare(e,n,i,r,o,s),this.TEXTAREA.dir="ltr"}}function Dre(){er(Uh),er(K_),er(Ik),er(Ok),er(Ak),er(G_),er(Hk),er(Nk),er(Dk),er(Ku),er($k)}const $re="html";function q_(t,e,n,i,r,o,s){Sg.apply(this,[t,e,n,i,r,o,s]),Yu(e,o??"",!1)}q_.RENDERER_TYPE=$re;const kre="autocomplete";function zh(t,e,n,i,r,o,s){const{rootDocument:a}=t,l=s.allowHtml?q_:ua,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Uu()),u.appendChild(a.createTextNode("â¼")),l.apply(this,[t,e,n,i,r,o,s]),e.firstChild||e.appendChild(a.createTextNode("Â ")),e.insertBefore(u,e.firstChild),B(e,"htAutocomplete"),!t.acArrowListener){const h=new wo(t);t.acArrowListener=function(d){Ce(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,i),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}zh.RENDERER_TYPE=kre;const Lre="dropdown";function Z_(t,e,n,i,r,o,s){zh.apply(this,[t,e,n,i,r,o,s])}Z_.RENDERER_TYPE=Lre;const BO=new WeakMap,jO=new WeakMap,Fre="htBadValue",Ph="data-row",Ih="data-col",Vre="checkboxRenderer",kk="checkbox";ie.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:i,type:r,row:o,column:s,prop:a}=e;if(r!==kk||!i)return;const{value:l,property:u}=i;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}return`${Tt(c).length}`});function J_(t,e,n,i,r,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;Sg.apply(this,[t,e,n,i,r,o,s]),Wre(t);let u=Bre(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),ea(e),o===s.checkedTemplate||Tt(o).toLocaleLowerCase(s.locale)===Tt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Tt(o).toLocaleLowerCase(s.locale)===Tt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:rn(o)?B(u,"noValue"):(u.style.display="none",B(u,Fre),h=!0),le(u,[[Ph,n],[Ih,i]]),l&&le(u,[lr(u.checked?t.getTranslatedPhrase(O_):t.getTranslatedPhrase(A_)),kD(u.checked),G6()]),!h&&c){let v="";if(c.value)v=typeof c.value=="function"?c.value.call(this,n,i,r,o):c.value;else if(c.property){const P=t.getDataAtRowProp(n,c.property);v=P!==null?P:""}const b=jre(a,v,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(b),e.appendChild(u)):(b.appendChild(u),u=b):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(b)):(b.insertBefore(u,b.firstChild),u=b))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),BO.has(t)||(BO.set(t,!0),d());function d(){const b=t.getShortcutManager().getContext("grid"),P={group:Vre,relativeToGroup:ul,position:"before"};b.addShortcuts([{keys:[["space"]],callback:()=>(f(),!p()),runOnlyIf:()=>{var _;return(_=t.getSelectedRangeActive())===null||_===void 0?void 0:_.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!p()),runOnlyIf:()=>{const _=t.getSelectedRangeActive();return t.getSettings().enterBeginsEditing&&(_==null?void 0:_.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!p()),runOnlyIf:()=>{var _;return(_=t.getSelectedRangeActive())===null||_===void 0?void 0:_.highlight.isCell()}}],P)}function f(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const b=t.getSelectedRange(),P=[],_=new Map;let F=[],I=0;if(b){for(let W=0;W<b.length;W++){const{row:k,col:$}=b[W].getTopStartCorner(),{row:Y,col:J}=b[W].getBottomEndCorner();for(let U=k;U<=Y;U+=1)for(let oe=$;oe<=J;oe+=1){const j=t.getCellMeta(U,oe);if(j.hidden)continue;const Z={checkedTemplate:j.checkedTemplate,uncheckedTemplate:j.uncheckedTemplate};if(j.type!=="checkbox"){v===!0&&!j.readOnly&&(_.has(P.length)?_.set(P.length,[..._.get(P.length),[U,oe,null]]):_.set(P.length,[[U,oe,null]]));continue}if(j.readOnly===!0)continue;typeof j.checkedTemplate>"u"&&(j.checkedTemplate=!0),typeof j.uncheckedTemplate>"u"&&(j.uncheckedTemplate=!1);const re=t.getDataAtCell(U,oe);v===!1?[j.checkedTemplate,j.checkedTemplate.toString()].includes(re)?F.push([U,oe,j.uncheckedTemplate,Z]):[j.uncheckedTemplate,j.uncheckedTemplate.toString(),null,void 0].includes(re)&&F.push([U,oe,j.checkedTemplate,Z]):F.push([U,oe,j.uncheckedTemplate,Z]),I+=1}P.push(I),I=0}F.every(W=>{let[,,k]=W;return k===F[0][2]})?F=F.map(W=>{let[k,$,Y]=W;return[k,$,Y]}):F=F.map(W=>{let[k,$,,Y]=W;return[k,$,Y.checkedTemplate]}),F.length>0&&P.forEach((W,k)=>{let $=F.splice(0,W);_.size&&_.has(k)&&($=[...$,..._.get(k)]),t.setDataAtCell($)})}}function p(){const v=t.getSelectedRange();if(v){for(let b=0;b<v.length;b++){const P=v[b].getTopStartCorner(),_=v[b].getBottomEndCorner();for(let F=P.row;F<=_.row;F++)for(let I=P.col;I<=_.col;I++){if(t.getCellMeta(F,I).readOnly)continue;const k=t.getCell(F,I);if(Js(k)&&k.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}J_.RENDERER_TYPE=kk;function Wre(t){let e=jO.get(t);if(!e){const{rootElement:n}=t;e=new wo(t),e.addEventListener(n,"click",i=>zre(i,t)),e.addEventListener(n,"mouseup",i=>Ure(i,t)),e.addEventListener(n,"change",i=>Yre(i,t)),jO.set(t,e)}return e}function Bre(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function jre(t,e,n){const i=t.createElement("label");i.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const r=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(r),i.appendChild(o)}else i.appendChild(r);return i.cloneNode(!0)}function Ure(t,e){const{target:n}=t;Q_(n)&&(!n.hasAttribute(Ph)||!n.hasAttribute(Ih)||setTimeout(e.listen,10))}function zre(t,e){const{target:n}=t;if(!Q_(n)||!n.hasAttribute(Ph)||!n.hasAttribute(Ih))return;const i=parseInt(n.getAttribute(Ph),10),r=parseInt(n.getAttribute(Ih),10);e.getCellMeta(i,r).readOnly&&t.preventDefault()}function Yre(t,e){const{target:n}=t;if(!Q_(n)||!n.hasAttribute(Ph)||!n.hasAttribute(Ih))return;const i=parseInt(n.getAttribute(Ph),10),r=parseInt(n.getAttribute(Ih),10),o=e.getCellMeta(i,r);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(i,r,s)}}function Q_(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const Gre="handsontable";function eM(t,e,n,i,r,o,s){zh.apply(this,[t,e,n,i,r,o,s])}eM.RENDERER_TYPE=Gre;var Kre=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xre(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var ub,UO;function qre(){return UO||(UO=1,ub={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),ub}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var cb,zO;function Lk(){if(zO)return cb;zO=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,u,c,h,d,f,p){if(!isNaN(+l))return+l;let v="",b=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(b!==l)return-1*n(b,u,c,h,d,f);for(let k=0;k<t.length;k++){let $=t[k];if(v=l.replace(RegExp(`([0-9 ])(${$.key})$`),"$1"),v!==l)return n(v,u,c,h,d,f)*$.factor}if(v=l.replace("%",""),v!==l)return n(v,u,c,h,d,f)/100;let P=parseFloat(l);if(isNaN(P))return;let _=h(P);if(_&&_!=="."&&(v=l.replace(new RegExp(`${e(_)}$`),""),v!==l))return n(v,u,c,h,d,f);let F={};Object.keys(f).forEach(k=>{F[f[k]]=k});let I=Object.keys(F).sort().reverse(),W=I.length;for(let k=0;k<W;k++){let $=I[k],Y=F[$];if(v=l.replace($,""),v!==l){let J;switch(Y){case"thousand":J=Math.pow(10,3);break;case"million":J=Math.pow(10,6);break;case"billion":J=Math.pow(10,9);break;case"trillion":J=Math.pow(10,12);break}return n(v,u,c,h,d,f)*J}}}function i(l,u,c){let h=l.replace(c,"");return h=h.replace(new RegExp(`([0-9])${e(u.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(u.decimal,"."),h}function r(l,u,c="",h,d,f,p){if(l==="")return;if(l===d)return 0;let v=i(l,u,c);return n(v,u,c,h,d,f)}function o(l,u){if(!(l.indexOf(":")&&u.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],p=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(p)}function s(l){let u=l.split(":"),c=+u[0],h=+u[1];return+u[2]+60*h+3600*c}function a(l,u){const c=iM();let h=c.currentDelimiters(),d=c.currentCurrency().symbol,f=c.currentOrdinal(),p=c.getZeroFormat(),v=c.currentAbbreviations(),b;if(typeof l=="string")o(l,h)?b=s(l):b=r(l,h,d,f,p,v);else if(typeof l=="number")b=l;else return;if(b!==void 0)return b}return cb={unformat:a},cb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var hb,YO;function tM(){if(YO)return hb;YO=1;let t=Lk();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],i=["trillion","billion","million","thousand"],r=["prefix","infix","postfix"],o=["sign","parenthesis"],s={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},u={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(b,P)=>P.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:b=>b.output==="byte"},characteristic:{type:"number",restriction:b=>b>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:i},average:"boolean",lowPrecision:{type:"boolean",restriction:(b,P)=>P.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:r},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:b=>b>=0,message:"value must be positive"},{restriction:(b,P)=>!P.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:b=>b>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(b,P)=>P.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:b=>b.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:s,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(b,P){let _=d(b),F=p(P);return _&&F}function d(b){return t.unformat(b)!==void 0}function f(b,P,_,F=!1){let I=Object.keys(b).map(W=>{if(!P[W])return console.error(`${_} Invalid key: ${W}`),!1;let k=b[W],$=P[W];if(typeof $=="string"&&($={type:$}),$.type==="format"){if(!f(k,u,`[Validate ${W}]`,!0))return!1}else if(typeof k!==$.type)return console.error(`${_} ${W} type mismatched: "${$.type}" expected, "${typeof k}" provided`),!1;if($.restrictions&&$.restrictions.length){let Y=$.restrictions.length;for(let J=0;J<Y;J++){let{restriction:U,message:oe}=$.restrictions[J];if(!U(k,b))return console.error(`${_} ${W} invalid value: ${oe}`),!1}}return $.restriction&&!$.restriction(k,b)?(console.error(`${_} ${W} invalid value: ${$.message}`),!1):$.validValues&&$.validValues.indexOf(k)===-1?(console.error(`${_} ${W} invalid value: must be among ${JSON.stringify($.validValues)}, "${k}" provided`),!1):!($.children&&!f(k,$.children,`[Validate ${W}]`))});return F||I.push(...Object.keys(P).map(W=>{let k=P[W];if(typeof k=="string"&&(k={type:k}),k.mandatory){let $=k.mandatory;if(typeof $=="function"&&($=$(b)),$&&b[W]===void 0)return console.error(`${_} Missing mandatory key "${W}"`),!1}return!0})),I.reduce((W,k)=>W&&k,!0)}function p(b){return f(b,u,"[Validate format]")}function v(b){return f(b,c,"[Validate language]")}return hb={validate:h,validateFormat:p,validateInput:d,validateLanguage:v},hb}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function Zre(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function Jre(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function Qre(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function eoe(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function toe(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function noe(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function ioe(t,e){let i=t.split(".")[0].match(/0+/);i&&(e.characteristic=i[0].length)}function roe(t,e){let n=t.split(".")[1];if(n){let i=n.match(/0+/);i&&(e.mantissa=i[0].length)}}function ooe(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function soe(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function aoe(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function loe(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function uoe(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function coe(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function hoe(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function doe(t,e={}){return typeof t!="string"?t:(t=Zre(t,e),t=Jre(t,e),Qre(t,e),noe(t,e),ioe(t,e),uoe(t,e),soe(t,e),aoe(t,e),roe(t,e),loe(t,e),ooe(t,e),eoe(t,e),toe(t,e),coe(t,e),hoe(t,e),e)}var nM={parseFormat:doe};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var db,GO;function iM(){if(GO)return db;GO=1;const t=qre(),e=tM(),n=nM;let i={},r,o={},s=null,a={};function l(c){r=c}function u(){return o[r]}return i.languages=()=>Object.assign({},o),i.currentLanguage=()=>r,i.currentBytes=()=>u().bytes||{},i.currentCurrency=()=>u().currency,i.currentAbbreviations=()=>u().abbreviations,i.currentDelimiters=()=>u().delimiters,i.currentOrdinal=()=>u().ordinal,i.currentDefaults=()=>Object.assign({},u().defaults,a),i.currentOrdinalDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().ordinalFormat),i.currentByteDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().byteFormat),i.currentPercentageDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().percentageFormat),i.currentCurrencyDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().currencyFormat),i.currentTimeDefaultFormat=()=>Object.assign({},i.currentDefaults(),u().timeFormat),i.setDefaults=c=>{c=n.parseFormat(c),e.validateFormat(c)&&(a=c)},i.getZeroFormat=()=>s,i.setZeroFormat=c=>s=typeof c=="string"?c:null,i.hasZeroFormat=()=>s!==null,i.languageData=c=>{if(c){if(o[c])return o[c];throw new Error(`Unknown tag "${c}"`)}return u()},i.registerLanguage=(c,h=!1)=>{if(!e.validateLanguage(c))throw new Error("Invalid language data");o[c.languageTag]=c,h&&l(c.languageTag)},i.setLanguage=(c,h=t.languageTag)=>{if(!o[c]){let d=c.split("-")[0],f=Object.keys(o).find(p=>p.split("-")[0]===d);if(!o[f]){l(h);return}l(f);return}l(c)},i.registerLanguage(t),r=t.languageTag,db=i,db}function foe(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function goe(t,e){t.forEach(n=>{let i;try{i=foe(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}i&&e.registerLanguage(i)})}var moe=t=>({loadLanguagesInNode:e=>goe(e,t)}),Fk={exports:{}};(function(t){(function(e){var n,i=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,r=Math.ceil,o=Math.floor,s="[BigNumber Error] ",a=s+"Number primitive has more than 15 significant digits: ",l=1e14,u=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function p(k){var $,Y,J,U=G.prototype={constructor:G,toString:null,valueOf:null},oe=new G(1),j=20,Z=4,re=-7,pe=21,Xe=-1e7,xe=1e7,Oe=!1,Re=1,Ae=0,Ze={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},gt="0123456789abcdefghijklmnopqrstuvwxyz",ke=!0;function G(m,C){var S,x,E,R,N,M,A,L,V=this;if(!(V instanceof G))return new G(m,C);if(C==null){if(m&&m._isBigNumber===!0){V.s=m.s,!m.c||m.e>xe?V.c=V.e=null:m.e<Xe?V.c=[V.e=0]:(V.e=m.e,V.c=m.c.slice());return}if((M=typeof m=="number")&&m*0==0){if(V.s=1/m<0?(m=-m,-1):1,m===~~m){for(R=0,N=m;N>=10;N/=10,R++);R>xe?V.c=V.e=null:(V.e=R,V.c=[m]);return}L=String(m)}else{if(!i.test(L=String(m)))return J(V,L,M);V.s=L.charCodeAt(0)==45?(L=L.slice(1),-1):1}(R=L.indexOf("."))>-1&&(L=L.replace(".","")),(N=L.search(/e/i))>0?(R<0&&(R=N),R+=+L.slice(N+1),L=L.substring(0,N)):R<0&&(R=L.length)}else{if(_(C,2,gt.length,"Base"),C==10&&ke)return V=new G(m),T(V,j+V.e+1,Z);if(L=String(m),M=typeof m=="number"){if(m*0!=0)return J(V,L,M,C);if(V.s=1/m<0?(L=L.slice(1),-1):1,G.DEBUG&&L.replace(/^0\.0*|\./,"").length>15)throw Error(a+m)}else V.s=L.charCodeAt(0)===45?(L=L.slice(1),-1):1;for(S=gt.slice(0,C),R=N=0,A=L.length;N<A;N++)if(S.indexOf(x=L.charAt(N))<0){if(x=="."){if(N>R){R=A;continue}}else if(!E&&(L==L.toUpperCase()&&(L=L.toLowerCase())||L==L.toLowerCase()&&(L=L.toUpperCase()))){E=!0,N=-1,R=0;continue}return J(V,String(m),M,C)}M=!1,L=Y(L,C,10,V.s),(R=L.indexOf("."))>-1?L=L.replace(".",""):R=L.length}for(N=0;L.charCodeAt(N)===48;N++);for(A=L.length;L.charCodeAt(--A)===48;);if(L=L.slice(N,++A)){if(A-=N,M&&G.DEBUG&&A>15&&(m>c||m!==o(m)))throw Error(a+V.s*m);if((R=R-N-1)>xe)V.c=V.e=null;else if(R<Xe)V.c=[V.e=0];else{if(V.e=R,V.c=[],N=(R+1)%u,R<0&&(N+=u),N<A){for(N&&V.c.push(+L.slice(0,N)),A-=u;N<A;)V.c.push(+L.slice(N,N+=u));N=u-(L=L.slice(N)).length}else N-=A;for(;N--;L+="0");V.c.push(+L)}}else V.c=[V.e=0]}G.clone=p,G.ROUND_UP=0,G.ROUND_DOWN=1,G.ROUND_CEIL=2,G.ROUND_FLOOR=3,G.ROUND_HALF_UP=4,G.ROUND_HALF_DOWN=5,G.ROUND_HALF_EVEN=6,G.ROUND_HALF_CEIL=7,G.ROUND_HALF_FLOOR=8,G.EUCLID=9,G.config=G.set=function(m){var C,S;if(m!=null)if(typeof m=="object"){if(m.hasOwnProperty(C="DECIMAL_PLACES")&&(S=m[C],_(S,0,f,C),j=S),m.hasOwnProperty(C="ROUNDING_MODE")&&(S=m[C],_(S,0,8,C),Z=S),m.hasOwnProperty(C="EXPONENTIAL_AT")&&(S=m[C],S&&S.pop?(_(S[0],-f,0,C),_(S[1],0,f,C),re=S[0],pe=S[1]):(_(S,-f,f,C),re=-(pe=S<0?-S:S))),m.hasOwnProperty(C="RANGE"))if(S=m[C],S&&S.pop)_(S[0],-f,-1,C),_(S[1],1,f,C),Xe=S[0],xe=S[1];else if(_(S,-f,f,C),S)Xe=-(xe=S<0?-S:S);else throw Error(s+C+" cannot be zero: "+S);if(m.hasOwnProperty(C="CRYPTO"))if(S=m[C],S===!!S)if(S)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Oe=S;else throw Oe=!S,Error(s+"crypto unavailable");else Oe=S;else throw Error(s+C+" not true or false: "+S);if(m.hasOwnProperty(C="MODULO_MODE")&&(S=m[C],_(S,0,9,C),Re=S),m.hasOwnProperty(C="POW_PRECISION")&&(S=m[C],_(S,0,f,C),Ae=S),m.hasOwnProperty(C="FORMAT"))if(S=m[C],typeof S=="object")Ze=S;else throw Error(s+C+" not an object: "+S);if(m.hasOwnProperty(C="ALPHABET"))if(S=m[C],typeof S=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(S))ke=S.slice(0,10)=="0123456789",gt=S;else throw Error(s+C+" invalid: "+S)}else throw Error(s+"Object expected: "+m);return{DECIMAL_PLACES:j,ROUNDING_MODE:Z,EXPONENTIAL_AT:[re,pe],RANGE:[Xe,xe],CRYPTO:Oe,MODULO_MODE:Re,POW_PRECISION:Ae,FORMAT:Ze,ALPHABET:gt}},G.isBigNumber=function(m){if(!m||m._isBigNumber!==!0)return!1;if(!G.DEBUG)return!0;var C,S,x=m.c,E=m.e,R=m.s;e:if({}.toString.call(x)=="[object Array]"){if((R===1||R===-1)&&E>=-f&&E<=f&&E===o(E)){if(x[0]===0){if(E===0&&x.length===1)return!0;break e}if(C=(E+1)%u,C<1&&(C+=u),String(x[0]).length==C){for(C=0;C<x.length;C++)if(S=x[C],S<0||S>=l||S!==o(S))break e;if(S!==0)return!0}}}else if(x===null&&E===null&&(R===null||R===1||R===-1))return!0;throw Error(s+"Invalid BigNumber: "+m)},G.maximum=G.max=function(){return w(arguments,-1)},G.minimum=G.min=function(){return w(arguments,1)},G.random=function(){var m=9007199254740992,C=Math.random()*m&2097151?function(){return o(Math.random()*m)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(S){var x,E,R,N,M,A=0,L=[],V=new G(oe);if(S==null?S=j:_(S,0,f),N=r(S/u),Oe)if(crypto.getRandomValues){for(x=crypto.getRandomValues(new Uint32Array(N*=2));A<N;)M=x[A]*131072+(x[A+1]>>>11),M>=9e15?(E=crypto.getRandomValues(new Uint32Array(2)),x[A]=E[0],x[A+1]=E[1]):(L.push(M%1e14),A+=2);A=N/2}else if(crypto.randomBytes){for(x=crypto.randomBytes(N*=7);A<N;)M=(x[A]&31)*281474976710656+x[A+1]*1099511627776+x[A+2]*4294967296+x[A+3]*16777216+(x[A+4]<<16)+(x[A+5]<<8)+x[A+6],M>=9e15?crypto.randomBytes(7).copy(x,A):(L.push(M%1e14),A+=7);A=N/7}else throw Oe=!1,Error(s+"crypto unavailable");if(!Oe)for(;A<N;)M=C(),M<9e15&&(L[A++]=M%1e14);for(N=L[--A],S%=u,N&&S&&(M=h[u-S],L[A]=o(N/M)*M);L[A]===0;L.pop(),A--);if(A<0)L=[R=0];else{for(R=-1;L[0]===0;L.splice(0,1),R-=u);for(A=1,M=L[0];M>=10;M/=10,A++);A<u&&(R-=u-A)}return V.e=R,V.c=L,V}}(),G.sum=function(){for(var m=1,C=arguments,S=new G(C[0]);m<C.length;)S=S.plus(C[m++]);return S},Y=function(){var m="0123456789";function C(S,x,E,R){for(var N,M=[0],A,L=0,V=S.length;L<V;){for(A=M.length;A--;M[A]*=x);for(M[0]+=R.indexOf(S.charAt(L++)),N=0;N<M.length;N++)M[N]>E-1&&(M[N+1]==null&&(M[N+1]=0),M[N+1]+=M[N]/E|0,M[N]%=E)}return M.reverse()}return function(S,x,E,R,N){var M,A,L,V,z,se,Q,ye,Be=S.indexOf("."),et=j,Se=Z;for(Be>=0&&(V=Ae,Ae=0,S=S.replace(".",""),ye=new G(x),se=ye.pow(S.length-Be),Ae=V,ye.c=C(W(b(se.c),se.e,"0"),10,E,m),ye.e=ye.c.length),Q=C(S,x,E,N?(M=gt,m):(M=m,gt)),L=V=Q.length;Q[--V]==0;Q.pop());if(!Q[0])return M.charAt(0);if(Be<0?--L:(se.c=Q,se.e=L,se.s=R,se=$(se,ye,et,Se,E),Q=se.c,z=se.r,L=se.e),A=L+et+1,Be=Q[A],V=E/2,z=z||A<0||Q[A+1]!=null,z=Se<4?(Be!=null||z)&&(Se==0||Se==(se.s<0?3:2)):Be>V||Be==V&&(Se==4||z||Se==6&&Q[A-1]&1||Se==(se.s<0?8:7)),A<1||!Q[0])S=z?W(M.charAt(1),-et,M.charAt(0)):M.charAt(0);else{if(Q.length=A,z)for(--E;++Q[--A]>E;)Q[A]=0,A||(++L,Q=[1].concat(Q));for(V=Q.length;!Q[--V];);for(Be=0,S="";Be<=V;S+=M.charAt(Q[Be++]));S=W(S,L,M.charAt(0))}return S}}(),$=function(){function m(x,E,R){var N,M,A,L,V=0,z=x.length,se=E%d,Q=E/d|0;for(x=x.slice();z--;)A=x[z]%d,L=x[z]/d|0,N=Q*A+L*se,M=se*A+N%d*d+V,V=(M/R|0)+(N/d|0)+Q*L,x[z]=M%R;return V&&(x=[V].concat(x)),x}function C(x,E,R,N){var M,A;if(R!=N)A=R>N?1:-1;else for(M=A=0;M<R;M++)if(x[M]!=E[M]){A=x[M]>E[M]?1:-1;break}return A}function S(x,E,R,N){for(var M=0;R--;)x[R]-=M,M=x[R]<E[R]?1:0,x[R]=M*N+x[R]-E[R];for(;!x[0]&&x.length>1;x.splice(0,1));}return function(x,E,R,N,M){var A,L,V,z,se,Q,ye,Be,et,Se,je,rt,Xt,Bn,mr,qt,Ui,_t=x.s==E.s?1:-1,Rt=x.c,Je=E.c;if(!Rt||!Rt[0]||!Je||!Je[0])return new G(!x.s||!E.s||(Rt?Je&&Rt[0]==Je[0]:!Je)?NaN:Rt&&Rt[0]==0||!Je?_t*0:_t/0);for(Be=new G(_t),et=Be.c=[],L=x.e-E.e,_t=R+L+1,M||(M=l,L=v(x.e/u)-v(E.e/u),_t=_t/u|0),V=0;Je[V]==(Rt[V]||0);V++);if(Je[V]>(Rt[V]||0)&&L--,_t<0)et.push(1),z=!0;else{for(Bn=Rt.length,qt=Je.length,V=0,_t+=2,se=o(M/(Je[0]+1)),se>1&&(Je=m(Je,se,M),Rt=m(Rt,se,M),qt=Je.length,Bn=Rt.length),Xt=qt,Se=Rt.slice(0,qt),je=Se.length;je<qt;Se[je++]=0);Ui=Je.slice(),Ui=[0].concat(Ui),mr=Je[0],Je[1]>=M/2&&mr++;do{if(se=0,A=C(Je,Se,qt,je),A<0){if(rt=Se[0],qt!=je&&(rt=rt*M+(Se[1]||0)),se=o(rt/mr),se>1)for(se>=M&&(se=M-1),Q=m(Je,se,M),ye=Q.length,je=Se.length;C(Q,Se,ye,je)==1;)se--,S(Q,qt<ye?Ui:Je,ye,M),ye=Q.length,A=1;else se==0&&(A=se=1),Q=Je.slice(),ye=Q.length;if(ye<je&&(Q=[0].concat(Q)),S(Se,Q,je,M),je=Se.length,A==-1)for(;C(Je,Se,qt,je)<1;)se++,S(Se,qt<je?Ui:Je,je,M),je=Se.length}else A===0&&(se++,Se=[0]);et[V++]=se,Se[0]?Se[je++]=Rt[Xt]||0:(Se=[Rt[Xt]],je=1)}while((Xt++<Bn||Se[0]!=null)&&_t--);z=Se[0]!=null,et[0]||et.splice(0,1)}if(M==l){for(V=1,_t=et[0];_t>=10;_t/=10,V++);T(Be,R+(Be.e=V+L*u-1)+1,N,z)}else Be.e=L,Be.r=+z;return Be}}();function g(m,C,S,x){var E,R,N,M,A;if(S==null?S=Z:_(S,0,8),!m.c)return m.toString();if(E=m.c[0],N=m.e,C==null)A=b(m.c),A=x==1||x==2&&(N<=re||N>=pe)?I(A,N):W(A,N,"0");else if(m=T(new G(m),C,S),R=m.e,A=b(m.c),M=A.length,x==1||x==2&&(C<=R||R<=re)){for(;M<C;A+="0",M++);A=I(A,R)}else if(C-=N,A=W(A,R,"0"),R+1>M){if(--C>0)for(A+=".";C--;A+="0");}else if(C+=R-M,C>0)for(R+1==M&&(A+=".");C--;A+="0");return m.s<0&&E?"-"+A:A}function w(m,C){for(var S,x,E=1,R=new G(m[0]);E<m.length;E++)x=new G(m[E]),(!x.s||(S=P(R,x))===C||S===0&&R.s===C)&&(R=x);return R}function y(m,C,S){for(var x=1,E=C.length;!C[--E];C.pop());for(E=C[0];E>=10;E/=10,x++);return(S=x+S*u-1)>xe?m.c=m.e=null:S<Xe?m.c=[m.e=0]:(m.e=S,m.c=C),m}J=function(){var m=/^(-?)0([xbo])(?=\w[\w.]*$)/i,C=/^([^.]+)\.$/,S=/^\.([^.]+)$/,x=/^-?(Infinity|NaN)$/,E=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(R,N,M,A){var L,V=M?N:N.replace(E,"");if(x.test(V))R.s=isNaN(V)?null:V<0?-1:1;else{if(!M&&(V=V.replace(m,function(z,se,Q){return L=(Q=Q.toLowerCase())=="x"?16:Q=="b"?2:8,!A||A==L?se:z}),A&&(L=A,V=V.replace(C,"$1").replace(S,"0.$1")),N!=V))return new G(V,L);if(G.DEBUG)throw Error(s+"Not a"+(A?" base "+A:"")+" number: "+N);R.s=null}R.c=R.e=null}}();function T(m,C,S,x){var E,R,N,M,A,L,V,z=m.c,se=h;if(z){e:{for(E=1,M=z[0];M>=10;M/=10,E++);if(R=C-E,R<0)R+=u,N=C,A=z[L=0],V=o(A/se[E-N-1]%10);else if(L=r((R+1)/u),L>=z.length)if(x){for(;z.length<=L;z.push(0));A=V=0,E=1,R%=u,N=R-u+1}else break e;else{for(A=M=z[L],E=1;M>=10;M/=10,E++);R%=u,N=R-u+E,V=N<0?0:o(A/se[E-N-1]%10)}if(x=x||C<0||z[L+1]!=null||(N<0?A:A%se[E-N-1]),x=S<4?(V||x)&&(S==0||S==(m.s<0?3:2)):V>5||V==5&&(S==4||x||S==6&&(R>0?N>0?A/se[E-N]:0:z[L-1])%10&1||S==(m.s<0?8:7)),C<1||!z[0])return z.length=0,x?(C-=m.e+1,z[0]=se[(u-C%u)%u],m.e=-C||0):z[0]=m.e=0,m;if(R==0?(z.length=L,M=1,L--):(z.length=L+1,M=se[u-R],z[L]=N>0?o(A/se[E-N]%se[N])*M:0),x)for(;;)if(L==0){for(R=1,N=z[0];N>=10;N/=10,R++);for(N=z[0]+=M,M=1;N>=10;N/=10,M++);R!=M&&(m.e++,z[0]==l&&(z[0]=1));break}else{if(z[L]+=M,z[L]!=l)break;z[L--]=0,M=1}for(R=z.length;z[--R]===0;z.pop());}m.e>xe?m.c=m.e=null:m.e<Xe&&(m.c=[m.e=0])}return m}function D(m){var C,S=m.e;return S===null?m.toString():(C=b(m.c),C=S<=re||S>=pe?I(C,S):W(C,S,"0"),m.s<0?"-"+C:C)}return U.absoluteValue=U.abs=function(){var m=new G(this);return m.s<0&&(m.s=1),m},U.comparedTo=function(m,C){return P(this,new G(m,C))},U.decimalPlaces=U.dp=function(m,C){var S,x,E,R=this;if(m!=null)return _(m,0,f),C==null?C=Z:_(C,0,8),T(new G(R),m+R.e+1,C);if(!(S=R.c))return null;if(x=((E=S.length-1)-v(this.e/u))*u,E=S[E])for(;E%10==0;E/=10,x--);return x<0&&(x=0),x},U.dividedBy=U.div=function(m,C){return $(this,new G(m,C),j,Z)},U.dividedToIntegerBy=U.idiv=function(m,C){return $(this,new G(m,C),0,1)},U.exponentiatedBy=U.pow=function(m,C){var S,x,E,R,N,M,A,L,V,z=this;if(m=new G(m),m.c&&!m.isInteger())throw Error(s+"Exponent not an integer: "+D(m));if(C!=null&&(C=new G(C)),M=m.e>14,!z.c||!z.c[0]||z.c[0]==1&&!z.e&&z.c.length==1||!m.c||!m.c[0])return V=new G(Math.pow(+D(z),M?m.s*(2-F(m)):+D(m))),C?V.mod(C):V;if(A=m.s<0,C){if(C.c?!C.c[0]:!C.s)return new G(NaN);x=!A&&z.isInteger()&&C.isInteger(),x&&(z=z.mod(C))}else{if(m.e>9&&(z.e>0||z.e<-1||(z.e==0?z.c[0]>1||M&&z.c[1]>=24e7:z.c[0]<8e13||M&&z.c[0]<=9999975e7)))return R=z.s<0&&F(m)?-0:0,z.e>-1&&(R=1/R),new G(A?1/R:R);Ae&&(R=r(Ae/u+2))}for(M?(S=new G(.5),A&&(m.s=1),L=F(m)):(E=Math.abs(+D(m)),L=E%2),V=new G(oe);;){if(L){if(V=V.times(z),!V.c)break;R?V.c.length>R&&(V.c.length=R):x&&(V=V.mod(C))}if(E){if(E=o(E/2),E===0)break;L=E%2}else if(m=m.times(S),T(m,m.e+1,1),m.e>14)L=F(m);else{if(E=+D(m),E===0)break;L=E%2}z=z.times(z),R?z.c&&z.c.length>R&&(z.c.length=R):x&&(z=z.mod(C))}return x?V:(A&&(V=oe.div(V)),C?V.mod(C):R?T(V,Ae,Z,N):V)},U.integerValue=function(m){var C=new G(this);return m==null?m=Z:_(m,0,8),T(C,C.e+1,m)},U.isEqualTo=U.eq=function(m,C){return P(this,new G(m,C))===0},U.isFinite=function(){return!!this.c},U.isGreaterThan=U.gt=function(m,C){return P(this,new G(m,C))>0},U.isGreaterThanOrEqualTo=U.gte=function(m,C){return(C=P(this,new G(m,C)))===1||C===0},U.isInteger=function(){return!!this.c&&v(this.e/u)>this.c.length-2},U.isLessThan=U.lt=function(m,C){return P(this,new G(m,C))<0},U.isLessThanOrEqualTo=U.lte=function(m,C){return(C=P(this,new G(m,C)))===-1||C===0},U.isNaN=function(){return!this.s},U.isNegative=function(){return this.s<0},U.isPositive=function(){return this.s>0},U.isZero=function(){return!!this.c&&this.c[0]==0},U.minus=function(m,C){var S,x,E,R,N=this,M=N.s;if(m=new G(m,C),C=m.s,!M||!C)return new G(NaN);if(M!=C)return m.s=-C,N.plus(m);var A=N.e/u,L=m.e/u,V=N.c,z=m.c;if(!A||!L){if(!V||!z)return V?(m.s=-C,m):new G(z?N:NaN);if(!V[0]||!z[0])return z[0]?(m.s=-C,m):new G(V[0]?N:Z==3?-0:0)}if(A=v(A),L=v(L),V=V.slice(),M=A-L){for((R=M<0)?(M=-M,E=V):(L=A,E=z),E.reverse(),C=M;C--;E.push(0));E.reverse()}else for(x=(R=(M=V.length)<(C=z.length))?M:C,M=C=0;C<x;C++)if(V[C]!=z[C]){R=V[C]<z[C];break}if(R&&(E=V,V=z,z=E,m.s=-m.s),C=(x=z.length)-(S=V.length),C>0)for(;C--;V[S++]=0);for(C=l-1;x>M;){if(V[--x]<z[x]){for(S=x;S&&!V[--S];V[S]=C);--V[S],V[x]+=l}V[x]-=z[x]}for(;V[0]==0;V.splice(0,1),--L);return V[0]?y(m,V,L):(m.s=Z==3?-1:1,m.c=[m.e=0],m)},U.modulo=U.mod=function(m,C){var S,x,E=this;return m=new G(m,C),!E.c||!m.s||m.c&&!m.c[0]?new G(NaN):!m.c||E.c&&!E.c[0]?new G(E):(Re==9?(x=m.s,m.s=1,S=$(E,m,0,3),m.s=x,S.s*=x):S=$(E,m,0,Re),m=E.minus(S.times(m)),!m.c[0]&&Re==1&&(m.s=E.s),m)},U.multipliedBy=U.times=function(m,C){var S,x,E,R,N,M,A,L,V,z,se,Q,ye,Be,et,Se=this,je=Se.c,rt=(m=new G(m,C)).c;if(!je||!rt||!je[0]||!rt[0])return!Se.s||!m.s||je&&!je[0]&&!rt||rt&&!rt[0]&&!je?m.c=m.e=m.s=null:(m.s*=Se.s,!je||!rt?m.c=m.e=null:(m.c=[0],m.e=0)),m;for(x=v(Se.e/u)+v(m.e/u),m.s*=Se.s,A=je.length,z=rt.length,A<z&&(ye=je,je=rt,rt=ye,E=A,A=z,z=E),E=A+z,ye=[];E--;ye.push(0));for(Be=l,et=d,E=z;--E>=0;){for(S=0,se=rt[E]%et,Q=rt[E]/et|0,N=A,R=E+N;R>E;)L=je[--N]%et,V=je[N]/et|0,M=Q*L+V*se,L=se*L+M%et*et+ye[R]+S,S=(L/Be|0)+(M/et|0)+Q*V,ye[R--]=L%Be;ye[R]=S}return S?++x:ye.splice(0,1),y(m,ye,x)},U.negated=function(){var m=new G(this);return m.s=-m.s||null,m},U.plus=function(m,C){var S,x=this,E=x.s;if(m=new G(m,C),C=m.s,!E||!C)return new G(NaN);if(E!=C)return m.s=-C,x.minus(m);var R=x.e/u,N=m.e/u,M=x.c,A=m.c;if(!R||!N){if(!M||!A)return new G(E/0);if(!M[0]||!A[0])return A[0]?m:new G(M[0]?x:E*0)}if(R=v(R),N=v(N),M=M.slice(),E=R-N){for(E>0?(N=R,S=A):(E=-E,S=M),S.reverse();E--;S.push(0));S.reverse()}for(E=M.length,C=A.length,E-C<0&&(S=A,A=M,M=S,C=E),E=0;C;)E=(M[--C]=M[C]+A[C]+E)/l|0,M[C]=l===M[C]?0:M[C]%l;return E&&(M=[E].concat(M),++N),y(m,M,N)},U.precision=U.sd=function(m,C){var S,x,E,R=this;if(m!=null&&m!==!!m)return _(m,1,f),C==null?C=Z:_(C,0,8),T(new G(R),m,C);if(!(S=R.c))return null;if(E=S.length-1,x=E*u+1,E=S[E]){for(;E%10==0;E/=10,x--);for(E=S[0];E>=10;E/=10,x++);}return m&&R.e+1>x&&(x=R.e+1),x},U.shiftedBy=function(m){return _(m,-c,c),this.times("1e"+m)},U.squareRoot=U.sqrt=function(){var m,C,S,x,E,R=this,N=R.c,M=R.s,A=R.e,L=j+4,V=new G("0.5");if(M!==1||!N||!N[0])return new G(!M||M<0&&(!N||N[0])?NaN:N?R:1/0);if(M=Math.sqrt(+D(R)),M==0||M==1/0?(C=b(N),(C.length+A)%2==0&&(C+="0"),M=Math.sqrt(+C),A=v((A+1)/2)-(A<0||A%2),M==1/0?C="5e"+A:(C=M.toExponential(),C=C.slice(0,C.indexOf("e")+1)+A),S=new G(C)):S=new G(M+""),S.c[0]){for(A=S.e,M=A+L,M<3&&(M=0);;)if(E=S,S=V.times(E.plus($(R,E,L,1))),b(E.c).slice(0,M)===(C=b(S.c)).slice(0,M))if(S.e<A&&--M,C=C.slice(M-3,M+1),C=="9999"||!x&&C=="4999"){if(!x&&(T(E,E.e+j+2,0),E.times(E).eq(R))){S=E;break}L+=4,M+=4,x=1}else{(!+C||!+C.slice(1)&&C.charAt(0)=="5")&&(T(S,S.e+j+2,1),m=!S.times(S).eq(R));break}}return T(S,S.e+j+1,Z,m)},U.toExponential=function(m,C){return m!=null&&(_(m,0,f),m++),g(this,m,C,1)},U.toFixed=function(m,C){return m!=null&&(_(m,0,f),m=m+this.e+1),g(this,m,C)},U.toFormat=function(m,C,S){var x,E=this;if(S==null)m!=null&&C&&typeof C=="object"?(S=C,C=null):m&&typeof m=="object"?(S=m,m=C=null):S=Ze;else if(typeof S!="object")throw Error(s+"Argument not an object: "+S);if(x=E.toFixed(m,C),E.c){var R,N=x.split("."),M=+S.groupSize,A=+S.secondaryGroupSize,L=S.groupSeparator||"",V=N[0],z=N[1],se=E.s<0,Q=se?V.slice(1):V,ye=Q.length;if(A&&(R=M,M=A,A=R,ye-=R),M>0&&ye>0){for(R=ye%M||M,V=Q.substr(0,R);R<ye;R+=M)V+=L+Q.substr(R,M);A>0&&(V+=L+Q.slice(R)),se&&(V="-"+V)}x=z?V+(S.decimalSeparator||"")+((A=+S.fractionGroupSize)?z.replace(new RegExp("\\d{"+A+"}\\B","g"),"$&"+(S.fractionGroupSeparator||"")):z):V}return(S.prefix||"")+x+(S.suffix||"")},U.toFraction=function(m){var C,S,x,E,R,N,M,A,L,V,z,se,Q=this,ye=Q.c;if(m!=null&&(M=new G(m),!M.isInteger()&&(M.c||M.s!==1)||M.lt(oe)))throw Error(s+"Argument "+(M.isInteger()?"out of range: ":"not an integer: ")+D(M));if(!ye)return new G(Q);for(C=new G(oe),L=S=new G(oe),x=A=new G(oe),se=b(ye),R=C.e=se.length-Q.e-1,C.c[0]=h[(N=R%u)<0?u+N:N],m=!m||M.comparedTo(C)>0?R>0?C:L:M,N=xe,xe=1/0,M=new G(se),A.c[0]=0;V=$(M,C,0,1),E=S.plus(V.times(x)),E.comparedTo(m)!=1;)S=x,x=E,L=A.plus(V.times(E=L)),A=E,C=M.minus(V.times(E=C)),M=E;return E=$(m.minus(S),x,0,1),A=A.plus(E.times(L)),S=S.plus(E.times(x)),A.s=L.s=Q.s,R=R*2,z=$(L,x,R,Z).minus(Q).abs().comparedTo($(A,S,R,Z).minus(Q).abs())<1?[L,x]:[A,S],xe=N,z},U.toNumber=function(){return+D(this)},U.toPrecision=function(m,C){return m!=null&&_(m,1,f),g(this,m,C,2)},U.toString=function(m){var C,S=this,x=S.s,E=S.e;return E===null?x?(C="Infinity",x<0&&(C="-"+C)):C="NaN":(m==null?C=E<=re||E>=pe?I(b(S.c),E):W(b(S.c),E,"0"):m===10&&ke?(S=T(new G(S),j+E+1,Z),C=W(b(S.c),S.e,"0")):(_(m,2,gt.length,"Base"),C=Y(W(b(S.c),E,"0"),10,m,x,!0)),x<0&&S.c[0]&&(C="-"+C)),C},U.valueOf=U.toJSON=function(){return D(this)},U._isBigNumber=!0,k!=null&&G.set(k),G}function v(k){var $=k|0;return k>0||k===$?$:$-1}function b(k){for(var $,Y,J=1,U=k.length,oe=k[0]+"";J<U;){for($=k[J++]+"",Y=u-$.length;Y--;$="0"+$);oe+=$}for(U=oe.length;oe.charCodeAt(--U)===48;);return oe.slice(0,U+1||1)}function P(k,$){var Y,J,U=k.c,oe=$.c,j=k.s,Z=$.s,re=k.e,pe=$.e;if(!j||!Z)return null;if(Y=U&&!U[0],J=oe&&!oe[0],Y||J)return Y?J?0:-Z:j;if(j!=Z)return j;if(Y=j<0,J=re==pe,!U||!oe)return J?0:!U^Y?1:-1;if(!J)return re>pe^Y?1:-1;for(Z=(re=U.length)<(pe=oe.length)?re:pe,j=0;j<Z;j++)if(U[j]!=oe[j])return U[j]>oe[j]^Y?1:-1;return re==pe?0:re>pe^Y?1:-1}function _(k,$,Y,J){if(k<$||k>Y||k!==o(k))throw Error(s+(J||"Argument")+(typeof k=="number"?k<$||k>Y?" out of range: ":" not an integer: ":" not a primitive number: ")+String(k))}function F(k){var $=k.c.length-1;return v(k.e/u)==$&&k.c[$]%2!=0}function I(k,$){return(k.length>1?k.charAt(0)+"."+k.slice(1):k)+($<0?"e":"e+")+$}function W(k,$,Y){var J,U;if($<0){for(U=Y+".";++$;U+=Y);k=U+k}else if(J=k.length,++$>J){for(U=Y,$-=J;--$;U+=Y);k+=U}else $<J&&(k=k.slice(0,$)+"."+k.slice($));return k}n=p(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(Kre)})(Fk);var Vk=Fk.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const eo=iM(),poe=tM(),woe=nM,voe=Vk,zn={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},Rg={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:Wk,decimalSuffixes:kw}=eo.currentBytes(),rM={general:{scale:1024,suffixes:kw},binary:{scale:1024,suffixes:Wk},decimal:{scale:1e3,suffixes:kw}};function Coe(t,e={},n){if(typeof e=="string"&&(e=woe.parseFormat(e)),!poe.validateFormat(e))return"ERROR: invalid format";let r=e.prefix||"",o=e.postfix||"",s=yoe(t,e,n);return s=Foe(s,r),s=Voe(s,o),s}function yoe(t,e,n){switch(e.output){case"currency":return e=Yc(e,eo.currentCurrencyDefaultFormat()),Poe(t,e,eo);case"percent":return e=Yc(e,eo.currentPercentageDefaultFormat()),Moe(t,e,eo,n);case"byte":return e=Yc(e,eo.currentByteDefaultFormat()),Eoe(t,e,eo,n);case"time":return e=Yc(e,eo.currentTimeDefaultFormat()),_oe(t);case"ordinal":return e=Yc(e,eo.currentOrdinalDefaultFormat()),Toe(t,e,eo);case"number":default:return Eg({instance:t,providedFormat:e})}}function boe(t){let e=rM.decimal;return nC(t._value,e.suffixes,e.scale).suffix}function Soe(t){let e=rM.binary;return nC(t._value,e.suffixes,e.scale).suffix}function Roe(t){let e=rM.general;return nC(t._value,e.suffixes,e.scale).suffix}function nC(t,e,n){let i=e[0],r=Math.abs(t);if(r>=n){for(let o=1;o<e.length;++o){let s=Math.pow(n,o),a=Math.pow(n,o+1);if(r>=s&&r<a){i=e[o],t=t/s;break}}i===e[0]&&(t=t/Math.pow(n,e.length-1),i=e[e.length-1])}return{value:t,suffix:i}}function Eoe(t,e,n,i){let r=e.base||"binary",o=Object.assign({},Rg,e);const{binarySuffixes:s,decimalSuffixes:a}=n.currentBytes();let u={general:{scale:1024,suffixes:a||kw,marker:"bd"},binary:{scale:1024,suffixes:s||Wk,marker:"b"},decimal:{scale:1e3,suffixes:a||kw,marker:"d"}}[r],{value:c,suffix:h}=nC(t._value,u.suffixes,u.scale);return`${Eg({instance:i(c),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${h}`}function Toe(t,e,n){let i=n.currentOrdinal(),r=Object.assign({},Rg,e),o=Eg({instance:t,providedFormat:e,state:n}),s=i(t._value);return`${o}${r.spaceSeparated?" ":""}${s}`}function _oe(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),i=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${i<10?"0":""}${i}`}function Moe(t,e,n,i){let r=e.prefixSymbol,o=Eg({instance:i(t._value*100),providedFormat:e,state:n}),s=Object.assign({},Rg,e);return r?`%${s.spaceSeparated?" ":""}${o}`:`${o}${s.spaceSeparated?" ":""}%`}function Poe(t,e,n){const i=n.currentCurrency();let r=Object.assign({},e),o=Object.assign({},Rg,r),s,a="",l=!!o.totalLength||!!o.forceAverage||o.average,u=r.currencyPosition||i.position,c=r.currencySymbol||i.symbol;const h=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;r.lowPrecision===void 0&&(r.lowPrecision=!1),h&&(a=" "),u==="infix"&&(s=a+c+a);let d=Eg({instance:t,providedFormat:r,state:n,decimalSeparator:s});return u==="prefix"&&(t._value<0&&o.negative==="sign"?d=`-${a}${c}${d.slice(1)}`:t._value>0&&o.forceSign?d=`+${a}${c}${d.slice(1)}`:d=c+a+d),(!u||u==="postfix")&&(a=!o.spaceSeparatedAbbreviation&&l?"":a,d=d+a+c),d}function Ioe({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:i,spaceSeparated:r=!1,totalLength:o=0,roundingFunction:s=Math.round}){let a="",l=Math.abs(t),u=-1;if(e&&i[e]&&zn[e]?(a=i[e],t=t/zn[e]):l>=zn.trillion||n&&s(l/zn.trillion)===1?(a=i.trillion,t=t/zn.trillion):l<zn.trillion&&l>=zn.billion||n&&s(l/zn.billion)===1?(a=i.billion,t=t/zn.billion):l<zn.billion&&l>=zn.million||n&&s(l/zn.million)===1?(a=i.million,t=t/zn.million):(l<zn.million&&l>=zn.thousand||n&&s(l/zn.thousand)===1)&&(a=i.thousand,t=t/zn.thousand),a&&(a=(r?" ":"")+a),o){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;u=Math.max(o-f,0)}return{value:t,abbreviation:a,mantissaPrecision:u}}function xoe({value:t,characteristicPrecision:e}){let[n,i]=t.toExponential().split("e"),r=+n;if(!e)return{value:r,abbreviation:`e${i}`};let o=1;return o<e&&(r=r*Math.pow(10,e-o),i=+i-(e-o),i=i>=0?`+${i}`:i),{value:r,abbreviation:`e${i}`}}function Im(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function Ooe(t,e){let n=t.toString(),[i,r]=n.split("e"),[o,s=""]=i.split(".");if(+r>0)n=o+s+Im(r-s.length);else{let a=".";+o<0?a=`-0${a}`:a=`0${a}`;let l=(Im(-r-1)+Math.abs(o)+s).substr(0,e);l.length<e&&(l+=Im(e-l.length)),n=a+l}return+r>0&&e>0&&(n+=`.${Im(e)}`),n}function Aoe(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?Ooe(t,e):new voe(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function Hoe(t,e,n,i,r,o){if(i===-1)return t;let s=Aoe(e,i,o),[a,l=""]=s.toString().split(".");if(l.match(/^0+$/)&&(n||r))return a;let u=l.match(/0+$/);return r&&u?`${a}.${l.toString().slice(0,u.index)}`:s.toString()}function Noe(t,e,n,i){let r=t,[o,s]=r.toString().split(".");if(o.match(/^-?0$/)&&n)return s?`${o.replace("0","")}.${s}`:o.replace("0","");const a=e<0&&o.indexOf("-")===0;if(a&&(o=o.slice(1),r=r.slice(1)),o.length<i){let l=i-o.length;for(let u=0;u<l;u++)r=`0${r}`}return a&&(r=`-${r}`),r.toString()}function Doe(t,e){let n=[],i=0;for(let r=t;r>0;r--)i===e&&(n.unshift(r),i=0),i++;return n}function $oe(t,e,n,i,r){let o=i.currentDelimiters(),s=o.thousands;r=r||o.decimal;let a=o.thousandsSize||3,l=t.toString(),u=l.split(".")[0],c=l.split(".")[1];const h=e<0&&u.indexOf("-")===0;return n&&(h&&(u=u.slice(1)),Doe(u.length,a).forEach((f,p)=>{u=u.slice(0,f+p)+s+u.slice(f+p)}),h&&(u=`-${u}`)),c?l=u+r+c:l=u,l}function koe(t,e){return t+e}function Loe(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function Foe(t,e){return e+t}function Voe(t,e){return t+e}function Eg({instance:t,providedFormat:e,state:n=eo,decimalSeparator:i,defaults:r=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let s=Object.assign({},Rg,r,e),a=s.totalLength,l=a?0:s.characteristic,u=s.optionalCharacteristic,c=s.forceAverage,h=s.lowPrecision,d=!!a||!!c||s.average,f=a?-1:d&&e.mantissa===void 0?0:s.mantissa,p=a?!1:e.optionalMantissa===void 0?f===-1:s.optionalMantissa,v=s.trimMantissa,b=s.thousandSeparated,P=s.spaceSeparated,_=s.negative,F=s.forceSign,I=s.exponential,W=s.roundingFunction,k="";if(d){let Y=Ioe({value:o,forceAverage:c,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:P,roundingFunction:W,totalLength:a});o=Y.value,k+=Y.abbreviation,a&&(f=Y.mantissaPrecision)}if(I){let Y=xoe({value:o,characteristicPrecision:l});o=Y.value,k=Y.abbreviation+k}let $=Hoe(o.toString(),o,p,f,v,W);return $=Noe($,o,u,l),$=$oe($,o,b,n,i),(d||I)&&($=koe($,k)),(F||o<0)&&($=Loe($,o,_)),$}function Yc(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var Woe=t=>({format:(...e)=>Coe(...e,t),getByteUnit:(...e)=>Roe(...e,t),getBinaryByteUnit:(...e)=>Soe(...e,t),getDecimalByteUnit:(...e)=>boe(...e,t),formatOrDefault:Yc});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const ta=Vk;function Boe(t,e,n){let i=new ta(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new ta(r),t._value=i.plus(r).toNumber(),t}function Bk(t,e,n){let i=new ta(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new ta(r),t._value=i.minus(r).toNumber(),t}function joe(t,e,n){let i=new ta(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new ta(r),t._value=i.times(r).toNumber(),t}function Uoe(t,e,n){let i=new ta(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new ta(r),t._value=i.dividedBy(r).toNumber(),t}function zoe(t,e,n){let i=e;return n.isNumbro(e)&&(i=e._value),t._value=i,t}function Yoe(t,e,n){let i=n(t._value);return Bk(i,e,n),Math.abs(i._value)}var Goe=t=>({add:(e,n)=>Boe(e,n,t),subtract:(e,n)=>Bk(e,n,t),multiply:(e,n)=>joe(e,n,t),divide:(e,n)=>Uoe(e,n,t),set:(e,n)=>zoe(e,n,t),difference:(e,n)=>Yoe(e,n,t),BigNumber:ta});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Koe="2.5.0",ms=iM(),Xoe=tM(),qoe=moe(on),Zoe=Lk();let Sl=Woe(on),Jl=Goe(on);const Joe=nM;class jk{constructor(e){this._value=e}clone(){return on(this._value)}format(e={}){return Sl.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=Joe.parseFormat(e)),e=Sl.formatOrDefault(e,ms.currentCurrencyDefaultFormat()),e.output="currency",Sl.format(this,e)}formatTime(e={}){return e.output="time",Sl.format(this,e)}binaryByteUnits(){return Sl.getBinaryByteUnit(this)}decimalByteUnits(){return Sl.getDecimalByteUnit(this)}byteUnits(){return Sl.getByteUnit(this)}difference(e){return Jl.difference(this,e)}add(e){return Jl.add(this,e)}subtract(e){return Jl.subtract(this,e)}multiply(e){return Jl.multiply(this,e)}divide(e){return Jl.divide(this,e)}set(e){return Jl.set(this,Uk(e))}value(){return this._value}valueOf(){return this._value}}function Uk(t){let e=t;return on.isNumbro(t)?e=t._value:typeof t=="string"?e=on.unformat(t):isNaN(t)&&(e=NaN),e}function on(t){return new jk(Uk(t))}on.version=Koe;on.isNumbro=function(t){return t instanceof jk};on.language=ms.currentLanguage;on.registerLanguage=ms.registerLanguage;on.setLanguage=ms.setLanguage;on.languages=ms.languages;on.languageData=ms.languageData;on.zeroFormat=ms.setZeroFormat;on.defaultFormat=ms.currentDefaults;on.setDefaults=ms.setDefaults;on.defaultCurrencyFormat=ms.currentCurrencyDefaultFormat;on.validate=Xoe.validate;on.loadLanguagesInNode=qoe.loadLanguagesInNode;on.unformat=Zoe.unformat;on.BigNumber=Jl.BigNumber;var Qoe=on,Rl=Xre(Qoe);const ese="numeric";function zk(t,e){if(Ci(t)){const n=e.numericFormat,i=n&&n.culture||"-",r=n&&n.pattern;if(typeof i<"u"&&!Rl.languages()[i]){const o=i.replace("-",""),s=Rl.allLanguages?Rl.allLanguages[i]:Rl[o];s&&Rl.registerLanguage(s)}Rl.setLanguage(i),t=Rl(t).format(r||"0")}return t}function oM(t,e,n,i,r,o,s){let a=o;if(Ci(a)){let u=[];if(Array.isArray(s.className))u=s.className;else{var l;const c=(l=s.className)!==null&&l!==void 0?l:"";c.length&&(u=c.split(" "))}a=zk(a,s),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),s.className=u.join(" "),e.dir="ltr"}ua(t,e,n,i,r,a,s)}oM.RENDERER_TYPE=ese;const tse="password";function sM(t,e,n,i,r,o,s){ua.apply(this,[t,e,n,i,r,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";he(a-1,()=>{u+=l}),Yu(e,u)}sM.RENDERER_TYPE=tse;const nse="select";function aM(t,e,n,i,r,o,s){ua.apply(this,[t,e,n,i,r,o,s])}aM.RENDERER_TYPE=nse;const ise="time";function lM(t,e,n,i,r,o,s){ua.apply(this,[t,e,n,i,r,o,s]),e.dir="ltr"}lM.RENDERER_TYPE=ise;function rse(){Rr(zh),Rr(Sg),Rr(J_),Rr(Z_),Rr(eM),Rr(q_),Rr(oM),Rr(sM),Rr(aM),Rr(ua),Rr(lM)}const ose="autocomplete";function iC(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,KO(n,e)):KO(n,e)(this.source):e(!0)}iC.VALIDATOR_TYPE=ose;function KO(t,e){const n=t;return function(i){let r=!1;for(let o=0,s=i.length;o<s;o++)if(Vv(n,i[o])){r=!0;break}e(r)}}function sse(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const ase="date";function uM(t,e){const n=d$(xk,this.instance);let i=t,r=!0;i==null&&(i="");let o=K(i,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=K(new Date(i)).isValid()||o;if(this.allowEmpty&&i===""&&(s=!0,o=!0),s||(r=!1),!s&&o&&(r=!0),s&&!o)if(this.correctFormat===!0){const a=lse(i,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),r=!0}else r=!1;e(r)}uM.VALIDATOR_TYPE=ase;function lse(t,e){const n=K(sse(t)),i=K(t,e),r=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===i.format("x")||!i.isValid()||r?o=n:o=i,o.format(e)}const use="dropdown";function cM(t,e){iC.apply(this,[t,e])}cM.VALIDATOR_TYPE=use;const cse="numeric";function hM(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Ci(t))}hM.VALIDATOR_TYPE=cse;const hse=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],dse="time";function dM(t,e){const n=this.timeFormat||"h:mm:ss a";let i=!0,r=t;r===null&&(r=""),r=/^\d{3,}$/.test(r)?parseInt(r,10):r;const o=/^\d{1,2}$/.test(r);o&&(r+=":00");const s=K(r,hse,!0).isValid()?K(r):K(r,n);let a=s.isValid(),l=K(r,n,!0).isValid()&&!o;if(this.allowEmpty&&r===""&&(a=!0,l=!0),a||(i=!1),!a&&l&&(i=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),i=!0}else i=!1;e(i)}dM.VALIDATOR_TYPE=dse;function fse(){zc(iC),zc(cM),zc(uM),zc(hM),zc(dM)}function Yk(t){return me(t)&&t.value!==void 0?t.value:t}function Gk(t,e,n){const i=this.getSourceDataAtCell(this.toPhysicalRow(e),this.toPhysicalColumn(n)),r=o=>me(o)&&te(o.key)&&te(o.value);return r(i)?r(t)?t:{key:t,value:t}:t}const gse="autocomplete",mse={CELL_TYPE:gse,editor:K_,renderer:zh,validator:iC,valueGetter:Yk,valueSetter:Gk};function pse(t,e,n){const{checkedTemplate:i,uncheckedTemplate:r}=this.getCellMeta(e,n),o=Tt(t),s=o===Tt(i),a=o===Tt(r);return s||a?s?i:r:t}const wse="checkbox",vse={CELL_TYPE:wse,editor:Ik,renderer:J_,valueSetter:pse},Cse="date";function Kk(t,e,n,i,r,o,s){zh.apply(this,[t,e,n,i,r,o,s])}Kk.RENDERER_TYPE=Cse;const yse="date",bse={CELL_TYPE:yse,editor:Ok,renderer:Kk,validator:uM};function Sse(t){return Yk.call(this,t)}function Rse(t,e,n,i){return Gk.call(this,t,e,n,i)}const Ese="dropdown",Tse={CELL_TYPE:Ese,editor:Ak,renderer:Z_,validator:cM,filter:!1,strict:!0,valueGetter:Sse,valueSetter:Rse},_se="handsontable",Mse={CELL_TYPE:_se,editor:G_,renderer:eM};function Pse(t){if(typeof t=="string"&&k5(t)){const e=L5(t);return rf(e)?t:e}return t}const Ise="numeric",xse={CELL_TYPE:Ise,editor:Hk,renderer:oM,validator:hM,dataType:"number",valueSetter:Pse},Ose="password",Ase={CELL_TYPE:Ose,editor:Nk,renderer:sM,copyable:!1},Hse="select",Nse={CELL_TYPE:Hse,editor:Dk,renderer:aM},Dse="time",$se={CELL_TYPE:Dse,editor:$k,renderer:lM,validator:dM};function kse(){qr(mse),qr(vse),qr(bse),qr(Tse),qr(Mse),qr(xse),qr(Ase),qr(Nse),qr(vk),qr($se)}function Lse(t,e){Xk(t,e),e.add(t)}function hc(t,e,n){return(e=Fse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fse(t){var e=Vse(t,"string");return typeof e=="symbol"?e:e+""}function Vse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function XO(t,e,n){Xk(t,e),e.set(t,n)}function Xk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xm(t,e,n){return t.set(fM(t,e),n),n}function Zt(t,e){return t.get(fM(t,e))}function fM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const qO=new Map([["plugin",K5],["cell-type",sk],["editor",h$],["renderer",v$],["validator",C$]]),qk=Symbol("mainSetting"),Wse="base",Om=[];let El=null;var an=new WeakMap,Tl=new WeakMap,ZO=new WeakSet;class qe{static get PLUGIN_KEY(){return Wse}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}static get SETTINGS_VALIDATORS(){return null}constructor(e){Lse(this,ZO),XO(this,an,null),hc(this,"eventManager",new wo(this)),hc(this,"pluginName",null),hc(this,"pluginsInitializedCallbacks",[]),hc(this,"isPluginsReady",!1),hc(this,"enabled",!1),hc(this,"initialized",!1),XO(this,Tl,{}),aa(this,"hot",e,{writable:!1}),El=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this),this.updatePluginSettings(this.hot.getSettings()[this.constructor.PLUGIN_KEY]);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const r=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!qO.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);qO.get(s)(a)||r.push(` - ${a} (${s})`)}),r.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${r.join(`
`)}
`].join("");Om.push(o)}}if(El||(El=w$()),El.indexOf(this.pluginName)>=0&&El.splice(El.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),El.length===0){if(Om.length>0){const r=[`${Om.join(`
`)}
`,"You have to import and register them manually."].join("");throw Om.length=0,new Error(r)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){var n=this;const i=this.constructor.DEFAULT_SETTINGS,r=this.constructor.SETTINGS_VALIDATORS;if(e===void 0)return me(Zt(an,this))?Fp(Zt(an,this),i):Zt(an,this);let o;if((Array.isArray(Zt(an,this))||me(Zt(an,this)))&&i[qk]===e)if(Array.isArray(Zt(an,this)))o=Zt(an,this);else{var s;o=(s=Zt(an,this)[e])!==null&&s!==void 0?s:i[e]}else if(e.includes(".")){const a=bR(Zt(an,this),e),l=bR(i,e);me(a)?o=Fp(a,l):o=a!==void 0?a:l}else me(Zt(an,this))?o=Fp(Zt(an,this),i)[e]:o=i[e];if(typeof o=="function"&&r&&typeof r=="object"){const a=r[e];if(a&&typeof a=="function")return function(){for(var l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];const h=o(...u);if(a(h)===!1){const f=u.map(v=>typeof v=="string"?`"${v}"`:"").join(", "),p=u.length>0?f:"";$e(`${n.pluginName} Plugin: "${e}" function (${p}) result                is not valid and will be ignored.`);return}return h}}return o}updatePluginSettings(e){const n=this.constructor.SETTINGS_VALIDATORS;if(n&&typeof n=="function"&&typeof e!="object"){if(n(e)===!1){$e(`${this.pluginName} Plugin: option is not valid and it will be ignored.`);return}return xm(an,this,e),Zt(an,this)}return n&&typeof n=="object"&&typeof e=="object"?((Zt(an,this)===null||typeof Zt(an,this)!="object")&&xm(an,this,{...this.constructor.DEFAULT_SETTINGS}),Object.keys(n).forEach(i=>{if(!(i in e))return;const r=n[i];if((r?r(e[i]):!0)===!1){$e(`${this.pluginName} Plugin: "${i}" option is not valid and it will be ignored.`);return}Zt(an,this)[i]=e[i]}),Zt(an,this)):(xm(an,this,e),e)}addHook(e,n,i){Zt(Tl,this)[e]=Zt(Tl,this)[e]||[];const r=Zt(Tl,this)[e];this.hot.addHook(e,n,i),r.push(n),Zt(Tl,this)[e]=r}removeHooks(e){O(Zt(Tl,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Zt(Tl,this);We(e,(n,i)=>this.removeHooks(i)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){O(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=fM(ZO,this,Bse).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&(this.updatePluginSettings(e[this.constructor.PLUGIN_KEY]),this.updatePlugin(e)))}updatePlugin(){}destroy(){var e;xm(an,this,null),(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),We(this,(n,i)=>{i!=="hot"&&(this[i]=null)}),delete this.t,delete this.hot}}function Bse(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function _l(t,e,n){return(e=jse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jse(t){var e=Use(t,"string");return typeof e=="symbol"?e:e+""}function Use(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Zk=class{constructor(e){_l(this,"hot",null),_l(this,"container",null),_l(this,"injected",!1),_l(this,"rows",[]),_l(this,"columns",[]),_l(this,"samples",null),_l(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={row:e};this.rows.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={col:e};this.columns.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}getHeights(e){this.injected||this.injectTable(),O(this.rows,n=>{const{height:i}=n.table.getBoundingClientRect();e(n.row,Math.ceil(i))})}getWidths(e){this.injected||this.injectTable(),O(this.columns,n=>{const{width:i}=n.table.getBoundingClientRect();e(n.col,Math.ceil(i))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(i=>{O(i.strings,r=>{n.appendChild(this.createColElement(r.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,r),i.appendChild(r)),this.samples.forEach(o=>{O(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),i.appendChild(c)})}),i}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){const r=e.createElement("th");i.push([-1,r]),n.appendChild(r)}this.samples.forEach(r=>{O(r.strings,o=>{const s=o.col,a=e.createElement("th");i.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),O(i,r=>{const[o,s]=r;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,i=n.createDocumentFragment();return this.samples.forEach(r=>{O(r.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e),l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),i.appendChild(c)})}),i}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const i=this.hot.rootDocument.createElement("col");let r=0;n>=0&&e>=0&&(r=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(r>1)for(let s=e+1;s<e+r;s++)o+=this.hot.getColWidth(s);return i.style.width=`${o}px`,i}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&r.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(o),this.isVertical()&&s.appendChild(l),r.appendChild(s),B(r,e),i.appendChild(r),{fragment:i,table:r,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return B(r,o),i.appendChild(r),{fragment:i,container:r}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function Sd(t,e,n){return(e=zse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zse(t){var e=Yse(t,"string");return typeof e=="symbol"?e:e+""}function Yse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rC{static get SAMPLE_COUNT(){return 3}constructor(e){Sd(this,"samples",null),Sd(this,"dataFactory",null),Sd(this,"customSampleCount",null),Sd(this,"allowDuplicates",!1),Sd(this,"includeHidden",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:rC.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}setIncludeHidden(e){this.includeHidden=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,i){const r=new Map,{from:o,to:s}=typeof i=="number"?{from:i,to:i}:i;return he(o,s,a=>{const l=this.generateSample(e,n,a);r.set(a,l)}),r}generateSample(e,n,i){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const r=new Map,o=e==="row"?"col":"row",s=[];return he(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(i,a,this):this.dataFactory(a,i,this);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:me(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Tt(u).length}`,r.has(d)||r.set(d,{needed:this.getSampleCount(),strings:[]});const f=r.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),r}}function Gse(t,e){Jk(t,e),e.add(t)}function fb(t,e,n){Jk(t,e),e.set(t,n)}function Jk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rd(t,e,n){return(e=Kse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kse(t){var e=Xse(t,"string");return typeof e=="symbol"?e:e+""}function Xse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ka(t,e){return t.get(ki(t,e))}function Lw(t,e,n){return t.set(ki(t,e),n),n}function ki(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("modifyAutoColumnSizeSeed");const gb="autoColumnSize",qse=10,Zse="autoColumnSize";var gM=new WeakMap,Gc=new WeakMap,xh=new WeakMap,tr=new WeakSet;class vf extends qe{static get PLUGIN_KEY(){return gb}static get PLUGIN_PRIORITY(){return qse}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Gse(this,tr),Rd(this,"ghostTable",new Zk(this.hot)),Rd(this,"samplesGenerator",new rC((n,i)=>{const r=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,i);let a="";s.spanned||(a=this.hot.getDataAtCell(n,i));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),Rd(this,"inProgress",!1),Rd(this,"measuredColumns",0),Rd(this,"columnWidthsMap",new ll),fb(this,gM,!1),fb(this,Gc,[]),fb(this,xh,[]),this.hot.columnIndexMapper.registerMap(Zse,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,i,r)=>ki(tr,this,JO).call(this,n,i,r))}isEnabled(){return this.hot.getSettings()[gb]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return ki(tr,e,eae).call(e,...r)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return ki(tr,e,tae).call(e,...r)}),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return ki(tr,e,iae).call(e,...r)}),this.addHook("beforeRender",()=>ki(tr,this,Qse).call(this)),this.addHook("modifyColWidth",(i,r)=>this.getColumnWidth(r,i)),this.addHook("init",()=>ki(tr,this,nae).call(this)),super.enablePlugin()}updatePlugin(){Lw(xh,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,i)=>ki(tr,this,JO).call(this,e,n,i))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const i=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,i)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;he(r.from,r.to,s=>{let a=this.hot.toPhysicalColumn(s);a===null&&(a=s),(i||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&ki(tr,this,Qk).call(this,s,o)}),this.ghostTable.columns.length&&(ki(tr,this,eL).call(this),this.measuredColumns=r.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const r=this.hot.countCols()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){yw(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:i,to:Math.min(i+vf.CALCULATION_STEP,r)},e,n),i=i+vf.CALCULATION_STEP+1,i<r?o=Cw(s):(yw(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),i=a+1),i<r?s():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[gb];let n=vf.SYNC_CALCULATION_LIMIT;const i=this.hot.countCols()-1;return me(e)&&(n=e.syncLimit,xD(n)?n=g$(i,n):n>>=0),Math.min(n,i)}getColumnWidth(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=n;return r===void 0&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),i&&typeof r=="number"&&(r=Math.max(r,Rh))),r}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((i,r,o)=>{const s=Ka(Gc,this).length;return(s-1<o||Ka(Gc,this)[o]!==r)&&i.push(this.hot.toVisualColumn(o)),s-1<o?Ka(Gc,this).push(r):Ka(Gc,this)[o]=r,i},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Jse(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const i=this.hot.toPhysicalColumn(n);i!==null&&(this.hot._getColWidthFromSettings(i)||ki(tr,this,Qk).call(this,n,e))}),this.ghostTable.columns.length&&(ki(tr,this,eL).call(this),this.ghostTable.clean())}function Qk(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((i,r)=>this.ghostTable.addColumn(r,i))}function eL(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function Qse(){this.calculateVisibleColumnsWidth(),this.inProgress||(ki(tr,this,Jse).call(this,Ka(xh,this)),Lw(xh,this,[]))}function eae(t,e){e||this.recalculateAllColumnsWidth()}function tae(t){const e=t.reduce((n,i)=>{let[,r]=i;const o=this.hot.propToCol(r);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);Ka(xh,this).push(...e)}function JO(t,e,n){let i=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),i=this.getColumnWidth(e,void 0,!1)),i}function nae(){Lw(Gc,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),Lw(gM,this,!0)}function iae(t){if(!Ka(gM,this))return;const e=t.reduce((n,i)=>{var r;const o=(r=i.address)===null||r===void 0?void 0:r.col;if(Number.isInteger(o)){const s=this.hot.toVisualColumn(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Ka(xh,this).push(...e)}const du={horizontal:"horizontal",vertical:"vertical"};function rae(t,e,n){let i,r,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",i=n(e[0],e[1]),r=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",i=n(e[0],t[3]+1),r=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",i=n(e[0],e[1]),r=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",i=n(t[2]+1,e[1]),r=n(e[2],e[3])),i&&i.normalize(),r&&r.normalize(),{directionOfDrag:o,startOfDragCoords:i,endOfDragCoords:r}}function oae(t){const e={};return t===!0?(e.directions=Object.keys(du),e.autoInsertRow=!0):me(t)?(te(t.autoInsertRow)?t.direction===du.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,te(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(du)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function sae(t,e){aae(t,e),e.add(t)}function aae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dc(t,e,n){return(e=lae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lae(t){var e=uae(t,"string");return typeof e=="symbol"?e:e+""}function uae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("modifyAutofillRange");ie.getSingleton().register("beforeAutofill");ie.getSingleton().register("afterAutofill");const QO="autofill",cae=20,hae=["fillHandle"],dae="insert_row_below",fae=200;var Ml=new WeakSet;class gae extends qe{constructor(){super(...arguments),sae(this,Ml),dc(this,"addingStarted",!1),dc(this,"mouseDownOnCellCorner",!1),dc(this,"mouseDragOutside",!1),dc(this,"handleDraggedCells",0),dc(this,"directions",[]),dc(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return QO}static get PLUGIN_PRIORITY(){return cae}static get SETTING_KEYS(){return[QO,...hae]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>fc(Ml,this,wae).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>fc(Ml,this,pae).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>fc(Ml,this,vae).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.hot.getSelectedRangeLast(),{row:i,col:r}=n.getTopStartCorner(),{row:o,col:s}=n.getBottomEndCorner(),a=this.hot.runHooks("modifyCopyableRange",[{startRow:i,startCol:r,endRow:o,endCol:s}]),l=[],u=[],c=[];return O(a,h=>{for(let d=h.startRow;d<=h.endRow;d+=1)l.indexOf(d)===-1&&l.push(d);for(let d=h.startCol;d<=h.endCol;d+=1)u.indexOf(d)===-1&&u.push(d)}),O(l,h=>{const d=[];O(u,f=>{const p=e?this.hot.getSourceDataAtCell(h,f):null;e&&me(p)?d.push(this.hot.getCopyableSourceData(h,f)):d.push(this.hot.getCopyableData(h,f))}),c.push(d)}),c}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,i,r]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,i),Math.max(a.col,r)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=rae(l,u,(f,p)=>this.hot._createCellCoords(f,p));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),p=this.getSelectionData(!0),v=o.clone(),b=this.hot._createCellRange(h,h,d),P=this.hot.runHooks("beforeAutofill",f,v,b,c);if(P===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let _=P;const F=P;if(["up","left"].indexOf(c)>-1&&!(F.length===1&&F[0].length===0))if(_=[],c==="up"){const I=d.row-h.row+1,W=I%F.length;for(let k=0;k<I;k++)_.push(F[(k+(F.length-W))%F.length])}else{const I=d.col-h.col+1,W=I%F[0].length;for(let k=0;k<F.length;k++){_.push([]);for(let $=0;$<I;$++)_[k].push(F[k][($+(F[k].length-W))%F[k].length])}}if(p.some(I=>I.some(W=>me(W)))){const I=fc(Ml,this,mae).call(this,_,p,h,d,c);I.length&&(_=I)}this.hot.populateFromArray(h.row,h.col,_,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",_,v,b,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),i=n.getBottomEndCorner();let r=e;if(this.directions.includes(du.vertical)&&this.directions.includes(du.horizontal)){const o=n.getTopStartCorner();(i.col<=e.col||o.col>=e.col)&&(r=this.hot._createCellCoords(i.row,e.col)),(i.row<e.row||o.row>e.row)&&(r=this.hot._createCellCoords(e.row,i.col))}else if(this.directions.includes(du.vertical))r=this.hot._createCellCoords(e.row,i.col);else if(this.directions.includes(du.horizontal))r=this.hot._createCellCoords(i.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(r)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(dae,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},fae)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();e[2]<i-1&&n[2]===i-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),i=this.hot.countRows();let r;for(let o=e[2]+1;o<i;o++){for(let l=e[1];l<=e[3];l++){const u=n[o][l];if(!rn(u))return-1}const s=n[o][e[1]-1],a=n[o][e[3]+1];(!rn(s)||!rn(a))&&(r=o)}return r}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...tt(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,i=oi(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+yn(this.hot.table),r=oi(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+cn(this.hot.table);return e.clientY>i&&e.clientX<=r}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>fc(Ml,this,Cae).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>fc(Ml,this,yae).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=oae(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function mae(t,e,n,i){const r=[];for(let o=Math.min(n.row,i.row);o<=Math.max(n.row,i.row);o+=1){r.push([]);for(let s=Math.min(n.col,i.col);s<=Math.max(n.col,i.col);s+=1){const a=this.hot.getSourceDataAtCell(o,s),l=o-Math.min(n.row,i.row),u=s-Math.min(n.col,i.col),c=l%e.length,h=u%e[0].length;me(a)?r[l][u]=e[c][h]:r[l][u]=t[c][h]}}return r}function pae(){this.selectAdjacent()&&this.fillIn()}function wae(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function vae(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function Cae(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function yae(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function bae(t,e){tL(t,e),e.add(t)}function eA(t,e,n){tL(t,e),e.set(t,n)}function tL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gc(t,e,n){return(e=Sae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sae(t){var e=Rae(t,"string");return typeof e=="symbol"?e:e+""}function Rae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nL(t,e,n){return t.set(ir(t,e),n),n}function Fw(t,e){return t.get(ir(t,e))}function ir(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const mb="autoRowSize",Eae=40,Tae="autoRowSize",tA="htFirstDatasetColumnNotRendered",nA="htAutoRowSize";var Gf=new WeakMap,mM=new WeakMap,Er=new WeakSet;class Cf extends qe{static get PLUGIN_KEY(){return mb}static get PLUGIN_PRIORITY(){return Eae}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),bae(this,Er),gc(this,"headerHeight",null),gc(this,"ghostTable",new Zk(this.hot)),gc(this,"samplesGenerator",new rC((n,i)=>{const r=this.hot.toPhysicalColumn(i);if(this.hot.columnIndexMapper.isHidden(r)||n>=0&&i>=0&&this.hot.getCellMeta(n,i).hidden)return!1;let o;return n>=0?o=this.hot.getDataAtCell(n,i):n===-1&&(o=this.hot.getColHeader(i)),{value:o}})),gc(this,"inProgress",!1),gc(this,"measuredRows",0),gc(this,"rowHeightsMap",new ll),eA(this,Gf,[]),eA(this,mM,!1),this.hot.rowIndexMapper.registerMap(Tae,this.rowHeightsMap),this.addHook("beforeRowResize",(n,i,r)=>ir(Er,this,iA).call(this,n,i,r))}isEnabled(){const e=this.hot.getSettings()[mb];return e===!0||me(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return ir(Er,e,Iae).call(e,...r)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return ir(Er,e,xae).call(e,...r)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return ir(Er,e,Aae).call(e,...r)}),this.addHook("beforeViewRender",()=>ir(Er,this,Mae).call(this)),this.addHook("beforeRender",()=>ir(Er,this,Pae).call(this)),this.addHook("modifyRowHeight",(i,r)=>this.getRowHeight(r,i)),this.addHook("init",()=>ir(Er,this,Oae).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),B(this.hot.rootElement,nA),super.enablePlugin()}disablePlugin(){this.headerHeight=null,ae(this.hot.rootElement,nA),super.disablePlugin(),ir(Er,this,iL).call(this,!1),this.addHook("beforeRowResize",(e,n,i)=>ir(Er,this,iA).call(this,e,n,i))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const i=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,i)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}he(r.from,r.to,s=>{let a=this.hot.toPhysicalRow(s);a===null&&(a=s),(i||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(s,o).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=r.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const r=this.hot.countRows()-1;let o=null;this.inProgress=!0;const s=()=>{if(!this.hot){yw(o),this.inProgress=!1;return}this.calculateRowsHeight({from:i,to:Math.min(i+Cf.CALCULATION_STEP,r)},e,n),i=i+Cf.CALCULATION_STEP+1,i<r?o=Cw(s):(yw(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),i=a+1),i<r?s():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[mb];let n=Cf.SYNC_CALCULATION_LIMIT;const i=this.hot.countRows()-1;return me(e)&&(n=e.syncLimit,xD(n)?n=g$(i,n):n>>=0),Math.min(n,i)}getRowHeight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.stylesHandler.getDefaultRowHeight(e);if(e<0){var i;return(i=this.headerHeight)!==null&&i!==void 0?i:n}const r=this.hot.toPhysicalRow(e);if(this.hot.rowIndexMapper.isHidden(r))return n;const o=this.rowHeightsMap.getValueAtIndex(r);let s=n;return o!==null&&o>n&&(s=o,!this.hot.stylesHandler.isClassicTheme()&&e===this.hot.view.getFirstRenderedVisibleRow()&&(s+=1)),s}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:i}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{he(Math.min(n,i),Math.max(n,i),r=>{this.rowHeightsMap.setValueAtIndex(r,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function _ae(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((r,o)=>this.ghostTable.addRow(o,r))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,i)=>{const r=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(r,i)})},!0),this.ghostTable.clean())}function iL(t){const e=this.hot.getFirstRenderedVisibleColumn(),n=this.hot.columnIndexMapper.getPhysicalFromVisualIndex(e);t===!1||n===this.hot.columnIndexMapper.getPhysicalFromRenderableIndex(0)?ae(this.hot.rootElement,tA):B(this.hot.rootElement,tA)}function Mae(){ir(Er,this,iL).call(this)}function Pae(){this.calculateVisibleRowsHeight(),this.inProgress||(ir(Er,this,_ae).call(this,Fw(Gf,this)),nL(Gf,this,[]))}function iA(t,e,n){let i=t;return n&&(this.calculateRowsHeight(e,void 0,!0),i=this.getRowHeight(e)),i}function Iae(t,e){e||this.recalculateAllRowsHeight()}function xae(t){const e=t.reduce((n,i)=>{let[r]=i;return n.indexOf(r)===-1&&n.push(r),n},[]);Fw(Gf,this).push(...e)}function Oae(){this.recalculateAllRowsHeight(),nL(mM,this,!0)}function Aae(t){if(!Fw(mM,this))return;const e=t.reduce((n,i)=>{var r;const o=(r=i.address)===null||r===void 0?void 0:r.row;if(Number.isInteger(o)){const s=this.hot.toVisualRow(o);n.indexOf(s)===-1&&n.push(s)}return n},[]);Fw(Gf,this).push(...e)}const{getListWithInsertedItems:Hae,getListWithRemovedItems:Nae}=V$("physicallyIndexed");class Dae extends Gu{constructor(){super(e=>e)}insert(e,n){const i=eT(this.indexedValues,n);this.indexedValues=Hae(i,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=Nae(this.indexedValues,e);this.indexedValues=Q0(n,e),super.remove(e)}}const{getListWithInsertedItems:$ae,getListWithRemovedItems:kae}=V$("physicallyIndexed");class Lae extends Gu{constructor(){super(e=>e)}insert(e,n){this.indexedValues=$ae(this.indexedValues,e,n,(i,r)=>this.getNextValue(r)),super.insert(e,n)}remove(e){this.indexedValues=kae(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function Fae(t,e){Vae(t,e),e.add(t)}function Vae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wae(t,e,n){return(e=Bae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bae(t){var e=jae(t,"string");return typeof e=="symbol"?e:e+""}function jae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Uae(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const rA="bindRowsWithHeaders",zae=210,Yae="loose",oA=new Map([["loose",Dae],["strict",Lae]]);var sA=new WeakSet;class Gae extends qe{constructor(){super(...arguments),Fae(this,sA),Wae(this,"headerIndexes",null)}static get PLUGIN_KEY(){return rA}static get PLUGIN_PRIORITY(){return zae}isEnabled(){return!!this.hot.getSettings()[rA]}enablePlugin(){var e;if(this.enabled)return;const n=(e=oA.get(this.getSetting()))!==null&&e!==void 0?e:oA.get(Yae);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",i=>Uae(sA,this,Kae).call(this,i)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function Kae(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function Xae(t,e){rL(t,e),e.add(t)}function qae(t,e,n){rL(t,e),e.set(t,n)}function rL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aA(t,e,n){return(e=Zae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zae(t){var e=Jae(t,"string");return typeof e=="symbol"?e:e+""}function Jae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lA(t,e){return t.get(rh(t,e))}function pb(t,e,n){return t.set(rh(t,e),n),n}function rh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Yp="collapsibleColumns",Qae=290,ele=["nestedHeaders"],wh="collapsibleIndicator",uA=Yp,cA=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var mc=new WeakMap,Ed=new WeakSet;class tle extends qe{constructor(){super(...arguments),Xae(this,Ed),aA(this,"nestedHeadersPlugin",null),aA(this,"headerStateManager",null),qae(this,mc,null)}static get PLUGIN_KEY(){return Yp}static get PLUGIN_PRIORITY(){return Qae}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Yp,...ele]}isEnabled(){return!!this.hot.getSettings()[Yp]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||$e("You need to configure the Nested Headers plugin in order to use collapsible headers."),pb(mc,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>rh(Ed,this,rle).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return rh(Ed,e,ole).call(e,...r)}),this.addHook("afterGetColHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return rh(Ed,e,nle).call(e,...r)}),this.addHook("beforeOnCellMouseDown",(i,r,o)=>rh(Ed,this,ile).call(this,i,r,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),pb(mc,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:i}=this.hot.getSelectedRangeActive().highlight,{collapsible:r,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,i))!==null&&e!==void 0?e:{};if(r)return o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.highlight.isHeader())},group:uA,relativeToGroup:ul,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(uA)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};he(0,e-1,s=>{const a=n.childNodes[s],l=i.childNodes[s],u=r?r.childNodes[s]:null;he(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${wh}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${wh}`),o(h)),r&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${wh}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(i=>{const{collapsible:r,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=i;if(r===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!cA.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const i=Tu(e,f=>{let{row:p}=f;return p<0});let r=i.length>0;O(i,f=>{var p;let{row:v,col:b}=f;const{collapsible:P,isCollapsed:_}=(p=this.headerStateManager.getHeaderSettings(v,b))!==null&&p!==void 0?p:{};if(!P||_&&n==="collapse"||!_&&n==="expand")return r=!1,!1});const o=[],s=[];r&&O(i,f=>{let{row:p,col:v}=f;const{colspanCompensation:b,affectedColumns:P,rollbackModification:_}=this.headerStateManager.triggerNodeModification(n,p,v);b>0&&(s.push(...P),o.push(_))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=x6([...a,...s]):n==="expand"&&(l=Tu(a,f=>!s.includes(f)));const u=cA.get(n);if(this.hot.runHooks(u.beforeHook,a,l,r)===!1){O(o,f=>{f()});return}this.hot.batchExecution(()=>{O(s,f=>{lA(mc,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeActive();if(n==="collapse"&&h&&d){const{row:f,col:p}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(p))&&s.includes(p)){const b=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,P=p>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(p,1,!0):p;b!==null&&P!==null&&this.hot.selectCell(b,P)}}this.hot.runHooks(u.afterHook,a,l,r,h),this.hot.view.adjustElementsSize(),this.hot.render()}getCollapsedColumns(){return lA(mc,this).getHiddenIndexes()}destroy(){pb(mc,this,null),super.destroy()}}function nle(t,e,n){var i;const{collapsible:r,origColspan:o,isCollapsed:s}=(i=this.headerStateManager.getHeaderSettings(n,t))!==null&&i!==void 0?i:{},a=r&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${wh}`);if(Zs(e,[Nr("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),B(u,wh),e.querySelector("div:first-child").appendChild(u)),ae(u,["collapsed","expanded"]),s?(B(u,"collapsed"),Mu(u,"+"),l&&le(e,...Nr(!1))):(B(u,"expanded"),Mu(u,"-"),l&&le(e,...Nr(!0))),l&&le(u,...Uu());else{var c;(c=u)===null||c===void 0||c.remove()}}function ile(t,e){Ce(t.target,wh)&&(Ce(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Ce(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),$r(t))}function rle(){this.updatePlugin()}function ole(t,e){e||this.updatePlugin()}function Pl(t,e,n){return(e=sle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sle(t){var e=ale(t,"string");return typeof e=="symbol"?e:e+""}function ale(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const lle=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],ule=!1,cle=!0,hle=!0;class dle{constructor(e,n){Pl(this,"hot",void 0),Pl(this,"sortingStates",new Xv),Pl(this,"sortEmptyCells",ule),Pl(this,"indicator",cle),Pl(this,"headerAction",hle),Pl(this,"compareFunctionFactory",void 0),Pl(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){me(e)&&We(e,(n,i)=>{lle.includes(i)&&(this[i]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[i]=n;return i===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return me(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[i,r]=n;return{column:this.hot.toVisualColumn(i),...r}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(te(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function oL(t,e,n){const i=e.locale;return function(r,o){const{sortEmptyCells:s}=n;return typeof r=="string"&&(r=r.toLocaleLowerCase(i)),typeof o=="string"&&(o=o.toLocaleLowerCase(i)),r===o?ss:rn(r)?rn(o)?ss:s&&t==="asc"?zt:Yt:rn(o)?s&&t==="asc"?Yt:zt:isNaN(r)&&!isNaN(o)?t==="asc"?Yt:zt:!isNaN(r)&&isNaN(o)||(isNaN(r)||isNaN(o)||(r=parseFloat(r),o=parseFloat(o)),r<o)?t==="asc"?zt:Yt:r>o?t==="asc"?Yt:zt:ss}}const sL="default";function fle(t,e,n){return function(i,r){const o=parseFloat(i),s=parseFloat(r),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return ss;if(a){if(rn(i))return t==="asc"?zt:Yt;if(rn(r))return t==="asc"?Yt:zt}return isNaN(o)?Yt:isNaN(s)?zt:o<s?t==="asc"?zt:Yt:o>s?t==="asc"?Yt:zt:ss}}const gle="numeric";function mle(t,e,n){const i=e.checkedTemplate,r=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=rn(s),u=rn(a),c=l?r:s,h=u?r:a,d=c===r||c===i,f=h===r||h===i;if(o===!1){if(l&&u===!1)return Yt;if(l===!1&&u)return zt}return d===!1&&f?t==="asc"?zt:Yt:d&&f===!1?t==="asc"?Yt:zt:d===!1&&f===!1?oL(t,e,n)(s,a):c===r&&h===i?t==="asc"?zt:Yt:c===i&&h===r?t==="asc"?Yt:zt:ss}}const ple="checkbox";function wle(t,e,n){return dL(t,e.dateFormat,n)}const vle="date";function Cle(t,e,n){return dL(t,e.timeFormat,n)}const yle="time",{register:Tg,getItem:hA,hasItem:ble}=Vr("sorting.compareFunctionFactory"),{register:aL,getItem:Sle}=Vr("sorting.mainSortComparator");function lL(t){return ble(t)?hA(t):hA(sL)}Tg(ple,mle);Tg(vle,wle);Tg(sL,oL);Tg(gle,fle);Tg(yle,Cle);const ss=0,zt=-1,Yt=1;function Rle(t,e){const n=Sle(e);for(var i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];t.sort(n(...r))}const Vw="asc",Ww="desc",uL="colHeader";function Ele(t){if(me(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Vw,Ww].includes(n)}function Tle(t){if(t.some(n=>Ele(n)===!1))return!1;const e=t.map(n=>{let{column:i}=n;return i});return new Set(e).size===e.length}function dA(t){if(t!==Ww)return t===Vw?Ww:Vw}function cL(t){return t.querySelector(`.${uL}`)}function hL(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function pM(t,e,n){return t===-1&&e>=0&&Iu(n)===!1}function dL(t,e,n){return function(i,r){const{sortEmptyCells:o}=n;if(i===r)return ss;if(rn(i))return rn(r)?ss:o&&t==="asc"?zt:Yt;if(rn(r))return o&&t==="asc"?Yt:zt;const s=K(i,e),a=K(r,e);return s.isValid()?a.isValid()?a.isAfter(s)?t==="asc"?zt:Yt:a.isBefore(s)?t==="asc"?Yt:zt:ss:zt:Yt}}function _le(t,e){$e(nt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const Mle="ascending",Ple="descending",fL="indicatorDisabled",gL="columnSorting",mL="sortAction",pL=new Map([[Vw,Mle],[Ww,Ple]]);function Ile(t,e,n,i){const r=[gL];if(i&&r.push(mL),n===!1)return r.push(fL),r;const o=t.getSortOrderOfColumn(e);return te(o)&&r.push(pL.get(o)),r}function xle(){return Array.from(pL.values()).concat(mL,fL,gL)}function Ole(t,e){return function(n,i){const[,...r]=n,[,...o]=i;return function(a){const l=t[a],u=e[a],c=r[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:lL(u.type))(l,u,d)(c,h)}(0)}}function Ale(t,e){Hle(t,e),e.add(t)}function Hle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Am(t,e,n){return(e=Nle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nle(t){var e=Dle(t,"string");return typeof e=="symbol"?e:e+""}function Dle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Bw="columnSorting",$le=50,jw="append",kle="replace",fA=Bw;aL(Bw,Ole);ie.getSingleton().register("beforeColumnSort");ie.getSingleton().register("afterColumnSort");const Td=new WeakMap;var Ql=new WeakSet;class wL extends qe{constructor(){super(...arguments),Ale(this,Ql),Am(this,"columnStatesManager",null),Am(this,"columnMetaCache",null),Am(this,"pluginKey",Bw),Am(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Bw}static get PLUGIN_PRIORITY(){return $le}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(Td.has(this.hot)&&Td.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),_le(Td.get(this.hot),this.pluginKey);return}this.enabled||(Td.set(this.hot,this.pluginKey),this.columnStatesManager=new dle(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new ll(n=>{let i=this.hot.toVisualColumn(n);return i===null&&(i=n),this.getMergedPluginSettings(i)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,i)=>Kc(Ql,this,Lle).call(this,n,i)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Kc(Ql,e,Vle).call(e,...i)}),this.addHook("afterOnCellMouseDown",(n,i)=>this.onAfterOnCellMouseDown(n,i)),this.addHook("afterInit",()=>Kc(Ql,this,GR).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Kc(Ql,e,Fle).call(e,...i)}),this.hot.view&&Kc(Ql,this,GR).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,i)=>{const r=cL(i);hL(n,i)===!1||r===null||this.updateHeaderClasses(r)};Td.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.row===-1&&i.col>=0},relativeToGroup:ul,position:"before",group:fA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(fA)}sort(e){const n=this.getSortConfig(),i=this.getNormalizedSortConfigs(e),r=this.areValidSortConfigs(i);this.hot.runHooks("beforeColumnSort",n,i,r)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new W$),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",n,r?i:n,r),r&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return te(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return Tle(e)&&e.every(i=>{let{column:r}=i;return r<=n&&r>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),i=r=>{let{column:o,...s}=r;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=tt(e,i),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,i=r=>{let{column:o,...s}=r;return{column:this.hot.toVisualColumn(o),...s}};return te(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=tt(n.initialConfig,i)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(te(n)){const r=dA(n);return te(r)?{column:e,sortOrder:r}:void 0}const i=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<i)return{column:e,sortOrder:dA()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:jw;const i=this.columnStatesManager.getIndexOfColumnInSortQueue(e),r=i!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(r){if(xt(s))return[...o.slice(0,i),...o.slice(i+1)];if(n===jw)return[...o.slice(0,i),...o.slice(i+1),s];if(n===kle)return[...o.slice(0,i),s,...o.slice(i+1)]}return te(s)?o.concat(s):o}getPluginColumnConfig(e){if(me(e)){const n=e[this.pluginKey];if(me(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(r);return Array.isArray(o.columns)?Object.assign(i,n,this.getPluginColumnConfig(o.columns[e])):ot(o.columns)?Object.assign(i,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(i,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),i=Object.create(n);return i[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),i}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],i=this.hot.countRows(),r=u=>tt(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(i);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(r(u)));const o=tt(n,u=>u[0]);Rle(n,this.pluginKey,tt(e,u=>u.sortOrder),tt(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<i;u+=1)n.push([u].concat(r(u)));const s=tt(n,u=>u[0]),a=new Map(tt(o,(u,c)=>[u,s[c]])),l=tt(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(me(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||me(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(ae(e,xle()),this.enabled!==!1){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];B(e,Ile(...i))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),te(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&Ce(e.target,uL)}onAfterOnCellMouseDown(e,n){if(pM(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const i=this.hot.getActiveEditor(),r=this.getColumnNextConfig(n.col);i!=null&&i.isOpened()&&this.hot.getCellValidator(i.row,i.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(r)}):this.sort(r)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function GR(){const t=this.getAllSavedSortSettings();if(me(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function Lle(t,e){const n=cL(e);if(hL(t,e)===!1||n===null)return;const i=this.getFirstCellSettings(t)[this.pluginKey],r=i.indicator,o=i.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,r,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);le(e,...n9(s?`${s}ending`:"none"))}}function Fle(t){t===!0&&this.hot.view&&Kc(Ql,this,GR).call(this)}function Vle(t,e,n,i){pM(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(i.column=!0)}function wb(t){return t==null||isNaN(t)}function Wle(t,e){if(typeof t!="number")return t;const n=i=>i.toString();switch(typeof e){case"number":return n(t.toFixed(Math.min(Math.max(0,e),100)));case"boolean":return e?n(Math.round(t)):t;case"string":if(e==="auto"){const i=Math.round(t).toString().length;return n(t.toFixed(8-i))}return t;default:return t}}function Il(t,e,n){return(e=Ble(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ble(t){var e=jle(t,"string");return typeof e=="symbol"?e:e+""}function jle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ule{constructor(e,n){Il(this,"plugin",void 0),Il(this,"hot",void 0),Il(this,"endpoints",[]),Il(this,"settings",void 0),Il(this,"settingsType","array"),Il(this,"currentEndpoint",null),Il(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let i=e;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),O(i,r=>{const o={};this.assignSetting(r,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(r,o,"reversedRowCoords",!1),this.assignSetting(r,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,o,"sourceColumn",r.destinationColumn),this.assignSetting(r,o,"type","sum"),this.assignSetting(r,o,"forceNumeric",!1),this.assignSetting(r,o,"suppressDataTypeErrors",!0),this.assignSetting(r,o,"customFunction",null),this.assignSetting(r,o,"readOnly",!0),this.assignSetting(r,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,i,r){if(i==="ranges"&&e[i]===void 0){n[i]=r;return}else if(i==="ranges"&&e[i].length===0)return;if(e[i]===void 0){if(r instanceof Error)throw r;n[i]=r}else i==="destinationRow"&&n.reversedRowCoords?n[i]=this.hot.countRows()-e[i]-1:n[i]=e[i]}resetSetupBeforeStructureAlteration(e,n,i){if(this.settingsType!=="function")return;const r=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();O(o,s=>{r==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=i:e==="remove_row"&&(s.alterRowOffset=-1*i)),r==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=i:e==="remove_col"&&(s.alterColumnOffset=-1*i))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,i,r,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(o==="auto")return;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;O(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*i),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*i)}),this.resetAllEndpoints(u,!c),c?O(u,d=>{this.extendEndpointRanges(d,h,r[0],r.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):O(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,i,r){O(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?i>o[1]?o[1]+=r:i<o[0]&&(o[0]-=r):i>=o[0]&&i<=o[1]&&(o[1]-=r,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,i=[],r=[];O(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));r.push(s)}),O(r,o=>{let s=[];O(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),i.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),i.push(s))})}),e.ranges=i}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,O(e.ranges,i=>{O(i,(r,o)=>{r>=n&&(i[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(r=>{const o=r.alterRowOffset||0,s=r.alterColumnOffset||0;return r.destinationRow+o>=this.hot.countRows()||r.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],O(e,r=>{this.resetEndpointValue(r,n)}),this.cellsToSetCache.length&&this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],O(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.cellsToSetCache.length&&this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],O(e,(i,r,o)=>{`${i[2]||""}`!=`${i[3]}`&&O(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[r][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),O(n,i=>{this.refreshEndpoint(this.getEndpoint(i))}),this.cellsToSetCache.length&&this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const i=this.hot.getCellMeta(n,e.destinationColumn);i.readOnly=e.readOnly,i.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const i=e.alterRowOffset||0,r=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?i:0)),this.hot.toVisualColumn(e.destinationColumn+(n?r:0)),""])}setEndpointValue(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}e.result=Wle(e.result,e.roundFloat),i?this.hot.setDataAtCell(r,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([r,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){$e("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function zle(t,e){Yle(t,e),e.add(t)}function Yle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gle(t,e,n){return(e=Kle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kle(t){var e=Xle(t,"string");return typeof e=="symbol"?e:e+""}function Xle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const vb="columnSummary",qle=220;var xl=new WeakSet;class Zle extends qe{constructor(){super(...arguments),zle(this,xl),Gle(this,"endpoints",null)}static get PLUGIN_KEY(){return vb}static get PLUGIN_PRIORITY(){return qle}isEnabled(){return!!this.hot.getSettings()[vb]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[vb],this.endpoints=new Ule(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return pc(xl,e,Jle).call(e,...i)}),this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return pc(xl,e,eue).call(e,...i)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return pc(xl,e,Qle).call(e,...i)}),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return pc(xl,e,tue).call(e,...i)}),this.addHook("afterUpdateData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return pc(xl,e,nue).call(e,...i)}),this.addHook("beforeCreateRow",(n,i,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,i,null,r)),this.addHook("beforeCreateCol",(n,i,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,i,null,r)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...i)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...i)}),this.addHook("afterCreateRow",(n,i,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,i,null,r)),this.addHook("afterCreateCol",(n,i,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,i,null,r)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...i)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return pc(xl,e,iue).call(e,...i)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return We(e.ranges,i=>{n+=this.getPartialSum(i,e.sourceColumn)}),n}getPartialSum(e,n){let i=0,r=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(r,n),o=wb(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}i+=o||0,r-=1}while(r>=e[0]);return Math.round(i*10**s)/10**s}calculateMinMax(e,n){let i=null;return We(e.ranges,r=>{const o=this.getPartialMinMax(r,e.sourceColumn,n);if(i===null&&o!==null&&(i=o),o!==null)switch(n){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break}}),i===null?"Not enough data":i}getPartialMinMax(e,n,i){let r=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=wb(s)?null:s,r===null)r=s;else if(s!==null)switch(i){case"min":r=Math.min(r,s);break;case"max":r=Math.max(r,s);break}o-=1}while(o>=e[0]);return r}countEmpty(e,n){let i,r=0,o=e[1]||e[0];do i=this.getCellValue(o,n),i=wb(i)?null:i,i===null&&(r+=1),o-=1;while(o>=e[0]);return r}countEntries(e){let n=0;const i=e.ranges;return We(i,r=>{const o=r[1]===void 0?1:r[1]-r[0]+1,s=this.countEmpty(r,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),i=this.countEntries(e);return n/i}getCellValue(e,n){const i=this.hot.toVisualRow(e),r=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(i!==null&&r!==null&&(s=this.hot.getCellMeta(i,r).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(nt`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function Jle(){this.endpoints.initEndpoints()}function Qle(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function eue(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function tue(t,e){e||this.endpoints.refreshAllEndpoints()}function nue(t,e){e||this.endpoints.refreshAllEndpoints()}function iue(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function rue(t,e){vL(t,e),e.add(t)}function Cb(t,e,n){vL(t,e),e.set(t,n)}function vL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xc(t,e){return t.get(wM(t,e))}function KR(t,e,n){return t.set(wM(t,e),n),n}function wM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Uw=new WeakMap,Hm=new WeakMap,Nm=new WeakMap,gA=new WeakSet;class CL{constructor(){rue(this,gA),Cb(this,Uw,!0),Cb(this,Hm,null),Cb(this,Nm,new ResizeObserver(e=>wM(gA,this,oue).call(this,e)))}setObservedElement(e){KR(Hm,this,e)}unobserve(){Xc(Nm,this).unobserve(Xc(Hm,this))}observe(){KR(Uw,this,!0),Xc(Nm,this).observe(Xc(Hm,this))}destroy(){Xc(Nm,this).disconnect()}}function oue(t){if(Xc(Uw,this)||!Array.isArray(t)||!t.length){KR(Uw,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:i,blockSize:r}=n[0];this.runLocalHooks("resize",i,r)})}ct(CL,An);function va(t,e,n){sue(t,e),e.set(t,n)}function sue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mt(t,e){return t.get(yL(t,e))}function Oo(t,e,n){return t.set(yL(t,e),n),n}function yL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var wc=new WeakMap,yb=new WeakMap,bb=new WeakMap,Ms=new WeakMap,Ca=new WeakMap,ya=new WeakMap,Dm=new WeakMap,vc=new WeakMap;class fu{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n,i){var r=this;va(this,wc,void 0),va(this,yb,void 0),va(this,bb,!1),va(this,Ms,null),va(this,Ca,void 0),va(this,ya,void 0),va(this,Dm,!0),va(this,vc,new CL),Oo(wc,this,e),Oo(yb,this,i),Oo(bb,this,n),Oo(Ca,this,this.createEditor()),Oo(ya,this,mt(Ca,this).style),mt(vc,this).setObservedElement(this.getInputElement()),mt(vc,this).addLocalHook("resize",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return r.runLocalHooks("resize",...s)}),this.hide()}setPosition(e,n){mt(ya,this).left=`${e}px`,mt(ya,this).top=`${n}px`}setSize(e,n){if(e&&n){const i=this.getInputElement();i.style.width=`${e}px`,i.style.height=`${n}px`}}getSize(){return{width:cn(this.getInputElement()),height:yn(this.getInputElement())}}observeSize(){mt(vc,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){mt(ya,this).display="block",Oo(Dm,this,!1)}hide(){mt(vc,this).unobserve(),mt(Dm,this)||(mt(ya,this).display="none"),Oo(Dm,this,!0)}isVisible(){return mt(ya,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return mt(wc,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=mt(wc,this).createElement("div"),n=mt(wc,this).createElement("textarea");return e.style.display="none",Oo(Ms,this,mt(wc,this).createElement("div")),mt(Ms,this).setAttribute("dir",mt(bb,this)?"rtl":"ltr"),B(mt(Ms,this),fu.CLASS_EDITOR_CONTAINER),mt(yb,this).appendChild(mt(Ms,this)),B(e,fu.CLASS_EDITOR),B(n,fu.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),mt(Ms,this).appendChild(e),e}getInputElement(){return mt(Ca,this).querySelector(`.${fu.CLASS_INPUT}`)}getEditorElement(){return mt(Ca,this)}destroy(){const e=mt(Ms,this)?mt(Ms,this).parentNode:null;mt(Ca,this).parentNode.removeChild(mt(Ca,this)),Oo(Ca,this,null),Oo(ya,this,null),mt(vc,this).destroy(),e&&e.removeChild(mt(Ms,this))}}ct(fu,An);function Sb(t,e,n){return(e=aue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aue(t){var e=lue(t,"string");return typeof e=="symbol"?e:e+""}function lue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const uue=250,cue=250;class bL{constructor(e){Sb(this,"wasLastActionShow",!0),Sb(this,"showDebounced",null),Sb(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},cue)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:uue;this.showDebounced=Uv(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}ct(bL,An);function hue(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function due(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Ol(t,e){const n={};return O(t,i=>{i.forAll((r,o)=>{r>=0&&o>=0&&(n[r]||(n[r]=[]),n[r][o]=e(r,o))})}),n}function ka(t,e,n,i,r){O(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&fue(s,a,e,n,i,r)})})}function fue(t,e,n,i,r,o){const s=r(t,e);let a=i;s.className&&(n==="vertical"?a=hue(s.className,i):a=due(s.className,i)),o(t,e,"className",a)}function SL(t){return`<span class="selected">â</span>${t}`}function Gp(t,e){let n=!1;return Array.isArray(t)&&O(t,i=>(i.forAll((r,o)=>{if(r>=0&&o>=0&&e(r,o))return n=!0,!1}),n)),n}function oC(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:i}=e.defaultView,{top:r,left:o}=i.getBoundingClientRect();n.top=r,n.left=o}return n}const Ve="---------";function gue(){return{name:Ve}}const Mr="alignment";function mue(){return{key:Mr,name(){return this.getTranslatedPhrase(MT)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeActive();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Mr}:left`,name(){return this.getTranslatedPhrase(PT)},callback(){const t=this.getSelectedRange(),e=Ol(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",e,t,n,i),ka(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Mr}:center`,name(){return this.getTranslatedPhrase(IT)},callback(){const t=this.getSelectedRange(),e=Ol(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",e,t,n,i),ka(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Mr}:right`,name(){return this.getTranslatedPhrase(xT)},callback(){const t=this.getSelectedRange(),e=Ol(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htRight";this.runHooks("beforeCellAlignment",e,t,n,i),ka(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Mr}:justify`,name(){return this.getTranslatedPhrase(OT)},callback(){const t=this.getSelectedRange(),e=Ol(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",e,t,n,i),ka(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{name:Ve},{key:`${Mr}:top`,name(){return this.getTranslatedPhrase(AT)},callback(){const t=this.getSelectedRange(),e=Ol(t,(r,o)=>this.getCellMeta(r,o).className),n="vertical",i="htTop";this.runHooks("beforeCellAlignment",e,t,n,i),ka(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Mr}:middle`,name(){return this.getTranslatedPhrase(HT)},callback(){const t=this.getSelectedRange(),e=Ol(t,(r,o)=>this.getCellMeta(r,o).className),n="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,i),ka(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1},{key:`${Mr}:bottom`,name(){return this.getTranslatedPhrase(NT)},callback(){const t=this.getSelectedRange(),e=Ol(t,(r,o)=>this.getCellMeta(r,o).className),n="vertical",i="htBottom";this.runHooks("beforeCellAlignment",e,t,n,i),ka(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,s,a)=>this.setCellMeta(r,o,s,a)),this.render()},disabled:!1}]}}}const sC="clear_column";function pue(){return{key:sC,name(){return this.getTranslatedPhrase(fT)},callback(t,e){const n=e[0].start.col,i=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),i,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,i)=>{if(n<0||i<0)return!0;const{readOnly:r}=this.getCellMeta(n,i);return r?!0:(e=!0,!1)}),!e}}}const _g="col_left";function wue(){return{key:_g,name(){return this.getTranslatedPhrase(aT)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const Mg="col_right";function vue(){return{key:Mg,name(){return this.getTranslatedPhrase(lT)},callback(){const t=this.getSelectedRangeActive().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Pg="make_read_only";function Cue(){return{key:Pg,checkable:!0,ariaChecked(){return Gp(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(_w)},name(){let t=this.getTranslatedPhrase(_w);return Gp(this.getSelectedRange(),(n,i)=>this.getCellMeta(n,i).readOnly)&&(t=SL(t)),t},callback(){const t=this.getSelectedRange(),e=Gp(t,(n,i)=>this.getCellMeta(n,i).readOnly);O(t,n=>{n.forAll((i,r)=>{i>=0&&r>=0&&this.setCellMeta(i,r,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeActive();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const aC="redo";function yue(){return{key:aC,name(){return this.getTranslatedPhrase(dT)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Ig="remove_col";function bue(){return{key:Ig,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,i]=t[0];n-i!==0&&(e=1)}return this.getTranslatedPhrase(cT,e)},callback(){this.alter("remove_col",Xee(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const lC="remove_row";function Sue(){return{key:lC,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,i]=t[0];n-i!==0&&(e=1)}return this.getTranslatedPhrase(uT,e)},callback(){this.alter("remove_row",qee(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const uC="row_above";function Rue(){return{key:uC,name(){return this.getTranslatedPhrase(oT)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const cC="row_below";function Eue(){return{key:cC,name(){return this.getTranslatedPhrase(sT)},callback(){const t=this.getSelectedRangeActive().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const Kf="no_items";function Tue(){return{key:Kf,name(){return this.getTranslatedPhrase(rT)},disabled:!0,isCommand:!1}}const hC="undo";function _ue(){return{key:hC,name(){return this.getTranslatedPhrase(hT)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Mue=[uC,cC,_g,Mg,sC,lC,Ig,hC,aC,Pg,Mr,Ve,Kf],Pue={[Ve]:gue,[Kf]:Tue,[uC]:Rue,[cC]:Eue,[_g]:wue,[Mg]:vue,[sC]:pue,[lC]:Sue,[Ig]:bue,[hC]:_ue,[aC]:yue,[Pg]:Cue,[Mr]:mue};function RL(){const t={};return We(Pue,(e,n)=>{t[n]=e()}),t}function Iue(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(ET):this.getTranslatedPhrase(RT)},callback(){const e=this.getSelectedRangeActive();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function xue(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(TT)},callback(){this.getSelectedRangeActive().forAll((n,i)=>{n>=0&&i>=0&&t.removeCommentAtCell(n,i,!1)}),this.render()},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Oue(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(_T);return Gp(this.getSelectedRange(),(i,r)=>t.getCommentMeta(i,r,Kp))?SL(e):e},callback(){this.getSelectedRangeActive().forAll((n,i)=>{if(n>=0&&i>=0){const r=!!t.getCommentMeta(n,i,Kp);t.updateCommentMeta(n,i,{[Kp]:!r})}})},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Aue(t,e){EL(t,e),e.add(t)}function Al(t,e,n){EL(t,e),e.set(t,n)}function EL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hue(t,e,n){return(e=Nue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nue(t){var e=Due(t,"string");return typeof e=="symbol"?e:e+""}function Due(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ts(t,e,n){return t.set(Pn(t,e),n),n}function Ne(t,e){return t.get(Pn(t,e))}function Pn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zw="comments",$ue=60,Ls="comment",sf="value",TL="style",Kp="readOnly",_d=zw,XR=`plugin:${zw}`;var wt=new WeakMap,Ko=new WeakMap,dC=new WeakMap,Xp=new WeakMap,Yw=new WeakMap,qR=new WeakMap,Gw=new WeakMap,kn=new WeakSet;class kue extends qe{constructor(){super(...arguments),Aue(this,kn),Hue(this,"range",{}),Al(this,wt,null),Al(this,Ko,null),Al(this,dC,!1),Al(this,Xp,!1),Al(this,Yw,!1),Al(this,qR,null),Al(this,Gw,"")}static get PLUGIN_KEY(){return zw}static get PLUGIN_PRIORITY(){return $ue}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[zw]}enablePlugin(){var e=this;this.enabled||(Ne(wt,this)||(ts(wt,this,new fu(this.hot.rootDocument,this.hot.isRtl(),this.hot.rootPortalElement)),Ne(wt,this).addLocalHook("resize",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Pn(kn,e,zue).call(e,...i)}),this.hot.addHook("afterSetTheme",(n,i)=>{i||this.hide()})),Ne(Ko,this)||ts(Ko,this,new bL(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,i,r,o,s,a)=>Pn(kn,this,Bue).call(this,n,a)),this.addHook("afterScroll",()=>Pn(kn,this,Yue).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>Pn(kn,this,mA).call(this,n)),this.addHook("beforeCompositionStart",n=>Pn(kn,this,mA).call(this,n)),Ne(Ko,this).addLocalHook("hide",()=>this.hide()),Ne(Ko,this).addLocalHook("show",(n,i)=>this.showAtCell(n,i)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){Ne(Ko,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),i=e.addContext(XR);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const r=this.hot.getSelectedRangeActive();ts(Xp,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(r),this.show(),this.focusEditor(),e.setActiveContextName(XR),this.hot._registerTimeout(()=>{ts(Xp,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var r;return(r=this.hot.getSelectedRangeActive())===null||r===void 0?void 0:r.highlight.isCell()},group:_d}),i.addShortcut({keys:[["Escape"]],callback:()=>{Ne(wt,this).setValue(Ne(Gw,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Ne(wt,this).isVisible()&&Ne(wt,this).isFocused(),group:_d}),i.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Ne(wt,this).isVisible()&&Ne(wt,this).isFocused(),group:_d}),i.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{ts(Yw,this,!0),Ne(wt,this).setValue(Ne(wt,this).getValue()),this.setComment(),this.hide(),e.setActiveContextName("grid")},group:_d})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(_d)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",i=>Pn(kn,this,Vue).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>Pn(kn,this,Lue).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>Pn(kn,this,Wue).call(this)),this.eventManager.addEventListener(n,"focus",()=>Pn(kn,this,Uue).call(this)),this.eventManager.addEventListener(n,"blur",()=>Pn(kn,this,jue).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",i=>Pn(kn,this,Fue).call(this,i))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=_u(e.target,"TD","TBODY");return!!(n&&Ce(n,"htCommentCell")&&_u(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=Ne(wt,this).getValue();let i="";e!=null?i=e:n!=null&&(i=n);const{row:r,col:o}=Pn(kn,this,qc).call(this);this.updateCommentMeta(r,o,{[sf]:i}),this.hot.render()}setCommentAtCell(e,n,i){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(i)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{row:n,col:i}=Pn(kn,this,qc).call(this);this.hot.setCellMeta(n,i,Ls),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(i)}getComment(){const{row:e,col:n}=Pn(kn,this,qc).call(this);return this.getCommentMeta(e,n,sf)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,sf)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{row:n,col:i}=Pn(kn,this,qc).call(this);if(n<0||n>this.hot.countSourceRows()-1||i<0||i>this.hot.countSourceCols()-1)return!1;const r=this.hot.getCellMeta(n,i);return Ne(Ko,this).cancelHiding(),Ne(wt,this).setValue((e=r[Ls]?r[Ls][sf]:null)!==null&&e!==void 0?e:""),Ne(wt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){Ne(wt,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!Ne(wt,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:i}=this.hot,{row:r,col:o}=Pn(kn,this,qc).call(this);let s=n.getRenderableFromVisualIndex(r),a=i.getRenderableFromVisualIndex(o);const l=s===null;Ne(wt,this).setPosition(0,0),s===null&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r,-1))),a===null&&(a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o,-1)));const u=s===null,c=a===null;s=s??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,p=d.getCell({row:s,col:a},!0),v=this.getCommentMeta(r,o,TL);v?Ne(wt,this).setSize(v.width,v.height):Ne(wt,this).resetSize();const b=c?0:f.getColumnWidth(a),P=l&&!u?yn(p):0,{left:_,top:F,width:I,height:W}=p.getBoundingClientRect(),{width:k,height:$}=Ne(wt,this).getSize(),{innerWidth:Y,innerHeight:J}=this.hot.rootWindow,U=this.hot.rootDocument.documentElement,oe=hn(this.hot.rootDocument),j=e$(this.hot.rootWindow)?oe:0,Z=t$(this.hot.rootWindow)?oe:0;let re=_+h.scrollX+b,pe=F+h.scrollY+P;this.hot.isRtl()&&(re-=k+b),this.hot.isLtr()&&_+I+k>Y-j?re=_+h.scrollX-k-1:this.hot.isRtl()&&re<-(U.scrollWidth-U.clientWidth)&&(re=_+h.scrollX+b+1),F+$>J-Z&&(pe-=$-W+1),Ne(wt,this).setPosition(re,pe),Ne(wt,this).setReadOnlyState(this.getCommentMeta(r,o,Kp)),Ne(wt,this).observeSize()}focusEditor(){Ne(wt,this).focus()}updateCommentMeta(e,n,i){const r=this.hot.getCellMeta(e,n)[Ls];let o;r?(o=Si(r),Fv(o,i)):o=i,this.hot.setCellMeta(e,n,Ls,o)}getCommentMeta(e,n,i){const r=this.hot.getCellMeta(e,n);if(r[Ls])return r[Ls][i]}addToContextMenu(e){e.items.push({name:Ve},Iue(this),xue(this),Oue(this))}getEditorInputElement(){return Ne(wt,this).getInputElement()}destroy(){var e,n;(e=Ne(wt,this))===null||e===void 0||e.destroy(),(n=Ne(Ko,this))===null||n===void 0||n.destroy(),super.destroy()}}function Lue(t){if(!(!this.hot.view||!this.hot.view._wt)&&!Ne(dC,this)&&!this.targetIsCommentTextArea(t)){const e=_u(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function Fue(t){t.stopPropagation()}function Vue(t){const{rootDocument:e}=this.hot;if(!(Ne(dC,this)||Ne(wt,this).isFocused()||Ce(t.target,"wtBorder")||Ne(qR,this)===t.target||!Ne(wt,this)))if(ts(qR,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));Ne(Ko,this).show(n)}else bu(t.target,e)&&!this.targetIsCommentTextArea(t)&&Ne(Ko,this).hide()}function Wue(){ts(dC,this,!1)}function Bue(t,e){e[Ls]&&e[Ls][sf]&&B(t,e.commentedCellClassName)}function jue(){if(Ne(Yw,this)){ts(Yw,this,!1);return}ts(Gw,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function Uue(){ts(Gw,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(XR)}function zue(t,e){const{row:n,col:i}=Pn(kn,this,qc).call(this);this.updateCommentMeta(n,i,{[TL]:{width:t,height:e}})}function mA(t){Ne(wt,this).isFocused()&&$r(t)}function Yue(){Ne(Xp,this)||this.hide()}function qc(){return this.range instanceof Vh?this.range.highlight:this.hot._createCellCoords(this.range.from.row,this.range.from.col)}function Rb(t,e,n){return(e=Gue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gue(t){var e=Kue(t,"string");return typeof e=="symbol"?e:e+""}function Kue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _L{constructor(e){Rb(this,"hot",void 0),Rb(this,"commands",{}),Rb(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=Xue(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||nn(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),i.unshift(o.join(":")),O(u,c=>c.apply(this.hot,i))}}function Xue(t,e){let n;return O(e,i=>{const r=i.key?i.key.split(":"):null;if(Array.isArray(r)&&r[1]===t)return n=i,!1}),n}function Eb(t,e,n){return(e=que(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function que(t){var e=Zue(t,"string");return typeof e=="symbol"?e:e+""}function Zue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ML{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Eb(this,"hot",void 0),Eb(this,"predefinedItems",RL()),Eb(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,We(e,(i,r)=>{let o="";i.name===Ve?(n[Ve]=i,o=Ve):isNaN(parseInt(r,10))?(i.key=i.key===void 0?r:i.key,n[r]=i,o=i.key):(n[i.key]=i,o=i.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Jue(e,this.defaultOrderPattern,this.predefinedItems)}}function Jue(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=[];let r=t;return r&&r.items?r=r.items:Array.isArray(r)||(r=e),me(r)?We(r,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),me(o)?bn(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),i.push(a)}):O(r,(o,s)=>{let a=n[o];!a&&Mue.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),me(o)&&bn(a,o),a.key===void 0&&(a.key=s),i.push(a))}),i}function ba(t,e,n){return(e=Que(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Que(t){var e=ece(t,"string");return typeof e=="symbol"?e:e+""}function ece(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tce{constructor(e,n){ba(this,"top",void 0),ba(this,"topRelative",void 0),ba(this,"left",void 0),ba(this,"leftRelative",void 0),ba(this,"scrollTop",void 0),ba(this,"scrollLeft",void 0),ba(this,"cellHeight",void 0),ba(this,"cellWidth",void 0);const i=n.scrollY,r=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=i,a+=r):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-i,l=a-r),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=i,this.scrollLeft=r,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.document.documentElement.clientWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Md(t,e,n){nce(t,e),e.set(t,n)}function nce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pe(t,e){return t.get(PL(t,e))}function $m(t,e,n){return t.set(PL(t,e),n),n}function PL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ui=new WeakMap,Pi=new WeakMap,Ii=new WeakMap,Tb=new WeakMap,Cc=new WeakMap;class ice{constructor(e){Md(this,ui,void 0),Md(this,Pi,void 0),Md(this,Ii,void 0),Md(this,Tb,!1),Md(this,Cc,{above:0,below:0,left:0,right:0}),$m(Tb,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Pe(Cc,this)[e]=n,this}setElement(e){return $m(ui,this,e),this}setParentElement(e){return $m(Pi,this,e),this}updatePosition(e){$m(Ii,this,new tce(e,Pe(ui,this).ownerDocument.defaultView)),Pe(Tb,this)?(Pe(Ii,this).fitsBelow(Pe(ui,this))?this.setPositionBelowCursor():Pe(Ii,this).fitsAbove(Pe(ui,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Pe(ui,this).dir==="rtl"?Pe(Ii,this).fitsOnLeft(Pe(ui,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Pe(Ii,this).fitsOnRight(Pe(ui,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Pe(Cc,this).above+Pe(Ii,this).top-Pe(ui,this).offsetHeight;if(Pe(Pi,this)){const i=Pe(Pi,this).ownerDocument.defaultView.getComputedStyle(Pe(Pi,this).querySelector(".ht_master")),r=Number.parseInt(i.paddingTop,10),o=Number.parseInt(i.borderTop,10);e=Pe(Ii,this).top+Pe(Ii,this).cellHeight-Pe(ui,this).scrollHeight+r+o}Pe(ui,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Pe(Cc,this).below+Pe(Ii,this).top+1;if(Pe(Pi,this)){const i=Pe(Pi,this).ownerDocument.defaultView.getComputedStyle(Pe(Pi,this).querySelector(".ht_master")),r=Number.parseInt(i.paddingTop,10),o=Number.parseInt(i.borderTop,10);e=Pe(Ii,this).top-r-o}Pe(ui,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Pe(Ii,this).left;if(Pe(Pi,this)){const n=Pe(Pi,this).ownerDocument.defaultView,i=Number.parseInt(n.getComputedStyle(Pe(Pi,this).querySelector(".htCore")).borderRightWidth,10);e+=Pe(Ii,this).cellWidth+i}else e+=Pe(Cc,this).right;Pe(ui,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Pe(Cc,this).left+Pe(Ii,this).left-Pe(ui,this).offsetWidth;if(Pe(Pi,this)){const n=Pe(Pi,this).ownerDocument.defaultView,i=Number.parseInt(n.getComputedStyle(Pe(Pi,this).querySelector(".htCore")).borderLeftWidth,10);e-=i}Pe(ui,this).style.left=`${e}px`}}function IL(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:i=()=>{},onClear:r=()=>{}}=t;const o=new Set;let s=Ue(e,-1,v()-1);function a(P,_){const F=v()-1;return P<0&&(P=F),P>F&&(P=0),o.has(P)?-1:(o.add(P),i(P,!1)===!1&&(P=a(_===1?++P:--P,_)),P)}function l(P){P>-1&&P<v()&&i(P,!0)!==!1&&(s=P)}function u(P){P>-1&&P<v()&&(s=P)}function c(){return s}function h(){v()>0&&(o.clear(),s=a(0,1))}function d(){v()>0&&(o.clear(),s=a(v()-1,-1))}function f(){v()>0&&(o.clear(),s=a(++s,1))}function p(){v()>0&&(o.clear(),s=a(--s,-1))}function v(){return Math.max(n(),0)}function b(){o.clear(),s=e,r()}return{setCurrentPage:l,setPageCursorAt:u,getCurrentPage:c,toFirstItem:h,toLastItem:d,toNextItem:f,toPreviousItem:p,getSize:v,clear:b}}function rce(t){return tt(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function ZR(t){return nn(t,"submenu")}function JR(t){return new RegExp(Ve,"i").test(t.name)}function qp(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function pA(t){return nn(t,"disableSelection")}function oce(t){return Ce(t,"htSeparator")}function sce(t){return Ce(t,"htSubmenu")}function ace(t){return Ce(t,"htDisabled")}function lce(t){return Ce(t,"htSelectionDisabled")}function uce(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function xL(t,e){const n=t.slice(0);for(let i=0;i<n.length&&n[i].name===e;)n.shift();return n}function cce(t,e){let n=t.slice(0);return n.reverse(),n=xL(n,e),n.reverse(),n}function hce(t){const e=[];return O(t,(n,i)=>{i>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function dce(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ve,n=t.slice(0);return n=xL(n,e),n=cce(n,e),n=hce(n),n}function fce(t){return t.checkable===!0}function gce(t){return IL({size:()=>t.countRows(),onItemSelect(e,n){const i=t.getCell(e,0);if(!i||oce(i)||ace(i)||lce(i))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function mce(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(i,r)=>{const o=e.getSettings(),s=typeof o.tabMoves=="function"?o.tabMoves(i):o.tabMoves;r.includes("shift")?e.selection.transformStart(-s.row,-s.col):e.selection.transformStart(s.row,s.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const i=n.getSelectedActive();if(i){const r=t.openSubMenu(i[0]);r&&r.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedActive()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:i=>{const r=n.getSelectedActive();r&&(n.getSourceDataAtRow(r[0]).submenu?t.openSubMenu(r[0]).getNavigator().toFirstItem():(t.executeCommand(i),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedActive()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedActive()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const OL="menu",wA=OL;function pce(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];i(mce(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;r(c,h)});function i(u,c){a(c).addShortcuts(u,{group:OL})}function r(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(p=>h.removeShortcutsByKeys(p))}),n.push({shortcuts:u,contextName:c}),i(u,c)}function o(){return[...n]}function s(u){return u?`${wA}:${u}`:wA}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:r,getCustomShortcuts:o,getContext:a,listen:l}}function wce(t){return(e,n,i,r,o,s)=>{const a=e.getSourceDataAtRow(i),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(ea(n),B(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!qp(a,t)&&!pA(a)&&!JR(a);le(n,[...fce(a)?[U6(),lr(c),kD(h)]:[j6(),lr(u)],...d?[po(-1)]:[],...qp(a,t)?[ef()]:[],...ZR(a)?[Nr(!1)]:[]])}n.className="",n.appendChild(l),JR(a)?B(n,"htSeparator"):typeof a.renderer=="function"?(B(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,i,r,o,u))):Yu(l,u),qp(a,t)?B(n,"htDisabled"):pA(a)?B(n,"htSelectionDisabled"):ZR(a)&&B(n,"htSubmenu")}}function _b(t,e,n){vce(t,e),e.set(t,n)}function vce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ao(t,e,n){return(e=Cce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cce(t){var e=yce(t,"string");return typeof e=="symbol"?e:e+""}function yce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mb(t,e,n){return t.set(AL(t,e),n),n}function Sa(t,e){return t.get(AL(t,e))}function AL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const vA=215;var yc=new WeakMap,km=new WeakMap,Lm=new WeakMap;class Yh{get tableBorderWidth(){return Sa(Lm,this)===void 0&&this.hotMenu&&Mb(Lm,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Sa(Lm,this)}constructor(e,n){var i=this;Ao(this,"hot",void 0),Ao(this,"options",void 0),Ao(this,"eventManager",new wo(this)),Ao(this,"container",void 0),Ao(this,"positioner",void 0),Ao(this,"hotMenu",null),Ao(this,"hotSubMenus",{}),Ao(this,"parentMenu",void 0),Ao(this,"menuItems",null),Ao(this,"origOutsideClickDeselects",null),_b(this,yc,void 0),_b(this,km,void 0),_b(this,Lm,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:vA,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new ice(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return i.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(r,o)=>{this.options.container!==this.hot.rootPortalElement&&(ae(this.options.container,/ht-theme-.*/g),B(this.options.container,r)),o||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=il(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Sa(yc,this)}getKeyboardShortcutsCtrl(){return Sa(km,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedActive()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedActive())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Uv(a=>this.openSubMenu(a),300),n=this.options.minWidth||vA;let i=!1,r=Tu(this.menuItems,a=>(a.key===Kf&&(i=!0),uce(a,this.hot)));if(r.length<1&&!i)r.push(RL()[Kf]);else if(r.length===0)return;r=dce(r,Ve);let o=!1;const s={data:r,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return te(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:wce(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{this.hotMenu.stylesHandler.isClassicTheme()?Sa(yc,this).setCurrentPage(l.row):Sa(yc,this).setPageCursorAt(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),SR()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!SR()||!Iu(a))&&o&&this.hasSelectedItem()&&(rs()||E0()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),Mb(yc,this,gce(this.hotMenu)),Mb(km,this,pce(this)),Sa(km,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Sa(yc,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedActive();if(n){const i=this.parentMenu.hotMenu.getCell(n[0],0);le(i,[Nr(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!sce(n))return!1;const i=this.hotMenu.getSourceDataAtRow(e),r=new Yh(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return r.setMenuItems(i.submenu.items),r.open(),r.setPosition(n.getBoundingClientRect()),this.hotSubMenus[i.key]=r,this.hot.getSettings().ariaTags&&le(n,[Nr(!0)]),r}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),i=this.hotSubMenus[n.key];if(i){i.destroy(),delete this.hotSubMenus[n.key];const r=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&le(r,[Nr(!1)])}}closeAllSubMenus(){O(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const i=this.hot.getSelectedRange(),r=i?rce(i):[];this.runLocalHooks("executeCommand",n.key,r,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,r,e)}isCommandPassive(e){return e.isCommand===!1||JR(e)||qp(e,this.hot)||ZR(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,i=e.hider.style,r=e.holder.style,o=parseInt(i.width,10),s=ji(n,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?yn(this.hotMenu.getCell(u,0)):0;return a+(l.name===Ve?1:h)},0);this.hotMenu.stylesHandler.isClassicTheme()?(r.width=`${o+3}px`,r.height=`${s+3}px`):(r.width=`${o}px`,r.height=`${s}px`),i.height=r.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let i=e,r;return i&&(ot(i)&&(i=i.call(this.hot),i===null||xt(i)?i="":i=i.toString()),i=i.replace(/[^A-Za-z0-9]/g,"_"),i=`${this.options.className}Sub_${i}`,r=n.querySelector(`.${this.options.className}.${i}`)),r||(r=n.createElement("div"),B(r,`htMenu handsontable ${this.options.className}`),i&&B(r,i),this.options.container.appendChild(r)),r}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&le(this.hotMenu.rootElement,[B6(),po(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!bu(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!bu(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Ce(e.target,"htCore")&&bu(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}ct(Yh,An);function bce(t,e){Sce(t,e),e.add(t)}function Sce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pb(t,e,n){return(e=Rce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rce(t){var e=Ece(t,"string");return typeof e=="symbol"?e:e+""}function Ece(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const af="contextMenu",Tce=70,CA=af;ie.getSingleton().register("afterContextMenuDefaultOptions");ie.getSingleton().register("beforeContextMenuShow");ie.getSingleton().register("afterContextMenuShow");ie.getSingleton().register("afterContextMenuHide");ie.getSingleton().register("afterContextMenuExecute");var Pd=new WeakSet;class fC extends qe{constructor(){super(...arguments),bce(this,Pd),Pb(this,"commandExecutor",new _L(this.hot)),Pb(this,"itemsFactory",null),Pb(this,"menu",null)}static get PLUGIN_KEY(){return af}static get PLUGIN_PRIORITY(){return Tce}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[uC,cC,Ve,_g,Mg,Ve,lC,Ig,Ve,hC,aC,Ve,Pg,Ve,Mr]}isEnabled(){return!!this.hot.getSettings()[af]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[af];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Yh(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>Fm(Pd,this,Mce).call(this)),this.menu.addLocalHook("afterOpen",()=>Fm(Pd,this,Pce).call(this)),this.menu.addLocalHook("afterClose",()=>Fm(Pd,this,Ice).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return e.executeCommand.call(e,...r)}),this.addHook("afterOnCellContextMenu",i=>Fm(Pd,this,_ce).call(this,i)),this.addHook("beforeDialogShow",()=>this.close()),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),i=oC(this.menu.container,this.hot.rootDocument);this.open({left:n.left+i.left,top:n.top+i.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:CA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(CA)}open(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.prepareMenuItems(),this.menu.open(),We(i,(r,o)=>{this.menu.setOffset(o,r)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.commandExecutor.execute(e,...i)}prepareMenuItems(){this.itemsFactory=new ML(this.hot,fC.DEFAULT_ITEMS);const e=this.hot.getSettings()[af],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const i=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),O(i,r=>this.commandExecutor.registerCommand(r.key,r))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function _ce(t){const e=this.hot.getSettings(),n=e.rowHeaders,i=e.colHeaders;function r(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),Ce(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||i)&&!r(o)&&!(Ce(o,"current")&&Ce(o,"wtBorder"))))return;const s=oC(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function Mce(){this.hot.runHooks("beforeContextMenuShow",this)}function Pce(){this.hot.runHooks("afterContextMenuShow",this)}function Ice(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}fC.SEPARATOR={name:Ve};function xce(t){return{key:"copy",name(){return this.getTranslatedPhrase(gT)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Oce(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeActive(),n=e?Ue(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(wT,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Ace(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeActive(),n=e?Ue(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(pT,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Hce(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeActive(),n=e?Ue(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(mT,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Nce(t){return{key:"cut",name(){return this.getTranslatedPhrase(vT)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class Dce{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class $ce{constructor(){this.clipboardData=new Dce}preventDefault(){}composedPath(){return[]}}function kce(t,e){HL(t,e),e.add(t)}function bc(t,e,n){HL(t,e),e.set(t,n)}function HL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function di(t,e){return t.get(oh(t,e))}function Sc(t,e,n){return t.set(oh(t,e),n),n}function oh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ra=new WeakMap,Ib=new WeakMap,Id=new WeakMap,QR=new WeakMap,eE=new WeakMap,xd=new WeakMap,Od=new WeakSet;class Lce{constructor(e){let{countRows:n,countColumns:i,rowsLimit:r,columnsLimit:o,countColumnHeaders:s}=e;kce(this,Od),bc(this,Ra,void 0),bc(this,Ib,void 0),bc(this,Id,void 0),bc(this,QR,void 0),bc(this,eE,void 0),bc(this,xd,void 0),Sc(Ib,this,n),Sc(Id,this,i),Sc(QR,this,r),Sc(eE,this,o),Sc(xd,this,s)}setSelectedRange(e){Sc(Ra,this,e)}getCellsRange(){if(di(Ib,this).call(this)===0||di(Id,this).call(this)===0)return null;const{row:e,col:n}=di(Ra,this).getTopStartCorner(),{row:i,col:r}=di(Ra,this).getBottomEndCorner(),o=oh(Od,this,Fce).call(this,e,i),s=oh(Od,this,xb).call(this,n,r);return{isRangeTrimmed:i!==o||r!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(di(Id,this).call(this)===0||di(xd,this).call(this)===0)return null;const{col:e}=di(Ra,this).getTopStartCorner(),{col:n}=di(Ra,this).getBottomEndCorner(),i=oh(Od,this,xb).call(this,e,n);return{isRangeTrimmed:n!==i,startRow:-1,startCol:e,endRow:-1,endCol:i}}getAllColumnHeadersRange(){if(di(Id,this).call(this)===0||di(xd,this).call(this)===0)return null;const{col:e}=di(Ra,this).getTopStartCorner(),{col:n}=di(Ra,this).getBottomEndCorner(),i=oh(Od,this,xb).call(this,e,n);return{isRangeTrimmed:n!==i,startRow:-di(xd,this).call(this),startCol:e,endRow:-1,endCol:i}}}function xb(t,e){return Math.min(e,Math.max(t+di(eE,this).call(this)-1,t))}function Fce(t,e){return Math.min(e,Math.max(t+di(QR,this).call(this)-1,t))}function NL(t){const e=[],n=[];return O(t,i=>{const r=Math.min(i.startRow,i.endRow),o=Math.max(i.startRow,i.endRow);he(r,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(i.startCol,i.endCol),a=Math.max(i.startCol,i.endCol);he(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function Vce(t,e){DL(t,e),e.add(t)}function Ea(t,e,n){DL(t,e),e.set(t,n)}function DL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ad(t,e,n){return(e=Wce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wce(t){var e=Bce(t,"string");return typeof e=="symbol"?e:e+""}function Bce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $i(t,e){return t.get(ii(t,e))}function Zr(t,e,n){return t.set(ii(t,e),n),n}function ii(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("afterCopyLimit");ie.getSingleton().register("modifyCopyableRange");ie.getSingleton().register("beforeCut");ie.getSingleton().register("afterCut");ie.getSingleton().register("beforePaste");ie.getSingleton().register("afterPaste");ie.getSingleton().register("beforeCopy");ie.getSingleton().register("afterCopy");const Ob="copyPaste",jce=80,Uce=["fragmentSelection"],$L="application/ht-source-data-json-html",yA=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var tE=new WeakMap,nE=new WeakMap,iE=new WeakMap,Rc=new WeakMap,Vm=new WeakMap,Wm=new WeakMap,Ec=new WeakMap,Kw=new WeakMap,fi=new WeakSet;class zce extends qe{constructor(){super(...arguments),Vce(this,fi),Ad(this,"columnsLimit",1/0),Ad(this,"rowsLimit",1/0),Ad(this,"pasteMode","overwrite"),Ad(this,"uiContainer",this.hot.rootDocument.body),Ea(this,tE,!1),Ea(this,nE,!1),Ea(this,iE,!1),Ea(this,Rc,"cells-only"),Ea(this,Vm,!1),Ea(this,Wm,!1),Ea(this,Ec,new Lce({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Ea(this,Kw,!1),Ad(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Ob}static get SETTING_KEYS(){return[Ob,...Uce]}static get PLUGIN_PRIORITY(){return jce}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[Ob]}enablePlugin(){var e,n,i=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Zr(tE,this,this.getSetting("copyColumnHeaders")),Zr(nE,this,this.getSetting("copyColumnGroupHeaders")),Zr(iE,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",r=>ii(fi,this,Kce).call(this,r)),this.addHook("afterSelection",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return ii(fi,i,Xce).call(i,...o)}),this.addHook("afterSelectionEnd",()=>ii(fi,this,qce).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return i.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return i.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return i.onPaste(...arguments)}),Wv()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return ii(fi,i,Zce).call(i,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return ii(fi,i,Jce).call(i,...o)}),this.addHook("afterSelection",()=>ii(fi,this,Qce).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Zr(Rc,this,e),Zr(Vm,this,!0),ii(fi,this,bA).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Zr(Wm,this,!0),ii(fi,this,bA).call(this,"cut")}getRangedCopyableData(e){return Iw(this.getRangedData(e))}getRangedData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=[],{rows:r,columns:o}=NL(e);return O(r,s=>{const a=[];O(o,l=>{if(s<0)a.push(this.hot.getColHeader(l,s));else{let u=n?this.hot.getCopyableSourceData(s,l):this.hot.getCopyableData(s,l);n&&me(u)&&(u=JSON.stringify(u)),a.push(u)}}),i.push(a)}),i}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const i=new $ce;e&&i.clipboardData.setData("text/plain",e),n&&i.clipboardData.setData("text/html",n),this.onPaste(i)}setCopyableText(){const e=this.hot.getSelectedRangeActive();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}$i(Ec,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);$i(Rc,this)==="column-headers-only"?n.set("headers",$i(Ec,this).getMostBottomColumnHeadersRange()):($i(Rc,this)==="with-column-headers"?n.set("headers",$i(Ec,this).getMostBottomColumnHeadersRange()):$i(Rc,this)==="with-column-group-headers"&&n.set("headers",$i(Ec,this).getAllColumnHeadersRange()),n.set("cells",$i(Ec,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(r=>r!==null).map(r=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=r;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const i=n.get("cells");if(i!==null&&i.isRangeTrimmed){const{startRow:r,startCol:o,endRow:s,endCol:a}=i;this.hot.runHooks("afterCopyLimit",s-r+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getSelectedRangeActive();if(!e.length)return[null,null,null,null];const r=e.length,o=e[0].length,s=[],{row:a,col:l}=i.getTopStartCorner(),{row:u,col:c}=i.getBottomEndCorner();let h=a,d=l,f=a,p=l;for(;s.length<r||h<=u;){const{skipRowOnPaste:b,visualRow:P}=this.hot.getCellMeta(h,l);if(h=P+1,b===!0)continue;f=P,d=l;const _=[],F=s.length%r;for(;_.length<o||d<=c;){var v;const{skipColumnOnPaste:I,visualCol:W}=this.hot.getCellMeta(P,d),k=this.hot.getSourceDataAtCell(P,d),$=_.length%o;if(d=W+1,I===!0)continue;p=W;const Y=n==null||(v=n[F])===null||v===void 0?void 0:v[$];let J=e[F][$];if(n&&$6(Y)){const U=JSON.parse(Y);(me(k)||k===null)&&(J=U)}_.push(J)}s.push(_)}return Zr(Kw,this,!0),this.hot.populateFromArray(a,l,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,l,f,p]}onCopy(e){const n=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!$i(Vm,this)||this.isEditorOpened()||Js(n)&&(r&&n!==i||!r&&n!==this.hot.rootDocument.body&&!Vp(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Zr(Vm,this,!1);const o=this.getRangedData(this.copyableRanges),s=this.getRangedData(this.copyableRanges,!0),a=ii(fi,this,Yce).call(this,this.copyableRanges);!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,a)&&(ii(fi,this,SA).call(this,e,o,s),this.hot.runHooks("afterCopy",o,this.copyableRanges,a)),Zr(Rc,this,"cells-only")}onCut(e){const n=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!$i(Wm,this)||this.isEditorOpened()||Js(n)&&(r&&n!==i||!r&&n!==this.hot.rootDocument.body&&!Vp(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Zr(Wm,this,!1);const o=this.getRangedData(this.copyableRanges),s=this.getRangedData(this.copyableRanges,!0);!!this.hot.runHooks("beforeCut",o,this.copyableRanges)&&(ii(fi,this,SA).call(this,e,o,s),this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges))}onPaste(e){const n=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=n==null?void 0:n.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||Js(n)&&(r&&n!==i||!r&&n!==this.hot.rootDocument.body&&!Vp(n,this.hot.rootElement)))return;e.preventDefault();let o,s;if(e&&typeof e.clipboardData<"u"){const h=e.clipboardData.getData($L);h&&(s=fx(h,this.hot.rootDocument).data);const d=C0(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});d&&/(<table)|(<TABLE)/g.test(d)?o=fx(d,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=tte(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[a,l,u,c]=this.populateValues(o,s);a!==null&&l!==null&&this.hot.selectCell(a,l,Math.min(this.hot.countRows()-1,u),Math.min(this.hot.countCols()-1,c)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function bA(t){if(Wv()){const e=this.hot.getSelectedRangeActive();if(e){const{row:n,col:i}=e.highlight,r=this.hot.getCell(n,i,!0);r&&i7(r,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function Yce(t){const{rows:e}=NL(t);let n=0;for(let i=0;i<e.length&&!(e[i]>=0);i++)n+=1;return{columnHeadersCount:n}}function Gce(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:n}=t.highlight,i=this.hot.getCell(e,n,!0);i&&r$(i)}}}function kL(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:n}=t.highlight,i=this.hot.getCell(e,n,!0);i!=null&&i.hasAttribute("contenteditable")&&o$(i)}}}function SA(t,e,n){const i=Iw(e);if(t&&t.clipboardData){const r=dx(e),o=dx(n);t.clipboardData.setData("text/plain",i),t.clipboardData.setData("text/html",[yA,r].join("")),t.clipboardData.setData($L,[yA,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i)}function Kce(t){t.items.push({name:"---------"},xce(this)),$i(tE,this)&&t.items.push(Hce(this)),$i(nE,this)&&t.items.push(Ace(this)),$i(iE,this)&&t.items.push(Oce(this)),t.items.push(Nce(this))}function Xce(t,e,n,i,r){$i(Kw,this)&&(r.value=!0),Zr(Kw,this,!1)}function qce(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function Zce(){ii(fi,this,kL).call(this)}function Jce(){ii(fi,this,Gce).call(this)}function Qce(){ii(fi,this,kL).call(this)}function LL(t,e){return`border_row${t}col${e}`}function lf(){return{width:1,color:"#000"}}function Us(){return{hide:!0}}function ehe(){return{width:1,color:"#000",cornerVisible:!1}}function Ab(t){if(te(t.start)||te(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(te(t.end)||te(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function Hd(t){return te(t.start)&&(t.left=t.start),te(t.end)&&(t.right=t.end),t}function Hb(t,e){return{id:LL(t,e),border:ehe(),row:t,col:e,top:Us(),bottom:Us(),start:Us(),end:Us()}}function the(t,e){return nn(e,"border")&&e.border&&(t.border=e.border),nn(e,"top")&&te(e.top)&&(e.top?(me(e.top)||(e.top=lf()),t.top=e.top):(e.top=Us(),t.top=e.top)),nn(e,"bottom")&&te(e.bottom)&&(e.bottom?(me(e.bottom)||(e.bottom=lf()),t.bottom=e.bottom):(e.bottom=Us(),t.bottom=e.bottom)),nn(e,"start")&&te(e.start)&&(e.start?(me(e.start)||(e.start=lf()),t.start=e.start):(e.start=Us(),t.start=e.start)),nn(e,"end")&&te(e.end)&&(e.end?(me(e.end)||(e.end=lf()),t.end=e.end):(e.end=Us(),t.end=e.end)),t}function na(t,e){let n=!1;return O(t.getSelectedRange(),i=>{i.forAll((r,o)=>{if(r<0||o<0)return;const s=t.getCellMeta(r,o).borders;if(s)if(e){if(!nn(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function gC(t){return`<span class="selected">â</span>${t}`}function nhe(t){return t.some(e=>te(e.left)||te(e.right))}function ihe(t){return t.some(e=>te(e.start)||te(e.end))}const rhe=new Map([["left","start"],["right","end"]]);function ohe(t){var e;return(e=rhe.get(t))!==null&&e!==void 0?e:t}function she(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(LT);return na(this,"bottom")&&(e=gC(e)),e},callback(e,n){const i=na(this,"bottom");t.prepareBorder(n,"bottom",i)}}}function ahe(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(FT);return na(this,e)&&(n=gC(n)),n},callback(n,i){const r=na(this,e);t.prepareBorder(i,e,r)}}}function lhe(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(VT)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!na(this)}}}function uhe(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(kT);return na(this,e)&&(n=gC(n)),n},callback(n,i){const r=na(this,e);t.prepareBorder(i,e,r)}}}function che(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase($T);return na(this,"top")&&(e=gC(e)),e},callback(e,n){const i=na(this,"top");t.prepareBorder(n,"top",i)}}}function hhe(t,e){dhe(t,e),e.add(t)}function dhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fhe(t,e,n){return(e=ghe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ghe(t){var e=mhe(t,"string");return typeof e=="symbol"?e:e+""}function mhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Zp="customBorders",phe=90,RA=["dashed","dotted","solid"];var Bm=new WeakSet;class whe extends qe{constructor(){super(...arguments),hhe(this,Bm),fhe(this,"savedBorders",[])}static get PLUGIN_KEY(){return Zp}static get PLUGIN_PRIORITY(){return phe}isEnabled(){return!!this.hot.getSettings()[Zp]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Nb(Bm,this,Che).call(this,e)),this.addHook("init",()=>Nb(Bm,this,yhe).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let i=["top","bottom","start","end"],r=null;n&&(this.checkSettingsCohesion([n]),i=Object.keys(n),r=Ab(n));const o=Eh(e),s=jf(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});O(e,a=>{s(a).forAll((l,u)=>{O(i,c=>{this.prepareBorderFromCustomAdded(l,u,r,ohe(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=Eh(e),i=jf(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),r=[];return O(e,o=>{i(o).forAll((s,a)=>{O(this.savedBorders,l=>{l.row===s&&l.col===a&&r.push(Hd(l))})})}),r}clearBorders(e){e?this.setBorders(e):(O(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const r=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,r,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:r})}prepareBorderFromCustomAdded(e,n,i,r){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=Hb(e,n);i&&(a=the(a,i),O(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,i),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",Hd(a)),this.insertBorderIntoSettings(a,r)}prepareBorderFromCustomAddedRange(e,n){const i=Math.min(e.to.row,this.hot.countRows()-1),r=Math.min(e.to.col,this.hot.countCols()-1);he(e.from.row,i,o=>{he(e.from.col,r,s=>{const a=Hb(o,s);let l=0;o===e.from.row&&nn(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&nn(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&nn(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&nn(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",Hd(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const i=LL(e,n);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,i,r){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=Hb(e,n):o=Ab(o),r?(o[i]=Us(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,i,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Hd(o)))):(o[i]=lf(),this.checkCustomSelectionsFromContextMenu(o,i,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Hd(o)))}prepareBorder(e,n,i){O(e,r=>{let{start:o,end:s}=r;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,i);else switch(n){case"noBorders":he(o.col,s.col,a=>{he(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":he(o.col,s.col,a=>{this.setBorder(o.row,a,n,i)});break;case"bottom":he(o.col,s.col,a=>{this.setBorder(s.row,a,n,i)});break;case"start":he(o.row,s.row,a=>{this.setBorder(a,o.col,n,i)});break;case"end":he(o.row,s.row,a=>{this.setBorder(a,s.col,n,i)});break}})}createCustomBorders(e){O(e,n=>{const i=Ab(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,i):this.prepareBorderFromCustomAdded(n.row,n.col,i)})}countHide(e){const{top:n,bottom:i,start:r,end:o}=e;return ji([n,i,r,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=tt(this.hot.selection.highlight.customSelections,i=>i.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){O(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){O(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=tt(this.savedBorders,i=>i.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):O(this.savedBorders,(r,o)=>{if(e.id===r.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,i){let r=!1;return O(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return O(s,a=>{a.toggleHiddenClass(n,i)}),r=!0,!1}}),r}checkCustomSelections(e,n,i){const r=this.countHide(e);let o=!1;return r===4?(this.removeAllBorders(e.row,e.col),o=!0):O(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),i){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);O(a,l=>{l.changeBorderStyle(i,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[Zp];if(Array.isArray(e)){const n=Si(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=nhe(e),i=ihe(e);if(n&&i)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".');Nb(Bm,this,vhe).call(this,e)}destroy(){super.destroy()}}function vhe(t){t.forEach(e=>{Object.keys(e).forEach(n=>{const i=e[n].style;te(i)&&!RA.includes(i)?($e(`The "${i}" border style is not supported. Please use one of the following styles: ${RA.join(", ")}.
The border style will be ignored.`),delete e[n].style):te(i)&&i==="solid"&&delete e[n].style})})}function Che(t){this.hot.getSettings()[Zp]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(DT)},disabled(){const e=this.getSelectedRangeActive();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[che(this),uhe(this),she(this),ahe(this),lhe(this)]}})}function yhe(){this.changeBorderSettings()}function bhe(t,e){She(t,e),e.add(t)}function She(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Db(t,e,n){return(e=Rhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rhe(t){var e=Ehe(t,"string");return typeof e=="symbol"?e:e+""}function Ehe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function EA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const TA="dragToScroll",The=100;var $b=new WeakSet;class _he extends qe{constructor(){super(...arguments),bhe(this,$b),Db(this,"boundaries",null),Db(this,"callback",null),Db(this,"listening",!1)}static get PLUGIN_KEY(){return TA}static get PLUGIN_PRIORITY(){return The}isEnabled(){return!!this.hot.getSettings()[TA]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>EA($b,this,_A).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>EA($b,this,_A).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let i=0,r=0;n<this.boundaries.top?r=n-this.boundaries.top:n>this.boundaries.bottom&&(r=n-this.boundaries.bottom),e<this.boundaries.left?i=e-this.boundaries.left:e>this.boundaries.right&&(i=e-this.boundaries.right),this.callback(i,r)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",i=>this.onMouseMove(i)),n=il(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function _A(t){if(Iu(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,i)=>{var r,o;const s=(r=e.scrollLeft)!==null&&r!==void 0?r:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(i)*20)}),this.listen()}function Mhe(t,e){FL(t,e),e.add(t)}function Phe(t,e,n){FL(t,e),e.set(t,n)}function FL(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kb(t,e,n){return(e=Ihe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ihe(t){var e=xhe(t,"string");return typeof e=="symbol"?e:e+""}function xhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ohe(t,e){return t.get(Pr(t,e))}function VL(t,e,n){return t.set(Pr(t,e),n),n}function Pr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("afterDropdownMenuDefaultOptions");ie.getSingleton().register("beforeDropdownMenuShow");ie.getSingleton().register("afterDropdownMenuShow");ie.getSingleton().register("afterDropdownMenuHide");ie.getSingleton().register("afterDropdownMenuExecute");const Jp="dropdownMenu",Ahe=230,Xf="changeType",Lb=Jp;var mC=new WeakMap,to=new WeakSet;class pC extends qe{static get PLUGIN_KEY(){return Jp}static get PLUGIN_PRIORITY(){return Ahe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[_g,Mg,Ve,Ig,Ve,sC,Ve,Pg,Ve,Mr]}constructor(e){super(e),Mhe(this,to),kb(this,"commandExecutor",new _L(this.hot)),kb(this,"itemsFactory",null),kb(this,"menu",null),Phe(this,mC,!1),this.hot.addHook("afterGetColHeader",(n,i)=>Pr(to,this,Nhe).call(this,n,i))}isEnabled(){return this.hot.getSettings()[Jp]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new ML(this.hot,pC.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Pr(to,e,Vhe).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Pr(to,e,Fhe).call(e,...o)}),this.addHook("beforeDialogShow",()=>this.close());const n=this.hot.getSettings()[Jp],i={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);const r=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Yh(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.hot.runHooks("beforeDropdownMenuSetItems",r),this.menu.setMenuItems(r),this.menu.addLocalHook("beforeOpen",()=>Pr(to,this,Dhe).call(this)),this.menu.addLocalHook("afterOpen",()=>Pr(to,this,$he).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>Pr(to,this,khe).call(this,o)),this.menu.addLocalHook("afterClose",()=>Pr(to,this,Lhe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),O(r,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:i}=this.hot.getSelectedRangeActive();if((i.isHeader()&&i.row===-1||i.isCell())&&i.col>=0){this.hot.selectColumns(i.col,i.col,-1);const{from:r}=this.hot.getSelectedRangeActive(),o=oC(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,r.col,!0).querySelector(`.${Xf}`),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var i;const r=(i=this.hot.getSelectedRangeActive())===null||i===void 0?void 0:i.highlight;return r&&this.hot.selection.isCellVisible(r)&&r.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:Lb},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var i;const r=(i=this.hot.getSelectedRangeActive())===null||i===void 0?void 0:i.highlight;return r&&this.hot.selection.isCellVisible(r)&&r.isCell()&&!this.menu.isOpened()},group:Lb}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Lb)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>Pr(to,this,Hhe).call(this,e))}open(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),We(i,(r,o)=>{this.menu.setOffset(o,r)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.commandExecutor.execute(e,...i)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function WL(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function Hhe(t){if(Ce(t.target,Xf)){const e=oC(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),VL(mC,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function Nhe(t,e){const n=e.parentNode;if(!n)return;const i=n.parentNode.childNodes,r=Array.prototype.indexOf.call(i,n);if(t<0||r!==i.length-1)return;const o=e.querySelector(`.${Xf}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=Xf,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(le(s,[Uu(),lr(" ")]),le(e,[ND("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function Dhe(){this.hot.runHooks("beforeDropdownMenuShow",this)}function $he(){this.hot.runHooks("afterDropdownMenuShow",this),Pr(to,this,WL).call(this,this.menu)}function khe(t){Pr(to,this,WL).call(this,t)}function Lhe(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function Fhe(t){return Ohe(mC,this)?null:t}function Vhe(t){Ce(t.target,Xf)&&VL(mC,this,!0)}pC.SEPARATOR={name:Ve};function MA(t,e,n){return(e=Whe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Whe(t){var e=Bhe(t,"string");return typeof e=="symbol"?e:e+""}function Bhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jhe{constructor(e){MA(this,"hot",void 0),MA(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:i,endCol:r}=this._getDataRange(),o=this.options,s=[];return he(e,i,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(he(n,r,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:i}=this._getDataRange(),r=this.hot.getRowHeader();he(n,i,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(r[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:i}=this._getDataRange(),r=this.hot.getColHeader();he(n,i,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(r[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[i=0,r=0,o=n,s=e]=this.options.range;return i=Math.max(i,0),r=Math.max(r,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:i,startCol:r,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function PA(t,e,n){return(e=Uhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uhe(t){var e=zhe(t,"string");return typeof e=="symbol"?e:e+""}function zhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vM{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){PA(this,"dataProvider",void 0),PA(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=ls(this.constructor.DEFAULT_OPTIONS);const i=new Date;return n=bn(ls(vM.DEFAULT_OPTIONS),n),n=bn(n,e),n.filename=v0(n.filename,{YYYY:i.getFullYear(),MM:`${i.getMonth()+1}`.padStart(2,"0"),DD:`${i.getDate()}`.padStart(2,"0")}),n}}function Yhe(t,e){Ghe(t,e),e.add(t)}function Ghe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const BL="\r",Khe='"',Xhe=`
`,qhe="=",Zhe="+",Jhe="-",Qhe="@",ede="	";var Fb=new WeakSet;class tde extends vM{constructor(){super(...arguments),Yhe(this,Fb)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let i=this.dataProvider.getColumnHeaders();const r=i.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?"\uFEFF":"";return r&&(i=tt(i,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),s&&(a+=e.columnDelimiter),a+=i.join(e.columnDelimiter),a+=e.rowDelimiter),O(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const c=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=c}),a}_escapeCell(e){let{force:n=!1,sanitizeValue:i=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=Tt(e);return r===""||(i&&(n=!0),i instanceof RegExp?r=IA(Fb,this,ide).call(this,r,i):typeof i=="function"?r=i(r):i&&(r=IA(Fb,this,nde).call(this,r)),(n||r.indexOf(BL)>=0||r.indexOf(Khe)>=0||r.indexOf(Xhe)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`)),r}}function nde(t){return t.startsWith(qhe)||t.startsWith(Zhe)||t.startsWith(Jhe)||t.startsWith(Qhe)||t.startsWith(ede)||t.startsWith(BL)?`'${t}`:t}function ide(t,e){return e.test(t)?`'${t}`:t}const rde="csv",rE={[rde]:tde};function ode(t,e,n){return typeof rE[t]=="function"?new rE[t](e,n):null}const sde="exportFile",ade=240;class lde extends qe{static get PLUGIN_KEY(){return sde}static get PLUGIN_PRIORITY(){return ade}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:i,rootWindow:r}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=r.URL||r.webkitURL,l=i.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),i.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),i.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!rE[e])throw new Error(`Export format type "${e}" is not supported.`);return ode(e,new jhe(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Tc(t,e,n){return(e=ude(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ude(t){var e=cde(t,"string");return typeof e=="symbol"?e:e+""}function cde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xg{constructor(e,n){let{id:i,stateless:r=!0}=n;Tc(this,"hot",void 0),Tc(this,"id",void 0),Tc(this,"elements",[]),Tc(this,"hidden",!1),Tc(this,"stateId",""),Tc(this,"state",void 0),this.hot=e,this.id=i,this.stateId=`Filters.component.${this.id}`,this.state=r?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Xv)}getElements(){return this.elements}reset(){O(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),O(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}ct(xg,An);const qf={};function rl(t,e){if(!qf[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:i}=qf[t];let r=e;return i.inputValuesDecorator&&(r=i.inputValuesDecorator(r)),function(o){return n.apply(o.meta.instance,[].concat([o],[r]))}}function gu(t){if(!qf[t])throw Error(`Filter condition "${t}" does not exist.`);return qf[t].descriptor}function mn(t,e,n){n.key=t,qf[t]={condition:e,descriptor:n}}const Wn="none";function hde(){return!0}mn(Wn,hde,{name:qv,inputsCount:0,showOperators:!1});const yf="empty";function dde(t){return rn(t.value)}mn(yf,dde,{name:GT,inputsCount:0,showOperators:!0});const Qp="not_empty";function fde(t,e){return!rl(yf,e)(t)}mn(Qp,fde,{name:KT,inputsCount:0,showOperators:!0});const bf="eq";function gde(t,e){let[n]=e;return Tt(t.value).toLocaleLowerCase(t.meta.locale)===Tt(n)}mn(bf,gde,{name:XT,inputsCount:1,showOperators:!0});const ew="neq";function mde(t,e){return!rl(bf,e)(t)}mn(ew,mde,{name:qT,inputsCount:1,showOperators:!0});const jL="gt";function pde(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>i}mn(jL,pde,{name:t_,inputsCount:1,showOperators:!0});const UL="gte";function wde(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>=i}mn(UL,wde,{name:n_,inputsCount:1,showOperators:!0});const zL="lt";function vde(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<i}mn(zL,vde,{name:i_,inputsCount:1,showOperators:!0});const YL="lte";function Cde(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<=i}mn(YL,Cde,{name:r_,inputsCount:1,showOperators:!0});const CM="date_after";function yde(t,e){let[n]=e;const i=K(t.value,t.meta.dateFormat),r=K(n,t.meta.dateFormat);return!i.isValid()||!r.isValid()?!1:i.diff(r)>=0}mn(CM,yde,{name:a_,inputsCount:1,showOperators:!0});const yM="date_before";function bde(t,e){let[n]=e;const i=K(t.value,t.meta.dateFormat),r=K(n,t.meta.dateFormat);return!i.isValid()||!r.isValid()?!1:i.diff(r)<=0}mn(yM,bde,{name:l_,inputsCount:1,showOperators:!0});const Xw="between";function Sde(t,e){let[n,i]=e,r=n,o=i;if(t.meta.type==="numeric"){const s=parseFloat(r,10),a=parseFloat(o,10);r=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=rl(yM,[o]),a=rl(CM,[r]);return s(t)&&a(t)}return t.value>=r&&t.value<=o}mn(Xw,Sde,{name:o_,inputsCount:2,showOperators:!0});const GL="not_between";function Rde(t,e){return!rl(Xw,e)(t)}mn(GL,Rde,{name:s_,inputsCount:2,showOperators:!0});const KL="begins_with";function Ede(t,e){let[n]=e;return Tt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Tt(n))}mn(KL,Ede,{name:ZT,inputsCount:1,showOperators:!0});const XL="ends_with";function Tde(t,e){let[n]=e;return Tt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Tt(n))}mn(XL,Tde,{name:JT,inputsCount:1,showOperators:!0});const bM="contains";function _de(t,e){let[n]=e;return Tt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Tt(n))>=0}mn(bM,_de,{name:QT,inputsCount:1,showOperators:!0});const qL="not_contains";function Mde(t,e){return!rl(bM,e)(t)}mn(qL,Mde,{name:e_,inputsCount:1,showOperators:!0});const ZL="date_tomorrow";function Pde(t){const e=K(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(K().subtract(-1,"days").startOf("day"),"d"):!1}mn(ZL,Pde,{name:c_,inputsCount:0});const JL="date_today";function Ide(t){const e=K(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(K().startOf("day"),"d"):!1}mn(JL,Ide,{name:u_,inputsCount:0});const QL="date_yesterday";function xde(t){const e=K(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(K().subtract(1,"days").startOf("day"),"d"):!1}mn(QL,xde,{name:h_,inputsCount:0});F9();function Ode(t,e){let n=t;return n===""&&(n=`(${e})`),n}function Og(t){const e=new Set(t);return function(n){return e.has(n)}}function SM(t){return t??""}function oE(t){return Array.from(new Set(t)).map(e=>SM(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function xA(t,e,n,i){const r=[],o=t===e;let s;return o||(s=Og(e)),t.forEach(a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:Ode(a,n)};i&&i(u),r.push(u)}),r}const mu="by_value";function Ade(t,e){let[n]=e;return n(t.value)}mn(mu,Ade,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Og(e)]},showOperators:!1});const Zf={};function Hde(t){if(!Zf[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Zf[t].func;return function(n,i){return e(n,i)}}function Nde(t){return Zf[t].name}function RM(t,e,n){Zf[t]={name:e,func:n}}const tl="conjunction",Dde=g_;function $de(t,e){return t.every(n=>n.func(e))}RM(tl,Dde,$de);const qw="disjunction",kde=Zv;function Lde(t,e){return t.some(n=>n.func(e))}RM(qw,kde,Lde);const EM="disjunctionWithExtraCondition",Fde=Zv;function Vde(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}RM(EM,Fde,Vde);const Wde="numeric",eF="text",Bde="date",OA={[Wde]:[Wn,Ve,yf,Qp,Ve,bf,ew,Ve,jL,UL,zL,YL,Xw,GL],[eF]:[Wn,Ve,yf,Qp,Ve,bf,ew,Ve,KL,XL,Ve,bM,qL],[Bde]:[Wn,Ve,yf,Qp,Ve,bf,ew,Ve,yM,CM,Xw,Ve,ZL,JL,QL]};function jde(t){const e=[];let n=t;return OA[n]||(n=eF),O(OA[n],i=>{let r;i===Ve?r={name:Ve}:r=ls(gu(i)),e.push(r)}),e}function Nd(t,e,n){return(e=Ude(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ude(t){var e=zde(t,"string");return typeof e=="symbol"?e:e+""}function zde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Vb="built",Wb="building",AA=["click","input","keydown","keypress","keyup","focus","blur","change"];let ho=class tF{static get DEFAULTS(){return ls({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){Nd(this,"hot",void 0),Nd(this,"eventManager",new wo(this)),Nd(this,"options",void 0),Nd(this,"_element",void 0),Nd(this,"buildState",void 0),this.hot=e,this.options=bn(tF.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Wb?this._element:this.buildState===Vb?(this.update(),this._element):(this.buildState=Wb,this.build(),this.buildState=Vb,this._element)}isBuilt(){return this.buildState===Vb}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Ri)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,i)=>{this.eventManager.addEventListener(n,i,r=>this.runLocalHooks(i,r,this))};if(this.buildState||(this.buildState=Wb),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&B(this._element,this.options.className),this.options.children.length)O(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),We(this.options,(i,r)=>{n[r]!==void 0&&r!=="className"&&r!=="tagName"&&r!=="children"&&(n[r]=this.translateIfPossible(i))}),this._element.appendChild(n),O(AA,i=>e(n,i))}else O(AA,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};ct(ho,An);function Yde(t,e){nF(t,e),e.add(t)}function Gde(t,e,n){nF(t,e),e.set(t,n)}function nF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jm(t,e){return t.get(TM(t,e))}function Kde(t,e,n){return t.set(TM(t,e),n),n}function TM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _c=new WeakMap,HA=new WeakSet;class nl extends ho{static get DEFAULTS(){return ls({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,bn(nl.DEFAULTS,n)),Yde(this,HA),Gde(this,_c,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>TM(HA,this,Xde).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");Kde(_c,this,this._element.firstChild),B(this._element,"htUIInput"),B(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(jm(_c,this).type=this.options.type,jm(_c,this).placeholder=this.translateIfPossible(this.options.placeholder),jm(_c,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&jm(_c,this).focus()}}function Xde(t){this.options.value=t.target.value}function qde(t,e){iF(t,e),e.add(t)}function Dd(t,e,n){iF(t,e),e.set(t,n)}function iF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mc(t,e,n){return t.set(Sf(t,e),n),n}function Ft(t,e){return t.get(Sf(t,e))}function Sf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Tn=new WeakMap,Um=new WeakMap,zm=new WeakMap,Bb=new WeakMap,Ym=new WeakMap,Gm=new WeakSet;class Jf extends ho{static get DEFAULTS(){return ls({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,bn(Jf.DEFAULTS,n)),qde(this,Gm),Dd(this,Tn,null),Dd(this,Um,[]),Dd(this,zm,void 0),Dd(this,Bb,void 0),Dd(this,Ym,void 0),this.registerHooks()}getMenu(){return Ft(Tn,this)}registerHooks(){this.addLocalHook("click",()=>Sf(Gm,this,Qde).call(this))}setItems(e){Mc(Um,this,this.translateNames(e)),Ft(Tn,this)&&Ft(Tn,this).setMenuItems(Ft(Um,this))}translateNames(e){return O(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),Mc(Tn,this,new Yh(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Ft(Tn,this).setMenuItems(Ft(Um,this));const e=new ho(this.hot,{className:"htUISelectCaption"}),n=new ho(this.hot,{className:"htUISelectDropdown"});Mc(zm,this,e),Mc(Bb,this,e.element),Mc(Ym,this,n),this.hot.getSettings().ariaTags&&(le(n.element,[Uu()]),le(this._element,[HD()])),O([e,n],i=>this._element.appendChild(i.element)),Ft(Tn,this).addLocalHook("select",i=>Sf(Gm,this,Zde).call(this,i)),Ft(Tn,this).addLocalHook("afterClose",()=>Sf(Gm,this,Jde).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Ft(Tn,this).hot.getTranslatedPhrase(qv),Ft(Bb,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Ft(Tn,this)&&(Ft(Tn,this).open(),Ft(Tn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Ft(Tn,this).getNavigator().toFirstItem(),Ft(Tn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Ft(Tn,this)&&Ft(Tn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Ft(Tn,this)&&(Ft(Tn,this).destroy(),Mc(Tn,this,null)),Ft(zm,this)&&Ft(zm,this).destroy(),Ft(Ym,this)&&Ft(Ym,this).destroy(),super.destroy()}}function Zde(t){t.name!==Ve&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function Jde(){this.runLocalHooks("afterClose")}function Qde(){this.openOptions()}function efe(t,e){tfe(t,e),e.add(t)}function tfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function NA(t,e,n){return(e=nfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nfe(t){var e=ife(t,"string");return typeof e=="symbol"?e:e+""}function ife(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var jb=new WeakSet;class sE extends xg{constructor(e,n){super(e,{id:n.id,stateless:!1}),efe(this,jb),NA(this,"name",""),NA(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Jf(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new nl(this.hot,{placeholder:y_})),this.elements.push(new nl(this.hot,{placeholder:b_})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>DA(jb,this,rfe).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),O(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>DA(jb,this,ofe).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=ls(e.command);n.name.startsWith(Kt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),O(e.args,(i,r)=>{if(r>n.inputsCount-1)return!1;const o=this.getInputElement(r);o.setValue(i),o[n.inputsCount>r?"show":"hide"](),r||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||gu(Wn),n=[];return O(this.getInputElements(),(i,r)=>{e.inputsCount>r&&n.push(i.getValue())}),{command:e,args:n}}updateState(e,n){const i=gu(e?e.name:Wn);this.state.setValueAtIndex(n,{command:i,args:e?e.args:[]}),e||O(this.getInputElements(),r=>r.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Jf)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof nl)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,i,r,o,s)=>{B(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&B(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return B(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||O(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[gu(Wn)];if(e!==null){const{visualIndex:i}=e;n=jde(this.hot.getDataType(0,i,this.hot.countRows(),i))}O(this.getInputElements(),i=>i.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function rfe(t){O(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function ofe(t){Sh(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),$r(t))}function $A(t,e,n){sfe(t,e),e.set(t,n)}function sfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $d(t,e){return t.get(rF(t,e))}function kA(t,e,n){return t.set(rF(t,e),n),n}function rF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Pc=new WeakMap,Ub=new WeakMap;class Zw extends ho{static get DEFAULTS(){return ls({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,bn(Zw.DEFAULTS,n)),$A(this,Pc,void 0),$A(this,Ub,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),kA(Ub,this,e),kA(Pc,this,this._element.firstChild),$d(Pc,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&($d(Ub,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?$d(Pc,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&($d(Pc,this).checked=e)}focus(){this.isBuilt()&&$d(Pc,this).focus()}}function afe(t,e){lfe(t,e),e.add(t)}function lfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ufe(t,e,n){return(e=cfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cfe(t){var e=hfe(t,"string");return typeof e=="symbol"?e:e+""}function hfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dfe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const LA=0;var FA=new WeakSet;class ffe extends xg{constructor(e,n){super(e,{id:n.id,stateless:!1}),afe(this,FA),ufe(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(B(n.parentNode,"htFiltersMenuOperators"),O(this.elements,i=>n.appendChild(i.element)),n)}}buildOperatorsElement(){const e=[tl,qw];O(e,n=>{const i=new Zw(this.hot,{name:"operator",label:{htmlFor:n,textContent:Nde(n)},value:n,checked:n===e[LA],id:n});i.addLocalHook("change",r=>dfe(FA,this,gfe).call(this,r)),this.elements.push(i)})}setChecked(e){if(this.elements.length<e)throw Error(nt`Radio button with index ${e} doesn't exist.`);O(this.elements,(n,i)=>{n.setChecked(i===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof Zw&&n.isChecked());return e?e.getValue():tl}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&O(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:tl,n=arguments.length>1?arguments[1]:void 0,i=e;i===EM&&(i=qw),this.state.setValueAtIndex(n,i)}reset(){this.setChecked(LA)}}function gfe(t){this.setState(t.target.value)}function mfe(t,e,n){pfe(t,e),e.set(t,n)}function pfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zb(t,e){return t.get(oF(t,e))}function wfe(t,e,n){return t.set(oF(t,e),n),n}function oF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var kd=new WeakMap;class Qf extends ho{static get DEFAULTS(){return ls({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,bn(Qf.DEFAULTS,n)),mfe(this,kd,void 0)}build(){super.build(),wfe(kd,this,this._element.firstChild)}update(){this.isBuilt()&&(zb(kd,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&zb(kd,this).focus()}activate(){zb(kd,this).click()}}function vfe(t,e){sF(t,e),e.add(t)}function Ic(t,e,n){sF(t,e),e.set(t,n)}function sF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Te(t,e){return t.get(sh(t,e))}function Yr(t,e,n){return t.set(sh(t,e),n),n}function sh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const VA="multipleSelect.itemBox";var io=new WeakMap,It=new WeakMap,Yb=new WeakMap,Ps=new WeakMap,Ta=new WeakMap,_a=new WeakMap,Ld=new WeakSet;class eg extends ho{static get DEFAULTS(){return ls({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,bn(eg.DEFAULTS,n)),vfe(this,Ld),Ic(this,io,[]),Ic(this,It,void 0),Ic(this,Yb,void 0),Ic(this,Ps,void 0),Ic(this,Ta,void 0),Ic(this,_a,void 0),Yr(Ps,this,new nl(this.hot,{placeholder:C_,className:"htUIMultipleSelectSearch"})),Yr(Ta,this,new Qf(this.hot,{textContent:m_,className:"htUISelectAll"})),Yr(_a,this,new Qf(this.hot,{textContent:p_,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Te(It,this)}registerHooks(){Te(Ps,this).addLocalHook("keydown",e=>sh(Ld,this,yfe).call(this,e)),Te(Ps,this).addLocalHook("input",e=>sh(Ld,this,Cfe).call(this,e)),Te(Ta,this).addLocalHook("click",e=>sh(Ld,this,bfe).call(this,e)),Te(_a,this).addLocalHook("click",e=>sh(Ld,this,Sfe).call(this,e))}setItems(e){var n;Yr(io,this,e),(n=Te(It,this))===null||n===void 0||n.loadData(Te(io,this))}setLocale(e){Yr(Yb,this,e)}getLocale(){return Te(Yb,this)}getItems(){return[...Te(io,this)]}getValue(){return Efe(Te(io,this))}getSearchInputElement(){return Te(Ps,this)}getSelectAllElement(){return Te(Ta,this)}getClearAllElement(){return Te(_a,this)}isSelectedAllValues(){return Te(io,this).length===this.getValue().length}build(){var e;super.build();const{rootDocument:n}=this.hot,i=n.createElement("div"),r=new ho(this.hot,{className:"htUISelectionControls",children:[Te(Ta,this),Te(_a,this)]});this._element.appendChild(Te(Ps,this).element),this._element.appendChild(r.element),this._element.appendChild(i),(e=Te(It,this))===null||e===void 0||e.destroy(),B(i,"htUIMultipleSelectHot"),Yr(It,this,new this.hot.constructor(i,{data:[[]],columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(a,l,u,c,h,d)=>{a.title=d.instance.getDataAtRowProp(l,d.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Te(It,this).listen()},modifyColWidth:a=>{const l=Te(It,this).container.scrollWidth-hn(n);return a!==void 0&&a<l?l:a},autoColumnSize:!0,autoRowSize:!1,hiddenRows:!0,maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Te(It,this).init();const s=Te(It,this).getShortcutManager().getContext("grid");s.removeShortcutsByKeys(["Tab"]),s.removeShortcutsByKeys(["Shift","Tab"]),s.addShortcut({keys:[["Escape"]],callback:a=>{this.runLocalHooks("keydown",a,this)},group:VA}),s.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:a=>{Te(It,this).deselectCell(),this.runLocalHooks("keydown",a,this),this.runLocalHooks("listTabKeydown",a,this)},group:VA})}focus(){this.isBuilt()&&Te(It,this).listen()}reset(){Te(Ps,this).reset(),Te(Ta,this).reset(),Te(_a,this).reset()}update(){!this.isBuilt()||Te(It,this).rootElement.offsetHeight===0||(Te(It,this).updateSettings({data:Rfe(Te(io,this),this.options.value)}),super.update())}destroy(){var e;(e=Te(It,this))===null||e===void 0||e.destroy(),Te(Ps,this).destroy(),Te(_a,this).destroy(),Te(Ta,this).destroy(),Yr(Ps,this,null),Yr(_a,this,null),Yr(Ta,this,null),Yr(It,this,null),Yr(io,this,null),super.destroy()}}function Cfe(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());if(this.options.searchMode==="apply"){const n=Te(It,this).getPlugin("hiddenRows");n.showRows(n.getHiddenRows()),Te(io,this).forEach((i,r)=>{i.checked=`${i.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0,i.checked||n.hideRow(r)}),Te(It,this).view.adjustElementsSize(),Te(It,this).render()}else{let n;e===""?n=[...Te(io,this)]:n=Te(io,this).filter(i=>`${i.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Te(It,this).loadData(n)}}function yfe(t){this.runLocalHooks("keydown",t,this),s$(Sh,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),$r(t),Te(It,this).listen(),Te(It,this).selectCell(0,0))}function bfe(t){const e=[];t.preventDefault(),Te(It,this).getSourceData().forEach((n,i)=>{n.checked=!0,e.push(L$(n,i)[0])}),Te(It,this).setSourceDataAtCell(e)}function Sfe(t){const e=[];t.preventDefault(),Te(It,this).getSourceData().forEach((n,i)=>{n.checked=!1,e.push(L$(n,i)[0])}),Te(It,this).setSourceDataAtCell(e)}function Rfe(t,e){const n=Og(e);return t.map(i=>(i.checked=n(i.value),i))}function Efe(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function Tfe(t,e){_fe(t,e),e.add(t)}function _fe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function WA(t,e,n){return(e=Mfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mfe(t){var e=Pfe(t,"string");return typeof e=="symbol"?e:e+""}function Pfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Km(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Fd=new WeakSet;class Ife extends xg{constructor(e,n){super(e,{id:n.id,stateless:!1}),Tfe(this,Fd),WA(this,"name",""),WA(this,"searchMode",void 0),this.name=n.name,this.searchMode=n.searchMode,this.elements.push(new eg(this.hot,{searchMode:this.searchMode})),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Km(Fd,this,xfe).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>Km(Fd,this,Ofe).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===mu){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?Wn:mu},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(i,r,o,s,a)=>{const[l]=Tu(r,h=>h.name===mu),u={},c=this.hot.getTranslatedPhrase(Mw);if(l){const h=s(i,a),d=tt(h,_=>_.value),f=new Map(h.map(_=>[_.value,this.hot.getCellMeta(_.meta.visualRow,_.meta.visualCol)])),p=oE(d);o&&(l.args[0]=o);const v=[],b=xA(p,l.args[0],c,_=>{_.checked&&v.push(_.value),Km(Fd,this,BA).call(this,_,f)}),P=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,P).locale,u.args=[v],u.command=gu(mu),u.itemsSnapshot=b}else u.args=[],u.command=gu(Wn);this.state.setValueAtIndex(i,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof eg)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,i,r,o,s)=>{B(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return B(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||O(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Mw),n=this._getColumnVisibleValues(),i=n.map(l=>l.value),r=new Map(n.map(l=>[l.value,l.meta])),o=oE(i),s=xA(o,o,e,l=>{Km(Fd,this,BA).call(this,l,r)});this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(o);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:tt(this.hot.getDataAtCol(e.visualIndex),(n,i)=>({value:SM(n),meta:this.hot.getCellMeta(i,e.visualIndex)}))}}function xfe(t){Sh(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),$r(t)),Sh(t.keyCode,"ENTER")&&(this.searchMode==="apply"&&this.runLocalHooks("accept"),$r(t))}function BA(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function Ofe(t,e){switch(e.type){case"numeric":return zk(t,e);default:return t}}var aF;function Afe(t,e){Hfe(t,e),e.add(t)}function Hfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nfe(t,e,n){return(e=Dfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dfe(t){var e=$fe(t,"string");return typeof e=="symbol"?e:e+""}function $fe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kfe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var jA=new WeakSet;class tg extends xg{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),Afe(this,jA),Nfe(this,"name",""),this.name=n.name,this.elements.push(new nl(this.hot,{type:"button",value:w_,className:"htUIButton htUIButtonOK",identifier:tg.BUTTON_OK})),this.elements.push(new nl(this.hot,{type:"button",value:v_,className:"htUIButton htUIButtonCancel",identifier:tg.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){O(this.elements,e=>{e.addLocalHook("click",(n,i)=>kfe(jA,this,Lfe).call(this,n,i))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(B(n.parentNode,"htFiltersMenuActionBar"),O(this.elements,i=>n.appendChild(i.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}aF=tg;function Lfe(t,e){e.options.identifier===aF.BUTTON_OK?this.accept():this.cancel()}function Gb(t,e,n){return(e=Ffe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ffe(t){var e=Vfe(t,"string");return typeof e=="symbol"?e:e+""}function Vfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const UA="ConditionCollection.filteringStates";class _M{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Gb(this,"hot",void 0),Gb(this,"isMapRegistrable",void 0),Gb(this,"filteringStates",new Xv),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(UA,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var i;const r=this.filteringStates.getValueAtIndex(n),o=(i=r==null?void 0:r.conditions)!==null&&i!==void 0?i:[],s=r==null?void 0:r.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:tl;return e.length?Hde(i)(e,n):!0}addCondition(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:tl,r=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=n.args.map(c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==i)throw Error(nt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(xt(Zf[i]))throw new Error(nt`Unexpected operation named \`${i}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:i,conditions:[{name:a,args:s,func:rl(a,s)}]},r):u.push({name:a,args:s,func:rl(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,i;return(n=(i=this.filteringStates.getValueAtIndex(e))===null||i===void 0?void 0:i.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[i,{operation:r,conditions:o}]=n;return e.push({column:i,operation:r,conditions:o.map(s=>{let{name:a,args:l}=s;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(i=>this.addCondition(n.column,i))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const i=this.getConditions(e);return n?i.some(r=>r.name===n):i.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(UA),this.filteringStates=null,this.clearLocalHooks()}}ct(_M,An);function zA(t,e,n){return(e=Wfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wfe(t){var e=Bfe(t,"string");return typeof e=="symbol"?e:e+""}function Bfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lF{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];zA(this,"conditionCollection",void 0),zA(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return O(this.conditionCollection.getFilteredColumns(),(n,i)=>{let r=this.columnDataFactory(n);i&&(r=this._getIntersectData(r,e)),e=this.filterByColumn(n,r)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=[];return O(n,r=>{r!==void 0&&this.conditionCollection.isMatch(r,e)&&i.push(r)}),i}_getIntersectData(e,n){const i=[];return O(n,r=>{const o=r.meta.visualRow;e[o]!==void 0&&(i[o]=e[o])}),i}}function jfe(t,e){Ufe(t,e),e.add(t)}function Ufe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hl(t,e,n){return(e=zfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zfe(t){var e=Yfe(t,"string");return typeof e=="symbol"?e:e+""}function Yfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Xm=new WeakSet;class uF{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];jfe(this,Xm),Hl(this,"hot",void 0),Hl(this,"conditionCollection",void 0),Hl(this,"columnDataFactory",void 0),Hl(this,"changes",[]),Hl(this,"grouping",!1),Hl(this,"latestEditedColumnPosition",-1),Hl(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=i,this.conditionCollection.addLocalHook("beforeRemove",r=>Kb(Xm,this,Gfe).call(this,r)),this.conditionCollection.addLocalHook("afterRemove",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("afterAdd",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("beforeClean",()=>Kb(Xm,this,Kfe).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>Kb(Xm,this,Xfe).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,O(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var i=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const r=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=r.slice(0,o),a=r.slice(o);a.length&&a[0].column===e&&a.shift();const l=r7(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new _M(i.hot,!1),p=[].concat(c,d);f.importAllConditions(p);const v=i.columnDataFactory(h);let b;f.isEmpty()?b=v:b=new lF(f,_=>i.columnDataFactory(_)).filter(),b=tt(b,_=>_.meta.visualRow);const P=Og(b);return f.destroy(),Tu(v,_=>P(_.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),We(this,(e,n)=>{this[n]=null})}}function Gfe(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function Kfe(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Xfe(){O(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}ct(uF,An);function qfe(t){return IL({initialPage:0,size:()=>t.length,onItemSelect:(n,i)=>{const r=t[n];if(r instanceof eg)return i;if(r.element&&!Pu(r.element))return!1;r.focus()}})}const Vd="filters";function Zfe(t,e){let n=-1,i;const r=qfe(e),o=h=>()=>{i.isOpened()&&i.getKeyboardShortcutsCtrl().listen(Vd),r.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof ho&&(h.addLocalHook("click",o(h)),h.addLocalHook("focus",o(h)),h.addLocalHook("afterClose",o(h)))}),l(t);function s(h){const d=i.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();r.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(Vd),callback:()=>{h.isSubMenu()&&h.close(),d.listen(Vd)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:p=>{const v=i.getNavigator();v.getCurrentPage()>-1&&(n=v.getCurrentPage()),v.clear(),p.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{i.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:p=>{const v=e[r.getCurrentPage()];v instanceof Jf&&(v.openOptions(),p.preventDefault()),v instanceof Qf&&(v.activate(),p.preventDefault()),v instanceof ho||p.preventDefault()}}],Vd)}function a(){i.focus(),i.getKeyboardShortcutsCtrl().listen(Vd)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||r.clear()}),h.addLocalHook("afterSubmenuOpen",s),h.addLocalHook("afterOpen",s),i=h}function u(){return i}function c(){return n}return{...r,listen:a,setMenu:l,getMenu:u,getLastMenuPage:c}}function Jfe(t,e){cF(t,e),e.add(t)}function Xb(t,e,n){cF(t,e),e.set(t,n)}function cF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wd(t,e,n){return(e=Qfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qfe(t){var e=ege(t,"string");return typeof e=="symbol"?e:e+""}function ege(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tw(t,e,n){return t.set(Ai(t,e),n),n}function Ir(t,e){return t.get(Ai(t,e))}function Ai(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const aE="filters",tge=250,YA=aE;var Hs=new WeakMap,lE=new WeakMap,su=new WeakMap,Gi=new WeakSet;class nge extends qe{static get PLUGIN_KEY(){return aE}static get PLUGIN_PRIORITY(){return tge}static get DEFAULT_SETTINGS(){return{searchMode:"show"}}static get SETTINGS_VALIDATORS(){return{searchMode:e=>typeof e=="string"&&["show","apply"].includes(e)}}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,Jfe(this,Gi),Wd(this,"dropdownMenuPlugin",null),Wd(this,"conditionCollection",null),Wd(this,"conditionUpdateObserver",null),Wd(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Wd(this,"filtersRowsMap",null),Xb(this,Hs,void 0),Xb(this,lE,new WeakSet),Xb(this,su,[]),this.hot.addHook("afterGetColHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Ai(Gi,n,uge).call(n,...r)})}isEnabled(){return!!this.hot.getSettings()[aE]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new bg),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,i=n&&n.uiContainer||this.hot.rootPortalElement,r=a=>(a.addLocalHook("accept",()=>Ai(Gi,this,GA).call(this,"accept")),a.addLocalHook("cancel",()=>Ai(Gi,this,GA).call(this,"cancel")),a.addLocalHook("change",l=>Ai(Gi,this,lge).call(this,a,l)),a),o=()=>`${this.hot.getTranslatedPhrase(d_)}:`,s=()=>`${this.hot.getTranslatedPhrase(f_)}:`;if(!this.components.get("filter_by_condition")){const a=new sE(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:i});a.addLocalHook("afterClose",()=>Ai(Gi,this,KA).call(this)),this.components.set("filter_by_condition",r(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new ffe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new sE(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:i});a.addLocalHook("afterClose",()=>Ai(Gi,this,KA).call(this)),this.components.set("filter_by_condition2",r(a))}if(!this.components.get("filter_by_value")){const a=this.getSetting("searchMode");this.components.set("filter_by_value",r(new Ife(this.hot,{id:"filter_by_value",name:s,searchMode:a})))}if(this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new tg(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new _M(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new uF(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>Ai(Gi,this,cge).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return Ai(Gi,e,age).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>Ai(Gi,this,sge).call(this)),this.addHook("afterDropdownMenuShow",()=>Ai(Gi,this,rge).call(this)),this.addHook("afterDropdownMenuHide",()=>Ai(Gi,this,oge).call(this)),this.addHook("afterChange",a=>Ai(Gi,this,ige).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Ir(Hs,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const u=Ir(Hs,this).getMenu(),c=u.getNavigator(),h=Ir(Hs,this).getLastMenuPage();u.focus(),h>0?c.setCurrentPage(h):c.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];tw(Hs,this,Zfe(this.dropdownMenuPlugin.menu,a));const l=u=>{Ir(Hs,this).listen(),u.preventDefault(),Sh(u.keyCode,"TAB")&&(u.shiftKey?Ir(Hs,this).toPreviousItem():Ir(Hs,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,i)=>{n.destroy(),this.components.set(i,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:YA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(YA)}addCondition(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:tl;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:i},r)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),i=!this.conditionCollection.isEmpty();let r=[];const o=this.exportConditions(),s=this.hot.runHooks("beforeFilter",o,Ir(su,this));if(s!==!1&&i){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),r=tt(n.filter(),u=>u.meta.visualRow);const l=Og(r);he(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),O(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!r.length&&this.hot.deselectCell(),tw(su,this,this.exportConditions())}else s!==!1&&!i?(tw(su,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(Ir(su,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeActive().highlight.col),s!==!1&&(this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),i=[];return O(this.hot.getSourceDataAtCol(n),(r,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:p}=this.hot.getCellMeta(o,n),v=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:r;i.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:p},value:SM(v)})}),i}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),i=oE(n);this.conditionUpdateObserver.updateStatesAtColumn(e,i)}restoreComponents(e){var n;const i=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(r=>{r.isHidden()||r.restoreState(i)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,i,r){let o=e;return o===qw&&n.command.key!==Wn&&i.command.key!==Wn&&r.command.key!==Wn?o=EM:r.command.key!==Wn&&(n.command.key===Wn||i.command.key===Wn)&&(o=tl),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),i=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...i):this.hideComponents(...i)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new lF(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return O(r,s=>{O(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const i=this.dropdownMenuPlugin.menu.hotMenu,r=i.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?r.showRows(l):r.hideRows(l),i.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function ige(t){t&&O(t,e=>{const[,n]=e,i=this.hot.propToCol(n);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}function rge(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function oge(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function sge(){const t=this.dropdownMenuPlugin.menu;Ir(lE,this).has(t)||Ir(Hs,this).setMenu(t),Ir(lE,this).add(t)}function age(t){t.items.push({name:Ve}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function GA(t){var e;if(t==="accept"){const i=this.getSelectedColumn();if(i===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:r}=i,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(r);u===-1&&(u=void 0),this.conditionCollection.removeConditions(r),o.command.key!==Wn&&(this.conditionCollection.addCondition(r,o,l,u),s.command.key!==Wn&&this.conditionCollection.addCondition(r,s,l,u)),a.command.key!==Wn&&this.conditionCollection.addCondition(r,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(r)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function lge(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===sE&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function KA(){this.setListeningDropdownMenu()}function uge(t,e,n){const i=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(i)&&n===this.hot.view.getColumnHeadersCount()-1?B(e,"htFiltersActive"):ae(e,"htFiltersActive")}function cge(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:i},conditionArgsChange:r}=t;Array.isArray(r)&&tw(su,this,Ir(su,this).map(a=>(a.column===i&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...r]])}),a)));const o=n.filter(a=>a.name===mu),s=n.filter(a=>a.name!==mu);if(o.length>=2||s.length>=3)$e(nt`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(i);this.components.get("filter_by_condition").updateState(s[0],i),this.components.get("filter_by_condition2").updateState(s[1],i),this.components.get("filter_operators").updateState(a,i),this.components.get("filter_by_value").updateState(t)}}const hF="internal-use-in-handsontable",uE={licenseKey:hF,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function dF(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[ri])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function fF(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function hge(t){var e;const n=t[ri],i=fF(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),r=dF(t);return{...uE,...i,...r}}function dge(t){var e;const n=t[ri],i=fF(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),r=dF(t);return{...i,...r}}function fge(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function wC(){const t="engine_relationship",e=Vr(ri);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function MM(){const t="shared_engine_usage",e=Vr(ri);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function gge(t){const e=t.getSettings(),n=e[ri],i=n==null?void 0:n.engine;if(n===!0||xt(i))return null;if(typeof i.hyperformula=="function"||typeof i=="function"){var r;return mge((r=i.hyperformula)!==null&&r!==void 0?r:i,e,t)}else if(typeof i=="object"&&xt(i.hyperformula)){const o=wC(),s=MM().get(i);return o.has(i)||o.set(i,[]),o.get(i).push(t),s&&s.push(t.guid),i.getConfig().licenseKey||i.updateConfig({licenseKey:hF}),(i.getConfig().leapYear1900!==uE.leapYear1900||Vv(i.getConfig().nullDate,uE.nullDate)===!1)&&$e(nt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),i}return null}function mge(t,e,n){const i=e[ri],r=hge(e),o=wC(),s=MM();pge(t,i.functions),wge(t,i.language);const a=t.buildEmpty(r);return o.set(a,[n]),s.set(a,[n.guid]),vge(a,i.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function XA(t){var e;const n=wC(),i=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(i.map(r=>[r.getPlugin("formulas").sheetId,r]))}function qA(t,e){if(t){const n=wC(),i=n.get(t),r=MM(),o=r.get(t);i&&i.includes(e)&&(i.splice(i.indexOf(e),1),i.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(r.delete(t),t.destroy()))}}function pge(t,e){e&&e.forEach(n=>{const{name:i,plugin:r,translations:o}=n;try{t.registerFunction(i,r,o)}catch(s){$e(s.message)}})}function wge(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(i){$e(i.message)}}}function vge(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:i,expression:r,scope:o,options:s}=n;try{t.addNamedExpression(i,r,o,s)}catch(a){$e(a.message)}}),t.resumeEvaluation())}function Cge(t,e){return(xt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const gF="DD/MM/YYYY";function yge(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function bge(t){return yge(t)?t.substr(1):t}function Sge(t){return typeof t=="string"&&t.startsWith("=")}function PM(t,e){return typeof t=="string"&&e==="date"}function mF(t,e){return K(t,e,!0).isValid()}function pF(t,e){return K(t,e,!0).format(gF)}function Rge(t,e){return K(t,gF,!0).format(e)}function wF(t,e){const i=new Date(Date.UTC(0,0,t+-1));return K(i).format(e)}function Ege(t,e,n){const i=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var r;return(r=i[e])!==null&&r!==void 0?r:0}return i[e-1]+1}function Tge(t,e){const n=[];return t.forEach(i=>{const r={from:i,to:e};n.forEach(o=>{const s=o.from>o.to,a=o.to<=r.from;o.from>r.from&&a&&s&&(r.from+=1)}),r.from>=e&&(e+=1),n.push(r)}),n}function _ge(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(r=>{const o=r.from<r.to;r.from>e.from&&o&&(r.from-=1)})}),t}function IM(t,e,n){const i=Tge(t,Ege(t,e,n));return _ge(i)}function Nl(t,e,n){Mge(t,e),e.set(t,n)}function Mge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mt(t,e){return t.get(vF(t,e))}function Ma(t,e,n){return t.set(vF(t,e),n),n}function vF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Bd=new WeakMap,Pa=new WeakMap,Ki=new WeakMap,qm=new WeakMap,qb=new WeakMap,Zb=new WeakMap,Zm=new WeakMap;class ZA{constructor(e,n,i){Nl(this,Bd,void 0),Nl(this,Pa,void 0),Nl(this,Ki,void 0),Nl(this,qm,[]),Nl(this,qb,[]),Nl(this,Zb,void 0),Nl(this,Zm,[]),Ma(Bd,this,e),Ma(Pa,this,n),Ma(Ki,this,i)}setRemovedHfIndexes(e){return Ma(Zm,this,e.map(n=>{const i=Mt(Pa,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(i)})),Mt(Zm,this)}getRemovedHfIndexes(){return Mt(Zm,this)}getHfIndexFromVisualIndex(e){const n=Mt(Pa,this).getIndexesSequence(),i=Mt(Pa,this).getNotTrimmedIndexes();return n.indexOf(i[e],e)}syncMoves(e){const i=`move${mo(Mt(Bd,this))}s`;Mt(Ki,this).getEngine().batch(()=>{e.forEach(r=>{const o=r.from!==r.to,s=r.from+1!==r.to;o&&s&&Mt(Ki,this).getEngine()[i](Mt(Ki,this).getSheetId(),r.from,1,r.to)})})}storeMovesInformation(e,n,i){i!==!1&&(Ma(qb,this,e.map(r=>this.getHfIndexFromVisualIndex(r))),Ma(Zb,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(Mt(Ki,this).isPerformingUndoRedo()||e===!1||n===!1)return;const i=IM(Mt(qb,this),Mt(Zb,this),Mt(Pa,this).getNumberOfIndexes());Mt(Ki,this).getSheetId()===null?Mt(Ki,this).getPostponeAction(()=>this.syncMoves(i)):this.syncMoves(i)}getIndexesChangeSyncMethod(){const e=`set${mo(Mt(Bd,this))}Order`;return n=>{if(Mt(Ki,this).isPerformingUndoRedo())return;const i=Mt(Pa,this).getIndexesSequence();if(n==="update"&&i.length>0){const r=Mt(qm,this).map(l=>i.indexOf(l)),o=Mt(Ki,this).getEngine().getSheetDimensions(Mt(Ki,this).getSheetId());let s;Mt(Bd,this)==="row"?s=o.height:s=o.width;const a=r.length;for(let l=a;l<s;l+=1)r.push(l);Mt(Ki,this).getEngine()[e](Mt(Ki,this).getSheetId(),r)}Ma(qm,this,i)}}init(){Ma(qm,this,Mt(Pa,this).getIndexesSequence())}}function Dl(t,e,n){Pge(t,e),e.set(t,n)}function Pge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Is(t,e){return t.get(CF(t,e))}function $l(t,e,n){return t.set(CF(t,e),n),n}function CF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Jm=new WeakMap,Qm=new WeakMap,Jb=new WeakMap,Qb=new WeakMap,eS=new WeakMap,tS=new WeakMap,nS=new WeakMap;class Ige{constructor(e,n,i){Dl(this,Jm,void 0),Dl(this,Qm,void 0),Dl(this,Jb,void 0),Dl(this,Qb,!1),Dl(this,eS,!1),Dl(this,tS,null),Dl(this,nS,null),$l(Jm,this,new ZA("row",e,this)),$l(Qm,this,new ZA("column",n,this)),$l(Jb,this,i)}getForAxis(e){return e==="row"?Is(Jm,this):Is(Qm,this)}setPerformUndo(e){$l(Qb,this,e)}setPerformRedo(e){$l(eS,this,e)}isPerformingUndoRedo(){return Is(Qb,this)||Is(eS,this)}getSheetId(){return Is(nS,this)}getEngine(){return Is(tS,this)}getPostponeAction(){return Is(Jb,this)}setupSyncEndpoint(e,n){$l(tS,this,e),$l(nS,this,n),Is(Jm,this).init(),Is(Qm,this).init()}}function xge(t,e){yF(t,e),e.add(t)}function kl(t,e,n){return(e=Oge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oge(t){var e=Age(t,"string");return typeof e=="symbol"?e:e+""}function Age(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iS(t,e,n){yF(t,e),e.set(t,n)}function yF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ol(t,e,n){return t.set(He(t,e),n),n}function Su(t,e){return t.get(He(t,e))}function He(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ri="formulas",Hge=["maxRows","maxColumns","language"],Nge=260;ie.getSingleton().register("afterNamedExpressionAdded");ie.getSingleton().register("afterNamedExpressionRemoved");ie.getSingleton().register("afterSheetAdded");ie.getSingleton().register("afterSheetRemoved");ie.getSingleton().register("afterSheetRenamed");ie.getSingleton().register("afterFormulasValuesUpdate");const Gh=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var ia=new WeakMap,vC=new WeakMap,jd=new WeakMap,Le=new WeakSet;class Dge extends qe{constructor(){var e;super(...arguments),e=this,xge(this,Le),iS(this,ia,!1),iS(this,vC,!1),iS(this,jd,[["valuesUpdated",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return He(Le,e,Zge).call(e,...i)}],["namedExpressionAdded",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return He(Le,e,Jge).call(e,...i)}],["namedExpressionRemoved",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return He(Le,e,Qge).call(e,...i)}],["sheetAdded",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return He(Le,e,eme).call(e,...i)}],["sheetRenamed",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return He(Le,e,tme).call(e,...i)}],["sheetRemoved",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return He(Le,e,nme).call(e,...i)}]]),kl(this,"staticRegister",Vr("formulas")),kl(this,"engine",null),kl(this,"sheetId",null),kl(this,"sheetName",null),kl(this,"indexSyncer",null),kl(this,"rowAxisSyncer",null),kl(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return ri}static get PLUGIN_PRIORITY(){return Nge}static get SETTING_KEYS(){return[ri,...Hge]}isEnabled(){return!!this.hot.getSettings()[ri]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=gge(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){$e("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const i=this.addSheet(this.sheetName,He(Le,this,ng).call(this));i!==!1&&He(Le,this,Rf).call(this,i)}this.addHook("beforeLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return He(Le,n,JA).call(n,...r)}),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return He(Le,n,QA).call(n,...r)}),this.addHook("beforeUpdateData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return He(Le,n,JA).call(n,...r)}),this.addHook("afterUpdateData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return He(Le,n,QA).call(n,...r)}),this.addHook("modifyData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return He(Le,n,Fge).call(n,...r)}),this.addHook("modifySourceData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return He(Le,n,Vge).call(n,...r)}),this.addHook("beforeValidate",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return He(Le,n,$ge).call(n,...r)}),this.addHook("afterSetSourceDataAtCell",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return He(Le,n,Wge).call(n,...r)}),this.addHook("afterSetDataAtCell",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return He(Le,n,e1).call(n,...r)}),this.addHook("afterSetDataAtRowProp",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return He(Le,n,e1).call(n,...r)}),this.addHook("beforeCreateRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return He(Le,n,Bge).call(n,...r)}),this.addHook("beforeCreateCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return He(Le,n,jge).call(n,...r)}),this.addHook("afterCreateRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return He(Le,n,Yge).call(n,...r)}),this.addHook("afterCreateCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return He(Le,n,Gge).call(n,...r)}),this.addHook("beforeRemoveRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return He(Le,n,Uge).call(n,...r)}),this.addHook("beforeRemoveCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return He(Le,n,zge).call(n,...r)}),this.addHook("afterRemoveRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return He(Le,n,Kge).call(n,...r)}),this.addHook("afterRemoveCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return He(Le,n,Xge).call(n,...r)}),this.indexSyncer=new Ige(this.hot.rowIndexMapper,this.hot.columnIndexMapper,i=>{this.hot.addHookOnce("init",()=>{i()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(i,r,o,s)=>{this.rowAxisSyncer.storeMovesInformation(i,r,s)}),this.hot.addHook("beforeColumnMove",(i,r,o,s)=>{this.columnAxisSyncer.storeMovesInformation(i,r,s)}),this.hot.addHook("afterRowMove",(i,r,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(i,r,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(i,r)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart,r)}),this.hot.addHook("afterColumnFreeze",(i,r)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,r)}),this.hot.addHook("beforeColumnUnfreeze",(i,r)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart-1,r)}),this.hot.addHook("afterColumnUnfreeze",(i,r)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,r)}),this.addHook("afterCellMetaReset",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return He(Le,n,Lge).call(n,...r)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return He(Le,n,qge).call(n,...r)}),this.addHook("beforeAutofill",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return He(Le,n,kge).call(n,...r)}),Su(jd,this).forEach(i=>{let[r,o]=i;return this.engine.on(r,o)}),super.enablePlugin()}}disablePlugin(){Su(jd,this).forEach(e=>{let[n,i]=e;return this.engine.off(n,i)}),qA(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=dge(this.hot.getSettings());fge(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const i=this.hot.getSettings()[ri];if(te(i)&&te(i.sheetName)&&i.sheetName!==this.sheetName&&this.switchSheet(i.sheetName),!e.data&&this.sheetName===null){const r=this.hot.getSettings()[ri].sheetName;if(r&&this.engine.doesSheetExist(r))this.switchSheet(this.sheetName);else{const o=this.addSheet(r??void 0,He(Le,this,ng).call(this));He(Le,this,Rf).call(this,o)}}super.updatePlugin(e)}destroy(){Su(jd,this).forEach(e=>{var n;let[i,r]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(i,r)}),ol(jd,this,null),qA(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(te(n)&&!OQ(n))return $e("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return $e("Sheet with the provided name already exists."),!1;try{const i=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(i),n),i}catch(i){return $e(i.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){I0(`The sheet named \`${e}\` does not exist, switch aborted.`);return}He(Le,this,Rf).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${mo(ri)}.switchSheet`)}getCellType(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const r=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return r!==null&&o!==null?this.engine.getCellType({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=new Set;e.forEach(r=>{var o;const s=r==null||(o=r.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(i.has(s)||i.add(s))}),XA(this.engine).forEach((r,o)=>{if((n||o!==this.sheetId)&&i.has(o)){var s;r.render(),(s=r.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return te(u)?`${u}:${a}x${l}`:""},r=new Set(n.map(o=>i(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(te(l)===!1||te(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=i(o);if(c!==void 0&&!r.has(h)){const d=XA(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,i){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(r)){$e(`Not possible to set cell data at ${JSON.stringify(r)}`);return}const o=this.hot.getCellMeta(e,n);return PM(i,o.type)&&(mF(i,o.dateFormat)?i=pF(i,o.dateFormat):Sge(i)===!1&&(i=`'${i}`)),this.engine.setCellContents(r,i)}}function Rf(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function bF(t,e,n){if(me(n)&&n!==null){const i=this.hot.toVisualRow(t),r=this.hot.toVisualColumn(e),o=this.hot.getCellMeta(i,r).valueGetter;return o?o.call(this.hot,n):n.toString()}return n}function ng(t,e,n,i){return this.hot.getSourceDataArray(t,e,n,i).map((r,o)=>r.map((s,a)=>He(Le,this,bF).call(this,o,a,s)))}function $ge(t,e,n){const i=this.hot.propToCol(n);if(this.isFormulaCellType(e,i)){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},o=this.hot.getCellMeta(e,i);let s=this.engine.getCellValue(r);return o.type==="date"&&Ci(s)&&(s=wF(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function kge(t,e,n){const{row:i,col:r}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:p,col:v}=h.start,{row:b,col:P}=h.end,_=b-p+1,F=P-v+1;for(let I=0;I<f.length;I+=1)for(let W=0;W<f[I].length;W+=1){const k=f[I][W],$=p+I%_,Y=v+W%F,J=this.hot.getCellMeta($,Y);PM(k,J.type)&&(k.startsWith("'")?f[I][W]=k.slice(1):this.isFormulaCellType($,Y,this.sheetId)===!1&&(f[I][W]=Rge(k,J.dateFormat)))}return f}function JA(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(mo(ri))||ol(vC,this,xt(this.hot.getSettings().data))}function Lge(){if(Su(vC,this)){this.switchSheet(this.sheetName);return}const t=He(Le,this,ng).call(this);t.forEach((n,i)=>{n.forEach((r,o)=>{const s=this.hot.getCellMeta(i,o,{skipMetaExtension:!0}),a=s.dateFormat;PM(r,s.type)&&(mF(r,a)?t[i][o]=pF(r,a):r.startsWith("=")||(t[i][o]=`'${r}`))})}),ol(ia,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),ol(ia,this,!1)}function QA(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(mo(ri)))return;const i=Cge(this.engine,this.hot.getSettings()[ri].sheetName);if(He(Le,this,Rf).call(this,i),n!=="updateSettings")if(Su(vC,this))this.switchSheet(this.sheetName);else{const r=He(Le,this,ng).call(this);if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){ol(ia,this,!0);const o=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),ol(ia,this,!1)}}}function Fge(t,e,n,i){if(i!=="get"||Su(ia,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName)||t===null||e===null)return;const r=this.getCellType(t,e);if(r==="VALUE"||r==="EMPTY"){n.value=bge(n.value);return}const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let s=this.engine.getCellValue(o);const a=this.hot.getCellMeta(t,e,{skipMetaExtension:!0});a.type==="date"&&Ci(s)&&(s=wF(s,a.dateFormat)),n.value=typeof s=="object"&&s!==null?s.value:s}function Vge(t,e,n,i){if(i!=="get"||Su(ia,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const r=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(r===null||o===null)return;const s=this.getCellType(r,o);if(s==="VALUE"||s==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function e1(t,e){if(Gh(e))return;const n=[],i=[],r=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};l=He(Le,this,bF).call(this,c,h,l),c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),i.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(r),this.validateDependentCells(r,i)}function Wge(t,e){if(Gh(e))return;const n=[],i=[];t.forEach(r=>{let[o,s,,a]=r;const l=this.hot.propToCol(s);if(!Ci(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){$e(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}i.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,i)}function Bge(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function jge(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function Uge(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function zge(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function Yge(t,e,n){if(Gh(n))return;const i=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function Gge(t,e,n){if(Gh(n))return;const i=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function Kge(t,e,n,i){if(Gh(i))return;const r=this.rowAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{r.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Xge(t,e,n,i){if(Gh(i))return;const r=this.columnAxisSyncer.getRemovedHfIndexes().sort((s,a)=>a-s),o=this.engine.batch(()=>{r.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function qge(t,e,n){var i;ol(ia,this,!0);const r=He(Le,this,ng).call(this,n,0,n+(((i=e.__children)===null||i===void 0?void 0:i.length)||0),this.hot.countSourceCols());ol(ia,this,!1),r.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function Zge(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function Jge(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function Qge(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function eme(t){this.hot.runHooks("afterSheetAdded",t)}function tme(t,e){He(Le,this,Rf).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function nme(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function ime(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedActive();let n=0;if(Array.isArray(e)){const[,i,,r]=e;i-r!==0&&(n=1)}return this.getTranslatedPhrase(jT,n)},callback(){const{from:e,to:n}=this.getSelectedRangeActive(),i=Math.max(Math.min(e.col,n.col),0),r=Math.max(e.col,n.col),o=[];for(let l=i;l<=r;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.view.adjustElementsSize(),this.render()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function rme(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(UT,n)},callback(){var n,i;if(e.length===0)return;let r=e[0],o=e[e.length-1];r=(n=this.columnIndexMapper.getNearestNotHiddenIndex(r-1,-1))!==null&&n!==void 0?n:0,o=(i=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&i!==void 0?i:this.countCols()-1,t.showColumns(e),this.view.adjustElementsSize(),this.render(),o-r+1===this.countCols()||this.selectColumns(r,o)},disabled:!1,hidden(){const n=tt(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const i=this.getSelectedRangeActive(),r=i.getTopStartCorner().col,o=i.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(r),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(r!==o){const h=o-r+1,d=l-a+1;if(h>d){const f=u.slice(r,o+1);c.push(...f.filter(p=>n.includes(p)))}}else if(a===0&&a<r)c.push(...u.slice(0,r));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return O(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function ome(t,e){SF(t,e),e.add(t)}function sme(t,e,n){SF(t,e),e.set(t,n)}function SF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ll(t,e){return t.get(La(t,e))}function t1(t,e,n){return t.set(La(t,e),n),n}function La(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeHideColumns");ie.getSingleton().register("afterHideColumns");ie.getSingleton().register("beforeUnhideColumns");ie.getSingleton().register("afterUnhideColumns");const n1="hiddenColumns",ame=310;var Ho=new WeakMap,Fl=new WeakSet;class lme extends qe{constructor(){super(...arguments),ome(this,Fl),sme(this,Ho,null)}static get PLUGIN_KEY(){return n1}static get PLUGIN_PRIORITY(){return ame}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[n1]}enablePlugin(){var e=this;this.enabled||(t1(Ho,this,new Kv),Ll(Ho,this).addLocalHook("init",()=>La(Fl,this,gme).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Ll(Ho,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return La(Fl,e,fme).call(e,...i)}),this.addHook("afterGetCellMeta",(n,i,r)=>La(Fl,this,cme).call(this,n,i,r)),this.addHook("modifyColWidth",(n,i)=>La(Fl,this,ume).call(this,n,i),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return La(Fl,e,dme).call(e,...i)}),this.addHook("modifyCopyableRange",n=>La(Fl,this,hme).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),i=this.isValidConfig(e);let r=n;const o=Ll(Ho,this).getValues().slice(),s=e.length>0;if(i&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));O(l,u=>{o[u]=!1}),r=ji(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,r,i&&s)!==!1&&(i&&s&&Ll(Ho,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,r,i&&s,i&&r.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{O(e,s=>{Ll(Ho,this).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,r,i,i&&r.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.hideColumns(n)}getHiddenColumns(){return tt(Ll(Ho,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Ll(Ho,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<n):!1}resetCellsMeta(){O(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){t1(Ho,this,null),super.destroy()}}function ume(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function cme(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const i=n.className.split(" ");if(i.length>0){const r=i.indexOf("afterHiddenColumn");r>-1&&i.splice(r,1),n.className=i.join(" ")}}}function hme(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(i,r,o,s)=>{e.push({startRow:i,endRow:r,startCol:o,endCol:s})};return O(t,i=>{let r=!0,o=0;he(i.startCol,i.endCol,s=>{this.isHidden(s)?(r||n(i.startRow,i.endRow,o,s-1),r=!0):(r&&(o=s),s===i.endCol&&n(i.startRow,i.endRow,o,s),r=!1)})}),e}function dme(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),B(e,n)}function fme(t){t.items.push({name:Ve},ime(this),rme(this))}function gme(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function mme(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedActive();let n=0;if(Array.isArray(e)){const[i,,r]=e;i-r!==0&&(n=1)}return this.getTranslatedPhrase(zT,n)},callback(){const{from:e,to:n}=this.getSelectedRangeActive(),i=Math.max(Math.min(e.row,n.row),0),r=Math.max(e.row,n.row),o=[];for(let l=i;l<=r;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.view.adjustElementsSize(),this.render()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function pme(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(YT,n)},callback(){var n,i;if(e.length===0)return;let r=e[0],o=e[e.length-1];r=(n=this.rowIndexMapper.getNearestNotHiddenIndex(r-1,-1))!==null&&n!==void 0?n:0,o=(i=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&i!==void 0?i:this.countRows()-1,t.showRows(e),this.view.adjustElementsSize(),this.render(),o-r+1===this.countRows()||this.selectRows(r,o)},disabled:!1,hidden(){const n=tt(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const i=this.getSelectedRangeActive(),r=i.getTopStartCorner().row,o=i.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(r),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(r!==o){const h=o-r+1,d=l-a+1;if(h>d){const f=u.slice(r,o+1);c.push(...f.filter(p=>n.includes(p)))}}else if(a===0&&a<r)c.push(...u.slice(0,r));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return O(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function wme(t,e){RF(t,e),e.add(t)}function vme(t,e,n){RF(t,e),e.set(t,n)}function RF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vl(t,e){return t.get(Fa(t,e))}function i1(t,e,n){return t.set(Fa(t,e),n),n}function Fa(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeHideRows");ie.getSingleton().register("afterHideRows");ie.getSingleton().register("beforeUnhideRows");ie.getSingleton().register("afterUnhideRows");const r1="hiddenRows",Cme=320;var No=new WeakMap,Wl=new WeakSet;class yme extends qe{constructor(){super(...arguments),wme(this,Wl),vme(this,No,null)}static get PLUGIN_KEY(){return r1}static get PLUGIN_PRIORITY(){return Cme}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[r1]}enablePlugin(){var e=this;this.enabled||(i1(No,this,new Kv),Vl(No,this).addLocalHook("init",()=>Fa(Wl,this,_me).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Vl(No,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Fa(Wl,e,Tme).call(e,...i)}),this.addHook("afterGetCellMeta",(n,i,r)=>Fa(Wl,this,Sme).call(this,n,i,r)),this.addHook("modifyRowHeight",(n,i)=>Fa(Wl,this,bme).call(this,n,i)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Fa(Wl,e,Eme).call(e,...i)}),this.addHook("modifyCopyableRange",n=>Fa(Wl,this,Rme).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),i=this.isValidConfig(e);let r=n;const o=Vl(No,this).getValues().slice(),s=e.length>0;if(i&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));O(l,u=>{o[u]=!1}),r=ji(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,r,i&&s)!==!1&&(i&&s&&Vl(No,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,r,i&&s,i&&r.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{O(e,s=>{Vl(No,this).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,r,i,i&&r.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.hideRows(n)}getHiddenRows(){return tt(Vl(No,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Vl(No,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<n):!1}resetCellsMeta(){O(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){i1(No,this,null),super.destroy()}}function bme(t,e){return this.isHidden(e)?0:t}function Sme(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const i=n.className.split(" ");if(i.length>0){const r=i.indexOf("afterHiddenRow");r>-1&&i.splice(r,1),n.className=i.join(" ")}}}function Rme(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(i,r,o,s)=>{e.push({startRow:i,endRow:r,startCol:o,endCol:s})};return O(t,i=>{let r=!0,o=0;he(i.startRow,i.endRow,s=>{this.isHidden(s)?(r||n(o,s-1,i.startCol,i.endCol),r=!0):(r&&(o=s),s===i.endRow&&n(o,s,i.startCol,i.endCol),r=!1)})}),e}function Eme(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),B(e,n)}function Tme(t){t.items.push({name:Ve},mme(this),pme(this))}function _me(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function Mme(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(CT)},callback(e,n){const[{start:{col:i}}]=n;t.freezeColumn(i),this.view.adjustElementsSize(),this.render()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Pme(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(yT)},callback(e,n){const[{start:{col:i}}]=n;t.unfreezeColumn(i),this.view.adjustElementsSize(),this.render()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function Ime(t,e){EF(t,e),e.add(t)}function xme(t,e,n){EF(t,e),e.set(t,n)}function EF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cE(t,e){return t.get(Jw(t,e))}function rS(t,e,n){return t.set(Jw(t,e),n),n}function Jw(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeColumnFreeze");ie.getSingleton().register("afterColumnFreeze");ie.getSingleton().register("beforeColumnUnfreeze");ie.getSingleton().register("afterColumnUnfreeze");const o1="manualColumnFreeze",Ome=110;var eu=new WeakMap,oS=new WeakSet;class Ame extends qe{constructor(){super(...arguments),Ime(this,oS),xme(this,eu,!1)}static get PLUGIN_KEY(){return o1}static get PLUGIN_PRIORITY(){return Ome}isEnabled(){return!!this.hot.getSettings()[o1]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Jw(oS,this,Hme).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>Jw(oS,this,Nme).call(this,e,n)),super.enablePlugin())}disablePlugin(){rS(eu,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),i=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;cE(eu,this)||rS(eu,this,!0),this.hot.runHooks("beforeColumnFreeze",e,i)!==!1&&(i&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,i))}unfreezeColumn(e){const n=this.hot.getSettings(),i=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;cE(eu,this)||rS(eu,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,i)!==!1&&(i&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,i))}}function Hme(t){t.items.push({name:"---------"},Mme(this),Pme(this))}function Nme(t,e){if(cE(eu,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(i=>i<n))return!1}}function ep(t,e,n){return(e=Dme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dme(t){var e=$me(t,"string");return typeof e=="symbol"?e:e+""}function $me(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const sS=0,s1=1,a1=2,xc="px";let TF=class{constructor(e){ep(this,"hot",void 0),ep(this,"_element",null),ep(this,"state",sS),ep(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=a1}build(){this.state===sS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=s1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=sS}isAppended(){return this.state===a1}isBuilt(){return this.state>=s1}setPosition(e,n){Ci(e)&&(this._element.style.top=e+xc),Ci(n)&&(this._element.style[this.inlineProperty]=n+xc)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Ci(e)&&(this._element.style.width=e+xc),Ci(n)&&(this._element.style.height=n+xc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Ci(e)&&(this._element.style.marginTop=e+xc),Ci(n)&&(this._element.style[`margin${mo(this.inlineProperty)}`]=n+xc)}getOffset(){const e=this._element.style,n=`margin${mo(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const kme="ht__manualColumnMove--backlight";let Lme=class extends TF{build(){super.build(),B(this._element,kme)}};const Fme="ht__manualColumnMove--guideline";let Vme=class extends TF{build(){super.build(),B(this._element,Fme)}};function Wme(t,e){_F(t,e),e.add(t)}function Gr(t,e,n){_F(t,e),e.set(t,n)}function _F(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Li(t,e,n){return t.set(Va(t,e),n),n}function ce(t,e){return t.get(Va(t,e))}function Va(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeColumnMove");ie.getSingleton().register("afterColumnMove");const aS="manualColumnMove",Bme=120,l1="ht__manualColumnMove",Qw="show-ui",hE="on-moving--columns",dE="after-selection--columns";var pi=new WeakMap,Ba=new WeakMap,zs=new WeakMap,nw=new WeakMap,Xa=new WeakMap,mi=new WeakMap,tp=new WeakMap,Tr=new WeakMap,Zc=new WeakMap,ev=new WeakMap,Ef=new WeakMap,Bl=new WeakSet;class jme extends qe{constructor(){super(...arguments),Wme(this,Bl),Gr(this,pi,new Lme(this.hot)),Gr(this,Ba,new Vme(this.hot)),Gr(this,zs,[]),Gr(this,nw,0),Gr(this,Xa,!1),Gr(this,mi,{}),Gr(this,tp,void 0),Gr(this,Tr,void 0),Gr(this,Zc,void 0),Gr(this,ev,void 0),Gr(this,Ef,void 0)}static get PLUGIN_KEY(){return aS}static get PLUGIN_PRIORITY(){return Bme}isEnabled(){return!!this.hot.getSettings()[aS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Va(Bl,e,Ume).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Va(Bl,e,Yme).call(e,...i)}),this.addHook("afterScrollVertically",()=>Va(Bl,this,Kme).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Va(Bl,e,Xme).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),B(this.hot.rootElement,l1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ae(this.hot.rootElement,l1),this.unregisterEvents(),ce(pi,this).destroy(),ce(Ba,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const i=ce(tp,this),r=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,i,r);if(Li(tp,this,void 0),o===!1)return;r&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=r&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,i,r,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const i=this.countFinalIndex(e,n);return Li(tp,this,n),this.moveColumns(e,i)}isMovePossible(e,n){const i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=e.length+n>i,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=i);return!(r||o||s||a)}isColumnOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}countFinalIndex(e,n){const i=ji(e,(r,o)=>(o<n&&(r+=1),r),0);return n-i}getColumnsWidth(e,n){const i=this.hot.columnIndexMapper;let r=0;for(let o=e;o<=n;o+=1){const s=i.getRenderableFromVisualIndex(o);o<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(r+=this.hot.view._wt.wtTable.getColumnWidth(s)||0)}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[aS];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const i=[];return he(e,n,r=>{i.push(r)}),i}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(ce(Tr,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtOverlays.scrollableElement,r=typeof i.scrollX=="number"?i.scrollX:i.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,ce(Tr,this)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=ce(pi,this).getOffset().start,u=ce(pi,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const p=this.hot.rootWindow,v=cn(this.hot.rootElement),b=p.innerWidth-ce(Zc,this)-v;h=p.innerWidth-ce(mi,this).eventPageX-b-(i.scrollX===void 0?r:0)}else h=ce(mi,this).eventPageX-(ce(Zc,this)-(i.scrollX===void 0?r:0));if(ce(ev,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(ce(Tr,this))&&(o+=r),o+=c,ce(Tr,this)<0)ce(Ef,this)>0?ce(mi,this).col=0:ce(mi,this).col=e>0?e-1:e;else if(ce(mi,this).TD.offsetWidth/2+o<=h){const p=ce(Tr,this)>=ce(nw,this)?ce(nw,this)-1:ce(Tr,this);ce(mi,this).col=p+1,o+=ce(mi,this).TD.offsetWidth}else ce(mi,this).col=ce(Tr,this);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:i.scrollX!==void 0&&ce(Tr,this)<ce(Ef,this)&&(f-=ce(Zc,this)<=i.scrollX?ce(Zc,this):0),ce(pi,this).setPosition(null,d),ce(Ba,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Va(Bl,this,zme).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Va(Bl,this,Gme).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){ce(pi,this).build(),ce(Ba,this).build()}destroy(){ce(pi,this).destroy(),ce(Ba,this).destroy(),super.destroy()}}function Ume(t,e,n,i){const r=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeActive(),a=Ce(t.target,"sortAction");if(!s||!o||ce(Xa,this)||t.button!==0||a){Li(Xa,this,!1),ce(zs,this).length=0,ae(this.hot.rootElement,[hE,Qw]);return}const l=ce(Ba,this).isBuilt()&&!ce(Ba,this).isAppended(),u=ce(pi,this).isBuilt()&&!ce(pi,this).isAppended();l&&u&&(ce(Ba,this).appendTo(r.hider),ce(pi,this).appendTo(r.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){i.column=!0,Li(Xa,this,!0);const p=n.firstChild?u7(t,n.firstChild).x:t.offsetX;ce(mi,this).eventPageX=t.pageX,Li(Tr,this,e.col),ce(mi,this).TD=n,ce(mi,this).col=e.col,Li(zs,this,this.prepareColumnsToMoving(d,f)),Li(ev,this,!!this.hot.getSettings().rowHeaders),Li(nw,this,this.hot.countCols()),Li(Ef,this,this.hot.getSettings().fixedColumnsStart),Li(Zc,this,oi(this.hot.rootElement).left);const v=ce(ev,this)?-1:0,b=r.holder.scrollTop+r.getColumnHeaderHeight(0)+1,P=e.col<ce(Ef,this),_=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),F=Math.abs(p-(this.hot.isRtl()?n.offsetWidth:0)),I=this.getColumnsWidth(d,e.col-1)+F,W=this.getColumnsWidth(v,d-1)+(P?_:0)+I;ce(pi,this).setPosition(b,W),ce(pi,this).setSize(this.getColumnsWidth(d,f),r.hider.offsetHeight-b),ce(pi,this).setOffset(null,-I),B(this.hot.rootElement,hE)}else ae(this.hot.rootElement,dE),Li(Xa,this,!1),ce(zs,this).length=0}function zme(t){ce(Xa,this)&&(ce(mi,this).eventPageX=t.pageX,this.refreshPositions())}function Yme(t,e,n,i){!this.hot.getSelectedRangeActive()||!ce(Xa,this)||(ce(zs,this).indexOf(e.col)>-1?ae(this.hot.rootElement,Qw):B(this.hot.rootElement,Qw),i.row=!0,i.column=!0,i.cell=!0,Li(Tr,this,e.col),ce(mi,this).TD=n)}function Gme(){const t=ce(mi,this).col,e=ce(zs,this).length;if(Li(Tr,this,void 0),Li(Xa,this,!1),ae(this.hot.rootElement,[hE,Qw,dE]),this.hot.selection.isSelectedByColumnHeader()&&B(this.hot.rootElement,dE),e<1||t===void 0)return;const n=ce(zs,this)[0],i=this.hot.toPhysicalColumn(n),r=this.dragColumns(ce(zs,this),t);if(ce(zs,this).length=0,r===!0){this.persistentStateSave(),this.hot.view.adjustElementsSize(),this.hot.render();const o=this.hot.toVisualColumn(i),s=o+e-1;this.hot.selectColumns(o,s)}}function Kme(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,i=e+n;ce(pi,this).setPosition(i),ce(pi,this).setSize(null,t.hider.offsetHeight-i)}function Xme(){this.moveBySettingsOrLoad()}function qme(t,e){MF(t,e),e.add(t)}function qn(t,e,n){MF(t,e),e.set(t,n)}function MF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tn(t,e,n){return t.set(no(t,e),n),n}function ne(t,e){return t.get(no(t,e))}function no(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const tv="manualColumnResize",Zme=130,u1="manualColumnWidths";var Fs=new WeakMap,np=new WeakMap,rr=new WeakMap,nv=new WeakMap,ns=new WeakMap,Jme=new WeakMap,vh=new WeakMap,ip=new WeakMap,Oi=new WeakMap,Ns=new WeakMap,Nu=new WeakMap,iv=new WeakMap,ah=new WeakMap,Tf=new WeakMap,sr=new WeakMap,_f=new WeakMap,Do=new WeakSet;class Qme extends qe{static get PLUGIN_KEY(){return tv}static get PLUGIN_PRIORITY(){return Zme}constructor(e){super(e),qme(this,Do),qn(this,Fs,null),qn(this,np,null),qn(this,rr,[]),qn(this,nv,null),qn(this,ns,null),qn(this,Jme,null),qn(this,vh,null),qn(this,ip,null),qn(this,Oi,this.hot.rootDocument.createElement("DIV")),qn(this,Ns,this.hot.rootDocument.createElement("DIV")),qn(this,Nu,null),qn(this,iv,!1),qn(this,ah,0),qn(this,Tf,null),qn(this,sr,void 0),qn(this,_f,void 0),B(ne(Oi,this),"manualColumnResizer"),B(ne(Ns,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[tv]}enablePlugin(){var e=this;this.enabled||(tn(sr,this,new ll),ne(sr,this).addLocalHook("init",()=>no(Do,this,epe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,ne(sr,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return no(Do,e,spe).call(e,...i)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return no(Do,e,ape).call(e,...i)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return no(Do,e,lpe).call(e,...i)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){tn(_f,this,ne(sr,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",u1,ne(sr,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",u1,e),e.value}setManualSize(e,n){const i=Math.max(n,20),r=this.hot.toPhysicalColumn(e);return ne(sr,this).setValueAtIndex(r,i),i}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);ne(sr,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode||ne(ah,this)>1)return;tn(Fs,this,e);const{_wt:n}=this.hot.view,i=n.wtTable.getCoords(ne(Fs,this)),r=i.col;if(r<0)return;const o=yn(ne(Fs,this)),s=ne(Fs,this).getBoundingClientRect(),a=r<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ne(Fs,this),i.row,i.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(ne(Fs,this),i.row,i.col)),tn(np,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)),tn(rr,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();O(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;he(d,f,p=>{ne(rr,this).includes(p)||ne(rr,this).push(p)})})}ne(rr,this).includes(ne(np,this))||tn(rr,this,[ne(np,this)]),tn(ip,this,l.start-6),tn(vh,this,parseInt(s.width,10)),ne(Oi,this).style.top=`${l.top}px`,ne(Oi,this).style[this.inlineDir]=`${ne(ip,this)+ne(vh,this)}px`,ne(Oi,this).style.height=`${o}px`,this.hot.rootElement.appendChild(ne(Oi,this))}refreshHandlePosition(){ne(Oi,this).style[this.inlineDir]=`${ne(ip,this)+ne(nv,this)}px`}setupGuidePosition(){const e=parseInt(yn(ne(Oi,this)),10),n=parseInt(ne(Oi,this).style.top,10)+e,i=this.hot.view.getTableHeight();B(ne(Oi,this),"active"),B(ne(Ns,this),"active"),ne(Ns,this).style.top=`${n}px`,this.refreshGuidePosition(),ne(Ns,this).style.height=`${i-e}px`,this.hot.rootElement.appendChild(ne(Ns,this))}refreshGuidePosition(){ne(Ns,this).style[this.inlineDir]=ne(Oi,this).style[this.inlineDir]}hideHandleAndGuide(){ae(ne(Oi,this),"active"),ae(ne(Ns,this),"active")}checkIfColumnHeader(e){const n=_u(e,["THEAD"],this.hot.rootElement),{topOverlay:i,topInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.THEAD,r.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},n=(i,r)=>{const o=this.hot.runHooks("beforeColumnResize",ne(ns,this),i,!0);o!==void 0&&tn(ns,this,o),this.setManualSize(i,ne(ns,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ne(ns,this),i,!0),r&&e()};ne(ah,this)>=2&&(ne(rr,this).length>1?(O(ne(rr,this),r=>{n(r)}),e()):O(ne(rr,this),r=>{n(r,!0)})),tn(ah,this,0),tn(Tf,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",i=>no(Do,this,tpe).call(this,i)),this.eventManager.addEventListener(n,"mousedown",i=>no(Do,this,npe).call(this,i)),this.eventManager.addEventListener(e,"mousemove",i=>no(Do,this,ipe).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>no(Do,this,rpe).call(this)),this.eventManager.addEventListener(ne(Oi,this),"contextmenu",()=>no(Do,this,ope).call(this))}destroy(){super.destroy()}}function epe(){const t=this.hot.getSettings()[tv],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,i)=>{ne(sr,this).setValueAtIndex(i,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,i)=>{ne(sr,this).setValueAtIndex(i,n)})},!0),tn(_f,this,t)):t===!0&&Array.isArray(ne(_f,this))&&this.hot.batchExecution(()=>{ne(_f,this).forEach((n,i)=>{ne(sr,this).setValueAtIndex(i,n)})},!0)}function tpe(t){if(!i$(t.target)&&ne(iv,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(ne(Nu,this)||this.setupHandlePosition(e))}}function npe(t){t.target.parentNode===this.hot.rootElement&&Ce(t.target,"manualColumnResizer")&&(this.setupHandlePosition(ne(Fs,this)),this.setupGuidePosition(),tn(Nu,this,!0),ne(Tf,this)===null&&(tn(Tf,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ne(Tf,this))),tn(ah,this,ne(ah,this)+1),this.startX=t.pageX,tn(ns,this,ne(vh,this)))}function ipe(t){if(ne(Nu,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();tn(nv,this,ne(vh,this)+e),O(ne(rr,this),n=>{tn(ns,this,this.setManualSize(n,ne(nv,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function rpe(){const t=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},e=(n,i)=>{this.hot.runHooks("beforeColumnResize",ne(ns,this),n,!1),i&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ne(ns,this),n,!1)};ne(Nu,this)&&(this.hideHandleAndGuide(),tn(Nu,this,!1),ne(ns,this)!==ne(vh,this)&&(ne(rr,this).length>1?(O(ne(rr,this),i=>{e(i)}),t()):O(ne(rr,this),i=>{e(i,!0)})),this.setupHandlePosition(ne(Fs,this)))}function ope(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ne(Oi,this)),this.hot.rootElement.removeChild(ne(Ns,this)),tn(Nu,this,!1),tn(iv,this,!0),this.hot._registerImmediate(()=>{tn(iv,this,!1)})}function spe(t,e){let n=t;if(this.enabled){const i=this.hot.toPhysicalColumn(e),r=ne(sr,this).getValueAtIndex(i);this.hot.getSettings()[tv]&&r&&(n=r)}return n}function ape(t,e){const n=ne(sr,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function lpe(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function lS(t,e,n){return(e=upe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function upe(t){var e=cpe(t,"string");return typeof e=="symbol"?e:e+""}function cpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const uS=0,c1=1,h1=2,Oc="px";let PF=class{constructor(e){lS(this,"hot",void 0),lS(this,"_element",null),lS(this,"state",uS),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=h1}build(){this.state===uS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=c1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=uS}isAppended(){return this.state===h1}isBuilt(){return this.state>=c1}setPosition(e,n){e!==void 0&&(this._element.style.top=e+Oc),n!==void 0&&(this._element.style.left=n+Oc)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+Oc),n&&(this._element.style.height=n+Oc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+Oc),n&&(this._element.style.marginLeft=n+Oc)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const hpe="ht__manualRowMove--backlight";class dpe extends PF{build(){super.build(),B(this._element,hpe)}}const fpe="ht__manualRowMove--guideline";class gpe extends PF{build(){super.build(),B(this._element,fpe)}}function mpe(t,e){IF(t,e),e.add(t)}function Ac(t,e,n){IF(t,e),e.set(t,n)}function IF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pu(t,e,n){return t.set(Wa(t,e),n),n}function _e(t,e){return t.get(Wa(t,e))}function Wa(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeRowMove");ie.getSingleton().register("afterRowMove");const cS="manualRowMove",ppe=140,d1="ht__manualRowMove",rv="show-ui",fE="on-moving--rows",gE="after-selection--rows";var wi=new WeakMap,ja=new WeakMap,Ys=new WeakMap,qa=new WeakMap,Fi=new WeakMap,rp=new WeakMap,jl=new WeakSet;class wpe extends qe{constructor(){super(...arguments),mpe(this,jl),Ac(this,wi,new dpe(this.hot)),Ac(this,ja,new gpe(this.hot)),Ac(this,Ys,[]),Ac(this,qa,void 0),Ac(this,Fi,{}),Ac(this,rp,void 0)}static get PLUGIN_KEY(){return cS}static get PLUGIN_PRIORITY(){return ppe}isEnabled(){return!!this.hot.getSettings()[cS]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wa(jl,e,vpe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wa(jl,e,ype).call(e,...i)}),this.addHook("afterScrollHorizontally",()=>Wa(jl,this,Spe).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Wa(jl,e,Rpe).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),B(this.hot.rootElement,d1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ae(this.hot.rootElement,d1),this.unregisterEvents(),_e(wi,this).destroy(),_e(ja,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const i=_e(rp,this),r=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,i,r);if(pu(rp,this,void 0),o===!1)return;r&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=r&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,i,r,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const i=this.countFinalIndex(e,n);return pu(rp,this,n),this.moveRows(e,i)}isMovePossible(e,n){const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=e.length+n>i,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=i);return!(r||o||s||a)}isRowOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}countFinalIndex(e,n){const i=ji(e,(r,o)=>(o<n&&(r+=1),r),0);return n-i}getRowsHeight(e,n){const i=this.hot.rowIndexMapper;let r=0;for(let o=e;o<=n;o++){const s=i.getRenderableFromVisualIndex(o);s!==null&&(r+=this.hot.view._wt.wtTable.getRowHeight(s)||this.hot.stylesHandler.getDefaultRowHeight())}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[cS];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeActive(),n=[];if(!e)return n;const{from:i,to:r}=e,o=Math.min(i.row,r.row),s=Math.max(i.row,r.row);return he(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=_e(Fi,this).coords,n=this.hot.getFirstFullyVisibleRow(),i=this.hot.getLastFullyVisibleRow(),r=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&i<r&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=_e(Fi,this).TD,a=this.hot.rootElement,l=oi(a),u=Wf(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=_e(Fi,this).eventPageY-d+c,p=o.hider.offsetHeight,v=o.TBODY.offsetTop,b=_e(wi,this).getOffset().top,P=_e(wi,this).getSize().height,_=s.offsetHeight/2,F=s.offsetHeight;let I=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const W=f>=I+_;this.isFixedRowTop(e.row)&&(I+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?_e(Fi,this).row=n>0?n-1:n:W?(_e(Fi,this).row=e.row+1,I+=e.row===0?F-1:F):_e(Fi,this).row=e.row;let k=f,$=I;f+P+b>=p?k=p-P-b:f+b<v&&(k=v+Math.abs(b)),I>=p-1&&($=p-1),_e(wi,this).setPosition(k),_e(ja,this).setPosition($)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Wa(jl,this,Cpe).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Wa(jl,this,bpe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){_e(wi,this).build(),_e(ja,this).build()}destroy(){_e(wi,this).destroy(),_e(ja,this).destroy(),super.destroy()}}function vpe(t,e,n,i){const{wtTable:r,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeActive();if(!a||!s||_e(qa,this)||t.button!==0){pu(qa,this,!1),_e(Ys,this).length=0,ae(this.hot.rootElement,[fE,rv]);return}const l=_e(ja,this).isBuilt()&&!_e(ja,this).isAppended(),u=_e(wi,this).isBuilt()&&!_e(wi,this).isAppended();l&&u&&(_e(ja,this).appendTo(r.hider),_e(wi,this).appendTo(r.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){i.row=!0,pu(qa,this,!0),_e(Fi,this).eventPageY=t.pageY,_e(Fi,this).coords=e,_e(Fi,this).TD=n,pu(Ys,this,this.prepareRowsToMoving());const p=r.holder.scrollLeft+o.getRowHeaderWidth(),v=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);_e(wi,this).setPosition(null,p),_e(wi,this).setSize(r.hider.offsetWidth-p,this.getRowsHeight(d,f)),_e(wi,this).setOffset(-v,null),B(this.hot.rootElement,fE),this.refreshPositions()}else ae(this.hot.rootElement,gE),pu(qa,this,!1),_e(Ys,this).length=0}function Cpe(t){_e(qa,this)&&(_e(Fi,this).eventPageY=t.pageY,this.refreshPositions())}function ype(t,e,n,i){!this.hot.getSelectedRangeActive()||!_e(qa,this)||(_e(Ys,this).indexOf(e.row)>-1?ae(this.hot.rootElement,rv):B(this.hot.rootElement,rv),i.row=!0,i.column=!0,i.cell=!0,_e(Fi,this).coords=e,_e(Fi,this).TD=n)}function bpe(){const t=_e(Fi,this).row,e=_e(Ys,this).length;if(pu(qa,this,!1),ae(this.hot.rootElement,[fE,rv,gE]),this.hot.selection.isSelectedByRowHeader()&&B(this.hot.rootElement,gE),e<1||t===void 0)return;const n=_e(Ys,this)[0],i=this.hot.toPhysicalRow(n),r=this.dragRows(_e(Ys,this),t);if(_e(Ys,this).length=0,r===!0){this.persistentStateSave(),this.hot.view.adjustElementsSize(),this.hot.render();const o=this.hot.toVisualRow(i),s=o+e-1;this.hot.selectRows(o,s)}}function Spe(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,i=e+n;_e(wi,this).setPosition(null,i),_e(wi,this).setSize(t.hider.offsetWidth-i)}function Rpe(){this.moveBySettingsOrLoad()}function Epe(t,e){xF(t,e),e.add(t)}function Zn(t,e,n){xF(t,e),e.set(t,n)}function xF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jt(t,e,n){return t.set(Vs(t,e),n),n}function ee(t,e){return t.get(Vs(t,e))}function Vs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ov="manualRowResize",Tpe=30,f1="manualRowHeights";var Xo=new WeakMap,op=new WeakMap,or=new WeakMap,Mf=new WeakMap,Ua=new WeakMap,xM=new WeakMap,Ch=new WeakMap,sp=new WeakMap,hi=new WeakMap,Yo=new WeakMap,Du=new WeakMap,sv=new WeakMap,lh=new WeakMap,Pf=new WeakMap,ao=new WeakMap,If=new WeakMap,Ia=new WeakSet;class _pe extends qe{static get PLUGIN_KEY(){return ov}static get PLUGIN_PRIORITY(){return Tpe}constructor(e){super(e),Epe(this,Ia),Zn(this,Xo,null),Zn(this,op,null),Zn(this,or,[]),Zn(this,Mf,null),Zn(this,Ua,null),Zn(this,xM,null),Zn(this,Ch,null),Zn(this,sp,null),Zn(this,hi,this.hot.rootDocument.createElement("DIV")),Zn(this,Yo,this.hot.rootDocument.createElement("DIV")),Zn(this,Du,!1),Zn(this,sv,!1),Zn(this,lh,0),Zn(this,Pf,null),Zn(this,ao,void 0),Zn(this,If,void 0),B(ee(hi,this),"manualRowResizer"),B(ee(Yo,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[ov]}enablePlugin(){this.enabled||(jt(ao,this,new ll),ee(ao,this).addLocalHook("init",()=>Vs(Ia,this,Hpe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ee(ao,this)),this.addHook("modifyRowHeight",(e,n)=>Vs(Ia,this,Ape).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){jt(If,this,ee(ao,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",f1,ee(ao,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",f1,e),e.value}setManualSize(e,n){const i=this.hot.toPhysicalRow(e),r=Math.max(n,this.hot.stylesHandler.getDefaultRowHeight());return ee(ao,this).setValueAtIndex(i,r),r}getLastDesiredRowHeight(){return ee(Mf,this)}setupHandlePosition(e){if(ee(lh,this)>1)return;jt(Xo,this,e);const{view:n}=this.hot,{_wt:i}=n,r=i.wtTable.getCoords(ee(Xo,this)),o=r.row;if(o<0)return;const s=cn(ee(Xo,this)),a=ee(Xo,this).getBoundingClientRect(),l=o<i.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-i.getSetting("fixedRowsBottom");let c;l?c=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ee(Xo,this),r.row,r.col):u&&(c=i.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(ee(Xo,this),r.row,r.col)),c||(c=i.wtOverlays.inlineStartOverlay.getRelativeCellPosition(ee(Xo,this),r.row,r.col)),jt(op,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),jt(or,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();O(d,f=>{const p=f.getTopStartCorner().row,v=f.getBottomStartCorner().row;he(p,v,b=>{ee(or,this).includes(b)||ee(or,this).push(b)})})}ee(or,this).includes(ee(op,this))||jt(or,this,[ee(op,this)]),jt(sp,this,c.top-6),jt(Ch,this,parseInt(a.height,10)),ee(hi,this).style.top=`${ee(sp,this)+ee(Ch,this)}px`,ee(hi,this).style[this.inlineDir]=`${c.start}px`,ee(hi,this).style.width=`${s}px`,this.hot.rootElement.appendChild(ee(hi,this))}refreshHandlePosition(){ee(hi,this).style.top=`${ee(sp,this)+ee(Mf,this)}px`}setupGuidePosition(){const e=parseInt(cn(ee(hi,this)),10),n=parseInt(ee(hi,this).style[this.inlineDir],10)+e,i=this.hot.view.getTableWidth();B(ee(hi,this),"active"),B(ee(Yo,this),"active"),ee(Yo,this).style.top=ee(hi,this).style.top,ee(Yo,this).style[this.inlineDir]=`${n}px`,ee(Yo,this).style.width=`${i-e}px`,this.hot.rootElement.appendChild(ee(Yo,this))}refreshGuidePosition(){ee(Yo,this).style.top=ee(hi,this).style.top}hideHandleAndGuide(){ae(ee(hi,this),"active"),ae(ee(Yo,this),"active")}checkIfRowHeader(e){const n=_u(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:i,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.TBODY,r.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&ee(Ua,this)<n?n:ee(Ua,this)}afterMouseDownTimeout(){const e=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},n=(i,r)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(i),i,!0);o!==void 0&&jt(Ua,this,o),this.setManualSize(i,ee(Ua,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(i),i,!0),r&&e()};ee(lh,this)>=2&&(ee(or,this).length>1?(O(ee(or,this),r=>{n(r)}),e()):O(ee(or,this),r=>{n(r,!0)})),jt(lh,this,0),jt(Pf,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",i=>Vs(Ia,this,Mpe).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>Vs(Ia,this,Ppe).call(this,i)),this.eventManager.addEventListener(n,"mousemove",i=>Vs(Ia,this,Ipe).call(this,i)),this.eventManager.addEventListener(n,"mouseup",()=>Vs(Ia,this,xpe).call(this)),this.eventManager.addEventListener(ee(hi,this),"contextmenu",()=>Vs(Ia,this,Ope).call(this))}destroy(){super.destroy()}}function Mpe(t){if(!i$(t.target)&&ee(sv,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(ee(Du,this)||this.setupHandlePosition(e))}}function Ppe(t){Ce(t.target,"manualRowResizer")&&(this.setupHandlePosition(ee(Xo,this)),this.setupGuidePosition(),jt(Du,this,!0),ee(Pf,this)===null&&(jt(Pf,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ee(Pf,this))),jt(lh,this,ee(lh,this)+1),jt(xM,this,t.pageY),jt(Ua,this,ee(Ch,this)))}function Ipe(t){ee(Du,this)&&(jt(Mf,this,ee(Ch,this)+(t.pageY-ee(xM,this))),O(ee(or,this),e=>{jt(Ua,this,this.setManualSize(e,ee(Mf,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function xpe(){const t=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},e=(n,i)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),i&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};ee(Du,this)&&(this.hideHandleAndGuide(),jt(Du,this,!1),ee(Ua,this)!==ee(Ch,this)&&(ee(or,this).length>1?(O(ee(or,this),i=>{e(i)}),t()):O(ee(or,this),i=>{e(i,!0)})),this.setupHandlePosition(ee(Xo,this)))}function Ope(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ee(hi,this)),this.hot.rootElement.removeChild(ee(Yo,this)),jt(Du,this,!1),jt(sv,this,!0),this.hot._registerImmediate(()=>{jt(sv,this,!1)})}function Ape(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),o=ee(ao,this).getValueAtIndex(r);if(this.hot.getSettings()[ov]&&o){var i;(i=this.hot.getPlugin("autoRowSize"))!==null&&i!==void 0&&i.isEnabled()?n=Math.max(o,n??0):n=o}}return n}function Hpe(){const t=this.hot.getSettings()[ov],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,i)=>{ee(ao,this).setValueAtIndex(i,n)}):Array.isArray(t)?(t.forEach((n,i)=>{ee(ao,this).setValueAtIndex(i,n)}),jt(If,this,t)):t===!0&&Array.isArray(ee(If,this))&&ee(If,this).forEach((n,i)=>{ee(ao,this).setValueAtIndex(i,n)})},!0)}var Npe=zv;Npe("flatMap");var Dpe=Sn,g1=Rn,$pe=hs,kpe=VE,Lpe=function(t,e){(!e||typeof t!="string")&&g1(t);var n=kpe(t);return $pe(g1(n!==void 0?Dpe(n,t):t))},Fpe=St,mE=Sn,Vpe=Wi,pE=Rn,Wpe=hs,Bpe=Lpe,jpe=YE,wE=Bi,Upe=GE,zpe=sl,OF=!Upe("flatMap",function(){}),vE=!OF&&zpe("flatMap",TypeError),Ype=OF||vE,Gpe=jpe(function(){for(var t=this.iterator,e=this.mapper,n,i;;){if(i=this.inner)try{if(n=pE(mE(i.next,i.iterator)),!n.done)return n.value;this.inner=null}catch(r){wE(t,"throw",r)}if(n=pE(mE(this.next,t)),this.done=!!n.done)return;try{this.inner=Bpe(e(n.value,this.counter++),!1)}catch(r){wE(t,"throw",r)}}});Fpe({target:"Iterator",proto:!0,real:!0,forced:Ype},{flatMap:function(e){pE(this);try{Vpe(e)}catch(n){wE(this,"throw",n)}return vE?mE(vE,this,e):new Gpe(Wpe(this),{mapper:e,inner:null})}});function Kpe(t,e,n){Xpe(t,e),e.set(t,n)}function Xpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ul(t,e,n){return(e=qpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qpe(t){var e=Zpe(t,"string");return typeof e=="symbol"?e:e+""}function Zpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function m1(t,e){return t.get(AF(t,e))}function ap(t,e,n){return t.set(AF(t,e),n),n}function AF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zl=new WeakMap;class qo{constructor(e,n,i,r,o,s){Ul(this,"row",void 0),Ul(this,"col",void 0),Ul(this,"rowspan",void 0),Ul(this,"colspan",void 0),Ul(this,"removed",!1),Ul(this,"cellCoordsFactory",void 0),Ul(this,"cellRangeFactory",void 0),Kpe(this,zl,null),this.row=e,this.col=n,this.rowspan=i,this.colspan=r,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:i,rowspan:r,colspan:o}=e;return nt`The merged cell declared with {row: ${n}, col: ${i},\x20
      rowspan: ${r}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:i}=e;return nt`The merged cell declared at [${n}, ${i}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:i}=e;return nt`The merged cell declared at [${n}, ${i}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:i}=e;return nt`The merged cell declared at [${n}, ${i}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:i,rowspan:r,colspan:o}=e;return n<0||i<0||r<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:i}=e;return i===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:i}=e;return i===0||n===0}static isOutOfBounds(e,n,i){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=i||e.col+e.colspan-1>=i}normalize(e){const n=e.countRows(),i=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col),ap(zl,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const i=e[0]||e[1],r=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,r),l=Math.max(n,r),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=i),i>0)n<=c&&n>u&&(this[o]+=i);else if(i<0){if(a<=u&&l>=c)return this.removed=!0,ap(zl,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(i)-h;this[s]-=d+i,this[o]-=h}else if(u<=a&&c>=l)this[o]+=i;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return ap(zl,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return m1(zl,this)||ap(zl,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),m1(zl,this)}}function Jpe(t,e){Qpe(t,e),e.add(t)}function Qpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lp(t,e,n){return(e=ewe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ewe(t){var e=twe(t,"string");return typeof e=="symbol"?e:e+""}function twe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yl(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xa=new WeakSet;class av{constructor(e){Jpe(this,xa),lp(this,"plugin",void 0),lp(this,"mergedCells",[]),lp(this,"mergedCellsMatrix",new Map),lp(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:i}=e;return nt`The merged cell declared at [${n}, ${i}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var i;return this.mergedCellsMatrix.has(e)&&(i=this.mergedCellsMatrix.get(e).get(n))!==null&&i!==void 0?i:!1}getByRange(e){const{row:n,col:i}=e.getTopStartCorner(),{row:r,col:o}=e.getBottomEndCorner(),s=this.mergedCells.length;let a=!1;for(let l=0;l<s;l++){const u=this.mergedCells[l],{row:c,col:h,rowspan:d,colspan:f}=u;if(c>=n&&c+d-1<=r&&h>=i&&h+f-1<=o){a=u;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(r=>{const{row:o,col:s,colspan:a,rowspan:l}=r;for(let u=o;u<o+l;u++)for(let c=s;c<s+a;c++)n.add(`r${u},c${c}`)}),e.filter(r=>{const{row:o,col:s,colspan:a,rowspan:l}=r,u=new Set;let c=!1;for(let h=o;h<o+l;h++){for(let d=s;d<s+a;d++){const f=`r${h},c${d}`;if(n.has(f)){$e(av.IS_OVERLAPPING_WARNING(r)),c=!0;break}u.add(f)}if(c)break}return c||n.add(...u),!c})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:i,col:r}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),a=[];for(let l=i;l<=o;l++)for(let u=r;u<=s;u++){const c=this.get(l,u);c&&(n||!n&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=e.row,r=e.col,o=e.rowspan,s=e.colspan,a=new qo(i,r,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(i,r),u=n?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),Yl(xa,this,p1).call(this,a),a):(u&&$e(av.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const i=this.get(e,n),r=i?this.mergedCells.indexOf(i):-1;return i&&r!==-1?(this.mergedCells.splice(r,1),Yl(xa,this,nwe).call(this,i),i):!1}clear(){O(this.mergedCells,e=>{let{row:n,col:i,rowspan:r,colspan:o}=e;he(n,n+r,s=>{he(i,i+o,a=>{const l=this.hot.getCell(s,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let i=0;i<this.mergedCells.length;i++)if(this.mergedCells[i].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const i=this.get(e,n);if(!i)return!1;const{row:r,col:o,rowspan:s,colspan:a}=i,l=this.hot.view.getActiveOverlayName(),u=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),c=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=Ue(u,r,r+s-1),d=Ue(c,o,o+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const i=this.get(e,n);if(!i||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const r=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(r,o)}getStartMostColumnIndex(e,n){const i=Yl(xa,this,up).call(this,e,"col",-1);let r=n;for(let o=0;o<i.length;o++)if(i[o]<=n){r=i[o];break}return r}getEndMostColumnIndex(e,n){const i=Yl(xa,this,up).call(this,e,"col",1);let r=n;for(let o=0;o<i.length;o++)if(i[o]>=n){r=i[o];break}return r}getTopMostRowIndex(e,n){const i=Yl(xa,this,up).call(this,e,"row",-1);let r=n;for(let o=0;o<i.length;o++)if(i[o]<=n){r=i[o];break}return r}getBottomMostRowIndex(e,n){const i=Yl(xa,this,up).call(this,e,"row",1);let r=n;for(let o=0;o<i.length;o++)if(i[o]>=n){r=i[o];break}return r}shiftCollections(e,n,i){const r=[0,0];switch(e){case"right":r[0]+=i;break;case"left":r[0]-=i;break;case"down":r[1]+=i;break;case"up":r[1]-=i;break}const o=[];this.mergedCells.forEach(s=>{s.shift(r,n),s.removed&&o.push(s)}),o.forEach(s=>{this.mergedCells.splice(this.mergedCells.indexOf(s),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(s=>{Yl(xa,this,p1).call(this,s)})}}function up(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=new Map,r=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let s=r.row;n===1?s<=o.row:s>=o.row;s+=n)for(let a=r.col;n===1?a<=o.col:a>=o.col;a+=n){const l=e==="row"?s:a,u=this.get(s,a);let c=l;u&&(c=n===1?u[e]+u[`${e}span`]-1:u[e]),i.has(l)||i.set(l,new Set),i.get(l).add(c)}return Array.from(new Set(Array.from(i.entries()).filter(s=>{let[,a]=s;return a.size===1}).flatMap(s=>{let[,a]=s;return Array.from(a)})))}function p1(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function nwe(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function hS(t,e,n){return(e=iwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iwe(t){var e=rwe(t,"string");return typeof e=="symbol"?e:e+""}function rwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class owe{constructor(e){hS(this,"plugin",void 0),hS(this,"mergedCellsCollection",void 0),hS(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let i=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?i="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?i="up":n[1]===e[1]&&n[2]===e[2]?i="right":i="left",i}snapDragArea(e,n,i,r){const o=n.slice(0),s=this.getAutofillSize(e,n,i),[a,l,u,c]=e,d=["up","down"].indexOf(i)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,p=s-f,v=this.getFarthestCollection(e,n,i,r);if(v){if(i==="down"){const b=v.row+v.rowspan-a-p;o[2]+b>=this.plugin.hot.countRows()?o[2]-=p:o[2]+=p?b:0}else if(i==="right"){const b=v.col+v.colspan-l-p;o[3]+b>=this.plugin.hot.countCols()?o[3]-=p:o[3]+=p?b:0}else if(i==="up"){const b=u-p-v.row+1;o[0]+b<0?o[0]+=p:o[0]-=p?b:0}else if(i==="left"){const b=c-p-v.col+1;o[1]+b<0?o[1]+=p:o[1]-=p?b:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:i,foundMergedCells:r,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),bn(this.currentFillData,e)}getAutofillSize(e,n,i){const[r,o,s,a]=e,[l,u,c,h]=n;switch(i){case"up":return r-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,i){const[r,o,s,a]=e,[l,u,c,h]=n;switch(i){case"up":return[l,u,r-1,a];case"down":{const d=this.mergedCellsCollection.get(c,a),f=d?d.rowspan-1:0;return[s+1,o,c+f,a]}case"left":return[l,u,s,o-1];case"right":{const d=this.mergedCellsCollection.get(c,a),f=d?d.colspan-1:0;return[r,a+f,c,h]}default:return null}}getFarthestCollection(e,n,i,r){const[o,s,a,l]=e,u=["up","down"].indexOf(i)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,i),f=u?a-o+1:l-s+1,p=Math.floor(d/f)*f,v=d-p;let b=null,P=null,_=null;switch(i){case"up":b="includesVertically",_=c-v+1;break;case"left":b="includesHorizontally",_=c-v+1;break;case"down":b="includesVertically",_=h+v-1;break;case"right":b="includesHorizontally",_=h+v-1;break}return O(r,F=>{F[b](_)&&F.isFarther(P,i)&&(P=F)}),P}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),i=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,o=(u,c)=>{switch(r){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<i.length;u+=1){if(a=i[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan},!0);break}u===i.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},i={min:null,max:null};return O(e,r=>{const o=r[0],s=this.plugin.hot.propToCol(r[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(i.min===null||s<i.min)&&(i.min=s),(i.max===null||s>i.max)&&(i.max=s)}),{from:{row:n.min,column:i.min},to:{row:n.max,column:i.max}}}dragAreaOverlapsCollections(e,n,i){const r=this.getDragArea(e,n,i),[o,s,a,l]=r,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:i==="up"||i==="down"?!f.every(p=>{let{colspan:v}=p;return v===h.getWidth()}):!f.every(p=>{let{rowspan:v}=p;return v===h.getHeight()})}}function dS(t,e,n){return(e=swe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function swe(t){var e=awe(t,"string");return typeof e=="symbol"?e:e+""}function awe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lwe{constructor(e){dS(this,"plugin",void 0),dS(this,"hot",void 0),dS(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,i,r){const o=Math.min(i[0],i[2]),s=Math.min(i[1],i[3]),a=Math.max(i[0],i[2]),l=Math.max(i[1],i[3]);if(r===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${r}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const i=[];if(!n||!e)return!1;for(let r=0;r<e.rowspan;r+=1)for(let o=0;o<e.colspan;o+=1)i.push(this.hot._createCellCoords(e.row+r,e.col+o));for(let r=0;r<i.length;r+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(i[r]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function uwe(t){return{key:"mergeCells",name(){const e=this.getSelectedActive();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(ST)}return this.getTranslatedPhrase(bT)},callback(){const e=this.getSelectedRangeActive();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:i}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,i.row,i.col,!1)},disabled(){const e=this.getSelectedActive();return e?qo.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function xf(t,e,n){return(e=cwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cwe(t){var e=hwe(t,"string");return typeof e=="symbol"?e:e+""}function hwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class w1{constructor(e){xf(this,"data",void 0),xf(this,"next",null),xf(this,"prev",null),this.data=e}}class cp{constructor(){xf(this,"first",null),xf(this,"last",null)}push(e){const n=new w1(e);if(this.first===null)this.first=n,this.last=n;else{const i=this.last;this.last=n,n.prev=i,i.next=n}return n}unshift(e){const n=new w1(e);if(this.first===null)this.first=n,this.last=n;else{const i=this.first;this.first=n,n.next=i,i.prev=n}}inorder(e){let n=this.first;for(;n;){const i=e(n);if(n===this.last||i===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,i,r;for(;n;){if(n.data===e)return i=n.next,r=n.prev,i&&(i.prev=r),r&&(r.next=i),n===this.first&&(this.first=i),n===this.last&&(this.last=r),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(i,r){r&&(e(r,r.next),r.next=i)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,i;for(;e;)i=e.next,e.next=n,n.prev=e,n=e,e=i;this.first.next=null,this.last.prev=null,i=this.first,this.first=n,this.last=i}}function dwe(t,e){HF(t,e),e.add(t)}function Gl(t,e,n){HF(t,e),e.set(t,n)}function HF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lt(t,e){return t.get(lv(t,e))}function Xi(t,e,n){return t.set(lv(t,e),n),n}function lv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var $o=new WeakMap,ko=new WeakMap,Lo=new WeakMap,Fo=new WeakMap,CE=new WeakMap,hp=new WeakMap,dp=new WeakMap,fS=new WeakSet;class fwe{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:i,columnIndexMapper:r}=e;dwe(this,fS),Gl(this,$o,new cp),Gl(this,ko,new cp),Gl(this,Lo,null),Gl(this,Fo,null),Gl(this,CE,null),Gl(this,hp,null),Gl(this,dp,null),Xi(CE,this,n),Xi(hp,this,i),Xi(dp,this,r)}getCurrentVerticalNode(){return lt(Fo,this).data}getFirstVerticalNode(){return lt(ko,this).first.data}getNextVerticalNode(){return lt(Fo,this).next.data}getPrevVerticalNode(){return lt(Fo,this).prev.data}getCurrentHorizontalNode(){return lt(Lo,this).data}getFirstHorizontalNode(){return lt($o,this).first.data}getNextHorizontalNode(){return lt(Lo,this).next.data}getPrevHorizontalNode(){return lt(Lo,this).prev.data}setPrevNodeAsActive(){Xi(Fo,this,lt(Fo,this).prev),Xi(Lo,this,lt(Lo,this).prev)}setNextNodeAsActive(){Xi(Fo,this,lt(Fo,this).next),Xi(Lo,this,lt(Lo,this).next)}buildFocusOrder(e){Xi($o,this,new cp),e.forEach((n,i)=>{const r=new WeakSet,o=n.getTopStartCorner(),s=n.getBottomEndCorner();for(let a=o.row;a<=s.row;a++)if(!lt(hp,this).isHidden(a))for(let l=o.col;l<=s.col;l++){if(lt(dp,this).isHidden(l))continue;const u=lv(fS,this,v1).call(this,{selectedRange:n,selectionLayer:i,listOrder:lt($o,this),mergeCellsVisitor:r,row:a,column:l});u&&Xi(Lo,this,u)}}),lt($o,this).first&&(lt($o,this).first.prev=lt($o,this).last,lt($o,this).last.next=lt($o,this).first),Xi(ko,this,new cp),e.forEach((n,i)=>{const r=new WeakSet,o=n.getTopStartCorner(),s=n.getBottomEndCorner();for(let a=o.col;a<=s.col;a++)if(!lt(dp,this).isHidden(a))for(let l=o.row;l<=s.row;l++){if(lt(hp,this).isHidden(l))continue;const u=lv(fS,this,v1).call(this,{selectedRange:n,selectionLayer:i,listOrder:lt(ko,this),mergeCellsVisitor:r,row:l,column:a});u&&Xi(Fo,this,u)}}),lt(ko,this).first&&(lt(ko,this).first.prev=lt(ko,this).last,lt(ko,this).last.next=lt(ko,this).first)}setActiveNode(e,n,i){return lt($o,this).inorder(r=>{const{selectionLayer:o,rowStart:s,rowEnd:a,colStart:l,colEnd:u}=r.data;if(o===i&&e>=s&&e<=a&&n>=l&&n<=u)return Xi(Lo,this,r),!0}),lt(ko,this).inorder(r=>{const{selectionLayer:o,rowStart:s,rowEnd:a,colStart:l,colEnd:u}=r.data;if(o===i&&e>=s&&e<=a&&n>=l&&n<=u)return Xi(Fo,this,r),!0}),this}}function v1(t){let{selectedRange:e,selectionLayer:n,listOrder:i,mergeCellsVisitor:r,row:o,column:s}=t;const a=e.getTopStartCorner(),l=e.getBottomEndCorner(),u=e.highlight.clone().normalize(),c=lt(CE,this).call(this,o,s);if(c&&r.has(c))return null;const h={selectionLayer:n,colStart:s,colEnd:s,rowStart:o,rowEnd:o};if(c){if(r.add(c),c.row<a.row||c.row+c.rowspan-1>l.row||c.col<a.col||c.col+c.colspan-1>l.col)return null;h.colStart=c.col,h.colEnd=c.col+c.colspan-1,h.rowStart=c.row,h.rowEnd=c.row+c.rowspan-1}const d=i.push(h);return o===u.row&&s===u.col||c&&u.row>=c.row&&u.row<=c.row+c.rowspan-1&&u.col>=c.col&&u.col<=c.col+c.colspan-1?d:null}function NF(t,e,n){const{rowIndexMapper:i,stylesHandler:r}=t;let o=0;for(let a=e;a<e+n;a++)if(!i.isHidden(a)){var s;o+=(s=t.getRowHeight(a))!==null&&s!==void 0?s:r.getDefaultRowHeight(a)}return o}function gwe(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:i}=e,r=new Map;function o(){}function s(a,l,u){const c=t.mergedCellsCollection.get(l,u);if(!me(c)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),r.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${r.get(l)}px`,r.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:p}=c,[v,b]=t.translateMergedCellToRenderable(h,p,d,f),P=t.getSetting("virtualized");if(d===0&&!e.getSettings().rowHeaders){const U=e._getRowHeightFromSettings(l);if(U!==void 0){const j=e.stylesHandler.areCellsBorderBox()?0:1;r.set(l,U-j)}else if(Wv()){const oe=NF(e,h,p);r.set(l,oe/p)}}const _=n.getRenderableFromVisualIndex(l),F=i.getRenderableFromVisualIndex(u),I=v-_+1,W=b-F+1;let k=n.getNearestNotHiddenIndex(h,1),$=i.getNearestNotHiddenIndex(d,1);if(P){const U=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(U)||(k=Math.max(k,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(U)||($=Math.max($,e.getFirstRenderedVisibleColumn()))}const Y=Math.min(p,I),J=Math.min(f,W);k===l&&$===u?(a.setAttribute("rowspan",Y),a.setAttribute("colspan",J)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:o,after:s}}function mwe(t,e){DF(t,e),e.add(t)}function fp(t,e,n){DF(t,e),e.set(t,n)}function DF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gS(t,e,n){return(e=pwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pwe(t){var e=wwe(t,"string");return typeof e=="symbol"?e:e+""}function wwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ig(t,e,n){return t.set(ht(t,e),n),n}function bt(t,e){return t.get(ht(t,e))}function ht(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}ie.getSingleton().register("beforeMergeCells");ie.getSingleton().register("afterMergeCells");ie.getSingleton().register("beforeUnmergeCells");ie.getSingleton().register("afterUnmergeCells");const yE="mergeCells",vwe=150,C1=yE;var Ar=new WeakMap,Hr=new WeakMap,is=new WeakMap,y1=new WeakMap,pt=new WeakSet;class Cwe extends qe{constructor(){super(...arguments),mwe(this,pt),gS(this,"mergedCellsCollection",null),gS(this,"autofillCalculations",null),gS(this,"selectionCalculations",null),fp(this,Ar,null),fp(this,Hr,{row:0,col:0}),fp(this,is,new fwe({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),fp(this,y1,gwe(this))}static get PLUGIN_KEY(){return yE}static get PLUGIN_PRIORITY(){return vwe}static get DEFAULT_SETTINGS(){return{[qk]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[yE]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new av(this),this.autofillCalculations=new owe(this),this.selectionCalculations=new lwe(this),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,ywe).call(e,...i)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,Swe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,Rwe).call(e,...i)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,Ewe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,Twe).call(e,...i)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,S1).call(e,...i)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,S1).call(e,...i)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,Mwe).call(e,...i)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,Pwe).call(e,...i)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,Iwe).call(e,...i)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,b1).call(e,...i)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,b1).call(e,...i)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,bwe).call(e,...i)}),this.addHook("afterRenderer",function(){return bt(y1,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,_we).call(e,...i)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,xwe).call(e,...i)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,Owe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,Awe).call(e,...i)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,Hwe).call(e,...i)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,Nwe).call(e,...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,Dwe).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,$we).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,kwe).call(e,...i)}),this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,Lwe).call(e,...i)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,Fwe).call(e,...i)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,Vwe).call(e,...i)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,Wwe).call(e,...i)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,Bwe).call(e,...i)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ht(pt,e,jwe).call(e,...i)}),this.addHook("beforeUndoStackChange",(n,i)=>{if(i==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!zD())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(i=>{const{row:r,rowspan:o}=i;for(let s=r+1;s<r+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(i=>{const r=this.hot.rowIndexMapper.getRenderableFromVisualIndex(i);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(r);s&&(s.style.background=Sw(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(i=>{var r;i.style.background=(r=Sw(i,"backgroundColor"))===null||r===void 0?void 0:r.replace(", 0.99)",")")})},1)}validateSetting(e){return e?qo.containsNegativeValues(e)?($e(qo.NEGATIVE_VALUES_WARNING(e)),!1):qo.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?($e(qo.IS_OUT_OF_BOUNDS_WARNING(e)),!1):qo.isSingleCell(e)?($e(qo.IS_SINGLE_CELL(e)),!1):qo.containsZeroSpan(e)?($e(qo.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(r=>this.validateSetting(r)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),i=[];n.forEach(r=>{const{row:o,col:s,rowspan:a,colspan:l}=r,u=this.hot._createCellCoords(o,s),c=this.hot._createCellCoords(o+a-1,s+l-1),h=this.hot._createCellRange(u,u,c);this.mergeRange(h,!0,!0);for(let d=o;d<o+a;d++)for(let f=s;f<s+l;f++)(d!==o||f!==s)&&i.push([d,f,null])}),i.length!==0&&this.hot.setDataAtCell(i,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeActive();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:i}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,i.row,i.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeActive();if(!e)return;const{from:n,to:i}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,i.row,i.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:r.row,col:r.col,rowspan:o.row-r.row+1,colspan:o.col-r.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),he(0,s.rowspan-1,c=>{he(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s,n)?(i?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=this.mergedCellsCollection.getWithinRange(e);i.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),O(i,r=>{this.mergedCellsCollection.remove(r.row,r.col),he(0,r.rowspan-1,o=>{he(0,r.colspan-1,s=>{this.hot.removeCellMeta(r.row+o,r.col+s,"hidden"),this.hot.removeCellMeta(r.row+o,r.col+s,"copyable")})}),this.hot.removeCellMeta(r.row,r.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:i}=e.clone().normalize(),r=this.mergedCellsCollection.get(n.row,n.col);r.row===n.row&&r.col===n.col&&r.row+r.rowspan-1===i.row&&r.col+r.colspan-1===i.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,i,r){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(i,r);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,i,r){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(i,r);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const i=this.hot.getSelectedRangeActive();i&&!i.isSingleHeader()&&(this.toggleMerge(i),this.hot.render())},runOnlyIf:i=>!i.altKey,group:C1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(C1)}modifyViewportRowStart(e,n){const i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(r,o);if(me(s)){const a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(r,o);if(me(s)){const a=s.row+s.rowspan-1,l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,r);if(me(s)){const a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,r);if(me(s)){const a=s.col+s.colspan-1,l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,i,r){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),r===0?l=s.getNearestNotHiddenIndex(i,1):l=s.getNearestNotHiddenIndex(i+r-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=i>=0?s.getRenderableFromVisualIndex(l):i;return[u,c]}}function ywe(){this.generateFromSettings(),this.hot.render()}function bwe(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeActive(),i=n.getTopStartCorner(),r=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(i.row===e[o].row&&i.col===e[o].col&&r.row===e[o].row+e[o].rowspan-1&&r.col===e[o].col+e[o].colspan-1)return!1}return t}function Swe(t){bt(Hr,this).row=t.row,bt(Hr,this).col=t.col}function Rwe(t){const e=this.hot.getSelectedRangeActive(),{highlight:n}=e,{columnIndexMapper:i,rowIndexMapper:r}=this.hot;bt(Ar,this)&&(r.getRenderableFromVisualIndex(bt(Ar,this).row)!==null&&(n.row=bt(Ar,this).row),i.getRenderableFromVisualIndex(bt(Ar,this).col)!==null&&(n.col=bt(Ar,this).col),ig(Ar,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const s=o.col,a=o.col+o.colspan-1;if(t.col<0){const c=n.col>=s&&n.col<=a?s-1:a,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const c=n.col>=s&&n.col<=a?a+1:s,h=i.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=o.row,u=o.row+o.rowspan-1;if(t.row<0){const c=n.row>=l&&n.row<=u?l-1:u,h=r.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const c=n.row>=l&&n.row<=u?u+1:l,h=r.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function Ewe(t){const e=this.hot.getSelectedRangeActive(),n=e.clone(),{to:i}=e,{columnIndexMapper:r,rowIndexMapper:o}=this.hot,s=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,i.col)+t.col;s(i.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=r.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,i.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,i.col)+t.col;s(i.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=r.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(i.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,i.row)+t.row;s(a,i.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=o.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,i.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,i.row)+t.row;s(a,i.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=o.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(i.row,l)-1,1))}}function Twe(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){ig(Ar,this,e.clone());return}for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);ig(Ar,this,e.clone()),n&&e.assign(n)}function b1(t,e,n,i){if(t<0||e<0)return;const r=this.mergedCellsCollection.get(t,e);if(!r)return;const{row:o,col:s,colspan:a,rowspan:l}=r,u=o,c=s,h=o+l-1,d=s+a-1;if(i==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),p=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),v=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[Ue(p,u,h),Ue(v,c,d),Ue(this.hot.getLastRenderedVisibleRow(),u,h),Ue(this.hot.getLastRenderedVisibleColumn(),c,d)]}return[u,c,h,d]}function _we(t){t.items.push({name:"---------"},uwe(this))}function S1(){ig(Ar,this,null)}function Mwe(){if(bt(Ar,this).isCell())return;const t=this.hot.getSelectedRangeActive(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),i=bt(Ar,this).clone().normalize();bt(is,this).setActiveNode(i.row,i.col),bt(Hr,this).row>0||bt(Hr,this).col>0?bt(is,this).setPrevNodeAsActive():(n==="E-W"&&bt(Hr,this).col<0||e==="S-N"&&bt(Hr,this).row<0)&&bt(is,this).setNextNodeAsActive()}function Pwe(t,e){const{columnIndexMapper:n,rowIndexMapper:i}=this.hot;let r=this.hot.getActiveSelectionLayerIndex(),o=null,s=null;if(bt(Hr,this).col<0){const{rowEnd:a,colEnd:l,selectionLayer:u}=bt(is,this).getPrevHorizontalNode();s=n.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1),r=u}else if(bt(Hr,this).col>0){const{rowStart:a,colStart:l,selectionLayer:u}=bt(is,this).getNextHorizontalNode();s=n.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1),r=u}else if(bt(Hr,this).row<0){const{rowEnd:a,colEnd:l,selectionLayer:u}=bt(is,this).getPrevVerticalNode();s=n.getNearestNotHiddenIndex(l,-1),o=i.getNearestNotHiddenIndex(a,-1),r=u}else if(bt(Hr,this).row>0){const{rowStart:a,colStart:l,selectionLayer:u}=bt(is,this).getNextVerticalNode();s=n.getNearestNotHiddenIndex(l,1),o=i.getNearestNotHiddenIndex(a,1),r=u}if(o!==null||s!==null){this.hot.selection.setActiveSelectionLayerIndex(r);const a=this.hot.getSelectedRangeActive(),l=this.hot._createCellCoords(o,s),u=this.mergedCellsCollection.get(l.row,l.col),c=this.hot.selection.highlight.getFocus();t=l.row,e=l.col,u?a.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(u.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(u.col,1)}):a.highlight.assign(l),c.clear(),c.add(l).commit()}bt(is,this).setActiveNode(t,e,r),ig(Hr,this,{row:0,col:0})}function Iwe(){bt(is,this).buildFocusOrder(this.hot.getSelectedRange())}function xwe(t,e,n){const i=this.mergedCellsCollection.get(t,e);i&&(i.row!==t||i.col!==e?n.copyable=!1:(n.rowspan=i.rowspan,n.colspan=i.colspan))}function Owe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Awe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Hwe(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const i=this.hot._createCellCoords(e[0],e[1]),r=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(i,i,r),s=this.mergedCellsCollection.getWithinRange(o);return s.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,s)}function Nwe(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function Dwe(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function $we(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function kwe(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Lwe(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function Fwe(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeActive(),i=this.mergedCellsCollection.getWithinRange(n);O(i,r=>{n.getBottomEndCorner().row===r.getLastRow()&&n.getBottomEndCorner().col===r.getLastColumn()&&(t[2]=r.row,t[3]=r.col)})}}function Vwe(t,e,n,i){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,i)}function Wwe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Bwe(t,e,n,i){if(!(i instanceof MouseEvent))return;const r=this.hot.getSelectedRangeActive(),o=this.mergedCellsCollection.getByRange(r);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&r.isEqual(this.hot._createCellRange(s,s,a))}function jwe(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let i,r;if(n==="master")i=this.hot.getFirstRenderedVisibleColumn(),r=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,i))return t;const s=this.hot._createCellCoords(e,i),a=this.hot._createCellCoords(e,r),l=this.hot._createCellRange(s,s,a),u=this.mergedCellsCollection.getWithinRange(l,!0),c=u.reduce((d,f)=>{let{rowspan:p}=f;return Math.max(d,p)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{let{rowspan:f}=d,p=0;n==="top"||n==="top_inline_start_corner"?p=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):p=f-h,t=Math.max(t??0,NF(this.hot,e,p))}),t}function Uwe(t,e){return function(n,i){const[,...r]=n,[,...o]=i;return function s(a){const l=t[a],u=e[a],c=r[a],h=o[a],d=u.multiColumnSorting,p=(d.compareFunctionFactory?d.compareFunctionFactory:lL(u.type))(l,u,d)(c,h);if(p===ss){const v=a+1;if(typeof e[v]<"u")return s(v)}return p}(0)}}const $F="sort";function zwe(t,e,n){const i=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&i.push(`${$F}-${t.getIndexOfColumnInSortQueue(e)+1}`),i}function Ywe(t){const e=t.className.split(" "),n=new RegExp(`^${$F}-[0-9]{1,2}$`);return e.filter(i=>n.test(i))}function Gwe(t,e,n){return(e=Kwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kwe(t){var e=Xwe(t,"string");return typeof e=="symbol"?e:e+""}function Xwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const uv="multiColumnSorting",qwe=170,R1=uv;aL(uv,Uwe);class Zwe extends wL{constructor(){super(...arguments),Gwe(this,"pluginKey",uv)}static get PLUGIN_KEY(){return uv}static get PLUGIN_PRIORITY(){return qwe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,jw)),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.isHeader()},relativeToGroup:ul,position:"before",group:R1})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(R1)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];super.updateHeaderClasses(e,...i),ae(e,Ywe(e)),this.enabled!==!1&&B(e,zwe(...i))}onAfterOnCellMouseDown(e,n){pM(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,jw))):this.sort(this.getColumnNextConfig(n.col)))}}function E1(t,e,n){return(e=Jwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jwe(t){var e=Qwe(t,"string");return typeof e=="symbol"?e:e+""}function Qwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const eve="multipleSelectionHandles",tve=160;class nve extends qe{constructor(){super(...arguments),E1(this,"dragged",[]),E1(this,"lastSetCell",null)}static get PLUGIN_KEY(){return eve}static get PLUGIN_PRIORITY(){return tve}isEnabled(){return rs()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function i(r){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(r);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",r=>{let o;if(Ce(r.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeActive(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},r.preventDefault(),!1;if(Ce(r.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeActive(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},r.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",r=>{if(Ce(r.target,"topSelectionHandle-HitArea"))return i.call(e,"top"),e.touchStartRange=void 0,r.preventDefault(),!1;if(Ce(r.target,"bottomSelectionHandle-HitArea"))return i.call(e,"bottom"),e.touchStartRange=void 0,r.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",r=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(r.touches[0].clientX,r.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeActive(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),r.preventDefault())})}getCurrentRangeCoords(e,n,i,r,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(i){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(r){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(r){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function bE(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:i=!1,crossHiddenColumns:r=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:i,isCollapsed:o,crossHiddenColumns:r,isHidden:s,isRoot:a,isPlaceholder:l,headerClassNames:u}}function kF(){return{label:"",isPlaceholder:!0}}function ive(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;O(t,r=>{const o=[];let s=0;n.push(o),O(r,a=>{const l=bE();if(me(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=Tt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=Tt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(kF());return!u})});const i=Math.max(...tt(n,r=>r.length));return O(n,r=>{if(r.length<i){const o=tt(new Array(i-r.length),()=>bE());r.splice(r.length,0,...o)}}),n}function mS(t,e,n){rve(t,e),e.set(t,n)}function rve(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kr(t,e){return t.get(LF(t,e))}function Ud(t,e,n){return t.set(LF(t,e),n),n}function LF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const T1=["label","collapsible"];var xs=new WeakMap,Kl=new WeakMap,pS=new WeakMap;class ove{constructor(){mS(this,xs,[]),mS(this,Kl,0),mS(this,pS,1/0)}setColumnsLimit(e){Ud(pS,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Ud(xs,this,ive(e,Kr(pS,this))),Ud(Kl,this,Kr(xs,this).length)}getData(){return Kr(xs,this)}mergeWith(e){O(e,n=>{let{row:i,col:r,...o}=n;const s=this.getHeaderSettings(i,r);s!==null&&bn(s,o,T1)})}map(e){O(Kr(xs,this),n=>{O(n,i=>{const r=e({...i});me(r)&&bn(i,r,T1)})})}getHeaderSettings(e,n){var i;if(e>=Kr(Kl,this)||e<0)return null;const r=Kr(xs,this)[e];return Array.isArray(r)===!1||n>=r.length?null:(i=r[n])!==null&&i!==void 0?i:null}getHeadersSettings(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=[];if(e>=Kr(Kl,this)||e<0)return r;const o=Kr(xs,this)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,r.push(l),l.colspan>1&&(a+=l.colspan-1),s===i)break;if(s>i)throw new Error("The last column settings cannot overlap the other header layers")}return r}getLayersCount(){return Kr(Kl,this)}getColumnsCount(){return Kr(Kl,this)>0?Kr(xs,this)[0].length:0}clear(){Ud(xs,this,[]),Ud(Kl,this,0)}}function wS(t,e,n){return(e=sve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sve(t){var e=ave(t,"string");return typeof e=="symbol"?e:e+""}function ave(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const FF="DF-pre-order";function VF(t,e){let n=t.call(e,this);for(let i=0;i<this.childs.length;i++){if(n===!1)return!1;n=VF.call(this.childs[i],t,e)}return n}const lve="DF-post-order";function WF(t,e){for(let n=0;n<this.childs.length;n++)if(WF.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const BF="BF";function uve(t,e){const n=[this];function i(){if(n.length===0)return;const r=n.shift();n.push(...r.childs),t.call(e,r)!==!1&&i()}i()}const cve=BF,_1=new Map([[FF,VF],[lve,WF],[BF,uve]]);class cv{constructor(e){wS(this,"data",{}),wS(this,"parent",null),wS(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new cv({...e.data});for(let i=0;i<e.childs.length;i++)n.addChild(this.cloneTree(e.childs[i]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:cve;if(!_1.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);_1.get(n).call(this,e,this)}walkUp(e){const n=this,i=r=>{e.call(n,r)!==!1&&r.parent!==null&&i(r.parent)};i(this)}}function vS(t,e,n){hve(t,e),e.set(t,n)}function hve(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ci(t,e){return t.get(jF(t,e))}function dve(t,e,n){return t.set(jF(t,e),n),n}function jF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Hc=new WeakMap,Xl=new WeakMap,Nc=new WeakMap;class fve{constructor(e){vS(this,Hc,new Map),vS(this,Xl,new Map),vS(this,Nc,null),dve(Nc,this,e)}getRoots(){return Array.from(ci(Hc,this).values())}getRootByColumn(e){let n;return ci(Xl,this).has(e)&&(n=ci(Hc,this).get(ci(Xl,this).get(e))),n}getNode(e,n){const i=this.getRootByColumn(n);if(!i)return;const r=n-ci(Xl,this).get(n);let o=0,s;return i.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(r>=o&&r<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;ci(Xl,this).clear(),O(ci(Hc,this),n=>{let[,{data:{colspan:i}}]=n;for(let r=e;r<e+i;r++)ci(Xl,this).set(r,e);e+=i})}buildTree(){this.clear();const e=ci(Nc,this).getColumnsCount();let n=0;for(;n<e;){const i=ci(Nc,this).getHeaderSettings(0,n),r=new cv;ci(Hc,this).set(n,r),this.buildLeaves(r,n,0,i.origColspan),n+=i.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=ci(Nc,this).getHeadersSettings(i,n,r);i+=1,O(o,s=>{const a={...s,headerLevel:i-1,columnIndex:n};let l;i===1?(e.data=a,l=e):(l=new cv(a),e.addChild(l)),i<ci(Nc,this).getLayersCount()&&this.buildLeaves(l,n,i,s.origColspan),n+=s.origColspan})}clear(){ci(Hc,this).clear(),ci(Xl,this).clear()}}function UF(t,e){t.walkDown(n=>{let{data:i,childs:r}=n;if(!i.isHidden&&(e(i.columnIndex),r.length===0))for(let o=1;o<i.colspan;o++)e(i.columnIndex+o)})}function hv(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function dv(t){return hv(t,"origColspan")===t.data.origColspan}function OM(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(dv(t))return OM(n[0]);e.isCollapsed=!1;const r=n.slice(1),o=new Set;let s=0;if(r.length>0)O(r,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,UF(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):dv(a)&&(l.isCollapsed=hv(a,"isCollapsed"))}),{rollbackModification:()=>AM(t),affectedColumns:Array.from(o),colspanCompensation:s}}function AM(t){var e;const{data:n,childs:i}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(dv(t))return AM(i[0]);n.isCollapsed=!0;const o=i.slice(1),s=new Set;if(o.length>0)O(o,l=>{UF(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=hv(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):dv(l)&&(u.isCollapsed=hv(l,"isCollapsed"))}),{rollbackModification:()=>OM(t),affectedColumns:Array.from(s),colspanCompensation:a}}function gve(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(nt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let i=!1;t.walkUp(r=>{const{data:{collapsible:o}}=r;if(o)return i=!0,!1}),!i&&t.walkUp(r=>{const{data:o}=r;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function mve(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(nt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let i=!1;t.walkUp(r=>{const{data:{collapsible:o}}=r;if(o)return i=!0,!1}),!i&&t.walkUp(r=>{const{data:o}=r;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const M1=new Map([["collapse",AM],["expand",OM],["hide-column",gve],["show-column",mve]]);function pve(t,e,n){if(!M1.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return M1.get(t)(e,n)}function gp(t){const e=[];return O(t,n=>{n.walkDown(i=>{const r=i.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=r,u=vve(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(kF());else{const f=wve(r);f.isRoot=!0,u.push(f),c=!0}})}),e}function wve(t){const{crossHiddenColumns:e,...n}=bE(t);return n}function vve(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function CS(t,e,n){Cve(t,e),e.set(t,n)}function Cve(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zd(t,e,n){return t.set(zF(t,e),n),n}function Vt(t,e){return t.get(zF(t,e))}function zF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Vo=new WeakMap,xi=new WeakMap,ql=new WeakMap;class yve{constructor(){CS(this,Vo,new ove),CS(this,xi,new fve(Vt(Vo,this))),CS(this,ql,[[]])}setState(e){Vt(Vo,this).setData(e);let n=!1;try{Vt(xi,this).buildTree()}catch{Vt(xi,this).clear(),Vt(Vo,this).clear(),n=!0}return zd(ql,this,gp(Vt(xi,this).getRoots())),n}setColumnsLimit(e){Vt(Vo,this).setColumnsLimit(e)}mergeStateWith(e){const n=tt(e,i=>{let{row:r,...o}=i;return{row:r<0?this.rowCoordsToLevel(r):r,...o}});Vt(Vo,this).mergeWith(n),Vt(xi,this).buildTree(),zd(ql,this,gp(Vt(xi,this).getRoots()))}mapState(e){Vt(Vo,this).map(e),Vt(xi,this).buildTree(),zd(ql,this,gp(Vt(xi,this).getRoots()))}mapNodes(e){return ji(Vt(xi,this).getRoots(),(n,i)=>(i.walkDown(r=>{const o=e(r.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,i){n<0&&(n=this.rowCoordsToLevel(n));const r=Vt(xi,this).getNode(n,i);let o;return r&&(o=pve(e,r,i),zd(ql,this,gp(Vt(xi,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var i,r;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(i=(r=Vt(ql,this)[e])===null||r===void 0?void 0:r[n])!==null&&i!==void 0?i:null}getHeaderTreeNodeData(e,n){const i=this.getHeaderTreeNode(e,n);return i?{...i.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const i=Vt(xi,this).getNode(e,n);return i||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=n-e+1;let r=!1,o=null;for(let s=e;s<=n;s++){const a=Vt(xi,this).getRootByColumn(s);if(!a)break;r=!0,a.walkDown(l=>{const{columnIndex:u,headerLevel:c,origColspan:h,isHidden:d}=l.data;d||h<=i&&u>=e&&u+h-1<=n&&(o===null||c<o)&&(o=c)},FF)}return r&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,n){var i;const{isRoot:r}=(i=this.getHeaderSettings(e,n))!==null&&i!==void 0?i:{isRoot:!0};if(r)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var i;const{isRoot:r,origColspan:o}=(i=this.getHeaderSettings(e,n))!==null&&i!==void 0?i:{isRoot:!0,origColspan:1};if(r)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Vt(Vo,this).getLayersCount()}getColumnsCount(){return Vt(Vo,this).getColumnsCount()}clear(){zd(ql,this,[]),Vt(Vo,this).clear(),Vt(xi,this).clear()}}function Yd(t,e,n){return(e=bve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bve(t){var e=Sve(t,"string");return typeof e=="symbol"?e:e+""}function Sve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rve{constructor(e,n){Yd(this,"hot",void 0),Yd(this,"nestedHeaderSettingsGetter",void 0),Yd(this,"layersCount",0),Yd(this,"container",void 0),Yd(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),i=n.length;this.widthsMap.clear();for(let r=0;r<i;r++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),s=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(s,n[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:i}=this.hot,r=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=i.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=i.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let p=f.label;s&&(p+='<button class="changeType"></button>'),Yu(d,p),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}r.appendChild(o),e.appendChild(r)}clear(){this.widthsMap.clear(),this.container=null}}function Eve(t,e){YF(t,e),e.add(t)}function P1(t,e,n){return(e=Tve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tve(t){var e=_ve(t,"string");return typeof e=="symbol"?e:e+""}function _ve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dc(t,e,n){YF(t,e),e.set(t,n)}function YF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gs(t,e,n){return t.set(_n(t,e),n),n}function Ie(t,e){return t.get(_n(t,e))}function _n(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const I1="nestedHeaders",Mve=280;var ft=new WeakMap,Oa=new WeakMap,Of=new WeakMap,CC=new WeakMap,fv=new WeakMap,Zl=new WeakMap,Nn=new WeakSet;class Pve extends qe{constructor(){super(...arguments),Eve(this,Nn),Dc(this,ft,new yve),Dc(this,Oa,null),Dc(this,Of,null),Dc(this,CC,!1),Dc(this,fv,null),P1(this,"ghostTable",new Rve(this.hot,(e,n)=>this.getHeaderSettings(e,n))),P1(this,"detectedOverlappedHeaders",!1),Dc(this,Zl,()=>{var e;const n=(e=this.hot)===null||e===void 0?void 0:e.getSelectedRangeActive();if(!n)return;const{highlight:i}=n;if(i.isHeader()&&i.col>=0){const o=Ie(ft,this).findLeftMostColumnIndex(i.row,i.col),s=this.hot.selection.highlight.getFocus();s.visualCellRange.highlight.col=o,s.visualCellRange.from.col=o,s.visualCellRange.to.col=o,s.commit()}})}static get PLUGIN_KEY(){return I1}static get PLUGIN_PRIORITY(){return Mve}isEnabled(){return!!this.hot.getSettings()[I1]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&$e(nt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>_n(Nn,this,Uve).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _n(Nn,e,zve).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _n(Nn,e,Ave).call(e,...r)}),this.addHook("afterOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _n(Nn,e,Hve).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _n(Nn,e,Nve).call(e,...r)}),this.addHook("beforeOnCellMouseUp",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _n(Nn,e,Dve).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _n(Nn,e,$ve).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _n(Nn,e,kve).call(e,...r)}),this.addHook("afterSelection",()=>Ie(Zl,this).call(this)),this.addHook("afterSelectionFocusSet",()=>Ie(Zl,this).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _n(Nn,e,Ive).call(e,...r)}),this.addHook("afterGetColumnHeaderRenderers",i=>_n(Nn,this,Fve).call(this,i)),this.addHook("modifyColWidth",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _n(Nn,e,Wve).call(e,...r)}),this.addHook("modifyColumnHeaderValue",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _n(Nn,e,Bve).call(e,...r)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _n(Nn,e,xve).call(e,...r)}),this.addHook("beforeCopy",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _n(Nn,e,Ove).call(e,...r)}),this.addHook("beforeSelectColumns",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _n(Nn,e,Lve).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _n(Nn,e,Vve).call(e,...r)}),this.addHook("modifyFocusedElement",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return _n(Nn,e,jve).call(e,...r)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",Ie(Zl,this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",Ie(Zl,this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Ie(ft,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Ie(ft,this).setState(e)),this.detectedOverlappedHeaders&&$e(nt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,i)=>{const r=n===!0?"hide-column":"show-column";Ie(ft,this).triggerColumnModification(r,i)}),!Ie(Oa,this)&&this.enabled&&Gs(Oa,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(i=>{let{op:r,index:o,newValue:s}=i;if(r==="replace"){const a=s===!0?"hide-column":"show-column";Ie(ft,this).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.removeLocalHook("cacheUpdated",Ie(Zl,this)),this.hot.columnIndexMapper.removeLocalHook("cacheUpdated",Ie(Zl,this)),this.clearColspans(),Ie(ft,this).clear(),Ie(Oa,this).unsubscribe(),Gs(Oa,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Ie(ft,this)}getLayersCount(){return Ie(ft,this).getLayersCount()}getHeaderSettings(e,n){return Ie(ft,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,i=e.wtTable.THEAD,r=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=i.childNodes[s];if(!a)break;const l=r.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),ae(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),ae(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),ae(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const i=this.hot.view._wt.getSetting("fixedColumnsStart");return(r,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(r);u===null&&(u=r),o.removeAttribute("colspan"),ae(o,"hiddenHeader"),ae(o,"hiddenHeaderText");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(s=Ie(ft,this).getHeaderSettings(e,u))!==null&&s!==void 0?s:{};if(d||h)B(o,"hiddenHeader");else if(c>1){var p,v,b;const{wtOverlays:P}=l._wt,_=(p=P.topInlineStartCornerOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(o),F=(v=P.inlineStartOverlay)===null||v===void 0?void 0:v.clone.wtTable.THEAD.contains(o);((b=P.topOverlay)===null||b===void 0?void 0:b.clone.wtTable.THEAD.contains(o))&&u<i&&B(o,"hiddenHeaderText");const W=_||F?Math.min(c,i-r):c;W>1&&o.setAttribute("colspan",W)}if(this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const P=o.querySelector("div.relative");P&&f&&f.length>0&&(ae(P,this.hot.getColumnMeta(u).headerClassName),B(P,f))}}}getColumnHeaderValue(e,n){var i;const{isHidden:r,isPlaceholder:o}=(i=Ie(ft,this).getHeaderSettings(n,e))!==null&&i!==void 0?i:{};return o||r?"":this.hot.getColHeader(e,n)}destroy(){Gs(ft,this,null),Ie(Oa,this)!==null&&(Ie(Oa,this).unsubscribe(),Gs(Oa,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Ie(ft,this).getHeaderTreeNodeData(e.row,e.col)}}function Ive(t,e){var n;const i=this.hot.getSelectedRangeActive();if(!i)return t;const{highlight:r}=i,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),a=o?r.row:(n=Ie(fv,this))===null||n===void 0?void 0:n.row,l=s?t:r.col,u=a<0&&l>=0;if(Gs(fv,this,null),!u)return t;const c=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-c+1,f=Ie(ft,this).findLeftMostColumnIndex(a,l),p=Ie(ft,this).findRightMostColumnIndex(a,l),v=p-f+1;if(f<c&&p>h)return f;if(s){let b=null;return f>=c&&p>h?v>d?(e.value="start",b=f):(e.value="end",b=p):f<c&&p<=h&&(v>d?(e.value="end",b=p):(e.value="start",b=f)),b}return f<=c?f:p}function xve(t,e,n){const i=Ie(ft,this).getHeaderTreeNodeData(e,t);if(!i)return t;const{columnCursor:r,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=Ie(ft,this).getHeaderSettings(e,t);if(o===V0){if(!a)return i.columnIndex}else if(o===O$&&(l>s-r||!a))return null;return t}function Ove(t,e,n){let{columnHeadersCount:i}=n;if(i!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var r;const p=c+f,v=d-a;if(v===0)continue;((r=Ie(ft,this).getHeaderTreeNodeData(f,d))===null||r===void 0?void 0:r.isRoot)===!1&&(t[p][v]="")}}}function Ave(t,e,n,i){this._getHeaderTreeNodeDataByCoords(e)&&(i.column=!0)}function Hve(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;Gs(Of,this,e.clone()),Gs(CC,this,!0);const{selection:i}=this.hot,r=i.isSelected()?i.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!i.inInSelection(e);t.shiftKey&&r?e.col<r.from.col?o.push(r.getTopEndCorner().col,s,e.row):e.col>r.from.col?o.push(r.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(P0(t)||Iu(t)&&l||l7(t))&&o.push(s,s+a-1,e.row),i.selectColumns(...o)}function Nve(t,e,n,i){if(!this.hot.view.isMouseDown()||i.column)return;const r=this._getHeaderTreeNodeDataByCoords(e);if(!r)return;const{columnIndex:o,origColspan:s}=r,a=this.hot.getSelectedRangeActive(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;i.column=!0,i.cell=!0;const h=[],d=Ue(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function Dve(){Gs(CC,this,!1)}function $ve(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Ie(CC,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,i=e.getBottomEndCorner().col,{columnIndex:r,origColspan:o}=Ie(ft,this).getHeaderTreeNodeData(Ie(Of,this).row,Ie(Of,this).col);if(e.setHighlight(Ie(Of,this)),o>e.getWidth()||r<n||r+o-1>i){const s=Ie(ft,this).findTopMostEntireHeaderLevel(Ue(n,r,r+o-1),Ue(i,r,r+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function kve(t){const{highlight:e}=this.hot.getSelectedRangeActive(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const r=Ie(ft,this).findLeftMostColumnIndex(n.row,n.col),o=Ie(ft,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=r&&e.col<=o?r-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=r&&e.col<=o?o+1:r,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function Lve(t,e,n){const i=t.row,r=this._getHeaderTreeNodeDataByCoords({row:i,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:i,col:e.col});Gs(fv,this,n.clone()),e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function Fve(t){if(Ie(ft,this).getLayersCount()>0){t.length=0;for(let e=0;e<Ie(ft,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function Vve(t){const e=Ie(ft,this).getLayersCount();let n=t.startColumn,i=!!e;for(let r=0;r<e;r++){const o=Ie(ft,this).findLeftMostColumnIndex(r,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(i=!1),Ci(s)&&s<t.startColumn){n=s;break}}t.startColumn=i?Ie(ft,this).getHeaderTreeNodeData(0,n).columnIndex:n}function Wve(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function Bve(t,e,n){var i;const{label:r}=(i=Ie(ft,this).getHeaderTreeNodeData(n,e))!==null&&i!==void 0?i:{label:""};return r}function jve(t,e){if(t<0)return this.hot.getCell(t,Ie(ft,this).findLeftMostColumnIndex(t,e),!0)}function Uve(){this.updatePlugin()}function zve(t,e){e||this.updatePlugin()}function Gd(t,e,n){return(e=Yve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yve(t){var e=Gve(t,"string");return typeof e=="symbol"?e:e+""}function Gve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kve{constructor(e,n){Gd(this,"hot",void 0),Gd(this,"data",null),Gd(this,"plugin",void 0),Gd(this,"parentReference",new WeakMap),Gd(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},he(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,i){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:i,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&O(e.__children,r=>{this.cacheNode(r,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,i,r){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),i!=null&&s===i?{result:a,end:!0}:r!=null&&a===r?{result:s,end:!0}:(s+=1,a.__children&&O(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,i,r),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return We(this.data[0],(n,i)=>{e[i]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const i=this.getRowParent(e);return i==null?this.data.indexOf(n):i.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,i=e;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(O(i.__children,r=>{n+=1,r.__children&&(n+=this.countChildren(r))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var i;return((i=e.__children)===null||i===void 0?void 0:i[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let i=e;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((n=i.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let i=n;this.hot.runHooks("beforeAddChild",e,i);let r=null;e&&(r=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),i||(i=this.mockNode()),o.__children.push(i),this.rewriteCache();const s=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,i)}addChildAtIndex(e,n,i){let r=i,o;if(r||(r=this.mockNode()),this.hot.runHooks("beforeAddChild",e,r,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,r),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);r=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,r,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const i=this.translateTrimmedRow(e),r=this.getRowParent(i),o=this.getRowIndexWithinParent(i);switch(n){case"below":this.addChildAtIndex(r,o+1,null);break;case"above":this.addChildAtIndex(r,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null;const r=[];Array.isArray(e)?(he(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);r.push(this.getDataObject(f))}),he(0,r.length-2,d=>{this.detachFromParent(r[d],!1)}),i=r[r.length-1]):i=e;const o=this.getRowIndex(i),s=this.countChildren(i),a=this.getRowIndexWithinParent(i),l=this.getRowParent(i),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,i),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),p=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",p+1,s+1,this.plugin.pluginName),u.__children.push(i)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,i,this.getRowIndex(i)),n&&this.hot.render()}filterData(e,n,i){const r=[];O(i,o=>{r.push(this.getDataObject(o))}),O(r,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,i){const r=this.getDataObject(e-1);let o=null,s=e;r&&r.__children&&r.__children.length===0?(o=r,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?i?o.__children.splice(s,n,...i):o.__children.splice(s,n):i?this.data.splice(s,n,...i):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,i=n;do i=this.getRowParent(i),i!==null&&(n=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,i,r){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||i||r?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function x1(t,e,n){return(e=Xve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xve(t){var e=qve(t,"string");return typeof e=="symbol"?e:e+""}function qve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HM{constructor(e,n){x1(this,"hot",void 0),x1(this,"plugin",void 0),this.hot=n,this.plugin=e}}class Jo extends HM{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const i=this.hot.toPhysicalRow(e),r=this.dataManager.getDataObject(i);if(!r)return;const o=this.dataManager.getRowLevel(i),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(O(l,c=>{c&&s.removeChild(c)}),B(n,Jo.CSS_CLASSES.indicatorContainer),o){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",he(0,o-1,()=>{const d=c.createElement("SPAN");B(d,Jo.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(r)){const c=this.hot.rootDocument.createElement("DIV");u&&le(c,[Uu()]),B(n,Jo.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?(B(c,`${Jo.CSS_CLASSES.button} ${Jo.CSS_CLASSES.expandButton}`),u&&le(n,[Nr(!1)])):(B(c,`${Jo.CSS_CLASSES.button} ${Jo.CSS_CLASSES.collapseButton}`),u&&le(n,[Nr(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);let i=11;this.hot.stylesHandler.isClassicTheme()||(i=this.hot.stylesHandler.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,i+10*n+25),this.hot.render()}}class Zve extends HM{constructor(e,n){var i;super(e,n),i=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,r)},shiftStash:function(r,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),O(i.lastCollapsedRows,(a,l)=>{a>=r&&a<o&&(i.lastCollapsedRows[l]=a+s)})},applyStash:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,r),i.lastCollapsedRows=void 0},trimStash:(r,o)=>{he(r,r+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&O(o.__children,l=>{r.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(r,!0,!1),i&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];O(e,o=>{r.push(...this.collapseChildren(o,!1,!1))}),i&&this.trimRows(r),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=[];return O(e,o=>{r.push(o),n&&this.collapseChildRows(o,r)}),i&&this.trimRows(r),r}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const r=this.dataManager.getDataObject(e);O(r.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}i&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=[];return O(e,o=>{r.push(o),n&&this.expandChildRows(o,r)}),i&&this.untrimRows(r),r}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const r=this.dataManager.getDataObject(e);O(r.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}i&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&O(o.__children,l=>{const u=this.dataManager.getRowIndex(l);r.push(u)}),a=this.expandRows(r,!0,!1),i&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];O(e,o=>{r.push(...this.expandChildren(o,!1,!1))}),i&&this.untrimRows(r),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];O(e,i=>{this.dataManager.hasChildren(i)&&n.push(i)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];O(e,i=>{this.dataManager.hasChildren(i)&&n.push(i)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{O(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{O(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),i=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&O(n.__children,r=>{const o=this.dataManager.getRowIndex(r);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return i=!1,!1}),i}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const i=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(i)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const i=this.translateTrimmedRow(n.row);Ce(e.target,Jo.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),$r(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.view.adjustElementsSize(),this.hot.render()}}function Jve(t,e,n){Qve(t,e),e.set(t,n)}function Qve(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eCe(t,e,n){return(e=tCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tCe(t){var e=nCe(t,"string");return typeof e=="symbol"?e:e+""}function nCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iCe(t,e){return t.get(rCe(t,e))}function rCe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var O1=new WeakMap;class oCe extends HM{constructor(){super(...arguments),eCe(this,"dataManager",this.plugin.dataManager),Jve(this,O1,{row_above:(e,n)=>{const i=n[n.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(e,n)=>{const i=n[n.length-1];this.dataManager.addSibling(i.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(WT)},callback:()=>{const i=this.dataManager.translateTrimmedRow(this.hot.getSelectedActive()[0]),r=this.dataManager.getDataObject(i);this.dataManager.addChild(r)},disabled:()=>{const i=this.hot.getSelectedActive();return!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(BT)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedActive())},disabled:()=>{const i=this.hot.getSelectedActive(),r=this.dataManager.translateTrimmedRow(i[0]);return!this.dataManager.getRowParent(r)||!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return he(0,e.items.length-1,i=>{if(i===0)return O(n,(r,o)=>{e.items.splice(i+o,0,r)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return he(0,e.items.length-1,n=>{const i=iCe(O1,this)[e.items[n].key];i!=null&&(e.items[n].callback=i)}),e}}function mp(t,e,n){return(e=sCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sCe(t){var e=aCe(t,"string");return typeof e=="symbol"?e:e+""}function aCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lCe{constructor(e){mp(this,"plugin",void 0),mp(this,"hot",void 0),mp(this,"dataManager",void 0),mp(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,i,r){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:i,movePossible:r}))return!1;this.movedToCollapsed=!1;const s=i===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i);let l=!0;const u=e.map(p=>{if(!l)return!1;const v=this.dataManager.translateTrimmedRow(p);return l=this.shouldAllowMoving(v,a),v}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,i,r,r&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,i),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:i,dropIndex:r,movePossible:o}=e;let s=!1;return xt(r)&&($e(nt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,i,r,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let i=this.dataManager.getRowParent(e?n-1:n);return i==null&&(i=this.dataManager.getRowParent(n-1)),i}shiftCollapsibleParentsLocations(e,n,i){i||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,i){const r=n===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,r)})})}moveCellsMeta(e,n){const i=[],r=Math.max(...e)<n;e.forEach(o=>{i.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(r?i.length:0),0,...i)}selectCells(e,n){const i=e.length;let r=0,o=0;if(this.movedToCollapsed){let s=null;e[i-1]<n?s=this.dataManager.translateTrimmedRow(n-i):s=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(s===null?this.hot.countSourceRows()-1:s-1),l=this.dataManager.getRowIndex(a);r=this.dataManager.untranslateTrimmedRow(l),o=r}else e[i-1]<n?(o=n-1,r=o-i+1):(r=n,o=r+i-1);this.hot.selectCells([[r,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}}function uCe(t,e){GF(t,e),e.add(t)}function A1(t,e,n){GF(t,e),e.set(t,n)}function GF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yS(t,e,n){return(e=cCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cCe(t){var e=hCe(t,"string");return typeof e=="symbol"?e:e+""}function hCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iw(t,e){return t.get(Mn(t,e))}function gv(t,e,n){return t.set(Mn(t,e),n),n}function Mn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const mv="nestedRows",dCe=300,H1=mv,fCe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var yC=new WeakMap,$c=new WeakMap,Dn=new WeakSet;class gCe extends qe{constructor(){super(...arguments),uCe(this,Dn),yS(this,"dataManager",null),yS(this,"headersUI",null),yS(this,"collapsedRowsMap",null),A1(this,yC,!1),A1(this,$c,!1)}static get PLUGIN_KEY(){return mv}static get PLUGIN_PRIORITY(){return dCe}isEnabled(){return!!this.hot.getSettings()[mv]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new bg),this.dataManager=new Kve(this,this.hot),this.collapsingUI=new Zve(this,this.hot),this.headersUI=new Jo(this,this.hot),this.contextMenuUI=new oCe(this,this.hot),this.rowMoveController=new lCe(this),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Mn(Dn,e,PCe).call(e,...i)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Mn(Dn,e,ICe).call(e,...i)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Mn(Dn,e,wCe).call(e,...i)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Mn(Dn,e,vCe).call(e,...i)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Mn(Dn,e,CCe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Mn(Dn,e,pCe).call(e,...i)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Mn(Dn,e,SCe).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Mn(Dn,e,bCe).call(e,...i)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Mn(Dn,e,RCe).call(e,...i)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Mn(Dn,e,ECe).call(e,...i)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Mn(Dn,e,TCe).call(e,...i)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Mn(Dn,e,_Ce).call(e,...i)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Mn(Dn,e,yCe).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Mn(Dn,e,MCe).call(e,...i)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Mn(Dn,e,mCe).call(e,...i)}),this.addHook("beforeLoadData",n=>Mn(Dn,this,N1).call(this,n)),this.addHook("beforeUpdateData",n=>Mn(Dn,this,N1).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.col===-1&&i.row>=0},group:H1,relativeToGroup:ul,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(H1)}disableCoreAPIModifiers(){gv($c,this,!0)}enableCoreAPIModifiers(){gv($c,this,!1)}onModifyRowData(e){if(!iw($c,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!iw($c,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,i){return iw($c,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,i),!1)}destroy(){super.destroy()}}function mCe(t,e,n,i){return this.rowMoveController.onBeforeRowMove(t,e,n,i)}function pCe(t,e,n){this.collapsingUI.toggleState(t,e,n)}function wCe(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),gv(yC,this,!0),this.dataManager.getData().slice()}function vCe(t){return this.contextMenuUI.appendOptions(t)}function CCe(t,e){this.headersUI.appendLevelIndicators(t,e)}function yCe(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function bCe(t,e,n,i){i!==this.pluginName&&this.hot._registerTimeout(()=>{gv(yC,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function SCe(t,e,n){const i=Array.from(n.reduce((r,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return r.add(o),Array.isArray(s)&&s.forEach(a=>r.add(this.dataManager.getRowIndex(a))),r}return r.add(o)},new Set));n.length=0,n.push(...i)}function RCe(){this.collapsingUI.collapsedRowsStash.stash()}function ECe(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function TCe(){this.collapsingUI.collapsedRowsStash.stash()}function _Ce(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function MCe(){this.dataManager.rewriteCache()}function PCe(){this.headersUI.updateRowHeaderWidth()}function ICe(t,e){iw(yC,this)&&(e.skipRender=!0)}function N1(t){if(!AQ(t)){I0(fCe),this.hot.getSettings()[mv]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function xCe(t,e){KF(t,e),e.add(t)}function Aa(t,e,n){KF(t,e),e.set(t,n)}function KF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ge(t,e){return t.get(Af(t,e))}function Wo(t,e,n){return t.set(Af(t,e),n),n}function Af(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const OCe=`
<div data-ref="container" class="ht-pagination handsontable">
  <div class="ht-pagination__inner">
    <div data-ref="pageSizeSection" class="ht-page-size-section">
      <span data-ref="pageSizeLabel" class="ht-page-size-section__label"></span>
      <div class="ht-page-size-section__select-wrapper">
        <select data-ref="pageSizeSelect" name="pageSize" data-hot-input></select>
      </div>
    </div>
    <div data-ref="pageCounterSection" class="ht-page-counter-section"></div>
    <nav data-ref="pageNavSection" class="ht-page-navigation-section">
      <button data-ref="first" class="ht-page-navigation-section__button ht-page-first"></button>
      <button data-ref="prev" class="ht-page-navigation-section__button ht-page-prev"></button>
      <span data-ref="pageNavLabel" class="ht-page-navigation-section__label"></span>
      <button data-ref="next" class="ht-page-navigation-section__button ht-page-next"></button>
      <button data-ref="last" class="ht-page-navigation-section__button ht-page-last"></button>
    </nav>
  </div>
</div>
`;var uh=new WeakMap,tu=new WeakMap,bS=new WeakMap,Jn=new WeakMap,kc=new WeakMap,Sr=new WeakMap,SS=new WeakMap,RS=new WeakMap,pp=new WeakSet;class XF{constructor(e){let{rootElement:n,uiContainer:i,isRtl:r,themeName:o,phraseTranslator:s,shouldHaveBorder:a,a11yAnnouncer:l}=e;xCe(this,pp),Aa(this,uh,void 0),Aa(this,tu,void 0),Aa(this,bS,!1),Aa(this,Jn,void 0),Aa(this,kc,void 0),Aa(this,Sr,void 0),Aa(this,SS,void 0),Aa(this,RS,void 0),Wo(uh,this,n),Wo(tu,this,i),Wo(bS,this,r),Wo(kc,this,o),Wo(Sr,this,s),Wo(SS,this,a),Wo(RS,this,l),this.install()}install(){var e;if((e=Ge(Jn,this))!==null&&e!==void 0&&e.container)return;const n=bh`${OCe}`,{container:i,first:r,prev:o,next:s,last:a,pageSizeSelect:l}=n.refs;Wo(Jn,this,n.refs),i.setAttribute("dir",Ge(bS,this)?"rtl":"ltr"),i.tabIndex=-1;const u=h=>h.currentTarget.disabled,c=(h,d,f)=>{d.addEventListener(h,p=>{u(p)||f()})};c("click",r,()=>this.runLocalHooks("firstPageClick")),c("click",o,()=>this.runLocalHooks("prevPageClick")),c("click",s,()=>this.runLocalHooks("nextPageClick")),c("click",a,()=>this.runLocalHooks("lastPageClick")),l.addEventListener("change",()=>{const h=l.value==="auto"?"auto":Number.parseInt(l.value,10);this.runLocalHooks("pageSizeChange",h)}),this.setCounterSectionVisibility(!1),this.setNavigationSectionVisibility(!1),this.setPageSizeSectionVisibility(!1),Ge(tu,this)?(Ge(tu,this).appendChild(n.fragment),B(i,[Ge(kc,this),"handsontable"])):Ge(uh,this).after(n.fragment)}getContainer(){return Ge(Jn,this).container}getFocusableElements(){const{first:e,prev:n,next:i,last:r,pageSizeSelect:o}=Ge(Jn,this);return[o,e,n,i,r].filter(s=>!s.disabled)}updateWidth(e){return Ge(Jn,this).container.style.width=`${e}px`,this}updateTheme(e){if(Wo(kc,this,e),Ge(tu,this)){const{container:n}=Ge(Jn,this);ae(n,/ht-theme-.*/g),Ge(kc,this)&&B(n,Ge(kc,this))}return this}getHeight(){return Ge(Jn,this).container.offsetHeight}refreshBorderState(){const{container:e}=Ge(Jn,this);return Ge(tu,this)||Ge(SS,this).call(this)?B(e,"ht-pagination--bordered"):ae(e,"ht-pagination--bordered"),this}updateState(e){let{currentPage:n,totalPages:i,firstVisibleRowIndex:r,lastVisibleRowIndex:o,totalRenderedRows:s,pageSizeList:a,pageSize:l,autoPageSize:u}=e;const{first:c,prev:h,next:d,last:f,pageCounterSection:p,pageNavSection:v,pageNavLabel:b,pageSizeSelect:P,pageSizeLabel:_}=Ge(Jn,this),F=Ge(Sr,this).call(this,E_,{start:r+1,end:o+1,total:s}),I=Ge(Sr,this).call(this,T_,{currentPage:n,totalPages:i}),W=Ge(Sr,this).call(this,Pw);p.textContent=F,b.textContent=I,P.textContent="",_.textContent=`${W}:`,le(v,[lr(Ge(Sr,this).call(this,S_))]),le(P,[lr(Ge(Sr,this).call(this,Pw))]),Ge(RS,this).call(this,I),this.refreshBorderState(),a.forEach(Y=>{const J=Y==="auto"?Ge(Sr,this).call(this,R_):Y,U=new Option(J,Y);(u&&Y==="auto"||!u&&Y===l)&&(U.selected=!0),P.add(U)});const k=n===1,$=n===i;if(v.style.display!=="none"){const Y=Ge(uh,this).ownerDocument.activeElement;k?(B(c,"ht-page-navigation-section__button--disabled"),B(h,"ht-page-navigation-section__button--disabled"),c.disabled=!0,h.disabled=!0):(ae(c,"ht-page-navigation-section__button--disabled"),ae(h,"ht-page-navigation-section__button--disabled"),c.disabled=!1,h.disabled=!1),$?(B(d,"ht-page-navigation-section__button--disabled"),B(f,"ht-page-navigation-section__button--disabled"),d.disabled=!0,f.disabled=!0):(ae(d,"ht-page-navigation-section__button--disabled"),ae(f,"ht-page-navigation-section__button--disabled"),d.disabled=!1,f.disabled=!1),[c,h,d,f].includes(Y)&&(h.disabled?d.focus():d.disabled&&h.focus())}return le(c,[lr(Ge(Sr,this).call(this,__)),ef(k)]),le(h,[lr(Ge(Sr,this).call(this,M_)),ef(k)]),le(d,[lr(Ge(Sr,this).call(this,P_)),ef($)]),le(f,[lr(Ge(Sr,this).call(this,I_)),ef($)]),this}setPageSizeSectionVisibility(e){const{pageSizeSection:n,pageSizeSelect:i}=Ge(Jn,this);return n.style.display=e?"":"none",i.disabled=!e,Af(pp,this,ES).call(this),this}setCounterSectionVisibility(e){return Ge(Jn,this).pageCounterSection.style.display=e?"":"none",Af(pp,this,ES).call(this),this}setNavigationSectionVisibility(e){const{pageNavSection:n,first:i,prev:r,next:o,last:s}=Ge(Jn,this);return n.style.display=e?"":"none",i.disabled=!e,r.disabled=!e,o.disabled=!e,s.disabled=!e,Af(pp,this,ES).call(this),this}destroy(){var e;(e=Ge(Jn,this))===null||e===void 0||e.container.remove(),Wo(Jn,this,null)}}function ES(){const{container:t,pageSizeSection:e,pageCounterSection:n,pageNavSection:i}=Ge(Jn,this),r=e.style.display!=="none"||n.style.display!=="none"||i.style.display!=="none";Ge(tu,this)||(r?B(Ge(uh,this).querySelector(".ht-wrapper"),"htPagination"):ae(Ge(uh,this).querySelector(".ht-wrapper"),"htPagination")),t.style.display=r?"":"none"}ct(XF,An);const ACe=["nestedRows","mergeCells","fixedRowsTop","fixedRowsBottom"];function HCe(t){return ACe.some(e=>{const n=!!t[e];return n&&$e(nt`The \`pagination\` plugin cannot be used with the \`${e}\` option.\x20
                        This combination is not supported. The plugin will remain disabled.`),n})}function TS(t,e,n){return(e=NCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NCe(t){var e=DCe(t,"string");return typeof e=="symbol"?e:e+""}function DCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $Ce{constructor(){TS(this,"pageSize",1),TS(this,"totalItems",0),TS(this,"totalPages",0)}calculate(e){let{pageSize:n,totalItems:i}=e;this.pageSize=Math.max(n,1),this.totalItems=i,this.totalPages=Math.max(1,Math.ceil(this.totalItems/this.pageSize))}getTotalPages(){return this.totalPages}getState(e){if(e-=1,e<0||e>=this.getTotalPages())return;const n=e*this.pageSize,i=Math.max(0,Math.min(n+this.pageSize-1,this.totalItems-1));return{startIndex:n,endIndex:i,pageSize:this.pageSize}}}function kCe(t,e,n){return(e=LCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LCe(t){var e=FCe(t,"string");return typeof e=="symbol"?e:e+""}function FCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VCe{constructor(){kCe(this,"pages",[])}calculate(e){let{itemsSizeProvider:n,viewportSizeProvider:i}=e;const r=n(),o=i(),s=[];let a=0,l=0,u=0;for(let c=0;c<r.length;c++){const h=r[c];u>0&&l+h>=o&&(s.push({startIndex:a,endIndex:c-1,pageSize:u}),a=c,l=0,u=0),l+=h,u+=1}s.push({startIndex:a,endIndex:Math.max(0,r.length-1),pageSize:u}),this.pages=s}getTotalPages(){return this.pages.length}getState(e){if(e-=1,!(e<0||e>=this.getTotalPages()))return this.pages[e]}}const D1=new Map([["fixed",$Ce],["auto",VCe]]);function $1(t){if(!D1.has(t))throw new Error(`Unknown pagination strategy type: ${t}`);const e=D1.get(t);return new e}function WCe(t,e){qF(t,e),e.add(t)}function Ha(t,e,n){qF(t,e),e.set(t,n)}function qF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ee(t,e){return t.get(Et(t,e))}function Gn(t,e,n){return t.set(Et(t,e),n),n}function Et(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const wu="pagination",BCe=900,jCe=`plugin:${wu}`,k1=nt`The \`auto\` page size setting requires the \`autoRowSize\`\x20
  plugin to be enabled. Set the \`autoRowSize: true\` in the configuration to ensure correct behavior.`;var Hf=new WeakMap,gi=new WeakMap,ro=new WeakMap,en=new WeakMap,oo=new WeakMap,pv=new WeakMap,rw=new WeakMap,Pt=new WeakSet,_S=new WeakMap;class UCe extends qe{constructor(){super(...arguments),WCe(this,Pt),Ha(this,Hf,null),Ha(this,gi,1),Ha(this,ro,10),Ha(this,en,null),Ha(this,oo,null),Ha(this,pv,!1),Ha(this,rw,!1),Ha(this,_S,()=>{var e;!Ee(pv,this)&&(e=this.hot)!==null&&e!==void 0&&e.view&&Et(Pt,this,vu).call(this)})}static get PLUGIN_KEY(){return wu}static get PLUGIN_PRIORITY(){return BCe}static get DEFAULT_SETTINGS(){return{pageSize:10,pageSizeList:["auto",5,10,20,50,100],initialPage:1,showPageSize:!0,showCounter:!0,showNavigation:!0,uiContainer:null}}isEnabled(){return!!this.hot.getSettings()[wu]}enablePlugin(){var e,n=this;if(HCe(this.hot.getSettings())){this.hot.getSettings()[wu]=!1;return}if(this.enabled)return;const i=this.hot.getSettings()[wu];(i==null?void 0:i.initialPage)!==void 0&&Gn(gi,this,this.getSetting("initialPage")),(i==null?void 0:i.pageSize)!==void 0&&Gn(ro,this,this.getSetting("pageSize")),Gn(Hf,this,this.hot.rowIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding",!1)),Ee(ro,this)==="auto"&&!((e=this.hot.getPlugin("autoRowSize"))!==null&&e!==void 0&&e.enabled)&&$e(k1),Gn(oo,this,$1(Ee(ro,this)==="auto"?"auto":"fixed")),Ee(en,this)||(Gn(en,this,new XF({rootElement:this.hot.rootGridElement,uiContainer:this.getSetting("uiContainer"),isRtl:this.hot.isRtl(),themeName:this.hot.getSettings().themeName,phraseTranslator:function(){return n.hot.getTranslatedPhrase(...arguments)},shouldHaveBorder:()=>Et(Pt,this,zCe).call(this),a11yAnnouncer:r=>Sie(r)})),Et(Pt,this,L1).call(this),Ee(en,this).addLocalHook("firstPageClick",()=>this.firstPage()).addLocalHook("prevPageClick",()=>this.prevPage()).addLocalHook("nextPageClick",()=>this.nextPage()).addLocalHook("lastPageClick",()=>this.lastPage()).addLocalHook("pageSizeChange",r=>this.setPageSize(r))),this.addHook("init",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Et(Pt,n,eye).call(n,...o)},-1),this.addHook("beforeSelectAll",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Et(Pt,n,F1).call(n,...o)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Et(Pt,n,F1).call(n,...o)}),this.addHook("beforeSetRangeEnd",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Et(Pt,n,KCe).call(n,...o)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Et(Pt,n,XCe).call(n,...o)}),this.addHook("beforePaste",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Et(Pt,n,qCe).call(n,...o)}),this.addHook("afterViewRender",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Et(Pt,n,ZCe).call(n,...o)}),this.addHook("afterRender",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Et(Pt,n,JCe).call(n,...o)}),this.addHook("afterScrollVertically",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Et(Pt,n,tye).call(n,...o)}),this.addHook("afterLanguageChange",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Et(Pt,n,nye).call(n,...o)}),this.addHook("beforeHeightChange",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Et(Pt,n,QCe).call(n,...o)}),this.addHook("afterSetTheme",function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return Et(Pt,n,iye).call(n,...o)}),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",Ee(_S,this)),Et(Pt,this,YCe).call(this),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),Et(Pt,this,vu).call(this),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.removeLocalHook("cacheUpdated",Ee(_S,this)).unregisterMap(this.pluginName),Et(Pt,this,GCe).call(this),Ee(en,this).destroy(),Gn(en,this,null),super.disablePlugin()}getPaginationData(){const e=Ee(oo,this).getTotalPages();let n=-1,i=-1;const{pageSize:r,startIndex:o}=Ee(oo,this).getState(Ee(gi,this)),s=this.hot.countRows();let a=0;for(let l=o;a<r&&!(l>=s);l++)this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(l))||(n===-1&&(n=l),i=l,a+=1);return{currentPage:Ee(gi,this),totalPages:e,pageSize:r,pageSizeList:[...this.getSetting("pageSizeList")],autoPageSize:Ee(ro,this)==="auto",numberOfRenderedRows:this.hot.rowIndexMapper.getRenderableIndexesLength(),firstVisibleRowIndex:n,lastVisibleRowIndex:i}}setPage(e){const n=Ee(gi,this);this.hot.runHooks("beforePageChange",n,e)!==!1&&(Gn(gi,this,e),Et(Pt,this,vu).call(this),this.hot.scrollViewportTo({row:0}),this.hot.runHooks("afterPageChange",n,Ee(gi,this)),this.hot.view.adjustElementsSize(),this.hot.render())}resetPage(){this.setPage(this.getSetting("initialPage"))}setPageSize(e){var n;const i=Ee(ro,this);this.hot.runHooks("beforePageSizeChange",i,e)!==!1&&(e==="auto"&&!((n=this.hot.getPlugin("autoRowSize"))!==null&&n!==void 0&&n.enabled)&&$e(k1),Gn(oo,this,$1(e==="auto"?"auto":"fixed")),Gn(ro,this,e),Et(Pt,this,vu).call(this),this.hot.runHooks("afterPageSizeChange",i,Ee(ro,this)),this.hot.view.adjustElementsSize(),this.hot.render())}resetPageSize(){this.setPageSize(this.getSetting("pageSize"))}resetPagination(){this.resetPage(),this.resetPageSize(),Et(Pt,this,L1).call(this)}nextPage(){this.setPage(Ee(gi,this)+1)}prevPage(){this.setPage(Ee(gi,this)-1)}firstPage(){this.setPage(1)}lastPage(){this.setPage(Ee(oo,this).getTotalPages())}hasPreviousPage(){return Ee(gi,this)>1}hasNextPage(){return Ee(gi,this)<Ee(oo,this).getTotalPages()}getCurrentPageData(){const{firstVisibleRowIndex:e,lastVisibleRowIndex:n}=this.getPaginationData();return e===-1||n===-1?[]:this.hot.getData(e,0,n,this.hot.countCols()-1)}showPageSizeSection(){Ee(en,this).setPageSizeSectionVisibility(!0),this.hot.runHooks("afterPageSizeVisibilityChange",!0)}hidePageSizeSection(){Ee(en,this).setPageSizeSectionVisibility(!1),this.hot.runHooks("afterPageSizeVisibilityChange",!1)}showPageCounterSection(){Ee(en,this).setCounterSectionVisibility(!0),this.hot.runHooks("afterPageCounterVisibilityChange",!0)}hidePageCounterSection(){Ee(en,this).setCounterSectionVisibility(!1),this.hot.runHooks("afterPageCounterVisibilityChange",!1)}showPageNavigationSection(){Ee(en,this).setNavigationSectionVisibility(!0),this.hot.runHooks("afterPageNavigationVisibilityChange",!0)}hidePageNavigationSection(){Ee(en,this).setNavigationSectionVisibility(!1),this.hot.runHooks("afterPageNavigationVisibilityChange",!1)}destroy(){var e;Gn(Hf,this,null),Gn(oo,this,null),(e=Ee(en,this))===null||e===void 0||e.destroy(),Gn(en,this,null),super.destroy()}}function L1(){this.getSetting("showPageSize")?this.showPageSizeSection():this.hidePageSizeSection(),this.getSetting("showCounter")?this.showPageCounterSection():this.hidePageCounterSection(),this.getSetting("showNavigation")?this.showPageNavigationSection():this.hidePageNavigationSection()}function vu(){Gn(pv,this,!0),Ee(Hf,this).clear();const t=this.hot.rowIndexMapper.getRenderableIndexes(),e=t.length,{stylesHandler:n}=this.hot;Ee(oo,this).calculate({pageSize:Ee(ro,this),totalItems:e,viewportSizeProvider:()=>{const{view:o}=this.hot;if(o.isVerticallyScrollableByWindow()){const a=getComputedStyle(this.hot.rootDocument.body),l=Number.parseInt(a.marginTop,10)+Number.parseInt(a.marginBottom,10),u=this.hot.hasColHeaders()?o._wt.wtTable.getColumnHeaderHeight():0,c=Ee(en,this).getHeight();return o.getWorkspaceHeight()-c-u-l}const s=o.hasHorizontalScroll()?hn():0;return o.getViewportHeight()-s},itemsSizeProvider:()=>this.hot.rowIndexMapper.getRenderableIndexes().map(s=>{var a;const l=this.hot.toVisualRow(s);return(a=this.hot.getRowHeight(l))!==null&&a!==void 0?a:n.getDefaultRowHeight(l)})});const i=Ee(oo,this).getTotalPages();if(Gn(gi,this,Ue(Ee(gi,this),1,i)),t.length>0){const{startIndex:o,pageSize:s}=Ee(oo,this).getState(Ee(gi,this));t.splice(o,s)}t.length>0?this.hot.batchExecution(()=>{t.forEach(o=>Ee(Hf,this).setValueAtIndex(o,!0))},!0):this.hot.rowIndexMapper.updateCache(!0),Gn(pv,this,!1);const r=this.getPaginationData();Ee(en,this).updateState({...r,totalRenderedRows:e})}function zCe(){if(!this.hot.view)return!0;const{view:t}=this.hot;if(t.isVerticallyScrollableByWindow())return!1;if(t.hasHorizontalScroll()||t.getTableHeight()<t.getWorkspaceHeight())return!0;const{lastVisibleRowIndex:e}=this.getPaginationData();return t.getLastFullyVisibleRow()!==e}function YCe(){this.hot.getFocusScopeManager().registerScope(wu,Ee(en,this).getContainer(),{shortcutsContextName:jCe,runOnlyIf:()=>this.getSetting("showPageSize")||this.getSetting("showNavigation"),onActivate:t=>{const e=Ee(en,this).getFocusableElements();e.length>0&&(t==="tab_from_above"?e.at(0).focus():t==="tab_from_below"&&e.at(-1).focus())}})}function GCe(){this.hot.getFocusScopeManager().unregisterScope(wu)}function F1(t,e){const{firstVisibleRowIndex:n,lastVisibleRowIndex:i}=this.getPaginationData();(Ee(gi,this)>1||t.row>=0)&&(t.row=n),e.row=i}function KCe(t){if(this.hot.selection.isSelectedByColumnHeader()){const{lastVisibleRowIndex:e}=this.getPaginationData();t.row=e}}function XCe(){if(!this.hot.getSettings().navigableHeaders)return;const t=this.hot.getSelectedRangeLast();if(!t.isSingle()){const{highlight:e}=t;e.row=Ue(e.row,t.getTopStartCorner().row,t.getBottomEndCorner().row)}}function qCe(t,e){const{firstVisibleRowIndex:n,lastVisibleRowIndex:i}=this.getPaginationData();if(n===-1||i===-1)return!1;e.forEach(r=>{let{startRow:o}=r;if(t.length===0)return;const s=Math.min(t.length-(i-o+1),t.length);t.splice(0,s)})}function ZCe(){if(Ee(ro,this)!=="auto"||Ee(rw,this)){Gn(rw,this,!1);return}Et(Pt,this,vu).call(this),Gn(rw,this,!0),this.hot.view.adjustElementsSize(),this.hot.render()}function JCe(){const{view:t}=this.hot,e=t.isHorizontallyScrollableByWindow()?t.getTotalTableWidth():t.getWorkspaceWidth();Ee(en,this).updateWidth(e).refreshBorderState()}function QCe(t){return this.getSetting("uiContainer")||!(typeof t=="number"||typeof t=="string"&&/^\d+$/.test(t)||typeof t=="string"&&t.endsWith("px"))?t:`calc(${typeof t=="string"&&t.endsWith("px")?t:`${t}px`} - ${Ee(en,this).getHeight()}px)`}function eye(){Ee(ro,this)!=="auto"&&Et(Pt,this,vu).call(this)}function tye(){Ee(en,this).refreshBorderState()}function nye(){Et(Pt,this,vu).call(this)}function iye(t){Ee(en,this).updateTheme(t)}function MS(t,e,n){return(e=rye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rye(t){var e=oye(t,"string");return typeof e=="symbol"?e:e+""}function oye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sye{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;MS(this,"rootWindow",void 0),MS(this,"prefix",void 0),MS(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const i=typeof e>"u"?n:e,r=this.rootWindow.localStorage.getItem(`${this.prefix}_${i}`);return r===null?void 0:JSON.parse(r)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){O(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function aye(t,e,n){return(e=lye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lye(t){var e=uye(t,"string");return typeof e=="symbol"?e:e+""}function uye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}ie.getSingleton().register("persistentStateSave");ie.getSingleton().register("persistentStateLoad");ie.getSingleton().register("persistentStateReset");const V1="persistentState",cye=0,W1=new WeakSet;class hye extends qe{constructor(){super(...arguments),aye(this,"storage",void 0)}static get PLUGIN_KEY(){return V1}static get PLUGIN_PRIORITY(){return cye}isEnabled(){return!!this.hot.getSettings()[V1]}enablePlugin(){this.enabled||(W1.has(this.hot)||(W1.add(this.hot),l$("The PersistentState plugin is deprecated and will be removed in version 17.0. Please update your settings to ensure compatibility with future versions.")),this.storage||(this.storage=new sye(this.hot.rootContainer.id||this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function dye(t,e){fye(t,e),e.add(t)}function fye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PS(t,e,n){return(e=gye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gye(t){var e=mye(t,"string");return typeof e=="symbol"?e:e+""}function mye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function B1(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const IS="search",pye=190,wye="htSearchResult",vye=function(t,e,n,i,r){t.getCellMeta(e,n).isSearchResult=r},Cye=function(t,e,n){return xt(t)||t===null||!t.toLocaleLowerCase||t.length===0||xt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var xS=new WeakSet;class yye extends qe{constructor(){super(...arguments),dye(this,xS),PS(this,"callback",vye),PS(this,"queryMethod",Cye),PS(this,"searchResultClass",wye)}static get PLUGIN_KEY(){return IS}static get PLUGIN_PRIORITY(){return pye}isEnabled(){return this.hot.getSettings()[IS]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[IS];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return B1(xS,e,j1).call(e,...r)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return B1(xS,e,j1).call(e,...r)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const r=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return he(0,r-1,l=>{he(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,p=(h.search.queryMethod||i)(e,c,h);if(p){const v={row:l,col:u,data:c};s.push(v)}d&&d(a,l,u,c,p)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){me(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function j1(t,e,n,i,r,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function wp(t,e,n){return(e=bye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bye(t){var e=Sye(t,"string");return typeof e=="symbol"?e:e+""}function Sye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZF{constructor(e){wp(this,"viewportWidth",void 0),wp(this,"overwriteColumnWidthFn",void 0),wp(this,"baseWidths",new Map),wp(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class Rye extends ZF{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const i=this.viewportWidth/e,r=[],o=[];let s=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*i),p=this.overwriteColumnWidthFn(f,d);f===p&&f>=Rh?(r.push([d,p]),a+=p):f!==p&&(r.push([d,p]),o.push(d),s-=p)}),s<=Rh){this.stretchedWidths.clear();return}const l=s/a;let u=-1,c=0;r.forEach((h,d)=>{let[f,p]=h,v=p;o.includes(f)||(v=Math.round(p*l)),this.stretchedWidths.set(f,v),u=f,d<r.length-1&&(c+=v)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(u,Math.round(this.viewportWidth-c))}}function U1(t,e,n){Eye(t,e),e.set(t,n)}function Eye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function OS(t,e){return t.get(JF(t,e))}function vp(t,e,n){return t.set(JF(t,e),n),n}function JF(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Cp=new WeakMap,Kd=new WeakMap;class Tye extends ZF{constructor(){super(...arguments),U1(this,Cp,0),U1(this,Kd,-1)}prepare(e){super.prepare(e),vp(Cp,this,0),vp(Kd,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),vp(Kd,this,e),vp(Cp,this,n)}calculate(){if(OS(Kd,this)===-1)return;const e=Array.from(this.baseWidths).reduce((i,r)=>{let[,o]=r;return i+o},0),n=Math.max(this.viewportWidth-e+OS(Cp,this),0);this.stretchedWidths.set(OS(Kd,this),n)}}function _ye(t,e){QF(t,e),e.add(t)}function yp(t,e,n){QF(t,e),e.set(t,n)}function QF(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kt(t,e){return t.get(ch(t,e))}function AS(t,e,n){return t.set(ch(t,e),n),n}function ch(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Mye="stretchColumns";var Ln=new WeakMap,Lc=new WeakMap,HS=new WeakMap,bp=new WeakMap,Xd=new WeakSet;class Pye{constructor(e){_ye(this,Xd),yp(this,Ln,void 0),yp(this,Lc,void 0),yp(this,HS,new Map([["all",new Rye(ch(Xd,this,z1).bind(this))],["last",new Tye(ch(Xd,this,z1).bind(this))]])),yp(this,bp,"none"),AS(Ln,this,e),AS(Lc,this,kt(Ln,this).columnIndexMapper.createAndRegisterIndexMap(Mye,"physicalIndexToValue"))}useStrategy(e){AS(bp,this,kt(HS,this).has(e)?e:"none")}refreshStretching(){if(kt(bp,this)==="none"){kt(Lc,this).clear();return}kt(Ln,this).batchExecution(()=>{kt(Lc,this).clear();const e=kt(HS,this).get(kt(bp,this));let i=kt(Ln,this).view.getViewportWidth();ch(Xd,this,Iye).call(this)&&(i-=hn(kt(Ln,this).rootDocument)),e.prepare({viewportWidth:i});for(let r=0;r<kt(Ln,this).countCols();r++)kt(Ln,this).columnIndexMapper.isHidden(kt(Ln,this).toPhysicalColumn(r))||e.setColumnBaseWidth(r,ch(Xd,this,xye).call(this,r));e.calculate(),e.getWidths().forEach(r=>{let[o,s]=r;kt(Lc,this).setValueAtIndex(kt(Ln,this).toPhysicalColumn(o),s)})},!0)}getStretchedWidth(e){return kt(Lc,this).getValueAtIndex(kt(Ln,this).toPhysicalColumn(e))}}function Iye(){const{view:t,stylesHandler:e}=kt(Ln,this);if(t.isVerticallyScrollableByWindow())return!1;const n=t.getViewportHeight(),i=kt(Ln,this).countRows(),r=e.getDefaultRowHeight(),o=e.isClassicTheme(),s=c=>o&&c===0?1:0;let a=0,l=!1;for(let c=0;c<i;c++){var u;if(!kt(Ln,this).rowIndexMapper.isHidden(kt(Ln,this).toPhysicalRow(c))&&(a+=((u=kt(Ln,this).getRowHeight(c))!==null&&u!==void 0?u:r)+s(c),a>n)){l=!0;break}}return l}function xye(t){var e;return(e=kt(Ln,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:Rh}function z1(t,e){return kt(Ln,this).runHooks("beforeStretchingColumnWidth",t,e)}function Oye(t,e){eV(t,e),e.add(t)}function NS(t,e,n){eV(t,e),e.set(t,n)}function eV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function DS(t,e,n){return t.set(wv(t,e),n),n}function Ds(t,e){return t.get(wv(t,e))}function wv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Aye="stretchColumns",Hye=155;var Jc=new WeakMap,Sp=new WeakMap,qd=new WeakMap,$S=new WeakSet;class Nye extends qe{constructor(){super(...arguments),Oye(this,$S),NS(this,Jc,new Pye(this.hot)),NS(this,Sp,null),NS(this,qd,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(i=>{let{contentRect:r}=i;Ds(Sp,this)!==null&&Ds(Sp,this)!==r.width&&(this.hot.view.adjustElementsSize(),this.hot.refreshDimensions()),DS(Sp,this,r.width)})})}))}static get PLUGIN_KEY(){return Aye}static get PLUGIN_PRIORITY(){return Hye}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(Ds(Jc,this).useStrategy(this.hot.getSettings().stretchH),Ds(qd,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return wv($S,e,$ye).call(e,...i)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return wv($S,e,Dye).call(e,...i)},10),super.enablePlugin())}updatePlugin(){Ds(Jc,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),Ds(qd,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return Ds(Jc,this).getStretchedWidth(e)}destroy(){Ds(qd,this).disconnect(),DS(qd,this,null),DS(Jc,this,null),super.destroy()}}function Dye(t,e,n){if(n===this.pluginName)return;const i=this.getColumnWidth(e);return typeof i=="number"?i:t}function $ye(t){t&&Ds(Jc,this).refreshStretching()}function kye(t,e){Lye(t,e),e.add(t)}function Lye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rp(t,e,n){return(e=Fye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fye(t){var e=Vye(t,"string");return typeof e=="symbol"?e:e+""}function Vye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Wye="touchScroll",Bye=200;var Ep=new WeakSet;class jye extends qe{constructor(){super(...arguments),kye(this,Ep),Rp(this,"scrollbars",[]),Rp(this,"clones",[]),Rp(this,"lockedCollection",!1),Rp(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return Wye}static get PLUGIN_PRIORITY(){return Bye}static get SETTING_KEYS(){return!0}isEnabled(){return UD()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>kS(Ep,this,Uye).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>kS(Ep,this,zye).call(this)),this.addHook("afterMomentumScroll",()=>kS(Ep,this,Yye).call(this))}}function Uye(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),i&&this.scrollbars.push(i),r&&r.clone&&this.scrollbars.push(r),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&this.clones.push(i.clone.wtTable.holder.parentNode),r&&r.clone&&this.clones.push(r.clone.wtTable.holder.parentNode)}function zye(){this.freezeOverlays=!0,O(this.clones,t=>{B(t,"hide-tween")})}function Yye(){this.freezeOverlays=!1,O(this.clones,t=>{ae(t,"hide-tween"),B(t,"show-tween")}),this.hot._registerTimeout(()=>{O(this.clones,t=>{ae(t,"show-tween")})},400),O(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Gye(t,e){Kye(t,e),e.add(t)}function Kye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xye(t,e,n){return(e=qye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qye(t){var e=Zye(t,"string");return typeof e=="symbol"?e:e+""}function Zye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jye(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ow="trimRows",Qye=330;var Y1=new WeakSet;class ebe extends qe{constructor(){super(...arguments),Gye(this,Y1),Xye(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return ow}static get PLUGIN_PRIORITY(){return Qye}isEnabled(){return!!this.hot.getSettings()[ow]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new bg),this.trimmedRowsMap.addLocalHook("init",()=>Jye(Y1,this,tbe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[ow];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),O(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{O(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,r,i,i&&r.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),i=this.isValidConfig(e);let r=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;i&&s&&(O(e,l=>{o[l]=!1}),r=ji(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,r,i&&s)!==!1&&(i&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,r,i&&s,i&&r.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(i=>Number.isInteger(i)&&i>=0&&i<n)}destroy(){super.destroy()}}function tbe(){const t=this.hot.getSettings()[ow];Array.isArray(t)&&this.hot.batchExecution(()=>{O(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function nbe(t,e,n){return(e=ibe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ibe(t){var e=rbe(t,"string");return typeof e=="symbol"?e:e+""}function rbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wr{constructor(e){nbe(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Tp(t,e,n){return(e=obe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function obe(t){var e=sbe(t,"string");return typeof e=="symbol"?e:e+""}function sbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NM extends Wr{constructor(e){let{stateBefore:n,range:i,type:r,alignment:o}=e;super("cell_alignment"),Tp(this,"stateBefore",void 0),Tp(this,"range",void 0),Tp(this,"type",void 0),Tp(this,"alignment",void 0),this.stateBefore=n,this.range=i,this.type=r,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(i,r,o,s)=>{n.done(()=>new NM({stateBefore:i,range:r,type:o,alignment:s}))})}undo(e,n){O(this.range,i=>{i.forAll((r,o)=>{r>=0&&o>=0&&e.setCellMeta(r,o,"className",this.stateBefore[r][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){ka(this.range,this.type,this.alignment,(i,r)=>e.getCellMeta(i,r),(i,r,o,s)=>e.setCellMeta(i,r,o,s)),e.addHookOnce("afterViewRender",n),e.render()}}function G1(t,e,n){return(e=abe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function abe(t){var e=lbe(t,"string");return typeof e=="symbol"?e:e+""}function lbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DM extends Wr{constructor(e){let{columns:n,finalIndex:i}=e;super("col_move"),G1(this,"columns",void 0),G1(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=i}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(i,r)=>{i!==!1&&n.done(()=>new DM({columns:i,finalIndex:r}))})}undo(e,n){const i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),IM(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),i.moveColumn(a,s)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),i.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function K1(t,e,n){return(e=ube(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ube(t){var e=cbe(t,"string");return typeof e=="symbol"?e:e+""}function cbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $M extends Wr{constructor(e){let{currentSortState:n,newSortState:i}=e;super("col_sort"),K1(this,"previousSortState",void 0),K1(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=i}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(i,r,o)=>{o&&n.done(()=>new $M({currentSortState:i,newSortState:r}))})}undo(e,n){const i=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting"),o=r.isEnabled()?r:i;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const i=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting");(r.isEnabled()?r:i).sort(this.nextSortState),n()}}function X1(t,e,n){return(e=hbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hbe(t){var e=dbe(t,"string");return typeof e=="symbol"?e:e+""}function dbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kM extends Wr{constructor(e){let{index:n,amount:i}=e;super("insert_col"),X1(this,"index",void 0),X1(this,"amount",void 0),this.index=n,this.amount=i}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(i,r,o)=>{n.done(()=>new kM({index:i,amount:r}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function q1(t,e,n){return(e=fbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fbe(t){var e=gbe(t,"string");return typeof e=="symbol"?e:e+""}function gbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LM extends Wr{constructor(e){let{index:n,amount:i}=e;super("insert_row"),q1(this,"index",void 0),q1(this,"amount",void 0),this.index=n,this.amount=i}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(i,r,o)=>{n.done(()=>new LM({index:i,amount:r}),o)})}undo(e,n){const i=e.countRows(),r=e.getSettings().minSpareRows;this.index>=i&&this.index-r<i&&(this.index-=r),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function _p(t,e,n){return(e=mbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mbe(t){var e=pbe(t,"string");return typeof e=="symbol"?e:e+""}function pbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FM extends Wr{constructor(e){let{changes:n,selected:i,countCols:r,countRows:o}=e;super("change"),_p(this,"changes",void 0),_p(this,"selected",void 0),_p(this,"countCols",void 0),_p(this,"countRows",void 0),this.changes=n,this.selected=i,this.countCols=r,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(i,r){const o=i&&i.length;if(!o||!i.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=i.reduce((c,h)=>(c.push([...h]),c),[]);l.forEach(c=>{c[1]=e.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new FM({changes:l,selected:u,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,r)})}undo(e,n){const i=Si(this.changes);for(let r=0,o=i.length;r<o;r++)i[r].splice(3,1);e.addHookOnce("afterChange",()=>{const r=e.countRows()-this.countRows;r>0&&e.alter("remove_row",null,r,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1),n()}),e.setDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,n){const i=Si(this.changes);for(let r=0,o=i.length;r<o;r++)i[r].splice(2,1);e.addHookOnce("afterChange",()=>{e.selectCells(this.selected,!1,!1),n()}),e.setDataAtCell(i,null,null,"UndoRedo.redo")}}function Z1(t,e,n){return(e=wbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wbe(t){var e=vbe(t,"string");return typeof e=="symbol"?e:e+""}function vbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VM extends Wr{constructor(e){let{conditionsStack:n,previousConditionsStack:i}=e;super("filter"),Z1(this,"conditionsStack",void 0),Z1(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=i}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(i,r)=>{n.done(()=>new VM({conditionsStack:i,previousConditionsStack:r}))})}undo(e,n){const i=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),i.importConditions(this.previousConditionsStack),i.filter()}redo(e,n){const i=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),i.importConditions(this.conditionsStack),i.filter()}}function Cbe(t,e,n){return(e=ybe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ybe(t){var e=bbe(t,"string");return typeof e=="symbol"?e:e+""}function bbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WM extends Wr{constructor(e){let{data:n,cellRange:i}=e;super("merge_cells"),Cbe(this,"cellRange",void 0),this.cellRange=i,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(i,r)=>{if(r)return;const o=i.getTopStartCorner(),s=i.getBottomEndCorner(),a=e.getData(o.row,o.col,s.row,s.col);n.done(()=>new WM({data:a,cellRange:i}))})}undo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.unmergeRange(this.cellRange,!0);const r=this.cellRange.getTopStartCorner();e.populateFromArray(r.row,r.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.mergeRange(this.cellRange)}}function tV(t,e,n,i,r){const o=["visualRow","visualCol","row","col","prop"],s=o.length,a=[];return he(i,r,l=>{he(e,n,u=>{const c=t.getCellMeta(u,l);if(Object.keys(c).length!==s){const h=Object.fromEntries(Object.entries(c).filter(d=>{let[f]=d;return o.includes(f)===!1}));a.push([c.visualRow,c.visualCol,h])}})}),a}function Os(t,e,n){return(e=Sbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sbe(t){var e=Rbe(t,"string");return typeof e=="symbol"?e:e+""}function Rbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class BM extends Wr{constructor(e){let{index:n,indexes:i,data:r,amount:o,headers:s,columnPositions:a,rowPositions:l,fixedColumnsStart:u,removedCellMetas:c}=e;super("remove_col"),Os(this,"index",void 0),Os(this,"indexes",void 0),Os(this,"data",void 0),Os(this,"amount",void 0),Os(this,"headers",void 0),Os(this,"columnPositions",void 0),Os(this,"rowPositions",void 0),Os(this,"fixedColumnsStart",void 0),Os(this,"removedCellMetas",void 0),this.index=n,this.indexes=i,this.data=r,this.amount=o,this.headers=s,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=u,this.removedCellMetas=c}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(i,r,o,s)=>{const a=()=>{const l=e.getSourceDataArray(),u=(e.countCols()+i)%e.countCols(),c=u+r-1,h=[],d=[],f=[];return he(l.length-1,p=>{const v=[],b=l[p];he(u,c,P=>{v.push(b[e.toPhysicalColumn(P)])}),h.push(v)}),he(r-1,p=>{f.push(e.toPhysicalColumn(u+p))}),Array.isArray(e.getSettings().colHeaders)&&he(r-1,p=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(u+p)]||null)}),new BM({index:u,indexes:f,data:h,amount:r,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:tV(e,0,e.countRows(),u,c)})};n.done(a,s)})}undo(e,n){const i=e.getSettings();i.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),o=(c,h,d)=>d[this.indexes.indexOf(r[h])],s=this.data.length,a=[];for(let c=0;c<s;c++)a.push(tt(this.data[c],o));const l=tt(this.headers,o),u=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),O(e.getSourceDataArray(),(c,h)=>{O(r,(d,f)=>{c[d]=a[h][f],u.push([h,d,c[d]])})}),typeof this.headers<"u"&&O(l,(c,h)=>{e.getSettings().colHeaders[r[h]]=c}),this.removedCellMetas.forEach(c=>{let[h,d,f]=c;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(u,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function Fc(t,e,n){return(e=Ebe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ebe(t){var e=Tbe(t,"string");return typeof e=="symbol"?e:e+""}function Tbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jM extends Wr{constructor(e){let{index:n,data:i,fixedRowsBottom:r,fixedRowsTop:o,rowIndexesSequence:s,removedCellMetas:a}=e;super("remove_row"),Fc(this,"index",void 0),Fc(this,"data",void 0),Fc(this,"fixedRowsBottom",void 0),Fc(this,"fixedRowsTop",void 0),Fc(this,"rowIndexesSequence",void 0),Fc(this,"removedCellMetas",void 0),this.index=n,this.data=i,this.fixedRowsBottom=r,this.fixedRowsTop=o,this.rowIndexesSequence=s,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(i,r,o,s)=>{const a=()=>{const l=e.toPhysicalRow(i),u=l+r-1,c=Si(e.getSourceData(l,0,l+r-1,e.countSourceCols()-1));return new jM({index:l,data:c,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:tV(e,l,u,0,e.countCols()-1)})};n.done(a,s)})}undo(e,n){const i=e.getSettings(),r=[];i.fixedRowsBottom=this.fixedRowsBottom,i.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,s)=>{Object.keys(o).forEach(a=>{const l=parseInt(a,10);r.push([this.index+s,isNaN(l)?a:l,o[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[s,a,l]=o;e.setCellMetaObject(s,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(r,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function J1(t,e,n){return(e=_be(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _be(t){var e=Mbe(t,"string");return typeof e=="symbol"?e:e+""}function Mbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UM extends Wr{constructor(e){let{rows:n,finalIndex:i}=e;super("row_move"),J1(this,"rows",void 0),J1(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=i}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(i,r)=>{i!==!1&&n.done(()=>new UM({rows:i,finalIndex:r}))})}undo(e,n){const i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),IM(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:s,to:a}=o;s<a&&(a-=1),i.moveRow(a,s)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),i.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function Pbe(t,e,n){return(e=Ibe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ibe(t){var e=xbe(t,"string");return typeof e=="symbol"?e:e+""}function xbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zM extends Wr{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),Pbe(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(i,r)=>{r||n.done(()=>new zM({cellRange:i}))})}undo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.mergeRange(this.cellRange,!0)}redo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.unmergeRange(this.cellRange,!0),e.render()}}function Obe(t,e){[NM,DM,$M,kM,LM,FM,VM,WM,BM,jM,UM,zM].forEach(n=>n.startRegisteringEvents(t,e))}function Abe(t,e){Hbe(t,e),e.add(t)}function Hbe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function LS(t,e,n){return(e=Nbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nbe(t){var e=Dbe(t,"string");return typeof e=="symbol"?e:e+""}function Dbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Q1="undoRedo",$be="undoRedo",kbe=1e3;ie.getSingleton().register("beforeUndo");ie.getSingleton().register("afterUndo");ie.getSingleton().register("beforeRedo");ie.getSingleton().register("afterRedo");const eH=new Set;var Mp=new WeakSet;class Lbe extends qe{static get PLUGIN_KEY(){return $be}static get PLUGIN_PRIORITY(){return kbe}static get SETTING_KEYS(){return!0}constructor(e){super(e),Abe(this,Mp),LS(this,"doneActions",[]),LS(this,"undoneActions",[]),LS(this,"ignoreNewActions",!1),Obe(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return FS(Mp,e,Fbe).call(e,...i)}),this.registerShortcuts(),FS(Mp,this,Vbe).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),FS(Mp,this,Wbe).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),r={runOnlyIf:o=>!o.altKey,group:Q1};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Q1)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const r=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",r,n)===!1)return;const s=e(),a=this.undoneActions.slice();this.doneActions.push(s),this.hot.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const i=Si(n);if(this.hot.runHooks("beforeUndo",i)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",i)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const i=Si(n);if(this.hot.runHooks("beforeRedo",i)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",i)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function Fbe(t,e){e==="loadData"&&this.clear()}function Vbe(){const t=e=>{eH.has(e)||($e(nt`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),eH.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function Wbe(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}const Vn="ht-dialog";function Bbe(){function t(){return`
      <div data-ref="contentElement" class="${Vn}__content"></div>
    `}let e=null;const n={};function i(){const o=bh`${t()}`;return Object.assign(n,o.refs),e=o.fragment,o}function r(){if(e===null)throw new Error("Compile the template first.");return[]}return{TEMPLATE_NAME:"base",dialogA11YOptions(){return{role:"dialog"}},compile:i,focusableElements:r}}function jbe(t){let{id:e="",title:n="",description:i="",buttons:r=[]}=t;function o(){return`
      <div tabindex="-1" data-ref="contentElement" class="${Vn}__content-wrapper-inner">
        <div class="${Vn}__content">
          <h2
            id="${e}-dialog-confirm-title"
            class="${Vn}__title">${qs(n)}</h2>
          <p
            id="${e}-dialog-confirm-description"
            class="${Vn}__description">${qs(i)}</p>
        </div>
        ${r.length>0?`
          <div data-ref="buttonsContainer" class="${Vn}__buttons">
            ${r.map(c=>`
              <button class="ht-button ht-button--${c.type}">${qs(c.text)}</button>
            `).join("")}
          </div>
        `:""}
      </div>
    `}let s=null;const a={};function l(){const c=bh`${o()}`;return Object.assign(a,c.refs),s=c.fragment,c}function u(){if(s===null)throw new Error("Compile the template first.");const{contentElement:c,buttonsContainer:h}=a,d=[];return h?d.push(...Array.from(h.children)):d.push(c),d}return{TEMPLATE_NAME:"confirm",dialogA11YOptions(){return{role:"alertdialog",ariaLabelledby:`${e}-dialog-confirm-title`,ariaDescribedby:i?`${e}-dialog-confirm-description`:void 0}},compile:l,focusableElements:u}}const Zd=new Map([["base",Bbe],["confirm",jbe]]);function Ube(t,e){nV(t,e),e.add(t)}function Vc(t,e,n){nV(t,e),e.set(t,n)}function nV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $t(t,e){return t.get(vv(t,e))}function Jr(t,e,n){return t.set(vv(t,e),n),n}function vv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const zbe=`
<div data-ref="dialogElement" class="${Vn}">
  <div data-ref="dialogWrapperElement" class="${Vn}__content-wrapper">
</div>
`;var VS=new WeakMap,Qn=new WeakMap,WS=new WeakMap,uf=new WeakMap,Bo=new WeakMap,Pp=new WeakMap,BS=new WeakSet;class iV{constructor(e){let{rootElement:n,isRtl:i}=e;Ube(this,BS),Vc(this,VS,void 0),Vc(this,Qn,void 0),Vc(this,WS,!1),Vc(this,uf,!1),Vc(this,Bo,Zd.get("base")),Vc(this,Pp,[]),Jr(VS,this,n),Jr(WS,this,i),this.install()}useTemplate(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Zd.has(e)||e==="base"){const r=Array.from(Zd.keys()).filter(o=>o!=="base").join(", ");throw new Error(nt`Invalid template: ${e}.\x20
        Valid templates are: ${r}.`)}Jr(Bo,this,Zd.get(e)(i)),Jr(Pp,this,((n=i.buttons)!==null&&n!==void 0?n:[]).map(r=>r.callback))}useDefaultTemplate(){Jr(Bo,this,Zd.get("base")()),Jr(Pp,this,[])}install(){var e;if((e=$t(Qn,this))!==null&&e!==void 0&&e.dialogElement)return;const n=bh`${zbe}`;Jr(Qn,this,n.refs);const{dialogElement:i}=$t(Qn,this);le(i,[c9(),["dir",$t(WS,this)?"rtl":"ltr"]]),i.addEventListener("transitionstart",()=>vv(BS,this,Gbe).call(this)),i.addEventListener("transitionend",()=>vv(BS,this,Ybe).call(this)),$t(VS,this).after(n.fragment)}getContainer(){return $t(Qn,this).dialogElement}getFocusableElements(){return $t(Bo,this).focusableElements()}updateDialog(e){let{isVisible:n,content:i,customClassName:r,background:o,contentBackground:s,animation:a,a11y:l}=e;const u=$t(Bo,this).compile(),{dialogElement:c,dialogWrapperElement:h}=$t(Qn,this);h.innerHTML="",h.appendChild(u.fragment),Object.assign($t(Qn,this),u.refs);const{contentElement:d,buttonsContainer:f}=$t(Qn,this);$t(Bo,this).TEMPLATE_NAME!=="base"&&Object.assign(l,$t(Bo,this).dialogA11YOptions());const p=r?` ${r}`:"",v=o?` ${Vn}--background-${o}`:"",b=a?` ${Vn}--animation`:"",P=n?` ${Vn}--show`:"";c.className=[Vn,`${Vn}--${$t(Bo,this).TEMPLATE_NAME}`,"handsontable",p,v,b,P].join(" "),le(c,[$t(Bo,this).TEMPLATE_NAME==="base"?po(-1):void 0]),le(c,[l.role==="alertdialog"?X6():K6()]),l.ariaLabel&&!l.ariaLabelledby?le(c,[l.ariaLabel?lr(l.ariaLabel):void 0]):Zs(c,"aria-label"),l.ariaLabelledby?le(c,[Q6(l.ariaLabelledby)]):Zs(c,"aria-labelledby"),l.ariaDescribedby?le(c,[e9(l.ariaDescribedby)]):Zs(c,"aria-describedby");const _=s?` ${Vn}__content--background`:"";return B(d,`${Vn}__content${_}`),$t(Bo,this).TEMPLATE_NAME==="base"?(d.innerHTML="",typeof i=="string"?Yu(d,i):(i instanceof HTMLElement||i instanceof DocumentFragment)&&d.appendChild(i)):f&&Array.from(f.children).forEach((F,I)=>{const W=$t(Pp,this)[I];W&&F.addEventListener("click",W)}),this}showDialog(e){const{dialogElement:n}=$t(Qn,this);return n.style.display="block",e&&n.offsetHeight,B(n,`${Vn}--show`),Jr(uf,this,!1),this}hideDialog(e){const{dialogElement:n}=$t(Qn,this);return ae(n,`${Vn}--show`),(e&&!$t(uf,this)||!e)&&(n.style.display="none"),Jr(uf,this,!1),this}focusDialog(){$t(Qn,this).dialogElement.focus()}updateWidth(e){return $t(Qn,this).dialogElement.style.width=`${e}px`,this}updateHeight(e){return $t(Qn,this).dialogElement.style.height=`calc(100% - ${e}px)`,this}destroyDialog(){var e;(e=$t(Qn,this))===null||e===void 0||e.dialogElement.remove(),Jr(Qn,this,null)}}function Ybe(){const{dialogElement:t}=$t(Qn,this);Ce(t,`${Vn}--show`)||(t.style.display="none")}function Gbe(){Jr(uf,this,!0)}ct(iV,An);function Kbe(t,e){rV(t,e),e.add(t)}function jS(t,e,n){rV(t,e),e.set(t,n)}function rV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Na(t,e,n){return t.set(au(t,e),n),n}function Fn(t,e){return t.get(au(t,e))}function au(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Za="dialog",Xbe=360,SE=Za,Cv=`plugin:${Za}`;var Kn=new WeakMap,Qc=new WeakMap,Wc=new WeakMap,Bc=new WeakSet;class yv extends qe{constructor(){super(...arguments),Kbe(this,Bc),jS(this,Kn,null),jS(this,Qc,!1),jS(this,Wc,null)}static get PLUGIN_KEY(){return Za}static get PLUGIN_PRIORITY(){return Xbe}static get DEFAULT_SETTINGS(){return{template:null,content:"",customClassName:"",background:"solid",contentBackground:!1,animation:!0,closable:!1,a11y:{role:"dialog",ariaLabel:"Dialog",ariaLabelledby:"",ariaDescribedby:""}}}static get SETTINGS_VALIDATORS(){return{template:e=>me(e)&&typeof["alert","confirm"].includes(e.type)&&typeof e.title=="string"&&(typeof(e==null?void 0:e.description)>"u"||typeof(e==null?void 0:e.description)=="string")&&(typeof(e==null?void 0:e.buttons)>"u"||Array.isArray(e==null?void 0:e.buttons)&&e.buttons.every(n=>typeof n=="object"&&typeof n.text=="string"&&["primary","secondary"].includes(n.type)&&(typeof n.callback>"u"||typeof n.callback=="function"))),content:e=>typeof e=="string"||typeof HTMLElement<"u"&&e instanceof HTMLElement||typeof DocumentFragment<"u"&&e instanceof DocumentFragment,customClassName:e=>typeof e=="string",background:e=>["solid","semi-transparent"].includes(e),contentBackground:e=>typeof e=="boolean",animation:e=>typeof e=="boolean",closable:e=>typeof e=="boolean",a11y:e=>me(e)&&(typeof(e==null?void 0:e.role)>"u"||["dialog","alertdialog"].includes(e==null?void 0:e.role))&&(typeof(e==null?void 0:e.ariaLabel)>"u"||typeof(e==null?void 0:e.ariaLabel)=="string")&&(typeof(e==null?void 0:e.ariaLabelledby)>"u"||typeof(e==null?void 0:e.ariaLabelledby)=="string")&&(typeof(e==null?void 0:e.ariaDescribedby)>"u"||typeof(e==null?void 0:e.ariaDescribedby)=="string")}}isEnabled(){return!!this.hot.getSettings()[Za]}enablePlugin(){this.enabled||(Fn(Kn,this)||Na(Kn,this,new iV({rootElement:this.hot.rootGridElement,isRtl:this.hot.isRtl()})),au(Bc,this,qbe).call(this),au(Bc,this,Jbe).call(this),this.addHook("afterViewRender",()=>au(Bc,this,eSe).call(this)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hide(),au(Bc,this,Zbe).call(this),au(Bc,this,Qbe).call(this),super.disablePlugin()}isVisible(){return Fn(Qc,this)}show(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.enabled){if(this.isVisible()){this.update(e);return}this.hot.runHooks("beforeDialogShow"),this.update(e),Fn(Kn,this).showDialog(this.getSetting("animation")),Na(Qc,this,!0),this.hot.getFocusScopeManager().activateScope(Za),Na(Wc,this,this.hot.selection.exportSelection()),this.hot.deselectCell(),this.hot.runHooks("afterDialogShow")}}hide(){var e;this.isVisible()&&(this.hot.runHooks("beforeDialogHide"),Fn(Kn,this).hideDialog(this.getSetting("animation")),Na(Qc,this,!1),this.hot.getFocusScopeManager().deactivateScope(Za),((e=Fn(Wc,this))===null||e===void 0?void 0:e.ranges.length)>0?(this.hot.selection.importSelection(Fn(Wc,this)),this.hot.view.render(),Na(Wc,this,null)):this.hot.selectCell(0,0),this.hot.runHooks("afterDialogHide"))}update(e){if(!this.enabled)return;this.updatePluginSettings(e);const n=this.getSetting("template");if(n!==yv.DEFAULT_SETTINGS.template&&this.getSetting("content")!==yv.DEFAULT_SETTINGS.content)throw new Error("The `template` option cannot be used together with the `content` option.");n?Fn(Kn,this).useTemplate(n.type,{id:this.hot.guid,...n}):Fn(Kn,this).useDefaultTemplate(),Fn(Kn,this).updateDialog({isVisible:this.isVisible(),content:this.getSetting("content"),customClassName:this.getSetting("customClassName"),background:this.getSetting("background"),contentBackground:this.getSetting("contentBackground"),animation:this.getSetting("animation"),a11y:this.getSetting("a11y")})}showAlert(e,n){const{title:i="Alert",description:r}=me(e)?e:{title:e};this.show({template:{type:"confirm",title:i,description:r,buttons:[{text:this.hot.getTranslatedPhrase(Tw),type:"primary",callback:function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n==null?void 0:n(...s)}}]},contentBackground:!1,background:"solid",animation:!0,closable:!1})}showConfirm(e,n,i){const{title:r="Confirm",description:o}=me(e)?e:{title:e};this.show({template:{type:"confirm",title:r,description:o,buttons:[{text:this.hot.getTranslatedPhrase(iT),type:"secondary",callback:function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return i==null?void 0:i(...a)}},{text:this.hot.getTranslatedPhrase(Tw),type:"primary",callback:function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return n==null?void 0:n(...a)}}]},contentBackground:!0,background:"semi-transparent",animation:!0,closable:!1})}focus(){Fn(Kn,this).focusDialog()}destroy(){var e;(e=Fn(Kn,this))===null||e===void 0||e.destroyDialog(),Na(Kn,this,null),Na(Qc,this,!1),Na(Wc,this,null),super.destroy()}}function qbe(){var t;const e=this.hot.getShortcutManager(),n=(t=e.getContext(Cv))!==null&&t!==void 0?t:e.addContext(Cv);n.addShortcut({keys:[["Escape"]],callback:()=>{this.hide()},runOnlyIf:()=>Fn(Qc,this)&&this.getSetting("closable"),group:SE}),n.addShortcut({keys:[["Shift","Tab"],["Tab"]],preventDefault:!1,callback:i=>{this.hot._registerTimeout(()=>{i.shiftKey?this.hot.runHooks("dialogFocusPreviousElement"):this.hot.runHooks("dialogFocusNextElement")})},group:SE})}function Zbe(){this.hot.getShortcutManager().getContext(Cv).removeShortcutsByGroup(SE)}function Jbe(){this.hot.getFocusScopeManager().registerScope(Za,Fn(Kn,this).getContainer(),{shortcutsContextName:Cv,type:"modal",runOnlyIf:()=>this.isVisible(),onActivate:t=>{const e=this.hot.isListening(),n=Fn(Kn,this).getFocusableElements();n.length>0?t==="tab_from_above"?n.at(0).focus():t==="tab_from_below"&&n.at(-1).focus():t!=="tab_from_above"&&t!=="tab_from_below"&&e&&!Fn(Kn,this).getContainer().contains(this.hot.rootDocument.activeElement)&&Fn(Kn,this).getContainer().focus(),e&&this.hot.runHooks("afterDialogFocus",t==="unknown"?"show":t)}})}function Qbe(){this.hot.getFocusScopeManager().unregisterScope(Za)}function eSe(){const{view:t,rootWrapperElement:e,rootWindow:n}=this.hot,i=t.isHorizontallyScrollableByWindow()?t.getTotalTableWidth():t.getWorkspaceWidth();Fn(Kn,this).updateWidth(i);const r=e.querySelector(".hot-display-license-info");if(r){const o=r.offsetHeight,s=Number.parseFloat(n.getComputedStyle(r).marginTop);Fn(Kn,this).updateHeight(o+s)}}function tSe(t){let{id:e,icon:n,title:i,description:r}=t;return`
    <div class="${lu}__content">
      <i class="${lu}__icon">${n}</i>
      <div class="${lu}__text">
        <h2 id="${e}-${Cu}-title" class="${lu}__title">${i}</h2>
        ${r?`<p id="${e}-${Cu}-description" class="${lu}__description">${r}</p>`:""}
      </div>
    </div>
  `}function nSe(t,e){oV(t,e),e.add(t)}function iSe(t,e,n){oV(t,e),e.set(t,n)}function oV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tH(t,e,n){return t.set(YM(t,e),n),n}function Qi(t,e){return t.get(YM(t,e))}function YM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Cu="loading",rSe=350,lu=`ht-${Cu}`;var ei=new WeakMap,nH=new WeakSet;class oSe extends qe{constructor(){super(...arguments),nSe(this,nH),iSe(this,ei,null)}static get PLUGIN_KEY(){return Cu}static get PLUGIN_PRIORITY(){return rSe}static get DEFAULT_SETTINGS(){return{icon:`<svg class="${lu}__icon-svg" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path stroke="currentColor" stroke-width="2" d="M15 8a7 7 0 1 1-3.5-6.062"></path></svg>`,title:void 0,description:""}}static get SETTINGS_VALIDATORS(){return{icon:e=>typeof e=="string",title:e=>typeof e=="string",description:e=>typeof e=="string"}}isEnabled(){return!!this.hot.getSettings()[Cu]}enablePlugin(){if(!this.enabled){if(Qi(ei,this)===null){var e;tH(ei,this,this.hot.getPlugin("dialog")),(e=Qi(ei,this))!==null&&e!==void 0&&e.isEnabled()||(this.hot.getSettings().dialog=!0),this.hot.addHook("afterDialogFocus",()=>YM(nH,this,sSe).call(this))}super.enablePlugin()}}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hide(),super.disablePlugin()}isVisible(){var e,n;return(e=(n=Qi(ei,this))===null||n===void 0?void 0:n.isVisible())!==null&&e!==void 0?e:!1}show(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.isEnabled()||!Qi(ei,this)||!((e=Qi(ei,this))!==null&&e!==void 0&&e.isEnabled()))return;if(this.isVisible()){this.update(n);return}this.hot.runHooks("beforeLoadingShow")!==!1&&(this.update(n),Qi(ei,this).show(),this.hot.runHooks("afterLoadingShow"))}hide(){var e;!Qi(ei,this)||!((e=Qi(ei,this))!==null&&e!==void 0&&e.isEnabled())||!this.isVisible()||this.hot.runHooks("beforeLoadingHide")===!1||(Qi(ei,this).hide(),this.hot.runHooks("afterLoadingHide"))}update(e){var n,i;if(!this.isEnabled()||!Qi(ei,this)||!((n=Qi(ei,this))!==null&&n!==void 0&&n.isEnabled()))return;this.updatePluginSettings(e);const r=this.hot.guid,o=this.getSetting("icon"),s=(i=this.getSetting("title"))!==null&&i!==void 0?i:this.hot.getTranslatedPhrase(H_),a=this.getSetting("description"),l=tSe({id:r,icon:o,title:s,description:a});Qi(ei,this).update({content:l,customClassName:lu,background:this.hot.countSourceRows()===0?"solid":"semi-transparent",a11y:{role:"alertdialog",ariaLabelledby:`${r}-${Cu}-title`,ariaDescribedby:a?`${r}-${Cu}-description`:void 0}})}destroy(){tH(ei,this,null),super.destroy()}}function sSe(){Qi(ei,this).focus()}function Ip(t,e,n){aSe(t,e),e.set(t,n)}function aSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dt(t,e){return t.get(sV(t,e))}function As(t,e,n){return t.set(sV(t,e),n),n}function sV(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const vi="ht-empty-data-state",lSe=150,uSe=`<div data-ref="emptyDataStateElement" class="${vi} handsontable">
  <div class="${vi}__content-wrapper">
    <div data-ref="emptyDataStateInner" class="${vi}__content-wrapper-inner"></div>
  </div>
</div>`,cSe=t=>{let{title:e,description:n,buttons:i}=t;return`
  <div class="${vi}__content">
    ${e?`<h2 class="${vi}__title">${qs(e)}</h2>`:""}
    ${n?`<p class="${vi}__description">${qs(n)}</p>`:""}
  </div>
  <div
    data-ref="emptyDataStateButtons"
    class="${vi}__buttons${(i==null?void 0:i.length)>0?` ${vi}__buttons--has-buttons`:""}"
  >${(i==null?void 0:i.length)>0?i.map(r=>`<button class="ht-button ht-button--${r.type}">${qs(r.text)}</button>`).join(""):""}</div>`};var US=new WeakMap,zS=new WeakMap,$n=new WeakMap,qi=new WeakMap;class hSe{constructor(e){let{rootElement:n,rootDocument:i}=e;Ip(this,US,void 0),Ip(this,zS,void 0),Ip(this,$n,void 0),Ip(this,qi,void 0),As(US,this,n),As(zS,this,i),this.install()}install(){var e;if((e=Dt($n,this))!==null&&e!==void 0&&e.emptyDataStateElement)return;const n=bh`${uSe}`;As($n,this,n.refs);const{emptyDataStateInner:i,emptyDataStateElement:r}=Dt($n,this);le(i,[po(-1)]),le(r,[po(-1)]),Dt(US,this).after(n.fragment)}getElement(){var e;return(e=Dt($n,this))===null||e===void 0?void 0:e.emptyDataStateElement}getFocusableElements(){const{emptyDataStateButtons:e,emptyDataStateInner:n}=Dt($n,this),i=Array.from(e==null?void 0:e.children);return i.length===0?[n]:i}show(){var e;(e=Dt($n,this))!==null&&e!==void 0&&e.emptyDataStateElement&&(Dt($n,this).emptyDataStateElement.style.display="block")}hide(){var e,n;(e=Dt($n,this))!==null&&e!==void 0&&e.emptyDataStateElement&&((n=Dt(qi,this))===null||n===void 0||n.remove(),As(qi,this,null),Dt($n,this).emptyDataStateElement.style.display="none")}updateContent(e){var n;const{emptyDataStateInner:i}=Dt($n,this);let r="";typeof e=="string"?r={title:e}:r={title:e==null?void 0:e.title,description:e==null?void 0:e.description,buttons:e==null?void 0:e.buttons};const o=bh`${cSe(r)}`;As($n,this,{...Dt($n,this),...o.refs}),i.innerHTML="",i.appendChild(o.fragment),((n=r.buttons)===null||n===void 0?void 0:n.length)>0&&Array.from(Dt($n,this).emptyDataStateButtons.children).forEach((s,a)=>{s.addEventListener("click",r.buttons[a].callback)})}updateClassNames(e){const{emptyDataStateElement:n}=Dt($n,this);e.countRenderableColumns()>0&&e.getColumnHeadersCount()>0?B(n,`${vi}--disable-top-border`):ae(n,`${vi}--disable-top-border`),e.countRenderableRows()>0&&e.getRowHeadersCount()>0?B(n,`${vi}--disable-inline-border`):ae(n,`${vi}--disable-inline-border`),e.hasHorizontalScroll()&&!e.isHorizontallyScrollableByWindow()?B(n,`${vi}--disable-bottom-border`):ae(n,`${vi}--disable-bottom-border`)}updateSize(e){const{emptyDataStateElement:n}=Dt($n,this),i=e.hasHorizontalScroll()?hn(e.hot.rootDocument):0,r=e.countRenderableRows(),o=e.countRenderableColumns(),s=e.getColumnHeadersCount();if(n.style.top=o>0?`${e.getColumnHeaderHeight()}px`:"0px",n.style.insetInlineStart=r>0?`${e.getRowHeaderWidth()}px`:"0px",r===0)Dt(qi,this)||(As(qi,this,Dt(zS,this).createElement("div")),Dt(qi,this).classList.add(`${vi}-placeholder`),e._wt.wtTable.holder.appendChild(Dt(qi,this))),Dt(qi,this).style.width="100%",Dt(qi,this).style.height=`${lSe}px`;else{var a;(a=Dt(qi,this))===null||a===void 0||a.remove(),As(qi,this,null)}let l=e.getWorkspaceWidth(),u=e.getTableHeight();e.isHorizontallyScrollableByWindow()?o>0?l=e.getTotalTableWidth():r>0&&(l=e.getViewportWidth()):r>0?l=e.getViewportWidth():e.getTableWidth()-e.getRowHeaderWidth()<e.getViewportWidth()&&o>0&&(l=e.getTableWidth()),e.isVerticallyScrollableByWindow()||e.hasVerticalScroll()?o>0?u=e.hot.getTableHeight()-e.getColumnHeaderHeight():u=e.hot.getTableHeight():s>0&&o>0?u=e.getViewportHeight()-i:s>0&&o===0&&(u=e.getWorkspaceHeight()-i),n.style.width=`${l}px`,n.style.height=`${u}px`}destroy(){var e,n;(e=Dt($n,this))===null||e===void 0||(e=e.emptyDataStateElement)===null||e===void 0||e.remove(),(n=Dt(qi,this))===null||n===void 0||n.remove(),As(qi,this,null),As($n,this,null)}}function dSe(t,e){aV(t,e),e.add(t)}function Jd(t,e,n){aV(t,e),e.set(t,n)}function aV(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vi(t,e,n){return t.set(un(t,e),n),n}function Gt(t,e){return t.get(un(t,e))}function un(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const $u="emptyDataState",fSe=370,RE=Object.freeze({UNKNOWN:"unknown",FILTERS:"filters"}),gSe=`plugin:${$u}`;var Ru=new WeakMap,In=new WeakMap,Oh=new WeakMap,bv=new WeakMap,yh=new WeakMap,vn=new WeakSet;class mSe extends qe{constructor(){super(...arguments),dSe(this,vn),Jd(this,Ru,!1),Jd(this,In,null),Jd(this,Oh,null),Jd(this,bv,!1),Jd(this,yh,null)}static get PLUGIN_KEY(){return $u}static get PLUGIN_PRIORITY(){return fSe}static get DEFAULT_SETTINGS(){return{message:void 0}}static get SETTINGS_VALIDATORS(){return{message:e=>typeof e=="string"||typeof e=="function"||me(e)&&(typeof(e==null?void 0:e.title)>"u"||typeof(e==null?void 0:e.title)=="string")&&(typeof(e==null?void 0:e.description)>"u"||typeof(e==null?void 0:e.description)=="string")&&(typeof(e==null?void 0:e.buttons)>"u"||Array.isArray(e==null?void 0:e.buttons)&&(e==null?void 0:e.buttons.every(n=>typeof n=="object"&&typeof n.text=="string"&&typeof n.type=="string"&&["primary","secondary"].includes(n.type)&&typeof n.callback=="function")))||e===void 0}}isEnabled(){return!!this.hot.getSettings()[$u]}enablePlugin(){this.enabled||(Gt(In,this)||(Vi(In,this,new hSe({rootElement:this.hot.rootGridElement,rootDocument:this.hot.rootDocument})),un(vn,this,CSe).call(this),un(vn,this,pSe).call(this),un(vn,this,wSe).call(this)),this.addHook("afterInit",()=>un(vn,this,ESe).call(this)),this.addHook("afterRender",()=>un(vn,this,TSe).call(this)),this.addHook("afterRowSequenceCacheUpdate",()=>un(vn,this,EE).call(this)),this.addHook("afterColumnSequenceCacheUpdate",()=>un(vn,this,EE).call(this)),this.addHook("beforeFilter",e=>un(vn,this,_Se).call(this,e)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),un(vn,this,GM).call(this),this.isVisible()&&Gt(In,this).show(),super.updatePlugin()}disablePlugin(){un(vn,this,ySe).call(this),un(vn,this,vSe).call(this),Gt(In,this).destroy(),Vi(In,this,null),super.disablePlugin()}isVisible(){return Gt(Ru,this)}destroy(){var e;Vi(Ru,this,!1),(e=Gt(In,this))===null||e===void 0||e.destroy(),Vi(In,this,null),Vi(Oh,this,null),Vi(bv,this,!1),Vi(yh,this,null),super.destroy()}}function pSe(){this.eventManager.addEventListener(Gt(In,this).getElement(),"wheel",t=>un(vn,this,RSe).call(this,t))}function wSe(){Vi(Oh,this,new MutationObserver(()=>{if(!this.hot)return;const t=Gt(In,this).getElement();this.hot.rootGridElement.nextElementSibling!==t&&this.hot.rootGridElement.after(t)})),Gt(Oh,this).observe(this.hot.rootWrapperElement,{childList:!0})}function vSe(){Gt(Oh,this).disconnect(),Vi(Oh,this,null)}function CSe(){this.hot.getFocusScopeManager().registerScope($u,Gt(In,this).getElement(),{shortcutsContextName:gSe,runOnlyIf:()=>this.isVisible(),onActivate:t=>{var e;const n=(e=Gt(In,this))===null||e===void 0?void 0:e.getFocusableElements();n.length>0&&(t==="tab_from_above"?n.at(0).focus():t==="tab_from_below"&&n.at(-1).focus())}})}function ySe(){this.hot.getFocusScopeManager().unregisterScope($u)}function iH(t){var e,n,i;let r;return typeof this.getSetting("message")=="function"?r=this.getSetting("message")(t):r=this.getSetting("message"),typeof r=="string"&&(r={title:r}),!((e=r)!==null&&e!==void 0&&e.title)&&!((n=r)!==null&&n!==void 0&&n.description)&&!((i=r)!==null&&i!==void 0&&i.buttons)&&(r={},t===RE.FILTERS?(r.title=this.hot.getTranslatedPhrase($_),r.description=this.hot.getTranslatedPhrase(k_),r.buttons=[{text:this.hot.getTranslatedPhrase(L_),type:"secondary",callback:()=>{const o=this.hot.getPlugin("filters");o&&(o.clearConditions(),o.filter())}}]):(r.title=this.hot.getTranslatedPhrase(N_),r.description=this.hot.getTranslatedPhrase(D_))),r}function EE(){this.hot.view&&(this.hot.view.countRenderableColumns()===0||this.hot.view.countRenderableRows()===0?un(vn,this,bSe).call(this):un(vn,this,SSe).call(this))}function bSe(){Gt(Ru,this)||(this.hot.runHooks("beforeEmptyDataStateShow"),un(vn,this,GM).call(this),Gt(In,this).show(),Vi(Ru,this,!0),Vi(yh,this,this.hot.selection.exportSelection()),this.hot.getFocusScopeManager().activateScope($u),this.hot.runHooks("afterEmptyDataStateShow"))}function GM(){Gt(bv,this)?Gt(In,this).updateContent(un(vn,this,iH).call(this,RE.FILTERS)):Gt(In,this).updateContent(un(vn,this,iH).call(this,RE.UNKNOWN))}function SSe(){var t;Gt(Ru,this)&&(this.hot.runHooks("beforeEmptyDataStateHide"),Gt(In,this).hide(),Vi(Ru,this,!1),this.hot.getFocusScopeManager().deactivateScope($u),((t=Gt(yh,this))===null||t===void 0?void 0:t.ranges.length)>0?(this.hot.selection.importSelection(Gt(yh,this)),this.hot.view.render(),Vi(yh,this,null)):this.hot.selectCell(0,0),this.hot.runHooks("afterEmptyDataStateHide"))}function RSe(t){const e=Number.isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;e!==0&&this.hot.view.hasHorizontalScroll()&&!this.hot.view.isHorizontallyScrollableByWindow()&&(this.hot.view.setTableScrollPosition({left:this.hot.view.getTableScrollPosition().left+e}),t.preventDefault())}function ESe(){un(vn,this,EE).call(this),this.hot.render()}function TSe(){var t;(t=Gt(In,this))!==null&&t!==void 0&&t.getElement()&&this.isVisible()&&(Gt(In,this).updateSize(this.hot.view),Gt(In,this).updateClassNames(this.hot.view))}function _Se(t){Vi(bv,this,(t==null?void 0:t.length)>0),this.isVisible()&&un(vn,this,GM).call(this)}function MSe(){Ye(vf),Ye(gae),Ye(Cf),Ye(Gae),Ye(tle),Ye(wL),Ye(Zle),Ye(kue),Ye(fC),Ye(zce),Ye(whe),Ye(_he),Ye(pC),Ye(lde),Ye(nge),Ye(Dge),Ye(lme),Ye(yme),Ye(Ame),Ye(jme),Ye(Qme),Ye(wpe),Ye(_pe),Ye(Cwe),Ye(Zwe),Ye(nve),Ye(Pve),Ye(gCe),Ye(UCe),Ye(hye),Ye(yye),Ye(Nye),Ye(jye),Ye(ebe),Ye(Lbe),Ye(yv),Ye(oSe),Ye(mSe)}function PSe(){Dre(),rse(),fse(),kse(),MSe()}PSe();const ISe=`
  .dark .handsontable,
  [data-theme="dark"] .handsontable,
  :root.dark .handsontable {
    --ht-background: #1f2937;
    --ht-cell-background: #1f2937;
    --ht-border-color: #374151;
    --ht-header-background: #111827;
    --ht-header-text: #f9fafb;
    --ht-cell-text: #f3f4f6;
    --ht-active-background: #374151;
    --ht-selection-background: rgba(59, 130, 246, 0.3);
  }

  .dark .handsontable,
  [data-theme="dark"] .handsontable,
  :root.dark .handsontable,
  .dark .handsontable td,
  .dark .handsontable th,
  [data-theme="dark"] .handsontable td,
  [data-theme="dark"] .handsontable th {
    background-color: #1f2937 !important;
    color: #f3f4f6 !important;
    border-color: #374151 !important;
  }

  .dark .handsontable thead th,
  .dark .handsontable .ht__highlight,
  [data-theme="dark"] .handsontable thead th,
  [data-theme="dark"] .handsontable .ht__highlight {
    background-color: #111827 !important;
    color: #f9fafb !important;
  }

  .dark .handsontable .htCore td.current,
  .dark .handsontable .htCore td.area,
  [data-theme="dark"] .handsontable .htCore td.current,
  [data-theme="dark"] .handsontable .htCore td.area {
    background-color: #374151 !important;
  }

  .dark .handsontable .htDimmed,
  [data-theme="dark"] .handsontable .htDimmed {
    color: #9ca3af !important;
  }

  .dark .htDropdownMenu,
  .dark .htFiltersConditionsMenu,
  .dark .htContextMenu,
  [data-theme="dark"] .htDropdownMenu,
  [data-theme="dark"] .htFiltersConditionsMenu,
  [data-theme="dark"] .htContextMenu {
    background-color: #1f2937 !important;
    border-color: #374151 !important;
  }

  .dark .htDropdownMenu td,
  .dark .htFiltersConditionsMenu td,
  .dark .htContextMenu td,
  [data-theme="dark"] .htDropdownMenu td,
  [data-theme="dark"] .htFiltersConditionsMenu td,
  [data-theme="dark"] .htContextMenu td {
    color: #f3f4f6 !important;
  }

  .dark .htDropdownMenu td:hover,
  .dark .htContextMenu td:hover,
  [data-theme="dark"] .htDropdownMenu td:hover,
  [data-theme="dark"] .htContextMenu td:hover {
    background-color: #374151 !important;
  }

  .dark .handsontable input,
  .dark .handsontable select,
  .dark .handsontable textarea,
  [data-theme="dark"] .handsontable input,
  [data-theme="dark"] .handsontable select,
  [data-theme="dark"] .handsontable textarea {
    background-color: #374151 !important;
    color: #f3f4f6 !important;
    border-color: #4b5563 !important;
  }

  .dark .handsontable .ht_clone_left th,
  .dark .handsontable .ht_clone_top_left_corner th,
  [data-theme="dark"] .handsontable .ht_clone_left th,
  [data-theme="dark"] .handsontable .ht_clone_top_left_corner th {
    background-color: #111827 !important;
    color: #9ca3af !important;
  }

  .dark .handsontableInput,
  .dark .handsontableInputHolder,
  [data-theme="dark"] .handsontableInput,
  [data-theme="dark"] .handsontableInputHolder {
    background-color: #374151 !important;
    color: #f3f4f6 !important;
  }

  .dark .htAutocomplete,
  [data-theme="dark"] .htAutocomplete {
    background-color: #1f2937 !important;
  }
`;function KM(){return document.documentElement.classList.contains("dark")||document.documentElement.getAttribute("data-theme")==="dark"||window.matchMedia("(prefers-color-scheme: dark)").matches}function xSe(t,e,n,i,r,o,s){e.innerHTML="",e.style.padding="4px",e.style.cursor="pointer";const a=KM();if(o){const l=document.createElement("div");l.style.display="flex",l.style.alignItems="center",l.style.gap="8px";const u=document.createElement("img");u.src=o,u.style.width="40px",u.style.height="40px",u.style.objectFit="cover",u.style.borderRadius="4px",u.style.border=a?"1px solid #4b5563":"1px solid #e5e7eb",u.onerror=()=>{u.style.display="none"};const c=document.createElement("span");c.textContent=o.length>30?o.substring(0,30)+"...":o,c.style.fontSize="12px",c.style.color=a?"#9ca3af":"#6b7280",c.style.overflow="hidden",c.style.textOverflow="ellipsis",l.appendChild(u),l.appendChild(c),e.appendChild(l)}else e.textContent="(click to add)",e.style.color=a?"#6b7280":"#9ca3af",e.style.fontStyle="italic";return e}function OSe(t,e,n,i,r,o,s){e.innerHTML="",e.style.padding="4px",e.style.cursor="pointer";const a=KM();if(o){const l=o.split(`
`).filter(h=>h.trim()),u=document.createElement("div");u.style.display="flex",u.style.alignItems="center",u.style.gap="4px",u.style.flexWrap="wrap";const c=4;if(l.slice(0,c).forEach(h=>{const d=document.createElement("img");d.src=h.trim(),d.style.width="32px",d.style.height="32px",d.style.objectFit="cover",d.style.borderRadius="4px",d.style.border=a?"1px solid #4b5563":"1px solid #e5e7eb",d.style.cursor="pointer",d.title=h.trim(),d.onerror=()=>{d.style.display="none"},u.appendChild(d)}),l.length>c){const h=document.createElement("span");h.textContent=`+${l.length-c}`,h.style.fontSize="11px",h.style.color=a?"#9ca3af":"#6b7280",h.style.padding="2px 6px",h.style.backgroundColor=a?"#374151":"#f3f4f6",h.style.borderRadius="4px",u.appendChild(h)}e.appendChild(u)}else e.textContent="(click to add)",e.style.color=a?"#6b7280":"#9ca3af",e.style.fontStyle="italic";return e}const ASe=()=>{const[t,e]=Ct.useState([]),[n,i]=Ct.useState([]),[r,o]=Ct.useState([]),[s,a]=Ct.useState(!0),[l,u]=Ct.useState(!1),[c,h]=Ct.useState(!1),[d,f]=Ct.useState(new Set),[p,v]=Ct.useState(null),[b,P]=Ct.useState(!1),_=Ct.useRef(null),F=Ct.useCallback(j=>j.map(Z=>{var Xe,xe,Oe,Re,Ae,Ze,gt,ke;const re=(Xe=Z.variants)==null?void 0:Xe[0],pe=(xe=re==null?void 0:re.prices)==null?void 0:xe.find(G=>G.currency_code==="usd");return{id:Z.id,title:Z.title,subtitle:Z.subtitle||"",handle:Z.handle,status:Z.status,description:Z.description||"",thumbnail:Z.thumbnail||"",collection:((Oe=Z.collection)==null?void 0:Oe.title)||"",collectionId:((Re=Z.collection)==null?void 0:Re.id)||"",categories:((Ae=Z.categories)==null?void 0:Ae.map(G=>G.name).join(", "))||"",categoryIds:((Ze=Z.categories)==null?void 0:Ze.map(G=>G.id))||[],variantTitle:(re==null?void 0:re.title)||"Default",variantId:(re==null?void 0:re.id)||"",sku:(re==null?void 0:re.sku)||"",price:pe?(pe.amount/100).toFixed(2):"0.00",images:((gt=Z.images)==null?void 0:gt.map(G=>G.url).join(`
`))||"",imageCount:((ke=Z.images)==null?void 0:ke.length)||0}}),[]),I=async()=>{a(!0);try{const j=window.__BACKEND_URL__||"https://backend-production-0d907.up.railway.app",Z=await fetch(`${j}/admin/products?limit=100&fields=*variants,*variants.prices,*images,*collection,*categories`,{credentials:"include"});if(!Z.ok)throw new Error("Failed to fetch products");const re=await Z.json(),Xe=await(await fetch(`${j}/admin/product-categories?limit=100`,{credentials:"include"})).json(),Oe=await(await fetch(`${j}/admin/collections?limit=100`,{credentials:"include"})).json();e(re.products||[]),i(Xe.product_categories||[]),o(Oe.collections||[])}catch(j){console.error(j),So.error("Failed to load data")}finally{a(!1)}};Ct.useEffect(()=>{I()},[]),Ct.useEffect(()=>{const j="handsontable-dark-mode-styles";if(!document.getElementById(j)){const Z=document.createElement("style");Z.id=j,Z.textContent=ISe,document.head.appendChild(Z)}return()=>{const Z=document.getElementById(j);Z&&Z.remove()}},[]);const W=F(t),k=[{data:"thumbnail",title:"Thumbnail",width:180,renderer:xSe},{data:"title",title:"Title",width:200},{data:"sku",title:"SKU",width:120},{data:"price",title:"Price (USD)",width:100,type:"numeric",numericFormat:{pattern:"0.00"}},{data:"status",title:"Status",width:100,type:"dropdown",source:["draft","published","proposed","rejected"]},{data:"images",title:"Images",width:200,renderer:OSe},{data:"collection",title:"Collection",width:150,type:"dropdown",source:["",...r.map(j=>j.title)]},{data:"categories",title:"Categories",width:150,readOnly:!0},{data:"handle",title:"Handle",width:150},{data:"subtitle",title:"Subtitle",width:150},{data:"description",title:"Description",width:250},{data:"id",title:"ID",width:200,readOnly:!0}],$=(j,Z)=>{if(Z==="loadData"||!j)return;h(!0);const re=new Set(d);j.forEach(([pe])=>{re.add(pe)}),f(re)},Y=(j,Z)=>{var pe;const re=(pe=k[Z.col])==null?void 0:pe.data;if(re==="images"||re==="thumbnail"){const Xe=t[Z.row];Xe&&(v(Xe),P(!0))}},J=async()=>{var xe;if(!_.current)return;u(!0);const Z=_.current.hotInstance.getSourceData(),re=window.__BACKEND_URL__||"https://backend-production-0d907.up.railway.app";let pe=0,Xe=0;for(const Oe of d){const Re=Z[Oe];if(!(!Re||!Re.id))try{const Ae={title:Re.title,subtitle:Re.subtitle||null,handle:Re.handle,status:Re.status,description:Re.description||null};if(Re.collection){const gt=r.find(ke=>ke.title===Re.collection);gt&&(Ae.collection_id=gt.id)}else Ae.collection_id=null;if(Re.thumbnail!==((xe=t[Oe])==null?void 0:xe.thumbnail)&&(Ae.thumbnail=Re.thumbnail||null),!(await fetch(`${re}/admin/products/${Re.id}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(Ae)})).ok)throw new Error(`Failed to update product ${Re.id}`);if(Re.variantId&&Re.price){const gt=Math.round(parseFloat(Re.price)*100);await fetch(`${re}/admin/products/${Re.id}/variants/${Re.variantId}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({prices:[{amount:gt,currency_code:"usd"}]})})}pe++}catch(Ae){console.error(`Error updating row ${Oe}:`,Ae),Xe++}}u(!1),f(new Set),h(!1),Xe===0?So.success(`Successfully updated ${pe} products`):So.error(`Updated ${pe} products, ${Xe} failed`),await I()},U=()=>{if(!_.current)return;_.current.hotInstance.getPlugin("exportFile").downloadFile("csv",{filename:`products-export-${new Date().toISOString().split("T")[0]}`,columnHeaders:!0,rowHeaders:!1}),So.success("CSV exported")},oe=()=>{var w,y;const[j,Z]=Ct.useState(!1),re=Ct.useRef(null);if(!p||!b)return null;const pe=KM(),Xe=window.__BACKEND_URL__||"https://backend-production-0d907.up.railway.app",xe=()=>{P(!1),v(null)},Oe=async T=>{const D=p.thumbnail;v(m=>m?{...m,thumbnail:T}:null),e(m=>m.map(C=>C.id===p.id?{...C,thumbnail:T}:C));try{if(!(await fetch(`${Xe}/admin/products/${p.id}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({thumbnail:T})})).ok)throw new Error("Failed to update thumbnail");So.success("Thumbnail updated")}catch{v(C=>C?{...C,thumbnail:D}:null),e(C=>C.map(S=>S.id===p.id?{...S,thumbnail:D}:S)),So.error("Failed to update thumbnail")}},Re=async T=>{var m;const D=T.target.files;if(!(!D||D.length===0)){Z(!0);try{const C=new FormData;for(let L=0;L<D.length;L++)C.append("files",D[L]);const S=await fetch(`${Xe}/admin/uploads`,{method:"POST",credentials:"include",body:C});if(!S.ok)throw new Error("Failed to upload images");const E=((m=(await S.json()).files)==null?void 0:m.map(L=>L.url))||[];if(E.length===0)throw new Error("No files uploaded");const R=p.images||[],N=E.map((L,V)=>({id:`temp-${Date.now()}-${V}`,url:L})),M=[...R,...N];if(!(await fetch(`${Xe}/admin/products/${p.id}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({images:M.map(L=>({url:L.url}))})})).ok)throw new Error("Failed to add images to product");v(L=>L?{...L,images:M}:null),e(L=>L.map(V=>V.id===p.id?{...V,images:M}:V)),So.success(`${E.length} image(s) uploaded`)}catch(C){console.error("Upload error:",C),So.error("Failed to upload images")}finally{Z(!1),re.current&&(re.current.value="")}}},Ae=async T=>{if(!confirm("Remove this image from the product?"))return;const D=p.images||[],m=p.thumbnail,C=D.filter(x=>x.url!==T),S=m===T?null:m;v(x=>x?{...x,images:C,thumbnail:S}:null),e(x=>x.map(E=>E.id===p.id?{...E,images:C,thumbnail:S}:E));try{if(!(await fetch(`${Xe}/admin/products/${p.id}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({images:C.map(E=>({url:E.url})),...m===T?{thumbnail:null}:{}})})).ok)throw new Error("Failed to remove image");So.success("Image removed")}catch{v(E=>E?{...E,images:D,thumbnail:m}:null),e(E=>E.map(R=>R.id===p.id?{...R,images:D,thumbnail:m}:R)),So.error("Failed to remove image")}},Ze=pe?"#1f2937":"white",gt=pe?"#374151":"#f9fafb",ke=pe?"#4b5563":"#e5e7eb",G=pe?"#f3f4f6":"#111827",g=pe?"#9ca3af":"#6b7280";return be.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:xe,children:be.jsxs("div",{style:{backgroundColor:Ze,borderRadius:"12px",padding:"24px",maxWidth:"900px",width:"90%",maxHeight:"85vh",overflow:"auto",color:G},onClick:T=>T.stopPropagation(),children:[be.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[be.jsxs("div",{children:[be.jsx(aP,{level:"h2",style:{color:G},children:"Manage Images"}),be.jsx(Ro,{style:{color:g},children:p.title})]}),be.jsx(Kh,{variant:"secondary",size:"small",onClick:xe,children:"Close"})]}),be.jsxs("div",{style:{padding:"20px",border:`2px dashed ${ke}`,borderRadius:"8px",textAlign:"center",marginBottom:"24px",backgroundColor:gt},children:[be.jsx("input",{type:"file",ref:re,multiple:!0,accept:"image/*",onChange:Re,style:{display:"none"},id:"image-upload"}),be.jsx(cH,{style:{width:"32px",height:"32px",color:g,margin:"0 auto 8px"}}),be.jsx(Ro,{style:{color:g,marginBottom:"12px",display:"block"},children:"Drag & drop images here, or click to browse"}),be.jsx(Kh,{variant:"secondary",onClick:()=>{var T;return(T=re.current)==null?void 0:T.click()},disabled:j,children:j?"Uploading...":"Upload Images"})]}),be.jsxs("div",{style:{marginBottom:"24px"},children:[be.jsx(Ro,{style:{fontWeight:600,color:G,marginBottom:"8px",display:"block"},children:"Current Thumbnail"}),p.thumbnail?be.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[be.jsx("img",{src:p.thumbnail,alt:"Thumbnail",style:{width:"80px",height:"80px",objectFit:"cover",borderRadius:"8px",border:"3px solid #10b981"}}),be.jsx(Ro,{style:{color:g,fontSize:"14px"},children:"This image appears as the product thumbnail in listings"})]}):be.jsx("div",{style:{width:"80px",height:"80px",backgroundColor:gt,borderRadius:"8px",border:`2px dashed ${ke}`,display:"flex",alignItems:"center",justifyContent:"center"},children:be.jsx(Ro,{style:{color:g,fontSize:"12px"},children:"None"})})]}),be.jsxs("div",{children:[be.jsxs(Ro,{style:{fontWeight:600,color:G,marginBottom:"12px",display:"block"},children:["Product Images (",((w=p.images)==null?void 0:w.length)||0,")"]}),!p.images||p.images.length===0?be.jsx("div",{style:{padding:"40px",textAlign:"center",backgroundColor:gt,borderRadius:"8px"},children:be.jsx(Ro,{style:{color:g},children:"No images yet. Upload some images above."})}):be.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(160px, 1fr))",gap:"16px"},children:(y=p.images)==null?void 0:y.map((T,D)=>{const m=T.url===p.thumbnail;return be.jsxs("div",{style:{position:"relative",backgroundColor:gt,borderRadius:"8px",overflow:"hidden",border:m?"3px solid #10b981":`1px solid ${ke}`},children:[m&&be.jsx("div",{style:{position:"absolute",top:"8px",left:"8px",backgroundColor:"#10b981",color:"white",padding:"2px 8px",borderRadius:"4px",fontSize:"11px",fontWeight:600,zIndex:1},children:"Thumbnail"}),be.jsx("button",{onClick:()=>Ae(T.url),style:{position:"absolute",top:"8px",right:"8px",backgroundColor:"rgba(239, 68, 68, 0.9)",color:"white",border:"none",borderRadius:"4px",width:"24px",height:"24px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",zIndex:1},title:"Remove image",children:"Ã"}),be.jsx("img",{src:T.url,alt:`Image ${D+1}`,style:{width:"100%",height:"140px",objectFit:"cover"}}),be.jsx("div",{style:{padding:"8px"},children:!m&&be.jsx(Kh,{variant:"secondary",size:"small",style:{width:"100%",fontSize:"12px"},onClick:()=>Oe(T.url),children:"Set as Thumbnail"})})]},T.id)})})]})]})})};return be.jsxs(be.Fragment,{children:[be.jsx(bV,{}),be.jsx(oe,{}),be.jsxs(fV,{className:"p-0 max-w-full",children:[be.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[be.jsxs("div",{children:[be.jsx(aP,{level:"h1",children:"Bulk Product Editor"}),be.jsx(Ro,{className:"text-ui-fg-subtle",children:"Edit products in a spreadsheet view. Double-click images to manage them."})]}),be.jsxs("div",{className:"flex gap-2 items-center",children:[c&&be.jsxs(gV,{color:"orange",children:[d.size," unsaved changes"]}),be.jsxs(Kh,{variant:"secondary",onClick:U,disabled:s,children:[be.jsx(aH,{}),"Export CSV"]}),be.jsx(Kh,{onClick:J,disabled:!c||l||s,children:l?"Saving...":"Save Changes"})]})]}),be.jsx("div",{className:"p-4",children:s?be.jsx("div",{className:"flex items-center justify-center py-20",children:be.jsx(Ro,{children:"Loading products..."})}):be.jsx("div",{style:{width:"100%",minHeight:"600px"},children:be.jsx(Mk,{ref:_,data:W,columns:k,colHeaders:!0,rowHeaders:!0,width:"100%",height:600,stretchH:"all",manualColumnResize:!0,manualRowResize:!0,contextMenu:!0,filters:!0,dropdownMenu:!0,multiColumnSorting:!0,autoWrapRow:!0,autoWrapCol:!0,afterChange:$,afterOnCellMouseDown:Y,licenseKey:"non-commercial-and-evaluation",rowHeights:50})})}),be.jsx("div",{className:"px-6 py-4 border-t bg-ui-bg-subtle",children:be.jsxs(Ro,{className:"text-ui-fg-subtle text-sm",children:[be.jsx("strong",{children:"Tips:"})," Double-click to edit cells. Click on thumbnail/images to manage product images. Use dropdowns for Status and Collection. Right-click for context menu."]})})]})]})},iRe=ASe;export{iRe as Component,ASe as default};
